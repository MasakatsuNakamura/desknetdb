/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.mlink={PAGE_MLINKINDEX:"mlinkindex",init:function(){var b=a("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(b);if(b==desknets.mlink.PAGE_MLINKINDEX){desknets.mlink.mlinkindex.init()}}};desknets.page(desknets.mlink,"mlinkindex",desknets.PageBase,{$menulist:null,init:function(){var b=this;b.initMenu();b.initToc();b.initSet()},initMenu:function(){var d=this;$menulist=a(".mlink-menulist");var c=desknets.Resource.mlink.portal;var b=desknets.Resource.mlink.pset;var e=desknets.Resource.mlink.gototop;$menulist.find("#co-m-h-tabs, #co-m-h-select, #co-m-h-setting-link, #jco-m-sub-title, .hplink").remove();if(desknets.pageframe.isCost()){$menulist.find("#pset-cost-list-open, #sch-cost-list-open").addClass("jmlink-cost-list-open")}else{$menulist.find(".jpset-cost-setting-link, .jsch-cost-setting-link").remove()}$menulist.find("#co-m-h-setting").removeAttr("id");$menulist.find("#co-m-h-setting-menus").removeAttr("id");$menulist.find(".co-m-header").removeAttr("class");$menulist.find(".co-m-h-setting-list-label, .co-setting-toggle>a").each(function(){var g=a(this);var f=a('<span class="co-m-h-setting-subtitle"/>');g.replaceWith(f.text(g.text()))});$menulist.find(".jmlink-menu-item").each(function(){if(a(this).attr("id")=="mlink-menu-portal"){a(this).find(".mglink").eq(1).removeClass("mglink").addClass("adlink")}else{if(a(this).attr("id")=="mlink-menu-pset"){a(this).find(".co-m-h-setting-menu").addClass("stlink")}else{if(a(this).attr("id")=="mlink-menu-set"){a(this).find(".co-m-h-setting-menu:first-child, .sysad-setting-menus").removeClass();var h=["stlink","mglink","adlink"];a(this).find(".sysad-setting-menus-row").removeClass().addClass("co-pop-up-box").children().each(function(j){a(this).addClass("co-m-h-setting-menu "+h[j])});a(this).children().find("h3, h4").addClass("co-m-h-setting-subtitle")}else{if(a(this).attr("id")=="mlink-menu-flow"){var f=a(this).find(".flow-aset");var g=a(this).find(".mglink");if(!f.hasClass("flow-all_manager")&&!f.hasClass("flow-tmpl_manager")){f.remove()}else{f.removeClass("stlink")}if(g.hasClass("flow-grp_manager")){g.find(".co-m-h-setting-item").not("#flowmsetindex").remove()}}}}}a("<h4/>").prependTo(a(this)).text(a(this).find(".co-m-title").remove().text());a('<a class="mlink-gototop" href="#" title="'+e+'" data-target="#">'+e+"</a>").appendTo(a(this));if(a(this).find(".stlink").length===0){a(this).find(".co-pop-up-box").prepend(a('<div class="co-m-h-setting-menu stlink"><span class="co-m-h-setting-subtitle">&nbsp;</span></div>'))}if(a(this).find(".mglink").length===0){a(this).find(".stlink").after(a('<div class="co-m-h-setting-menu mglink"><span class="co-m-h-setting-subtitle">&nbsp;</span></div>'))}if(a(this).find(".adlink").length===0){a(this).find(".mglink").after(a('<div class="co-m-h-setting-menu adlink"><span class="co-m-h-setting-subtitle">&nbsp;</span></div>'))}if(a(this).attr("id")=="mlink-menu-portal"){a(this).find(".portal-button, .portal-tabs").remove();a(this).find("h4").text(c)}else{if(a(this).attr("id")=="mlink-menu-pset"){a(this).find("h4").text(b)}else{if(a(this).attr("id")=="mlink-menu-flow"){a(this).find(".flow-aset").remove().children().prependTo(a(this).find(".mglink"))}}}});$menulist.show()},initToc:function(){var d=this;var i=a(window);var f=a("#dn-main-wrap .co-m-content");var b=f.find(".mlink-toc");var c=f.find(".co-setarea");var e=b.height();var h=b.offset();var g=500;b.css({width:b.width(),position:"fixed",top:h.top,zIndex:2});e=e+30;c.css({"margin-top":e+"px"});i.on("scroll.mlink resize.mlink",function(k){var j=i.scrollTop();var l=i.scrollLeft();b.css({top:j>h.top?0:h.top-j,left:f.offset().left-l})});a(".mlink-toc, .mlink-menulist").on("click.mlink","a",function(k){var j=a(this).data("target");if(!a(this).attr("target")&&j&&j.indexOf("#")===0&&!a(this).data("page")&&!a(this).parent().hasClass("jmlink-cost-list-open")){a("html, body").animate({scrollTop:j==="#"||j===""?0:a(j).offset().top},g,"swing");k.preventDefault()}})},initSet:function(){var b=this;if(desknets.pageframe.isCost()){$menulist.find(".jmlink-cost-list-open").click(function(d){d.preventDefault();desknets.popUp.hide(a(this));desknets.cost.list.open()})}$menulist.find(".jmail-prisetting-link").click(function(d){d.preventDefault();desknets.webmail.openSettingPage(a(this).find("a").data("page"),false)});$menulist.find(".jmailimap-prisetting-link").click(function(d){d.preventDefault();desknets.webmailimap.openSettingPage(a(this).find("a").data("page"),false)});var c=$menulist.find("#mlink-menu-addr .co-m-h-setting-menu.stlink").attr("data-target");$menulist.find(".jaddr-prisetting-link").click(function(d){d.preventDefault();if(c=="2"){desknets.webmailimap.openSettingPage(a(this).find("a").data("page"),false)}else{desknets.webmail.openSettingPage(a(this).find("a").data("page"),false)}})}});app.addInitialAction(function(){desknets.mlink.init()})})(jQuery);