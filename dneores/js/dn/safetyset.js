/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){(function(b){desknets.safetyset={MODULE_MAIN_SAFETY:"zsafety",MODULE_API_SAFETY:"zrsafety",PAGE_SAFETYPSPETGEN:"safetypsetgen",PAGE_SAFETYLIST:"safetylist",PAGE_SAFETYSETADMIN:"safetysetadmin",PAGE_SAFETYSETGEN:"safetysetgen",PAGE_SAFETYSETMANAGER:"safetysetmanager",PAGE_SAFETYSETADMINPAGE:"safetysetadminpage",PAGE_SAFETYSETMAILSERVER:"safetysetmailserver",CMD_SAFETYSETSENDMAIL:"safetysetcmdsendmail",PAGE_SAFETYMSETLIST:"safetymsetlist",CMD_SAFETYMSETLIST:"safetymsetcmdlist",CMD_SAFETYMSETDELIVERYRETRYCONF:"safetymsetcmddeliveryretryconf",CMD_SAFETYMSETDELIVERYRETRY:"safetymsetcmddeliveryretry",CMD_SAFETYMSETDELIVERYTRETRYCONF:"safetymsetcmddeliverytretryconf",CMD_SAFETYMSETDELIVERYTRYRETRY:"safetymsetcmddeliverytryretry",CMD_SAFETYMSETDELIVERYCLEARCONF:"safetymsetcmddeliveryclearconf",CMD_SAFETYMSETDELIVERYCLEAR:"safetymsetcmddeliveryclear",CMD_SAFETYMSETGETCONTACT:"safetymsetcmdgetcontact",CMD_SAFETYMSETCONTENTRY:"safetymsetcmdcontentry",CMD_SAFETYMSETANSWERDOWNLOAD:"safetymsetanswerdownload",PAGE_SAFETYMSETDELIVERYMAIL:"safetymsetdeliverymaillist",CMD_SAFETYMSETDELIVERYMAIL:"safetymsetcmddeliverymail",CMD_SAFETYMSETDELIVERYMAILCONF:"safetymsetcmddeliverymailconf",CMD_SAFETYMSETDELIVERYMAILTRY:"safetymsetcmddeliverymailtry",CMD_SAFETYMSETDELIVERYMAILTRYCONF:"safetymsetcmddeliverymailtryconf",PAGE_SAFETYMSETDISASTERINFO:"safetymsetdisasterinfo",CMD_SAFETYMSETDISASTERINFO:"safetymsetcmddisasterinfolist",CMD_SAFETYMSETDISASTERINFOENTRY:"safetymsetcmddisasterinfoentry",PAGE_SAFETYMSETDELIVERYMAILLIST:"safetymsetdeliverymaillist",PAGE_SAFETYMSETDELIMLLIST:"safetymsetdeliverymail",CMD_SAFETYMSETDELIMLLIST:"safetymsetcmddeliverymaillist",PAGE_SAFETYMSETDELIMLENTRY:"safetymsetdeliverymailentry",CMD_SAFETYMSETDELIMLENTRY:"safetymsetcmddeliverymailentry",PAGE_SAFETYMSETCONTACTLIST:"safetymsetcontactlist",CMD_SAFETYMSETCONTACTLIST:"safetymsetcmdcontactlist",PAGE_SAFETYCONTACTDELIVERYMAIL:"safetycontactdeliverymail",PAGE_SAFETYMSETCONCONTACTDELIVERYMAIL:"safetymsetcontactdeliverymail",CMD_SAFETYMSETCONCONTACTDELIVERYGROUP:"safetymsetcmdcontactdeliverygrp",CMD_SAFETYMSETCONTACTDELIVERYMAIL:"safetymsetcmdcontactdeliverymail",CMD_SAFETYMSETCONTACTDELIVERYMAILCONF:"safetymsetcmdcontactdeliveryconf",CMD_SAFETYMSETREGDELIVERYMAIL:"safetymsetcmdregdeliverymail",CMD_SAFETYMSETREGDELIVERYMAILCONF:"safetymsetcmdregdeliverymailconf",PAGE_SAFETYMSETREGLIST:"safetymsetreglist",PAGE_SAFETYMSETREGACTDELIVERYMAIL:"safetymsetregdeliverymail",CMD_SAFETYMSETREGDELIVERYRETRY:"safetymsetcmdregdeliveryretry",CMD_SAFETYMSETREGDELIVERYRETRYCONF:"safetymsetcmdregdeliveryreconf",CMD_SAFETYMSETREGDELIVERYCLEAR:"safetymsetcmdregdeliveryclear",CMD_SAFETYMSETREGDELIVERYCLRCONF:"safetymsetcmdregdeliveryclrconf",PAGE_SAFETYMSETCONTACTIMPORT:"safetymsetcontactimport",PAGE_SAFETYMSETDISASTERPREPAREENTRY:"safetymsetdisasterprepareentry",PAGE_SAFETYMSETEVACUATIONROUTE:"safetymsetevacuationroute",CMD_SAFETYMSETEVACUATIONROUTE:"safetymsetcmdevacuationroutelist",PAGE_SAFETYMSETEVACUATIONROUTEENTRY:"safetymsetevacuationrouteentry",CMD_SAFETYMSETEVACUATIONROUTEENTRY:"safetymsetcmdevacuationentry",CMD_SAFETYMSETEVACUATIONROUTEDEL:"safetymsetcmdevacuationdel",CMD_SAFETYMSETEVACUATIONROUTEDELCONF:"safetymsetcmdevacuationdelconf",CMD_SAFETYMSETEVACUATIONROUTEMOVE:"safetymsetcmdevacuationmove",PAGE_SAFETYMSETADMINLIST:"safetymsetadminlist",CMD_SAFETYMSETCMDADMINENTRY:"safetymsetcmdadminentry",CMD_SAFETYMSETDELIVERYURLMAIL:"safetymsetcmddeliveryurlmail",CMD_SAFETYMSETDISASTERINFODEL:"safetymsetcmddisasterinfodel",init:function(){var c=b("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(c);desknets.hashobserver.init(desknets.safetyset);if(c==desknets.safetyset.PAGE_SAFETYPSPETGEN){desknets.safetyset.psetgen.init()}else{if(c==desknets.safetyset.PAGE_SAFETYSETADMINPAGE){b("#jco-m-sub-title").html(b(".jco-title").val())}else{if(c==desknets.safetyset.PAGE_SAFETYSETGEN){desknets.safetyset.setgen.init()}else{if(c==desknets.safetyset.PAGE_SAFETYSETMANAGER){desknets.safetyset.safetysetmanager.init()}else{if(c==desknets.safetyset.PAGE_SAFETYSETADMINPAGE){desknets.safetyset.safetysetadminpage.init()}else{if(c==desknets.safetyset.PAGE_SAFETYSETMAILSERVER){desknets.safetyset.safetysetmailserver.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETLIST||c==desknets.safetyset.PAGE_SAFETYMSETDISASTERINFO){desknets.safetyset.safetymsetlist.init();desknets.safetyset._initSetEventDisasterMenu()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETDELIVERYMAIL){desknets.safetyset.safetymsetdeliverymaillist.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETDELIMLLIST){desknets.safetyset.safetymsetdeliverymail.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETCONTACTLIST){desknets.safetyset.safetymsetcontactlist.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETREGLIST){desknets.safetyset.safetymsetreglist.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETREGACTDELIVERYMAIL){desknets.safetyset.safetymsetregdeliverymail.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETCONTACTIMPORT){desknets.safetyset.safetymsetcontactimport.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETDISASTERPREPAREENTRY){desknets.safetyset.safetymsetdisasterprepareentry.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETEVACUATIONROUTE){desknets.safetyset.safetymsetevacuationroute.init()}else{if(c==desknets.safetyset.PAGE_SAFETYMSETADMINLIST){desknets.safetyset.safetymsetadminlist.init()}}}}}}}}}}}}}}}}},_initSetEventDisasterMenu:function(){var c=this;b(".co-m-h-setting-menu").delegate("#safetymsetdisasterinfo","click",function(d){d.preventDefault();var e="cmd="+c.PAGE_SAFETYMSETDISASTERINFO;c.safetymsetlist._hashUpdatePageView(c.PAGE_SAFETYMSETDISASTERINFO);desknets.paramanalyzer.setLocationHash(e);b("#co-m-h-setting-menus").removeClass("show")})}}})(jQuery);(function(b){desknets.page(desknets.safetyset,"psetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.safetyset.PAGE_SAFETYLIST}})})(jQuery);desknets.page(desknets.safetyset,"safetymsetlist",desknets.safety.safetylist,{boSetUpWaterMark:false,init:function(){var b=this;b.callBase("init");desknets.safetyset.safetymsetdisasterinfo.init()},_setListEvent:function(){var b=this;var c={"$entrySuccessFunc":desknets.safetyset.safetymsetlist._entryContact,"$cmd":desknets.safetyset.CMD_SAFETYMSETCONTENTRY};desknets.safety.contactalteruserdl.init(c);a(".safety-table-list").delegate(".safety-dialog-deputy","click",function(d){d.preventDefault();var k=this;var g=a(d.target.parentNode.parentNode);var f=g.find("input[name=id]").val();var e=g.find(".safety-dialog-deputy").text();var h=g.find(".safety-dialog-deputy").data("value");var l=[];var i={};var j={cmd:desknets.safetyset.CMD_SAFETYMSETGETCONTACT,id:f};i={success:function(n,m,o){desknets.safety.contactalteruserdl.setparam(f,n.Tel,n.Mail,e,h);desknets.safety.contactalteruserdl.open()},error:function(n,m,o){desknets.ajax.onError(n.status,o)}};l=a.extend({},i);desknets.safetyset.safetymsetlist._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_JSON,j,l)});a(".safety-table-list").delegate(".co-td-num a","click",function(d){d.preventDefault();var e=a(d.target).parent().parent().find("[name=id]").val();desknets.safety.safetyreport.setparam(e);desknets.safety.safetyreport.open()});a(".safety-answer-download").click(function(f){f.preventDefault();var d=this;var e=desknets.getUrl(desknets.safetyset.MODULE_MAIN_SAFETY)+"/safetystatus.csv?cmd="+desknets.safetyset.CMD_SAFETYMSETANSWERDOWNLOAD;desknets.execLocation(e)});a(".safety-delivery-mail").click(function(f){f.preventDefault();var d=this;var e=desknets.getUrl(desknets.safetyset.MODULE_MAIN_SAFETY)+"?cmd="+desknets.safetyset.PAGE_SAFETYMSETDELIVERYMAILLIST;desknets.execLocation(e)});a(".safety-m-tb-item>a").click(function(g){g.preventDefault();var h=a("#jco-pv-funcid").val();var f=a(g.target).data("url");var i="";if(!desknets.PageBase.isConnecting()){if(f=="cmd="+desknets.safetyset.PAGE_SAFETYMSETLIST){var d=desknets.safetyset.safetymsetlist;var e=d.$mjListPage.find(".jco-back-page-data");if(h==desknets.safetyset.PAGE_SAFETYMSETLIST){d._getListAjax(d._getListRow())}i=desknets.getInputDataToUrl(e);i=i+"&cmd="+desknets.safetyset.PAGE_SAFETYMSETLIST}else{var d=desknets.safetyset.safetymsetdisasterinfo;if(h==desknets.safetyset.PAGE_SAFETYMSETDISASTERINFO){a("textarea").val("");d.sId=1;d.eId=-1;d.noMorePassedInfo=false;d._getListData()}i="cmd="+desknets.safetyset.PAGE_SAFETYMSETDISASTERINFO}desknets.paramanalyzer.setLocationHash(i)}});desknets.safetyset.safetydeliveryretrydl.init(function(){b._DeliveryRetryMailSend()});a("[name=deliveryretry]").click(function(d){d.preventDefault();b.clickDeliveryRetryBtn(d)});desknets.safetyset.safetycleardl.init(function(){b._clearAnswerList()});a("[name=clear]").click(function(d){d.preventDefault();b.clickClearBtn(d)})},clickDeliveryRetryBtn:function(b){var j=this;var c=null;var d=null;var e="";var h=a(".jco-sel-items span");var f=h.attr("title");f=desknets.tmpl.escapeWord(f);var g=a("input[name=gid]").val();c=j._getRestModule();d=desknets.getUrl(c);if(j.training==1){e=desknets.safetyset.CMD_SAFETYMSETDELIVERYTRETRYCONF}else{e=desknets.safetyset.CMD_SAFETYMSETDELIVERYRETRYCONF}var i={cmd:e,id:g};desknets.ajax.rest({url:d,data:i,success:function(){desknets.safetyset.safetydeliveryretrydl.setparam(f);desknets.safetyset.safetydeliveryretrydl.open()}})},_DeliveryRetryMailSend:function(e){var b=this;var d=null;var h="";var g=a("input[name=gid]").val();var c=b._getRestModule();d=desknets.getUrl(c);if(b.training==1){h=desknets.safetyset.CMD_SAFETYMSETDELIVERYTRYRETRY}else{h=desknets.safetyset.CMD_SAFETYMSETDELIVERYRETRY}var f={cmd:h,id:g,sendtype:"2"};desknets.ajax.rest({url:d,data:f,success:function(){b._getListAjax(b._getListRow())}})},clickClearBtn:function(b){var k=this;var j=0;var f=null;var c=null;var d=null;var e="";var h=a(".jco-sel-items span");f=h.text();f=f.substring(1,f.length-1);var g=a("[name=gid]").val();c=k._getRestModule();d=desknets.getUrl(c);e=desknets.safetyset.CMD_SAFETYMSETDELIVERYCLEARCONF;var i={cmd:e,id:g};desknets.ajax.rest({url:d,data:i,success:function(l){desknets.safetyset.safetycleardl.setparam(l.msg,l.addmsg);desknets.safetyset.safetycleardl.open()}})},_clearAnswerList:function(){var b=this;var d=null;var c=null;var g="";var f=a("input[name=gid]").val();d=b._getRestModule();c=desknets.getUrl(d);g=desknets.safetyset.CMD_SAFETYMSETDELIVERYCLEAR;var e={cmd:g,id:f};desknets.ajax.rest({url:c,data:e,success:function(){b._getListAjax(b._getListRow())}})},_entryContact:function(b){var d=desknets.Resource.Message.safetyContactSuccessMsg;var c={type:"message"};desknets.dialog.alert(d,c)},_getListAjaxSuccess:function(c){var b=this;b.callBase("_getListAjaxSuccess",c);var d=b.$mjListPage.find(".jco-sel-items").find("input").val();if(c.userconfflg=="1"&&d!=desknets.PRM_VAL_ALLDEL){a(".safety-userconfbtn").show()}else{a(".safety-userconfbtn").hide()}clearTimeout(desknets.safetyset.safetymsetdisasterinfo.timerObserver);b._showPage()},_showPage:function(){var b=this;a(".co-m-h-setting-item").removeClass("on");a("#jco-pv-funcid").val(b._getListCmd());desknets.pageframe.setFuncSel(a("#jco-pv-funcid").val());a(".safety-answer-btn").show();a(".safety-tab-list").show();a(".safety-tab-disasterinfo").hide();a(".safety-tab").find(".safety-m-tb-answerlist").addClass("on");a(".safety-tab").find(".safety-m-tb-disasterinfo").removeClass("on");a(".jco-page").show();b._setWaterMark()},_setWaterMark:function(){var b=this;if(a(".safety-tab-list").css("display")=="block"&&!b.boSetUpWaterMark){setTimeout(function(){desknets.watermark.set(a(".co-list-search-text"))},500);b.boSetUpWaterMark=true}},_hashUpdatePageView:function(c){var b=desknets.safetyset.safetymsetdisasterinfo;if(c==this._getDisasterPage()){a("textarea").val("");b.sId=1;b.eId=-1;b.noMorePassedInfo=false;b._getListData();b._showPage()}},_getListCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETLIST},_getListExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETLIST},_getDisasterPage:function(){return desknets.safetyset.PAGE_SAFETYMSETDISASTERINFO}});desknets.page(desknets.safetyset,"safetydeliveryretrydl",null,{$root:null,gName:"",$options:{},init:function(c){var b=this;b.$options=c},setparam:function(b){this.gName=b},open:function(){var b=this;if(b.$root==null){b._create()}else{b._show()}},_create:function(){var b=this;var c=this._getDialogOptions();b.$root=desknets.dialog.make("safety-confmailsend-dialog",c);b._show()},_getDialogOptions:function(){var b=this;var d={};var c={title:desknets.Resource.safety.safetyRetryMailTitle,width:530,dialogClass:"dn-dialog",modal:true,resizable:false,beforeclose:function(e){return b._onBeforeCloseConfirm(e,a(this),b.$options)},buttons:d};d[desknets.Resource.OKButtonLabel]=function(e){a(this).data("result","ok").dialog("close")};d[desknets.Resource.CancelButtonLabel]=function(e){a(this).data("result","cancel").dialog("close")};return c},_show:function(){var b=this;var c=desknets.Resource.Message.safetyRetlyMailConfirm;c=desknets.tmpl.replaceWordHtml(c,"gname",b.gName);desknets.dialog._setMessage(b.$root,c);b.$root.dialog("open");desknets.dialog.setFirstDialogOpen(b.$root)},_onBeforeCloseConfirm:function(d,e,c){var b=e.data("result");e.data("result","");if(b=="ok"&&typeof(c)=="function"){return c.apply(e[0])}}});desknets.page(desknets.safetyset,"safetycleardl",null,{$root:null,msg:"",addMsg:"",$options:{},init:function(c){var b=this;b.$options=c},setparam:function(c,b){this.msg=c;this.addMsg=b},open:function(){var b=this;if(b.$root==null){b._create()}else{b._show()}},_create:function(){var b=this;var c=b._getDialogOptions();this.$root=desknets.dialog.make("safety-clear-dialog",c);desknets.dialog._setMessage(b.$root,b.msg);b._show()},_getDialogOptions:function(){var b=this;var d={};var c={title:desknets.Resource.safety.safetyClearTitle,width:530,dialogClass:"dn-dialog",modal:true,resizable:false,beforeclose:function(e){return b._onBeforeCloseConfirm(e,a(this),b.$options)},buttons:d};d[desknets.Resource.OKButtonLabel]=function(e){a(this).data("result","ok").dialog("close")};d[desknets.Resource.CancelButtonLabel]=function(e){a(this).data("result","cancel").dialog("close")};return c},_show:function(){var b=this;desknets.dialog._setAddMessage(b.$root,b.addMsg,"co-msg-r");b.$root.dialog("open");desknets.dialog.setFirstDialogOpen(b.$root)},_onBeforeCloseConfirm:function(d,e,c){var b=e.data("result");e.data("result","");if(b=="ok"&&typeof(c)=="function"){return c.apply(e[0])}}});desknets.page(desknets.safetyset,"safetymsetdeliverymaillist",desknets.PageInputList,{init:function(){var b=this;b._initStartSet();b.callBase("init")},_initStartSet:function(){var c=this;var b=a("[name=mailsend]");b.click(function(d){c._setEntConfirm()});desknets.safety.contactdeliverydl.init(function(){c._sendMailSubmit()})},_setEntConfirm:function(){var o=this;var n=0;var g=null;var j=[];var p=null;var d=null;var l=o.$mjListPage.find(".jco-checkbox-all").attr("checked");var f=null;var i=null;var h=null;var k=null;var e=null;f=a("[name=sendtype]:checked").val();if(f=="1"){i=desknets.Resource.Message.safetySendGrpConfirm;h=desknets.safetyset.CMD_SAFETYMSETDELIVERYMAILCONF}else{i=desknets.Resource.Message.safetyTrgSendGrpConfirm;h=desknets.safetyset.CMD_SAFETYMSETDELIVERYMAILTRYCONF;k=desknets.Resource.safety.safetyContactDeliveryDiaRegTitle;e="safety-contact-deliveryregdialog"}if(!l){o.$mjListPage.find('input[name="id"]:checked').each(function(){j[j.length]=a(this.parentNode.parentNode).find(".company").find("label").html()})}if(j.length>0||l){if(l){d=desknets.Resource.safety.safetySendAllGroup;g=d}else{d=desknets.Resource.safety.safetySendConfDeliGrp;for(n=0;n<j.length;n++){if(n==0){g=j[n]}else{g=g+","+j[n]}}}p=i;p=desknets.tmpl.replaceWordHtml(p,"gname",d);var c=null;var b=null;var m={};c=o._getRestModule();b=desknets.getUrl(c);o._getSendMailPrm(h,m);desknets.ajax.rest({url:b,data:m,success:function(r,q,s){desknets.safety.contactdeliverydl.setparam(g,p,o.addMsgFig,k,e);desknets.safety.contactdeliverydl.open()},traditional:true})}else{desknets.dialog.alert(desknets.Resource.Message.safetyNoSelectGroup,{type:"warn"})}},_sendMailSubmit:function(){var b=this;var d=null;var c=null;var e={};var f=null;var g=a("[name=sendtype]:checked").val();if(g=="1"){f=desknets.safetyset.CMD_SAFETYMSETDELIVERYMAIL}else{f=desknets.safetyset.CMD_SAFETYMSETDELIVERYMAILTRY}d=b._getRestModule();c=desknets.getUrl(d);b._getSendMailPrm(f,e);desknets.ajax.rest({url:c,data:e,success:function(i,h,j){desknets.execLocation(desknets.getUrl(b._getModule())+"?cmd="+desknets.safetyset.PAGE_SAFETYMSETLIST)},traditional:true})},_getSendMailPrm:function(h,e){var b=this;var c=null;var d=b.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]').val();var g=[];b.$mjListPage.find('input[name="id"]:checked').each(function(){g[g.length]=a(this).val()});var f=b.$mjListPage.find(".jco-checkbox-all").attr("checked");if(f){c="1"}else{c="2"}e.cmd=h;e.gid=d;e.id=g;e.sendtype=c},changeModPage:function(c){var b=this;b.$mjListPage.find(".jco-back-page-data").find("input[name=gid]").val(c);b._listPage("0")},_getListAjaxSuccess:function(h){var k=this;var g=desknets.ajax.getJsonItems(h);var j=[];var b=[];var f=0;var i=0;var e=k._mcListTemplate;var d="";var c=neo.dateTime.parse(h.entrydate);if(g.length<=0){k.$mjListPage.find(".co-table-list").hide();k.$mjTableList.empty();if(h.group){k.$mjListPage.find(".co-btnarea").show();k.$mjListPage.find(".co-nodata.nodata").show();k.$mjListPage.find(".co-nodata.nogroup").hide()}else{k.$mjListPage.find(".co-btnarea").hide();k.$mjListPage.find(".co-nodata.nodata").hide();k.$mjListPage.find(".co-nodata.nogroup").show();k.$mjListPage.find("[name=mailsend]").show()}d="0"}else{k.$mjListPage.find(".co-btnarea").show();k.$mjListPage.find(".co-table-list").show();k.$mjListPage.find(".co-nodata").hide();f=g.length;for(i=0;i<f;i++){j=g[i];b[b.length]=k._listLine(e,j)}k.$mjTableList.empty();k.$mjTableList.html(b.join(""));k._setListStyle(h);d=h.row}k.$mjListPage.find(".jco-back-page-data").find('input[name="row"]').val(d);k.$mjListPage.find(".jco-pv-cnt").val(i);k.$mjListPage.find(".jco-pv-all-cnt").val(h.allcnt);k._getListAjaxSuccessOtherSet(h);k._getListAjaxSuccessEnd()},_getListAjaxSuccessOtherSet:function(c){var b=this;if(c.allgrpflg=="1"){a(".co-btnarea").show();var d=desknets.tmpl.escapeWord(c.group.item.gname);a(".jco-sel-items").find("input[name=gid]").val(c.group.item.id);a(".jco-sel-items span").html(d);a(".jco-sel-items span").attr("title",c.group.item.tgname);a(".jco-sel-items").show()}else{a(".co-btnarea").hide()}b._getBtnOtherSet(c)},_getBtnOtherSet:function(c){var b=this;var d=desknets.ajax.getJsonItems(c);if(d.length<=0&&!c.group){b.$mjListPage.find("[name=mailsend]").hide()}else{b.$mjListPage.find("[name=mailsend]").show()}},getJsonGroups:function(b){if(!b||!b.group){return[]}else{return desknets.ajax.getItems(b.group.item)}},_getListAjaxSuccessEnd:function(){var b=this;var c=desknets.paramanalyzer.getLocationHash();b.callBase("_getListAjaxSuccessEnd");if(neo.isSet(c)&&c.length>0&&b.$mjTableList.find("tr").length>0){b.$mjListPage.find(".jco-checkbox-all").attr("checked","checked").trigger("click").attr("checked","checked")}},_initListEnd:function(){var b=this;b.callBase("_initListEnd");var d={onSelectGroup:function(e){b.changeModPage(e)},onSelectGroupHide:true};var c={allGroup:"choosable",allGroupLabel:desknets.Resource.safety.safetyAllGroup};desknets.page.groupSelect.init(d,c);if(b.$mjTableList.find("tr").length>0){b.$mjListPage.find(".jco-checkbox-all").attr("checked","checked").trigger("click").attr("checked","checked")}},_initListEndChk:function(){var b=this;b.$mjListPage.find(".co-table-list").find("thead").delegate(".jco-checkbox-all","click",function(d){var c=(a(this).attr("checked"))?true:false;b.$mjTableList.find("input[type=checkbox]").attr("checked",c);if(c){b.$mjTableList.find("tr").addClass("co-tr-selected")}else{b.$mjTableList.find("tr").removeClass("co-tr-selected")}if(b.$mjListPage.find(".jco-sort-change").css("display")!="block"){if(c){b.$mjListPage.find(".co-chk-cnt-all").show()}else{b.$mjListPage.find(".co-chk-cnt-all").hide()}}})},_getModule:function(){return desknets.safetyset.MODULE_MAIN_SAFETY},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getListCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETDELIVERYMAIL},_getListExecCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETDELIVERYMAIL}});desknets.page(desknets.safetyset,"safetymsetdisasterinfo",desknets.safety.disasterinfo,{_initDisasterList:function(){var b=this;b.$mjListPage=a("."+b._getListDataClass());b._setListScrollObserve();b._initButtonEvent()},_initButtonEvent:function(){var b=this;var c=a(".safety-tab").find(".safety-tab-disasterinfo");c.delegate(".safety-disasterinfo-btn","click",function(d){d.preventDefault();b._updateDisasterInfo()});c.find(".jsafety-infodel").click(function(d){d.preventDefault();b._delDisasterInfo()});c.find(".jsafety-infodelall").click(function(d){d.preventDefault();b._delAllDisasterInfo()})},_updateDisasterInfo:function(){var b=this;var e=a(".safety-tab").find(".safety-tab-disasterinfo");var d={cmd:b._getAddExecCmd(),memo:e.find(".safety-info-textarea").val()};var c={success:function(g,f,h){b._onAjaxFormSuccess()},errorconvmsg:function(f,g){var h=desknets.getErrField(f,g);h.fieldname=b._getErrorPlace(h.fieldid);return desknets.getErrConvMsg(h)},complete:function(g,f){b.setConnecting(false);desknets.submitform.clearDisabled(a("#listfrm"))}};b._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_JSON,d,c)},_onAjaxFormSuccess:function(){var b=this;a("textarea").val("");b.sId=1;b.eId=-1;b.noMorePassedInfo=false;b._getListData()},_getErrorPlace:function(b){var c=this;if(b!==""){return desknets.getErrFieName(a("#listfrm"),b)}return""},_showPage:function(){var b=this;var c="&nbsp;&gt;&nbsp;"+a(".safety-tab").find(".safety-m-tb-disasterinfo").text();b._setTitle(c);a(".co-m-h-setting-item").removeClass("on");a("#jco-pv-funcid").val(b._getDisasterPage());desknets.pageframe.setFuncSel(a("#jco-pv-funcid").val());a(".safety-answer-btn").hide();a(".safety-tab-list").hide();a(".safety-tab-disasterinfo").show();a(".co-topmsg-text").hide();a(".safety-tab").find(".safety-m-tb-answerlist").removeClass("on");a(".safety-tab").find(".safety-m-tb-disasterinfo").addClass("on");a(".jco-page").show()},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getAddExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETDISASTERINFOENTRY},_getDisasterPage:function(){return desknets.safetyset.PAGE_SAFETYMSETDISASTERINFO},_getListHtml:function(d,c){var b=this;b.htmlListTemplate='<li class="safety-info-list-item">   <div><input type="checkbox" name="id" value="{{id}}"></div>   <div class="uname">&gt;{{Group}} {{entryname}}</div>   <div class="message">{{memo}}</div>   <div class="date">{{date}}</div></li>';return b.callBase("_getListHtml",d,c)},_delDisasterInfo:function(){var c=this;var d=0;var b="";c.$mjListPage.find("input[type=checkbox]").each(function(){if(a(this).attr("checked")){d++;return true}});if(d<1){desknets.dialog.alert(desknets.Resource.Message.com_del_nochecked,{type:"warn"});return}b=desknets.Resource.Message.com_del_listconf;b=desknets.tmpl.replaceWordHtml(b,"count",d);c._setDelConfirm(b);return},_delAllDisasterInfo:function(){var b=this;sMsg=desknets.Resource.Message.com_del_allconf;b._setDelConfirm(sMsg,true);return},_setDelConfirm:function(f,d){var b=this;var c;clearTimeout(b.timerObserver);var e={cancel:function(){b._setListTimerObserve()}};c=desknets.dialog.confirm(f,function(){b._listDel(d,c);return false},e)},_listDel:function(e,c){var i=this;var h=[];if(c!=null){desknets.submitform.setDialogDisabled(c)}if(e){h=desknets.PRM_VAL_ALLDEL}else{i.$mjListPage.find('input[name="id"]:checked').each(function(){h[h.length]=a(this).val()})}var f={};var j={};var b={};b.cmd=desknets.safetyset.CMD_SAFETYMSETDISASTERINFODEL;b.id=h;var d=i._getListExecCmd();var g=i._getMaxRow();f={cmd:d,num:g};j=a.extend({url:desknets.getUrl(i._getRestModule()),data:desknets.ajax.arrayToMultiCmdData([b,f])},i._getListAjaxOptionsExec(c));desknets.ajax.rest(j);return},_getListAjaxOptionsExec:function(d){var b=this;var c={};c={success:function(f,e,g){b.sId=1;b.eId=-1;b.bottom_flag=false;b.noMorePassedInfo=false;b._pageListData(f[1])},complete:function(g,e,f){if(d!=null){desknets.submitform.clearDialogDisabled(d);d.dialog("close")}b._setListTimerObserve()}};return c}});desknets.page(desknets.safetyset,"safetymsetdeliverymail",desknets.PageListBase,{inputDispPage:function(c){var b=this;b.inputModPage(c)},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getListCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETDELIMLLIST},_getListExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETDELIMLLIST},_getListModCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETDELIMLENTRY},_getListModClass:function(){return desknets.safetyset.safetymsetdeliverymailentry}});desknets.page(desknets.safetyset,"safetymsetdeliverymailentry",desknets.PageInputBase,{changPage:function(){var b=this;b.$mjPage.find(".jsafety-hide-itemname").hide();b.callBase("changPage")},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getAddExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETDELIMLENTRY},_getModExecCmd:function(){return this._getAddExecCmd()}});desknets.page(desknets.safetyset,"safetymsetdisasterprepareentry",desknets.PageSet,{init:function(){var b=this;desknets.rte.loadRte();var c={height:"460px",idval:"ckeditor1",};b.callBase("init");desknets.rte.init(a('textarea[name="memo1"]'),c);var e={};a.extend(e,c,{idval:"ckeditor2",initFunc:function(){setTimeout(function(){a('textarea[name="memo1"]').val(CKEDITOR.instances.ckeditor1.getData());a('textarea[name="memo2"]').val(CKEDITOR.instances.ckeditor2.getData());b._inputFormSaveToObserver()},2500)}});desknets.rte.init(a('textarea[name="memo2"]'),e);var d=a(b._mIdPageForm);d.find(".safety-submit-save").click(function(f){desknets.rte.inputSubmitRte(f,d)})},_getNextCmd:function(){return desknets.safetyset.PAGE_SAFETYLIST}});desknets.page(desknets.safetyset,"safetymsetcontactlist",desknets.PageInputList,{_mcGroupOptTemplate:null,$gropList:null,EVENT_SELECT_CHANGEGID:0,EVENT_SELECT_CHANGECONTACT:1,$boAllGroup:false,changeCmdFlg:"0",boDeliveryFlg:false,uselSortListFlg:null,_initSet:function(){var b=this;b._initStartSet();b._setListEvent();b.callBase("_initSet")},_initStartSet:function(){var c=this;var b=a("select[name=sgid]");var d=a("select[name=dispcontact]");b.bind("change",function(e){c.changeModPage(e.target.value,c.EVENT_SELECT_CHANGEGID)});d.bind("change",function(e){c.changeModPage(e.target.value,c.EVENT_SELECT_CHANGECONTACT)});a(".dn-side-close").click(function(){if(c.$mjListPage.find(".co-usel-sort-list").css("display")=="block"){if(c.uselSortListFlg){c.$mjListPage.find(".co-usel-sort-list").hide();c.uselSortListFlg=null}}})},_setListEvent:function(){var b=this;a("#listfrm").delegate("[name=safetymsetcontactdeliverymail]","click",function(d){b.deliveryMailPage(d)});var c={"$entrySuccessFunc":desknets.safetyset.safetymsetcontactlist._entryContact,"$cmd":desknets.safetyset.CMD_SAFETYMSETCONTENTRY};desknets.safety.contactalteruserdl.init(c);a("#listfrm").delegate(".jco-moduserlink","click",function(d){d.preventDefault();b.openAlterUserDir(d)})},changeModPage:function(g,e){var d=this;var c=a("select[name=sgid]");var h=a("select[name=dispcontact]");var f=null;var b=null;if(e==d.EVENT_SELECT_CHANGEGID){f=g;b=h.val()}else{if(e==d.EVENT_SELECT_CHANGECONTACT){if(d.$boAllGroup){f=d.$mjListPage.find(".jco-back-page-data").find("input[name=gid]").val()}else{f=c.val()}b=g}}d.$mjListPage.find(".jco-back-page-data").find("input[name=gid]").val(f);d.$mjListPage.find(".jco-back-page-data").find("input[name=dispcontact]").val(b);d._listPage("0")},deliveryMailPage:function(d){var b=this;var c={};d.preventDefault();c=b._getAddPageParam();c.cmd=b._getListDeliveryMailCmd();b._inputPage(c)},openAlterUserDir:function(b){var i=this;var e=a(b.target.parentNode.parentNode);b.preventDefault();var d=e.find(".jco-id").val();var c=e.find(".jco-moduserlink").text();var f=e.find(".jco-moduserlink").data("value");var h={cmd:desknets.safetyset.CMD_SAFETYMSETGETCONTACT,id:d};var g={success:function(l,k,m){desknets.safety.contactalteruserdl.setparam(d,l.Tel,l.Mail,c,f);desknets.safety.contactalteruserdl.open()},error:function(l,k,m){desknets.ajax.onError(l.status,m)}};var j=a.extend({},g);desknets.safetyset.safetymsetlist._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_JSON,h,j)},_entryContact:function(c){var b=desknets.safetyset.safetymsetcontactlist;setTimeout(function(){b._getListAjax(b._getListRow())},100)},initParamsFromHash:function(c){var b=this;var d=c.cmd;if(!neo.isSet(d)||d==b._getListDeliveryMailCmd()){b.boDeliveryFlg=true}if((!neo.isSet(d)||d==b._getListExecDeliveryMailCmd())&&!b.boDeliveryFlg){c.cmd=b._getListDeliveryMailCmd();b.changeCmdFlg="1"}b.callBase("initParamsFromHash",c)},_hashUpdatePageView:function(c){var b=this;var d=desknets.paramanalyzer.getHashParams();if(c==b._getListDeliveryMailCmd()){b._hashUpdateDeliveryMailPage()}else{if(c==b._getListExecDeliveryMailCmd()){b._hashUpdateDeliveryMailData()}}},_hashUpdateDeliveryMailPage:function(){var b=this;var c;if(neo.isSet(desknets.safetyset.safetymsetcontactdeliverymail)){desknets.safetyset.safetymsetcontactdeliverymail.initPage(b.mhashBackCmd,b.mhashIdBack,b.changeCmdFlg)}},_hashUpdateDeliveryMailData:function(){var b=this;var c;if(neo.isSet(desknets.safetyset.safetymsetcontactdeliverymail)){desknets.safetyset.safetymsetcontactdeliverymail.funcHashObserver()}},_initListStartTemplate:function(){var b=this;b.callBase("_initListStartTemplate");b.$gropList=a("[name=sgid]");b._mcGroupOptTemplate=b.$gropList.html()},_getListAjaxSuccess:function(i){var l=this;var h=desknets.ajax.getJsonItems(i);var k=[];var b=[];var g=0;var j=0;var e=l._mcListTemplate;var d="";var c=neo.dateTime.parse(i.entrydate);var m=i.contactmessage;var f=i.mailstatus;l._getMailMessageOtherSet(i);l._checkMailStatus(i);if(h.length<=0||(m.length>0&&f=="1")){l.$mjListPage.find(".co-table-list").hide();l.$mjListPage.find(".co-list-sort").hide();l.$mjTableList.empty();if(i.group){l.$mjListPage.find(".co-btnarea").show();l.$mjListPage.find(".co-nodata.nodata").show();l.$mjListPage.find(".co-nodata.nogroup").hide()}else{l.$mjListPage.find(".co-btnarea").hide();l.$mjListPage.find(".co-nodata.nodata").hide();l.$mjListPage.find(".co-nodata.nogroup").show()}l.$mjListPage.find(".jco-pager").hide();d="0"}else{l.$mjListPage.find(".co-btnarea").show();l.$mjListPage.find(".co-table-list").show();l.$mjListPage.find(".co-list-sort").show();l.$mjListPage.find(".co-nodata").hide();l.$mjListPage.find(".jco-pager").show();g=h.length;for(j=0;j<g;j++){k=h[j];b[b.length]=l._listLine(e,k)}l.$mjTableList.empty();l.$mjTableList.html(b.join(""));l._setListStyle(i);d=i.row}l.$mjListPage.find(".jco-back-page-data").find('input[name="row"]').val(d);l.$mjListPage.find(".jco-pv-cnt").val(j);l.$mjListPage.find(".jco-pv-all-cnt").val(i.allcnt);l._getListAjaxSuccessOtherSet(i);l._getListAjaxSuccessEnd()},_getListAjaxSuccessOtherSet:function(c){var b=this;var d;if(c.allgrpflg=="1"){a(".safety-allgroup").show();a(".safety-partgroup").hide();d=desknets.tmpl.escapeWord(c.group.item.gname);a(".jco-sel-items [name=gid]").val(c.group.item.id);a(".jco-sel-items span").html(d);a(".jco-sel-items span").attr("title",c.group.item.tgname);a(".jco-sel-items").show();b.$boAllGroup=true}else{a(".safety-allgroup").hide();a(".safety-partgroup").show();b.$boAllGroup=false}b._getBtnOtherSet(c);b._getSelGroupListOtherSet(c);b.callBase("_getListAjaxSuccessOtherSet",c)},_getBtnOtherSet:function(c){var b=this;var e=desknets.ajax.getJsonItems(c);var d=neo.dateTime.parse(c.entrydate);if(c.allgrpflg=="1"){a(".safety-partgroup").hide()}else{if(e.length<=0&&!c.group){b.$mjListPage.find(".safety-partgroup").hide()}else{b.$mjListPage.find(".safety-partgroup").show()}}if(e.length<=0&&!c.group){b.$mjListPage.find(".safety-dispcontact").hide()}else{b.$mjListPage.find(".safety-dispcontact").show()}},_getSelGroupListOtherSet:function(j){var m=this;var i=m.getJsonGroups(j);var d=[];var g=0;var l=0;var c=m.$gropList;var e=m.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]');var f=m._mcGroupOptTemplate;var h=null;var b="";g=i.length;if(g==0){return}for(l=0;l<g;l++){var k=i[l];f=m._mcGroupOptTemplate;for(b in k){f=desknets.tmpl.replaceWord(f,b,k[b])}d[l]=f}c.empty();c.html(d.join(""));if(!e.val()){h=a("select[name=sgid]").find("option").eq(0).val()}else{h=e.val()}c.val(h)},_initListEnd:function(){var b=this;b.callBase("_initListEnd");var d={onSelectGroup:function(e){b.changeModPage(e,b.EVENT_SELECT_CHANGEGID)},onSelectGroupHide:true};var c={allGroup:"choosable",unassignGroup:"choosable"};b.$mjListPage.find('.jco-back-page-data [name="gid"]').val(a('.jco-sel-items [name="gid"]').val());desknets.page.groupSelect.init(d,c)},_getMailMessageOtherSet:function(e){var d=this;var f=null;var c=null;var b=null;var g=desknets.pageframe.getTopMsg();f=e.contactmessage;b=e.mailstatus;if(f.length!=0){if(b=="1"){c="info"}else{c="error"}d.$mjListPage.find("#co-topmsg-text-set").html(f);desknets.pageframe.viewTopMsg(f,c)}else{desknets.pageframe.closeTopMsg()}},_checkMailStatus:function(c){var b=null;b=c.mailstatus;if(b=="1"){setTimeout("desknets.safetyset.safetymsetcontactlist._getListAjax()",5000)}},getJsonGroups:function(b){if(!b||!b.group){return[]}else{return desknets.ajax.getItems(b.group.item)}},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getListCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETCONTACTLIST},_getListExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETCONTACTLIST},_getListDeliveryMailCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETCONCONTACTDELIVERYMAIL},_getListExecDeliveryMailCmd:function(){return desknets.safetyset.CMD_SAFETYMSETCONCONTACTDELIVERYGROUP}});desknets.page(desknets.safetyset,"safetymsetcontactdeliverymail",desknets.PageInputList,{$dialog:null,changeCmdFlg:"0",addMsgFig:"1",_onClickPageBack:function(c){var b=this;var e=desknets.paramanalyzer.getHashParams();if(neo.isSet(e.bproc)){desknets.execLocation(desknets.msUrl+decodeURIComponent(e.bproc))}else{var d=b.getLocationFormParam();if(neo.isSet(d)){b._setLocationHash(d)}}},initPage:function(e,d,c){var b=this;b.changeCmdFlg=c;b.callBase("initPage",e,d)},_initGetHtml:function(){var b=this;var d={};var f={};var e={};var c={};if(b.boGetHtmlSingle&&b.changeCmdFlg=="1"){d.success=function(g){if(g[0]["status"]!=desknets.RES_STATUS_SUCCESS){b.onError(g[0]["errorno"],g[0]["errormessage"])}else{b._initHtml(g)}};e=desknets.paramanalyzer.getHashParams();f=b._getSearchPageParam();f.cmd=b._getListDeliveryMailCmd();c["0"]=f;b._sendRequestAjax(desknets.ajax.REQTYPE_MULTI,desknets.ajax.RESTYPE_JSON,c,d)}else{b.callBase("_initGetHtml")}},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");desknets.safety.contactdeliverydl.init(function(){b._sendMailSubmit()});b.$mjListPage.find("[name=mailsend]").click(function(e){b._setEntConfirm()});var d={pageID:"jco-m-deliverymail-page",initCreate:false,dialogID:"jsafety-sel-chooser-dialog",onSelectGroup:function(e){b.$mjListPage.find(".jco-back-page-data").find("input[name=gid]").val(e);b._listPage("0")},onSelectGroupHide:true};var c={allGroup:"choosable",allGroupLabel:desknets.Resource.safety.safetyAllGroup};desknets.page.groupSelect.init(d,c)},_initListEndChk:function(){var b=this;b.$mjListPage.find(".co-table-list").find("thead").delegate(".jco-checkbox-all","click",function(d){var c=(a(this).attr("checked"))?true:false;b.$mjTableList.find("input[type=checkbox]").attr("checked",c);if(c){b.$mjTableList.find("tr").addClass("co-tr-selected")}else{b.$mjTableList.find("tr").removeClass("co-tr-selected")}if(b.$mjListPage.find(".jco-sort-change").css("display")!="block"){if(c){b.$mjListPage.find(".co-chk-cnt-all").show()}else{b.$mjListPage.find(".co-chk-cnt-all").hide()}}})},_setEntConfirm:function(){var j=this;var i=0;var e=null;var f=[];var k=null;var d=null;var g=j.$mjListPage.find(".jco-checkbox-all").attr("checked");if(!g){j.$mjListPage.find('input[name="id"]:checked').each(function(){f[f.length]=a(this.parentNode.parentNode).find(".company").find("label").html()})}if(f.length>0||g){if(g){d=desknets.Resource.safety.safetySendAllGroup;e=d}else{d=desknets.Resource.safety.safetySendConfDeliGrp;for(i=0;i<f.length;i++){if(i==0){e=f[i]}else{e=e+","+f[i]}}}k=j._getMailSendMessage();k=desknets.tmpl.replaceWordHtml(k,"gname",d);var c=null;var b=null;var h={};c=j._getRestModule();b=desknets.getUrl(c);j._getSendMailPrm(j._getMailSendConfCmd(),h);desknets.ajax.rest({url:b,data:h,success:function(m,l,n){desknets.safety.contactdeliverydl.setparam(e,k,j.addMsgFig);desknets.safety.contactdeliverydl.open()},traditional:true})}else{desknets.dialog.alert(desknets.Resource.Message.safetyNoSelectGroup,{type:"warn"})}},_sendMailSubmit:function(){var b=this;var d=null;var c=null;var e={};d=b._getRestModule();c=desknets.getUrl(d);b._getSendMailPrm(b._getMailSendCmd(),e);desknets.ajax.rest({url:c,data:e,success:function(g,f,h){b.dispBackListPage()},traditional:true})},_getSendMailPrm:function(h,e){var b=this;var c=null;var d=b.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]').val();var g=[];b.$mjListPage.find('input[name="id"]:checked').each(function(){g[g.length]=a(this).val()});var f=b.$mjListPage.find(".jco-checkbox-all").attr("checked");if(f){c="1"}else{c="2"}e.cmd=h;e.gid=d;e.id=g;e.sendtype=c},_getListAjaxSuccess:function(h){var k=this;var g=desknets.ajax.getJsonItems(h);var j=[];var b=[];var f=0;var i=0;var e=k._mcListTemplate;var d="";var c=neo.dateTime.parse(h.entrydate);if(g.length<=0){k.$mjListPage.find(".co-table-list").hide();k.$mjTableList.empty();if(h.group){k.$mjListPage.find(".co-btnarea").show();k.$mjListPage.find(".co-nodata.nodata").show();k.$mjListPage.find(".co-nodata.nogroup").hide()}else{k.$mjListPage.find(".co-btnarea").hide();k.$mjListPage.find(".co-nodata.nodata").hide();k.$mjListPage.find(".co-nodata.nogroup").show()}d="0"}else{k.$mjListPage.find(".co-btnarea").show();k.$mjListPage.find(".co-table-list").show();k.$mjListPage.find(".co-nodata").hide();f=g.length;for(i=0;i<f;i++){j=g[i];b[b.length]=k._listLine(e,j)}k.$mjTableList.empty();k.$mjTableList.html(b.join(""));k._setListStyle(h);d=h.row}k.$mjListPage.find(".jco-back-page-data").find('input[name="row"]').val(d);k.$mjListPage.find(".jco-pv-cnt").val(i);k.$mjListPage.find(".jco-pv-all-cnt").val(h.allcnt);k._getListAjaxSuccessOtherSet(h);k._getListAjaxSuccessEnd()},_getListAjaxSuccessOtherSet:function(c){var b=this;if(c.allgrpflg=="1"){a("#jco-m-deliverymail-page .co-btnarea").show();b.$boAllGroup=true;var d;d=desknets.tmpl.escapeWord(c.group.item.gname);a(".jco-sel-items [name=gid]").val(c.group.item.id);a(".jco-sel-items span").html(d);a(".jco-sel-items span").attr("title",c.group.item.tgname);a(".jco-sel-items").show()}else{a("#jco-m-deliverymail-page .co-btnarea").hide();b.$boAllGroup=false}b._getBtnOtherSet(c)},_getBtnOtherSet:function(c){var b=this;var d=desknets.ajax.getJsonItems(c);if(d.length<=0&&!c.group){b.$mjListPage.find("[name=mailsend]").hide()}else{b.$mjListPage.find("[name=mailsend]").show()}},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getIdListPage:function(){return"jco-m-deliverymail-page"},_getIdListPageForm:function(){return"dellistfrm"},_getListCmd:function(){return desknets.safetyset.CMD_SAFETYMSETCONCONTACTDELIVERYGROUP},_getListExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETCONCONTACTDELIVERYGROUP},_getMailSendCmd:function(){return desknets.safetyset.CMD_SAFETYMSETCONTACTDELIVERYMAIL},_getMailSendConfCmd:function(){return desknets.safetyset.CMD_SAFETYMSETCONTACTDELIVERYMAILCONF},_getMailSendMessage:function(){return desknets.Resource.Message.safetyConsendGrpConfirm},_getListDeliveryMailCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETCONCONTACTDELIVERYMAIL}});desknets.page(desknets.safety,"contactalteruserdl",desknets.safety.contactdl,{_TMPL_CONTACTDIALOG:"safety/msetcontacteditdl.html",$name:"",$kana:"",setparam:function(f,d,b,c,e){this.$id=f;this.$tel=d;this.$mail=b;this.$name=c;this.$kana=e},_create:function(){var b=this._getDialogOptions();this.$root=desknets.dialog.make("safety-contact-editdialog co-editarea",b);this._loadContent()},_getDialogOptions:function(){var b=this;var e={};var c=desknets.dialog.getDialogOption();var d={title:desknets.Resource.safety.safetyContactEditDiaTitle,dialogClass:"dn-dialog",modal:true,resizable:false,buttons:e};a.extend(c,d);e[desknets.Resource.OKButtonLabel]=function(f){b._updateEntryValue()};e[desknets.Resource.CancelButtonLabel]=function(f){a(this).dialog("close")};return c},_setInputVal:function(){var b=this;var d="";var c="";if(b.$kana.length>0){d="("+b.$kana+")"}c=b.$name+d;this.$root.find("[name=Tel]").val(this.$tel);this.$root.find("[name=Mail]").val(this.$mail);this.$root.find(".safety-deliverydia-deputy").text(c)}});desknets.page(desknets.safety,"contactdeliverydl",desknets.safety.contactdl,{_TMPL_CONTACTDIALOG:"safety/msetcontactdeliverydl.html",$groups:null,$message:null,$noAddMsg:null,$dirTitle:null,$dirClass:null,setparam:function(b,c,e,f,d){this.$groups=b;this.$message=c;this.$noAddMsg=e;if(!f){f=desknets.Resource.safety.safetyContactDeliveryDiaTitle}if(!d){d="safety-contact-deliverydialog"}if(this.$dirTitle!=f){this.$root=null}this.$dirTitle=f;this.$dirClass=d},_create:function(){var b=this._getDialogOptions();this.$root=desknets.dialog.make(this.$dirClass,b);this._loadContent()},_getDialogOptions:function(){var b=this;var e={};var c=desknets.dialog.getDialogOption();var d={title:b.$dirTitle,width:530,dialogClass:"dn-dialog",modal:true,resizable:false,beforeclose:function(f){return b._onBeforeCloseConfirm(f,a(this),b.$options)},buttons:e};a.extend(c,d);e[desknets.Resource.OKButtonLabel]=function(f){a(this).data("result","ok").dialog("close")};e[desknets.Resource.CancelButtonLabel]=function(f){a(this).data("result","cancel").dialog("close")};return c},_onBeforeCloseConfirm:function(d,e,c){var b=e.data("result");e.data("result","");if(b=="ok"&&typeof(c)=="function"){return c.apply(e[0])}},_setInputVal:function(){var b=this;this.$root.find(".co-message").eq(0).find("span").html(this.$message);this.$root.find(".co-etd").find("div").html(this.$groups);if(b.$noAddMsg){this.$root.find("#delivery-diaaddmsg").hide()}}});desknets.page(desknets.safetyset,"safetymsetreglist",desknets.safetyset.safetymsetcontactlist,{boSetUpWaterMark:false,_initStartSet:function(){var b=this;b.callBase("_initStartSet");a(".safety-list-side-category a").click(function(c){c.preventDefault();b._clickStatusLink(c)});a(".co-list-search-btn a").click(function(c){c.preventDefault();b._searchKey()});a(".co-list-search-text").keypress(function(c){if(c.keyCode==13){c.preventDefault();b._searchKey()}});desknets.keysearch.setUp("safetysearch",a(".co-list-search-text"),function(){b._searchKey()});b._selectedStatus()},_setListEvent:function(){var b=this;var c={"$entrySuccessFunc":desknets.safetyset.safetymsetreglist._entryContact,"$cmd":desknets.safetyset.CMD_SAFETYMSETCONTENTRY};desknets.safety.contactalteruserdl.init(c);a("#listfrm").delegate(".jco-moduserlink","click",function(d){d.preventDefault();b.openAlterUserDir(d)})},_clickStatusLink:function(d){var c=this;var e=a(d.target);var b="";if(e.hasClass("all")){b=""}else{if(e.hasClass("answered")){b="1"}else{b="5"}}a("[name=status]").val(b);c._selectedStatus();c._listPage("0")},_selectedStatus:function(){var c=this;var b=a(".jco-back-page-data [name=status]").val();var d=a(".safety-list-side-category");var e=d.find("a");var f;e.removeClass("on");if(b=="5"){f=e.eq(1)}else{if(b=="1"){f=e.eq(2)}else{f=e.eq(0)}}f.addClass("on")},openAlterUserDir:function(b){var i=this;var j=[];var g={};var e=a(b.target.parentNode.parentNode);b.preventDefault();var d=e.find(".jco-id").val();var c=e.find(".jco-moduserlink").text();var f=e.find(".jco-moduserlink").data("value");var h={cmd:desknets.safetyset.CMD_SAFETYMSETGETCONTACT,id:d};g={success:function(l,k,m){desknets.safety.contactalteruserdl.setparam(d,l.Tel,l.Mail,c,f);desknets.safety.contactalteruserdl.open()},error:function(l,k,m){desknets.ajax.onError(l.status,m)}};j=a.extend({},g);desknets.safetyset.safetymsetlist._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_JSON,h,j)},_entryContact:function(b){var d=desknets.Resource.Message.safetyContactSuccessMsg;var c={type:"message"};desknets.dialog.alert(d,c)},_searchKey:function(){var c=this;var d=a(".co-list-search-text").val();var b=a("[name=srch_key]").val();if(!c.chkListSearchKeyLength(d)){return}if(desknets.escape(d)!=b){a("[name=srch_key]").val(d);c.boChangePageNoHide=true;c._listPage("0")}},_initKeyWordMessage:function(){if(a("#jco-m-list-container").css("display")=="block"&&!self.boSetUpWaterMark){setTimeout(function(){desknets.watermark.set(a(".co-list-search-text"))},500);self.boSetUpWaterMark=true}},changeModPage:function(d,c){var b=this;b.$mjListPage.find(".jco-back-page-data").find("input[name=srch_key]").val("");b.$mjListPage.find(".jco-back-page-data").find("input[name=status]").val("");a(".co-list-search-text").val("");a(".co-list-search-text").blur();b.callBase("changeModPage",d,c);b._selectedStatus()},_initListEnd:function(){var b=this;b.callBase("_initListEnd");b._initKeyWordMessage()},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find("[name=safetymsetregdeliverymail]").click(function(c){c.preventDefault();b.deliveryMailPage(c)});desknets.safety.regdeliveryretrydl.init(function(){b._DeliveryRetryMailSend()});b.$mjListPage.find("[name=deliveryretry]").click(function(c){c.preventDefault();b.clickDeliveryRetryBtn(c)});desknets.safety.reglistcleardl.init(function(){b._clearRegList()});b.$mjListPage.find("[name=clear]").click(function(c){c.preventDefault();b.clickClearRegListBtn(c)})},deliveryMailPage:function(d){var b=this;var c={};c=b._getAddPageParam();c.cmd=b._getListDeliveryMailCmd();b._inputPage(c)},clickDeliveryRetryBtn:function(h){var c=this;var e=null;var d=null;var g={};var f=a("[name=sgid] option:selected");var b=f.text();for(icnt=0;b[0].indexOf("*")==0;icnt++){b=b.substring(1)}e=c._getRestModule();d=desknets.getUrl(e);c._getRegPrm(desknets.safetyset.CMD_SAFETYMSETREGDELIVERYRETRYCONF,2,g);desknets.ajax.rest({url:d,data:g,success:function(){desknets.safety.regdeliveryretrydl.setparam(b);desknets.safety.regdeliveryretrydl.open()}})},_DeliveryRetryMailSend:function(){var b=this;var d=null;var e={};var c=b._getRestModule();d=desknets.getUrl(c);b._getRegPrm(desknets.safetyset.CMD_SAFETYMSETREGDELIVERYRETRY,2,e);desknets.ajax.rest({url:d,data:e,success:function(){b._getListAjax(b._getListRow())}})},clickClearRegListBtn:function(h){var c=this;var i=0;var b=null;var e=null;var d=null;var g={};var f=a("[name=sgid] option:selected");b=f.text();for(i=0;b[0].indexOf("*")==0;i++){b=b.substring(1)}e=c._getRestModule();d=desknets.getUrl(e);c._getRegPrm(desknets.safetyset.CMD_SAFETYMSETREGDELIVERYCLRCONF,null,g);desknets.ajax.rest({url:d,data:g,success:function(j){desknets.safety.reglistcleardl.setparam(j.msg,j.addmsg);desknets.safety.reglistcleardl.open()}})},_clearRegList:function(){var b=this;var d=null;var c=null;var e={};d=b._getRestModule();c=desknets.getUrl(d);b._getRegPrm(desknets.safetyset.CMD_SAFETYMSETREGDELIVERYCLEAR,null,e);desknets.ajax.rest({url:c,data:e,success:function(){b._getListAjax(b._getListRow())}})},_getRegPrm:function(f,g,d){var b=this;var e=null;e=b.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]').val();if(!e){var c=a("[name=sgid] option:selected");e=c.val()}d.cmd=f;d.id=e;if(g){d.sendtype=g}},_replaceListLine:function(b,e,c){var d=desknets.escape(c[e]);d=desknets.escapeValue(d);d=desknets.escapeSpace(d);if(e=="accdate"){d=desknets.dateTime.dispDateTime(d.substring(0,12),{type:"list"})}b=desknets.tmpl.replaceWordHtml(b,e,d);return b},_getListAjaxSuccessOtherSet:function(c){var b=this;b.callBase("_getListAjaxSuccessOtherSet",c);b._getBtnOtherSet(c);b._getEntrydateOtherSet(c);b._getStatusOtherSet(c)},_getBtnOtherSet:function(c){var b=this;var e=desknets.ajax.getJsonItems(c);var d=neo.dateTime.parse(c.entrydate);if(c.allgrpflg=="1"){a(".safety-partgroup").hide()}else{if(e.length<=0&&!c.group){b.$mjListPage.find(".safety-partgroup").hide()}else{b.$mjListPage.find(".safety-partgroup").show()}}if(e.length<=0&&!d){b.$mjListPage.find("[name=deliveryretry]").hide();b.$mjListPage.find(".line").hide();b.$mjListPage.find("[name=clear]").hide()}else{b.$mjListPage.find("[name=deliveryretry]").show();b.$mjListPage.find(".line").show();b.$mjListPage.find("[name=clear]").show()}},_getEntrydateOtherSet:function(d){var c=this;var e=null;var g=neo.dateTime.parse(d.entrydate);if(g){var f=neo.dateTime.format(desknets.Resource.longDateFormat,g);var b=neo.dateTime.format(desknets.Resource.timeFormat,g);e=f+" "+b}else{e=desknets.Resource.safety.safetyContactNoDeliveryMail}a(".co-listview-left-title").text(e)},_getStatusOtherSet:function(h){var j=this;var e=h.statuscnt.nomessage;var d=h.statuscnt.answered;var i=new RegExp("{{nomessage}}","ig");var b=new RegExp("{{answered}}","ig");var g=desknets.Resource.safety.unanswered;var c=desknets.Resource.safety.answered;g=g.replace(i,e);c=c.replace(b,d);var f=a(".safety-list-side-category a");f.eq(1).text(g);f.eq(2).text(c)},_checkMailStatus:function(d){var c=this;var b=null;b=d.mailstatus;if(b=="1"){setTimeout("desknets.safetyset.safetymsetreglist._getListAjax()",5000)}},_hashUpdateDeliveryMailPage:function(){var b=this;var c;var d;if(neo.isSet(desknets.safetyset.safetymsetregdeliverymail)){desknets.safetyset.safetymsetregdeliverymail.initPage(b.mhashBackCmd,b.mhashIdBack,b.changeCmdFlg)}},_hashUpdateDeliveryMailData:function(){var b=this;var c;var d;if(neo.isSet(desknets.safetyset.safetymsetregdeliverymail)){desknets.safetyset.safetymsetregdeliverymail.funcHashObserver()}},_getListAjaxSuccess:function(j){var m=this;var i=desknets.ajax.getJsonItems(j);var l=[];var b=[];var g=0;var k=0;var e=m._mcListTemplate;var d="";var c=neo.dateTime.parse(j.entrydate);var h=desknets.paramanalyzer.getHashParams();var n=j.contactmessage;var f=j.mailstatus;m._getMailMessageOtherSet(j);m._checkMailStatus(j);if(i.length<=0||(n.length>0&&f=="1")){if(j.group){m.$mjListPage.find(".co-btnarea").show();m.$mjListPage.find(".co-nodata.noadmingroup").hide();m.$mjListPage.find(".co-table-list").hide();m.$mjListPage.find(".co-list-sort").hide();m.$mjListPage.find(".jco-pager").hide();m.$mjTableList.empty();if(c||(n.length>0&&f=="1")){m.$mjListPage.find(".co-nodata.nodata").show();m.$mjListPage.find(".co-nodata.nodelivery").hide()}else{m.$mjListPage.find(".co-nodata.nodata").hide();m.$mjListPage.find(".co-nodata.nodelivery").show()}}else{m.$mjListPage.find(".co-btnarea").hide();m.$mjListPage.find(".co-listview").hide();m.$mjListPage.find(".co-nodata.noadmingroup").show()}m.$mjListPage.find(".jco-pager").hide();d="0"}else{m.$mjListPage.find(".co-btnarea").show();m.$mjListPage.find(".co-table-list").show();m.$mjListPage.find(".co-list-sort").show();m.$mjListPage.find(".co-nodata").hide();m.$mjListPage.find(".jco-pager").show();g=i.length;for(k=0;k<g;k++){l=i[k];b[b.length]=m._listLine(e,l)}m.$mjTableList.empty();m.$mjTableList.html(b.join(""));m._setListStyle(j);d=j.row}m.$mjListPage.find(".jco-back-page-data").find('input[name="row"]').val(d);m.$mjListPage.find(".jco-pv-cnt").val(k);m.$mjListPage.find(".jco-pv-all-cnt").val(j.allcnt);m._getListAjaxSuccessOtherSet(j);m._getListAjaxSuccessEnd();m._initKeyWordMessage();desknets.keysearch.fixListWatermark(m.$mjListPage,h)},_listMoveScroll:function(){return},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getListCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETREGLIST},_getListExecCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETREGLIST},_getListDeliveryMailCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETREGACTDELIVERYMAIL},_getListAjaxSuccessEnd:function(){var c=this;var b=desknets.paramanalyzer.getHashParam("status");c.$mjListPage.find(".jco-back-page-data").find("input[name=status]").val(b);c._selectedStatus();c.callBase("_getListAjaxSuccessEnd")}});desknets.page(desknets.safety,"regdeliveryretrydl",null,{$root:null,gName:"",$options:{},init:function(c){var b=this;b.$options=c},setparam:function(b){this.gName=b},open:function(){var b=this;if(b.$root==null){b._create()}else{b._show()}},_create:function(){var b=this;var c=this._getDialogOptions();b.$root=desknets.dialog.make("safety-regmailsend-dialog",c);b._show()},_getDialogOptions:function(){var b=this;var e={};var c=desknets.dialog.getDialogOption();var d={title:desknets.Resource.safety.safetyRetryMailTitle,width:530,dialogClass:"dn-dialog",modal:true,resizable:false,beforeclose:function(f){return b._onBeforeCloseConfirm(f,a(this),b.$options)},buttons:e};a.extend(c,d);e[desknets.Resource.OKButtonLabel]=function(f){a(this).data("result","ok").dialog("close")};e[desknets.Resource.CancelButtonLabel]=function(f){a(this).data("result","cancel").dialog("close")};return c},_show:function(){var b=this;var c=desknets.Resource.Message.safetyRegUnconfDiaMsg;c=desknets.tmpl.replaceWordHtml(c,"gname",b.gName);desknets.dialog._setMessage(b.$root,c);b.$root.dialog("open");desknets.dialog.setFirstDialogOpen(b.$root)},_onBeforeCloseConfirm:function(d,e,c){var b=e.data("result");e.data("result","");if(b=="ok"&&typeof(c)=="function"){return c.apply(e[0])}}});desknets.page(desknets.safety,"reglistcleardl",null,{$root:null,msg:"",addMsg:"",$options:{},init:function(c){var b=this;b.$options=c},setparam:function(c,b){this.msg=c;this.addMsg=b},open:function(){var b=this;if(b.$root==null){b._create()}else{b._show()}},_create:function(){var b=this;var c=b._getDialogOptions();this.$root=desknets.dialog.make("safety-clear-dialog",c);desknets.dialog._setMessage(b.$root,b.msg);b._show()},_getDialogOptions:function(){var b=this;var e={};var c=desknets.dialog.getDialogOption();var d={title:desknets.Resource.safety.safetyClearDiaTitle,width:530,dialogClass:"dn-dialog",modal:true,resizable:false,beforeclose:function(f){return b._onBeforeCloseConfirm(f,a(this),b.$options)},buttons:e};a.extend(c,d);e[desknets.Resource.OKButtonLabel]=function(f){a(this).data("result","ok").dialog("close")};e[desknets.Resource.CancelButtonLabel]=function(f){a(this).data("result","cancel").dialog("close")};return c},_show:function(){var b=this;desknets.dialog._setAddMessage(b.$root,b.addMsg,"co-msg-r");b.$root.dialog("open");desknets.dialog.setFirstDialogOpen(b.$root)},_onBeforeCloseConfirm:function(d,e,c){var b=e.data("result");e.data("result","");if(b=="ok"&&typeof(c)=="function"){return c.apply(e[0])}}});desknets.page(desknets.safetyset,"safetymsetregdeliverymail",desknets.safetyset.safetymsetcontactdeliverymail,{addMsgFig:null,_getMailSendCmd:function(){return desknets.safetyset.CMD_SAFETYMSETREGDELIVERYMAIL},_getMailSendConfCmd:function(){return desknets.safetyset.CMD_SAFETYMSETREGDELIVERYMAILCONF},_getMailSendMessage:function(){return desknets.Resource.Message.safetyRegsendGrpConfirm},_getListDeliveryMailCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETREGACTDELIVERYMAIL}});desknets.page(desknets.safetyset,"safetymsetcontactimport",desknets.PageImport,{_onAjaxFormSuccess:function(e){var c=this;var d=a(e.documentElement);var f=null;var b=null;f=d.find("message").text();b=d.find("addmessage").text();if(f){c._setEntAlert(f,b);c._execImportEnd(e)}else{c.callBase("_onAjaxFormSuccess",e)}},_setEntAlert:function(d,c){var b=this;if(neo.isSet(d)&&d.length>0){d=d+"\n"}d=d+c;desknets.dialog.alert(d,{type:"warn"})},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY}});desknets.page(desknets.safetyset,"safetymsetevacuationroute",desknets.PageInputList,{inputDispPage:function(c){var b=this;b.inputModPage(c)},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getListCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETEVACUATIONROUTE},_getListExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETEVACUATIONROUTE},_getListAddCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETEVACUATIONROUTEENTRY},_getListModCmd:function(){return desknets.safetyset.PAGE_SAFETYMSETEVACUATIONROUTEENTRY},_getListEntryClass:function(){return desknets.safetyset.safetymsetevacuationrouteentry},_getListModClass:function(){return desknets.safetyset.safetymsetevacuationrouteentry},_getDelCmd:function(){return desknets.safetyset.CMD_SAFETYMSETEVACUATIONROUTEDELCONF},_getDelExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETEVACUATIONROUTEDEL},_getMoveExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETEVACUATIONROUTEMOVE}});desknets.page(desknets.safetyset,"safetymsetevacuationrouteentry",desknets.PageInputBase,{changPage:function(){var b=this;var c=b.$mjPage.find('input[name="map"]:checked').val();b.displayInputAreaByMapType(c);b.callBase("changPage")},_inputButton:function(){var b=this;b.callBase("_inputButton");b.$mjPage.find('input[name="map"]').on("click",function(c){var d=a(c.target).val();b.displayInputAreaByMapType(d)});b.$mjPage.find(".jsafety-display-map").on("click",function(i){i.preventDefault();var d="";if(a("#mapgoogle").attr("checked")=="checked"){d=a("#mapgoogle").data("url")}else{d=a("input[name=Url]").val()}var j=a("input[name=start]").val();var c=a("input[name=goal]").val();var e=a("input[name=slat]").val();var g=a("input[name=slon]").val();var f=a("input[name=dlat]").val();var h=a("input[name=dlon]").val();if(!neo.isSet(d,{blank:false})){return}d=desknets.safety.getMapAPIUrl(d,j,c,e,g,f,h);window.open(d)})},displayInputAreaByMapType:function(e){var c=this;var d;var b={y:["lat","lon","name"],g:["name"],"0":["lat","lon","name","url"]};var g={lat:a(".jsafety-route-plat"),lon:a(".jsafety-route-plon"),name:a(".jsafety-route-pname"),url:a(".jsafety-route-url")};for(d in g){g[d].hide()}var f=b[e];for(d=0,len=f.length;d<len;d++){g[f[d]].show()}},_getErrorPlace:function(b){var c=this;var d="";if(b=="start"||b=="goal"||b=="slat"||b=="slon"||b=="dlat"||b=="dlon"){d=a("#inputfrm").find(".jco-input-"+b).closest("tr").closest("table").closest("tr").find(".co-required").html();sFieldSubName=a("#inputfrm").find(".jco-input-"+b).closest("td").prev().find(".co-colon").html();if(neo.isSet(d)&&d.length>0){d=d+" - "+sFieldSubName+desknets.merrMsgConnect}return d}else{return c.callBase("_getErrorPlace",b)}},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getAddExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETEVACUATIONROUTEENTRY},_getModExecCmd:function(){return this._getAddExecCmd()},_getDelExecCmd:function(){return desknets.safetyset.CMD_SAFETYMSETEVACUATIONROUTEDEL}});desknets.page(desknets.safetyset,"safetymsetadminlist",desknets.PageSetList,{elChecked:null,boEntry:false,_initListButton:function(){var b=this;b.callBase("_initListButton");b._initSetEvent()},_initSetEvent:function(){var c=this;var b=[];a(".co-btnarea").delegate("#safetyad-user-btn","click",function(d){d.preventDefault();b=desknets.chooser.getItemsFromElement(a(".co-tbody-list"));desknets.chooser.open("safety-user-chooser-dialog",{allGroup:"choosable",unassignGroup:"choosable",chooseTarget:["user"],choose:function(e){c._setAdminUser(e);c._setShowHideNoListMsg()},items:b,cmdusers:desknets.CMD_CHOOSERMSETUSERSEL})});a(".co-btnarea").delegate("#safetyad-group-btn","click",function(d){d.preventDefault();c.elChecked=a(".co-tbody-list .co-chk input:checked");if(c.elChecked.length<=0){var f=desknets.Resource.Message.com_set_nochecked;var e={type:"warn"};desknets.dialog.alert(f,e)}else{desknets.chooser.open("safety-group-chooser-dialog",{allGroup:null,unassignGroup:"choosable",chooseTarget:["group"],choose:function(g){c._setAdminGroup(g);c._setShowHideNoListMsg()},items:c._getGroupItems()})}});a(".co-btnarea").delegate("#safetyad-del-user","click",function(d){d.preventDefault();c.elChecked=a(".co-tbody-list .co-chk input:checked");if(c.elChecked.length<=0){var f=desknets.Resource.Message.com_sel_nochecked;var e={type:"warn"};desknets.dialog.alert(f,e)}else{c.elChecked.each(function(){c.elChecked.parent().parent().remove()});c._setShowHideNoListMsg()}});a(".co-actionarea").delegate(".safety-update-admin","click",function(d){d.preventDefault();c.boEntry=true;c._updateEntryValue()})},_setAdminUser:function(f){var h,e;var j=this;var c=a(".co-tbody-list").find("tr");var d="";var g;var b=f.length;var i=c.length;for(h=0;h<b;h++){g=false;d=f[h].id;for(e=0;e<i;e++){if(c[e]!="undefined"&&a(c[e]).find('input[name="id"]').val()==d){g=true;delete c[e];break}}if(g){continue}j._createAdminRow(f[h].id,f[h].name,f[h].summary,f[h].description)}for(e=0;e<i;e++){if(c[e]!="undefined"){a(c[e]).remove()}}},_createAdminRow:function(f,i,b,c){var d=this;var g="";var h=desknets.tmpl.escapeWord(i);var e=desknets.escapeValue(a("<div>"+b+"</div>").text());c=desknets.escape(c);c=desknets.escapeValue(c);g="<tr>";g=g+'<td class="co-chk"><input type="checkbox" name="id" value="'+f+'" /></td>';g=g+'<td><span class="co-gicon-user">&nbsp;</span><a href="#" class="safety-admin-name jco-sel-item jco-ref-dialog-link" data-id="'+f+'" data-name="'+h+'" data-refid="user'+f+' " data-description="'+c+'">'+h+"</a></td>";g=g+'<td class="co-busyo"><span class="safety-admin-group" title="'+e+'">'+b+"</span></td>";g=g+'<td class="safety-td-admin-groups"><input type="hidden" name="adminids" value=""><span class="safety-admin-groupname" title="'+desknets.Resource.safety.safetyNoSetAdminName+'">'+desknets.Resource.safety.safetyNoSetAdminName+"</span></td>";g=g+"</tr>";a(".co-tbody-list").append(g)},_getGroupItems:function(){var k=this;var f=[];var c={};var h={};var e=k.elChecked.parent().parent();for(var d=0;d<e.length;d++){var b=e.eq(d).find("[name=adminids]").val().split(",");var g=e.eq(d).find(".safety-admin-groupname").text().split(",\n");for(var i=0;i<b.length;i++){if(b[i].length<=0){continue}if(c[b[i]]){c[b[i]]++}else{c[b[i]]=1}h[b[i]]=g[i]}}for(var j in c){if(c[j]==e.length){f.push({id:j,type:"group",name:h[j]})}}return f},_setAdminGroup:function(c){var b=this;var e="";var f="";for(var d=0;d<c.length;d++){if(e.length>0){e+=",";f+=",\n"}e+=c[d].id;f+=c[d].name}if(c.length==0){f=desknets.Resource.safety.safetyNoSetAdminName}b.elChecked.parent().nextAll().find("[name=adminids]").val(e);b.elChecked.parent().nextAll().find(".safety-admin-groupname").text(f);b.elChecked.parent().nextAll().find(".safety-admin-groupname").attr("title",f)},_updateEntryValue:function(){var b=this;var i=[];var e=[];var d=a(".co-tbody-list tr");for(var g=0;g<d.length;g++){i[g]=d.eq(g).find("[name=id]").val();var h=d.eq(g).find("[name=adminids]").val().split(",");for(var f=0;f<h.length;f++){if(h[f].length>0){e[e.length]=i[g]+"_"+h[f]}}}var c={cmd:desknets.safetyset.CMD_SAFETYMSETCMDADMINENTRY,id:i,gid:e};a("#frm").find("input").attr("disabled",true);a("#frm").find('input[type="checkbox"]').attr("disabled",false);desknets.ajax.rest({url:desknets.getUrl(b._getRestModule()),data:c,success:function(l,j,m){var k=desknets.getUrl(b._getModule())+"?cmd="+desknets.safetyset.PAGE_SAFETYLIST;desknets.execLocation(k)},error:function(k,j,l){desknets.ajax.onError(k.status,l);a("#frm").find("input").attr("disabled",false)},traditional:true})},_setShowHideNoListMsg:function(){var b=this;if(a(".co-m-content .co-tbody-list tr").length>0){a(".co-m-content tr").removeClass("co-tr-selected");a(".co-m-content .co-chk-cnt-all").hide();a(".co-m-content .co-table-list").show();a(".co-m-content .co-list-sort").show();a(".co-m-content .co-nodata").hide()}else{a(".co-m-content tr").removeClass("co-tr-selected");a(".co-m-content .co-chk-cnt-all").hide();a(".co-m-content .co-table-list").hide();a(".co-m-content .co-list-sort").hide();a(".co-m-content .co-nodata").show()}a('input[type="checkbox"]').attr("checked",false)},_formObserve_isChanged:function(c){var b=this;if(b.boEntry){return false}return b.callBase("_formObserve_isChanged",c)},_getModule:function(){return desknets.safetyset.MODULE_MAIN_SAFETY},_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},_getBeforeUnloadMsg:function(){return desknets.Resource.Message.com_setting_beforeentry_msg},_formObserve_getTargetNames:function(){return["adminids"]}});(function(b){desknets.page(desknets.safetyset,"setgen",desknets.PageSet,{init:function(){var d=this;var c=b("#"+d._getIdPageForm());var g=c.find('input[name="dneturl"]');var f=c.find('input[name="url"]');var h=desknets.getDataAttr(g,"def");var j=desknets.getDataAttr(f,"def");if(h=="1"){g.val("")}if(j=="1"){f.val("")}d.callBase("init");if(h=="1"||j=="1"){var i=c.find(".safetyset-urldef-msg").html();var e=desknets.msUrl+"dneosafety";if(h=="1"){g.val(e)}if(j=="1"){f.val(e)}if(h=="1"&&j!="1"){i=desknets.getErrFieName(c,"dneturl")+i}if(h!="1"&&j=="1"){i=desknets.getErrFieName(c,"url")+i}desknets.pageframe.viewTopMsg(i,"info")}},_getNextCmd:function(){return desknets.safetyset.PAGE_SAFETYSETADMIN}})})(jQuery);(function(b){desknets.page(desknets.safetyset,"safetysetmanager",desknets.PageAdmin,{_getNextCmd:function(){return desknets.safetyset.PAGE_SAFETYSETADMIN}})})(jQuery);(function(b){desknets.page(desknets.safetyset,"safetysetadminpage",desknets.PageSet,{_getNextCmd:function(){return desknets.safetyset.PAGE_SAFETYSETADMIN}})})(jQuery);(function(b){desknets.page(desknets.safetyset,"safetysetmailserver",desknets.PageSet,{_getRestModule:function(){return desknets.safetyset.MODULE_API_SAFETY},init:function(){var c=this;this.callBase("init");b("#jsafetyset-sendmsg").click(function(d){c._sendMsgDialogSend()})},_sendMsgDialogSend:function(){var l=this;var e=b("[name=mailfrom]:checked").val();var k=b("[name=mailfromaddr]").val();var t=b("[name=smtpkind]:checked").val();var r=b("[name=smtpserver]").val();var n=b("[name=smtp]").val();var f=b("[name=popbsmtp]:checked").val();var m=b("[name=pop3server]").val();var g=b("[name=pop3]").val();var h=b("[name=pop3uid]").val();var i=b("[name=pop3pwd]").val();var c=b("[name=pop3apop]").val();var s=b("[name=timeout]").val();var q=b("[name=smtpauthuid]").val();var p=b("[name=smtpauthpwd]").val();var u=b("[name=smtpauthkind]").val();var d=b("[name=sendtocheck]").val();var j=b("[name=pop3secure]").val();var o=b("[name=smtpsecure]").val();l._pageDetailSendAjax(e,k,t,r,n,f,m,g,h,i,c,s,q,p,u,d,j,o)},_pageDetailSendAjax:function(u,r,q,j,n,w,c,e,m,l,i,k,t,s,d,g,v,h){var p=this;var o={};var f={};o.cmd=p._getMailServerCmd();o.mailfrom=u;o.mailfromaddr=r;o.smtpkind=q;o.smtpserver=j;o.smtp=n;o.popbsmtp=w;o.pop3server=c;o.pop3=e;o.pop3uid=m;o.pop3pwd=l;o.pop3apop=i;o.timeout=k;o.smtpauthuid=t;o.smtpauthpwd=s;o.smtpauthkind=d;o.sendtocheck=g;o.pop3secure=v;o.smtpsecure=h;f.success=function(x){var z=desknets.Resource.Message.safetyMailSendMsg;var y={type:"message"};desknets.dialog.alert(z,y)};p._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_JSON,o,f)},_getErrorPlace:function(d){var e=this;var f="";var c="";if(d=="smtpserver"||d=="smtp"){f=b("#frm").find(".jco-input-"+d).closest("td").prev().find(".co-colon").eq(0).text();c=b("#frm").find(".jco-input-"+d).closest("table").prev().closest("table").find(".safety-setmail-smtptitle").html();if(neo.isSet(f)&&f.length>0){f=c+" - "+f+desknets.merrMsgConnect}return f}else{if(d=="pop3server"||d=="pop3"||d=="pop3uid"||d=="pop3pwd"||d=="timeout"||d=="smtpauthuid"||d=="smtpauthpwd"){f=b("#frm").find(".jco-input-"+d).closest("td").prev().find(".co-colon").eq(0).text();c=b("#frm").find(".jco-input-"+d).closest("li").find("label").html();if(neo.isSet(f)&&f.length>0){f=c+" - "+f+desknets.merrMsgConnect}return f}else{return e.callBase("_getErrorPlace",d)}}},_getMailServerCmd:function(){return desknets.safetyset.CMD_SAFETYSETSENDMAIL},_getNextCmd:function(){return desknets.safetyset.PAGE_SAFETYSETADMIN}})})(jQuery);app.addInitialAction(function(){desknets.safetyset.init()})})(jQuery);