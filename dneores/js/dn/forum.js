/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.forum={MODULE_FORUM:"zforum",MODULE_API_FORUM:"zrforum",PAGE_FORUMINDEX:"forumlist",PAGE_FORUMTLIST:"forumtlist",PAGE_FORUMALIST:"forumalist",PAGE_FORUMSEARCH:"forumsearch",CMD_FORUMFORUMROOMLISTNEW:"forumcmdforumroomlistnew",CMD_FORUMPOSTLISTNEW:"forumcmdpostlistnew",CMD_FORUMFORUMLISTLABEL:"forumcmdforumlistlabel",CMD_FORUMMODASSIGNLABEL:"forumcmdmodassignlabel",CMD_FORUMNEWREAD:"forumcmdnewread",CMD_FORUMINFO:"forumcmdinfo",CMD_FORUMSEARCH:"forumcmdsearch",CMD_FORUMSEARCHSTOP:"forumcmdsearchstop",CMD_FORUMBATSEARCH:"forumbatsrch",CMD_FORUMTOPICLIST:"forumcmdtopiclist",CMD_FORUMTOPICENTRY:"forumcmdtopicentry",CMD_FORUMTOPICDELCONF:"forumcmdtopicdelconf",CMD_FORUMTOPICDEL:"forumcmdtopicdel",CMD_FORUMTOPICSTATUSSETCONF:"forumcmdtopicstatussetconf",CMD_FORUMTOPICSTATUSSET:"forumcmdtopicstatusset",CMD_FORUMARTICLELIST:"forumcmdarticlelist",CMD_FORUMARTICLEENTRY:"forumcmdarticleentry",CMD_FORUMARTICLEDELCONF:"forumcmdarticledelconf",CMD_FORUMARTICLEDEL:"forumcmdarticledel",CMD_FORUMARTICLESTATUSSETCONF:"forumcmdarticlestatussetconf",CMD_FORUMARTICLESTATUSSET:"forumcmdarticlestatusset",CMD_FORUMCOMMENTLIST:"forumcmdcommentlist",CMD_FORUMCOMMENTENTRY:"forumcmdcommententry",CMD_FORUMCOMMENTDELCONF:"forumcmdcommentdelconf",CMD_FORUMCOMMENTDEL:"forumcmdcommentdel",CMD_FORUMCOMMENTSTATUSSETCONF:"forumcmdcommentstatussetconf",CMD_FORUMCOMMENTSTATUSSET:"forumcmdcommentstatusset",CMD_FORUMPSETLABEL:"forumpsetcmdlabel",CMD_FORUMPSETLABELENTRY:"forumpsetcmdlabelentry",CMD_FORUMPSETDELLABEL:"forumpsetcmddellabel",CMD_FORUMREFATTACH:"forumdispattach",CMD_FORUMVIEWATTACH:"forumviewattach",CMD_FORUMVIEWCOMMENTATTACH:"forumviewcommentattach",CMD_FORUMADDATTACH:"forumcmdaddattach",CMD_FORUMDELATTACH:"forumcmddelattach",CMD_FORUMATTEXTLIST:"forumcmdgetextlist",CMD_FORUMATTACHDELTEMP:"forumcmdattachdeltemp",CMD_FORUMCOPYATTACH:"forumcmdcopyattach",FORUM_MSETINDEXID:"forummsetlist",HTML_CABREGIST_FORUM:"forum.html",DEF_INIT_NONE:"0",DEF_INIT_NOW:"1",DEF_INIT_TOP:"2",DEF_INIT_TOPIC:"3",DEF_STATUS_SHOW:"0",DEF_STATUS_HIDE:"1",DEF_SORT_UPDATE_FIELD:"latestentrytime",DEF_SORT_NEW_FIELD:"cretime",mOpenLabelId:"-1",mLeftListPosition:0,init:function(){var b=a("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(b);if(b==desknets.forum.PAGE_FORUMINDEX){desknets.hashobserver.init(desknets.forum);desknets.forum.forumlist.init();desknets.forum.subwin.init()}},changeLocationToNewList:function(){var b="cmd="+desknets.forum.PAGE_FORUMINDEX;var c=desknets.getUrl(desknets.forum.MODULE_FORUM)+"?"+b;desknets.execLocation(c)},changeLocationToTopicList:function(b,c,e){var d={};var f="";var g="";d.cmd=desknets.forum.PAGE_FORUMTLIST;d.fid=c;d._=desknets.createRandomId();if(neo.isSet(e)&&e!=desknets.forum.DEF_INIT_NONE){d.init=e}b._inputPage(d)},changeLocationToArticleList:function(c,e,d,b,g){var f={};var h="";var i="";f.cmd=desknets.forum.PAGE_FORUMALIST;f.fid=e;f.tid=d;if(neo.isSet(b)){f.aid=b}f._=desknets.createRandomId();if(neo.isSet(g)&&g!=desknets.forum.DEF_INIT_NONE){f.init=g}c._inputPage(f)},setOpenLabelIds:function(b){var c=this;c.mOpenLabelId=b},getOpenLabelIds:function(){var b=this;return b.mOpenLabelId},setLeftListPosition:function(c){var b=this;b.mLeftListPosition=c},getLeftListPosition:function(){var b=this;return b.mLeftListPosition},isSortUpdate:function(b){var c=this;var d=desknets.paramanalyzer.getHashParams();if(neo.isSet(d.fldsort)&&d.fldsort==c.DEF_SORT_NEW_FIELD){return false}return true},setItemsHref:function(c,b){var d=a.extend({forum:desknets.forum.PAGE_FORUMTLIST,topic:desknets.forum.PAGE_FORUMALIST},b);c.find("a.jforum-forumlink").each(function(){var e=a(this);var f={cmd:d.forum,fid:e.data("fid"),init:desknets.forum.DEF_INIT_NOW};e.attr("href","#"+desknets.getNeoParam(f))});c.find("a.jforum-topiclink").each(function(){var e=a(this);var f={cmd:d.topic,fid:e.data("fid"),tid:e.data("tid"),init:desknets.forum.DEF_INIT_NOW};e.attr("href","#"+desknets.getNeoParam(f))});c.find("a.jforum-articlelink").each(function(){var e=a(this);var f={cmd:d.topic,fid:e.data("fid"),tid:e.data("tid"),aid:e.data("aid"),init:desknets.forum.DEF_INIT_NOW};e.attr("href","#"+desknets.getNeoParam(f))})}};desknets.page(desknets.forum,"subwin",desknets.PageSubwinSearch,{init:function(){var b=this;var c=a(".jco-subwindow-search");var d=desknets.paramanalyzer.getHashParams();c.find('input[name="srch_key"]').val(d.srch_key);c.find('input[name="sdate"]').val(d.sdate);c.find('input[name="edate"]').val(d.edate);if(neo.isSet(d.sw_target)){if(d.srch_filecontents=="1"){c.find('select[name="sw_target"]').val("4")}else{c.find('select[name="sw_target"]').val(d.sw_target)}}else{if(d.srch_filecontents=="1"){c.find('select[name="sw_target"]').val("4")}else{c.find('select[name="sw_target"]').val("3")}}b.callBase("init");desknets.htmlparts.setUpForm(b.$_inputArea)},_getSearchPrm:function(d){var b=this;var c=b.$_inputArea;d.fldsort="cretime";d.order="-1";d.row="0";d.srch_key=c.find('input[name="srch_key"]').val();d.sdate=c.find('input[name="sdate"]').val();d.edate=c.find('input[name="edate"]').val();d.sw_target=c.find('select[name="sw_target"]').val();if(d.sw_target=="4"){d.srch_filecontents="1";d.sw_target="3"}else{d.srch_filecontents=""}return d},_execClear:function(){var b=this;b.callBase("_execClear");var c=a(".jco-subwindow-search");c.find('select[name="sw_target"]').val("3")},_chkInputSearchRequired:function(){var d=this;var e=d.$_inputArea;var f="";var c=true;if(e.find('input[name="srch_key"]').val()==""&&e.find('input[name="sdate"]').val()==""&&e.find('input[name="edate"]').val()==""){c=false}if(!c){var b=desknets.Resource.searchcond;f=desknets.tmpl.replaceWordHtml(desknets.Resource.Message.com_search_required,"item",b);desknets.dialog.alert(f,{type:"warn"});return false}return d.callBase("_chkInputSearchRequired")},_getMainCmd:function(){return desknets.forum.PAGE_FORUMINDEX},_getSearchCmd:function(){return desknets.forum.PAGE_FORUMSEARCH},});desknets.forum.dialogForumInfo={_TMPL_FORUMINFO:"forum/forum.info.html",$mDialogViewRoom:null,$mjListPage:null,_Data_Type:"",createDialog:function(d,c){var b=this;if(neo.isSet(c)){b._Data_Type=c}if(b.$mDialogViewRoom===null){b.$mjListPage=d;desknets.tmpl.load(b.$mjListPage.find(".forum-pop-viewroom"),b._TMPL_FORUMINFO)}},showDialog:function(c){var b=this;if(c.length==0){var e=desknets.Resource.forum.unselectedForum;desknets.dialog.alert(e,{type:"warn"});return}var d={};d.cmd=desknets.forum.CMD_FORUMINFO;d.fid=c;desknets.ajax.rest({url:desknets.getUrl(desknets.forum.MODULE_API_FORUM),data:d,success:function(g,f,h){b._dialogViewRoom(g)},})},_dialogViewRoom:function(j){var n=this;var d=null;d=n.$mDialogViewRoom;if(d===null){d=n._makeDialogViewRoom();n.$mDialogViewRoom=d}var f={};f.title=desknets.Resource.forum.menuViewRoom;var m=desknets.tmpl.dispStr(j.outline);d.find(".jforum-info-outline").html(m);var h=desknets.ajax.getJsonItems(j);var l=[];var c=[];var e=0;var k=0;e=h.length;for(k=0;k<e;k++){l=h[k];if(k>0){c[c.length]=", "}var b=desknets.escape(l.Name);b=desknets.escapeValue(b);b=desknets.escapeSpace(b);var o='<a class="jco-ref-dialog-link" href="#" data-refid="user{{id}}" data-type="{{type}}">';var i=new RegExp("{{id}}","ig");o=o.replace(i,l.id);var g=new RegExp("{{type}}","ig");o=o.replace(g,n._Data_Type);c[c.length]=o;c[c.length]=b;c[c.length]="</a>"}d.find(".jforum-info-admin").html(c.join(""));d.dialog(f);d.dialog("open");desknets.dialog.setFirstDialogOpen(d)},_makeDialogViewRoom:function(){var b=this;var d=null;var c=desknets.dialog.getDialogOption();c.width=600;c.buttons={};c.buttons[desknets.Resource.CloseButtonLabel]=function(){a(this).dialog("close")};d=b.$mjListPage.find(".forum-pop-viewroom");d=desknets.dialog.setUp(d,c);return d},};desknets.forum.dialogTopicEntry={_TMPL_EDITTOPIC:"forum/forum.edit.topic.html",$mDialogTopicEntry:null,callbackFuncOK:null,$mjListPage:null,createDialog:function(d,c){var b=this;b.callbackFuncOK=c;if(b.$mDialogTopicEntry===null){b.$mjListPage=d;desknets.tmpl.load(b.$mjListPage.find(".forum-pop-topic"),b._TMPL_EDITTOPIC)}},showDialog:function(c,g){var b=this;var h=null;var f=null;if(c.length==0){var d=desknets.Resource.forum.unselectedForum;desknets.dialog.alert(d,{type:"warn"});return}h=b.$mDialogTopicEntry;if(h===null){h=b._makeDialogTopic();b.$mDialogTopicEntry=h}var e={};e.title=desknets.Resource.forum.menuTopicAdd;h.find(".jforum-topic-entry-fid").val(c);h.find(".jforum-topic-entry-id").val("");h.find(".jforum-topic-entry-name").val("");h.find(".jforum-topic-entry-anonymity").attr("checked",false);if(g){h.find(".jforum-Anonymity-area").show()}else{h.find(".jforum-Anonymity-area").hide()}h.dialog(e);h.dialog("open");desknets.dialog.setFirstDialogOpen(h)},_makeDialogTopic:function(){var c=this;var f=null;var e=null;var d=desknets.dialog.getDialogOption();var b="";d.width=400;d.buttons={};d.buttons[desknets.Resource.OKButtonLabel]=function(){if(f!=null){desknets.submitform.setDialogDisabled(f)}var g=c._getInputValTopicEntry(f);if(c.callbackFuncOK!=null){c.callbackFuncOK(f,g)}return false};d.buttons[desknets.Resource.CancelButtonLabel]=function(){a(this).dialog("close")};f=c.$mjListPage.find(".forum-pop-topic");f=desknets.dialog.setUp(f,d);return f},_getInputValTopicEntry:function(c){var b=this;var d={};d.fid=c.find(".jforum-topic-entry-fid").val();d.Name=c.find(".jforum-topic-entry-name").val();d.contr="";if(c.find(".jforum-topic-entry-anonymity").attr("checked")){d.anonymouse="1"}return d},};desknets.page(desknets.forum,"attach",desknets.attachSetUp,{_funcToggleTarget:null,init:function(d,e,b){var c=this;c._funcToggleTarget=null;if(neo.isSet(b)){c._funcToggleTarget=b}c.callBase("init",d,e)},_getUploadURL:function(){return desknets.forum.MODULE_API_FORUM},_getUploadCmd:function(){return desknets.forum.CMD_FORUMADDATTACH},_getDelCmd:function(){return desknets.forum.CMD_FORUMDELATTACH},_getDownLoadURL:function(){return desknets.forum.MODULE_FORUM},_getDownLoadCmd:function(){return desknets.forum.CMD_FORUMREFATTACH},_getHideArea:function(){return".jco-remove-all-button"},_getToggleTarget:function(){var b=this;return b._funcToggleTarget},_getUploadPrm:function(){var b=this;var c=a.extend({},this._objDefPrm);var d=desknets.paramanalyzer.getHashParam("fid");c.fid=d;return c}});desknets.page(desknets.forum,"PageLabelListforum",desknets.PageLabelList,{DEF_STATUS_RUN:"1",DEF_STATUS_STOP:"2",DEF_STATUS_READY:"3",_MAX_DISPLENGTH_FORUMNAME:20,$mjListPageLeft:null,_initListStart:function(){var b=this;b.$mjListPageLeft=b.$mjListPage.find(".co-listview-left");desknets.forum.dialogForumInfo.createDialog(b.$mjListPage);b._setLabelEditButton(true);b._setLabelScrollEvent();b.callBase("_initListStart")},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".forum-link-viewroom").click(function(d){d.preventDefault();var c=b.$mjListPage.find(".jco-back-page-data").find('input[name="fid"]').val();desknets.forum.dialogForumInfo.showDialog(c)})},_initLabelListBeforeLeft:function(){var b=this;var c=b.$mjListPageLeft.find(".co-listview-items");c.delegate(".co-label","click",function(g){g.preventDefault();var h=a(this).find(".jco-label-id").val();var f=a(this).parents(".jforum_label_item");var d=f.find(".jco-label-data");var e=f.find(".forum-listview-inside");if(d.hasClass("open")){d.removeClass("open");e.removeClass("open")}else{d.addClass("open");e.addClass("open")}c.find(".co-label").not(a(this)).removeClass("on");a(this).addClass("on");if(a(this).hasClass("co-label-none")){b._setLabelEditButton(true)}else{b._setLabelEditButton(false)}b.$mjListPage.find('input[name="labelid"]').val(h);b._saveLabelOpen()});b._setLabelListForumClick()},_initLabelListBeforeList:function(){},_initLabelEnd:function(){var b=this;b.callBase("_initLabelEnd");b.$mjListPageLeft.find(".forum-new").click(function(c){c.preventDefault();desknets.forum.changeLocationToNewList()})},_setLabelListForumDrag:function(){var b=this;if(desknets.browser.tablet){return}var e=b.$mjListPageLeft.find(".forum-drag");var d=e.find(".forum-listview-inside").find(".forum-listview-forum");b._setLabelDrag(d);var c=e.find(".co-label");b._setLabelDrop(d,c)},_setLabelDrag:function(d){var b=this;var c={};if(desknets.browser.tablet){return}c=b._getDraggableOption();d.draggable(c)},_getDraggableOption:function(){var b=this;var c={handle:".co-draghandle",containment:b.$mjListPageLeft.find(".forum-drag"),axis:"y",cursor:"move",zIndex:1,};if(desknets.browser.msie){a.extend(c,{helper:function(f){var e=f.originalEvent;var d="???";if(!!e){var h=e.target||e.srcElement;var g=a(h).closest(".forum-listview-forum");d=g.find(".jforum-label-forum").html()}if(desknets.browser.msie8){return a('<div id="co-dragtip-ie8"><div class="dragtip" title="'+d+'">'+d+'</div><div class="ieShadow"></div></div>')}else{return a('<div id="co-dragtip" title="'+d+'">'+d+"</div>")}},drag:function(j,i){var k=20;var d=b.$mjListPageLeft.find(".co-listview-left-data");var g=b.$mjListPageLeft.find(".co-listview-left-data");var f=g.offset().top;var h=g.height()-40;if(i.offset.top<f){d.scrollTop(d.scrollTop()-k)}else{if(i.offset.top>(f+h)){d.scrollTop(d.scrollTop()+k)}}},})}else{a.extend(c,{revert:true,revertDuration:10,})}return c},_setLabelDrop:function(d,c){var b=this;c.droppable({accept:d,tolerance:"intersect",hoverClass:"forum-dropover",drop:function(f,h){var e=a(h.draggable);var i=a(this);var g=desknets.dialog.confirm(desknets.Resource.forum.confirmation_moveforum,function(){if(g!=null){desknets.submitform.setDialogDisabled(g)}var k=i.find(".jco-label-id").val();var j=e.find(".jforum-label-forum").data("fid");b._moveLabelOfForum(k,j,g)})}})},_setLabelListForumClick:function(){var b=this;var c=b.$mjListPageLeft.find(".forum-drag");c.delegate("a.jforum-label-forum","click",function(d){d.preventDefault();var e=a(this).parent().find(".jforum-label-forum").data("fid");desknets.forum.changeLocationToTopicList(b,e,desknets.forum.DEF_INIT_TOP)})},_moveLabelOfForum:function(d,b,g){var c=this;var f={};var e={};f=c._moveLabelOfForumMultiParams(d,b);e=c._getListAjaxOptionsExec(g);c._sendRequestAjax(desknets.ajax.REQTYPE_MULTI,desknets.ajax.RESTYPE_JSON,f,e)},_moveLabelOfForumMultiParams:function(d,b){var c=this;var g={};var f={};var h={};var e={};e.cmd=c._getLabelOfForumMoveCmd();e.id=d;e.assignid=b;f=c.getListParamToObj();f.labelid="";h=c.getAddDataParam();h.cmd=c._getAddDataGetCmd();g["0"]=e;g["1"]=f;g["2"]=h;return g},_setLabelEditButton:function(c){var b=this;var d=b.$mjListPageLeft.find(".co-listview-left-subtitle");d.find(".jco-label-mod").attr("disabled",c);d.find(".jco-label-del").attr("disabled",c)},_setForumInfoLink:function(){var b=this;var c=b.$mjListPageLeft.find(".forum-listview-forum.on");if(neo.isSet(c)&&c.length>0){b.$mjListPage.find(".forum-link-viewroom").show()}else{b.$mjListPage.find(".forum-link-viewroom").hide()}},_setAppendLabel:function(f,i){var c=this;var b=[];var e=c.$mjListPageLeft.find(".co-listview-items").find(".jforum_label_area");b[b.length]='<div class="jforum_label_item">';b[b.length]=c._getLabelLeftHtml(i.id,f.name,0,false);b[b.length]='<div class="forum-listview-inside">';b[b.length]="</div>";b[b.length]="</div>";e.append(b.join(""));var h=c.$mjListPageLeft.find(".forum-drag");var g=h.find(".forum-listview-inside").find(".forum-listview-forum");var d=h.find(".co-label:last");c._setLabelDrop(g,d)},_getLabelAjaxSuccess:function(g){var m=this;var f=desknets.ajax.getJsonItems(g);var i=[];var c=[];var n=m.$mjListPageLeft.find(".jforum_label_area");var d=0;var h=0;var l=false;var e=m.$mjListPage.find(".jco-back-page-data").find('input[name="fid"]').val();var k=desknets.forum.getOpenLabelIds();var b=k.split(",");d=f.length;for(h=0;h<d;h++){c[c.length]='<div class="jforum_label_item">';i=f[h];if(neo.array._hasItemInv(i.id,b,function(p,o){return p==o})){l=true}else{l=false}var j=desknets.ajax.getJsonItems(i);c[c.length]=m._getLabelLeftHtml(i.id,i.Name,j.length,l);if(l){c[c.length]='<div class="forum-listview-inside open">'}else{c[c.length]='<div class="forum-listview-inside">'}c[c.length]=m._getLabelForumAjaxSuccessProc(j,e);c[c.length]="</div>";c[c.length]="</div>";if(h==0){c[c.length]='<hr class="dashed">'}}n.empty();n.append(c.join(""));m._setForumInfoLink();m._setLabelListForumDrag();m._setLabelEditButton(true);m._setLabelScroll();m._getLabelAjaxSuccessOtherSet(g)},_getLabelAjaxSuccessOtherSet:function(b){},_getLabelForumAjaxSuccess:function(d,c){var b=this;var e=desknets.ajax.getJsonItems(d);return b._getLabelForumAjaxSuccessProc(e,c)},_getLabelForumAjaxSuccessProc:function(g,f){var k=this;var j=[];var b=[];var d="";var h='<div class="forum-listview-forum {{fsel}} {{fsts}}"><span class="co-draghandle">:</span><a data-fid="{{id}}" title="{{Name}}" href="#" class="forum jforum-label-forum">{{SName}}</a></div>';var e='<div class="forum-listview-forum {{fsel}} {{fsts}}"><span class="co-draghandle">:</span><span data-fid="{{id}}" title="{{Name}}" class="forum jforum-label-forum">{{SName}}</span></div>';var c=0;var i=0;c=g.length;for(i=0;i<c;i++){j=g[i];if(j.fstatus==k.DEF_STATUS_STOP||j.fstatus==k.DEF_STATUS_READY){j.fsts="off";d=e}else{j.fsts="";d=h}if(j.id==f){j.fsel="on"}else{j.fsel=""}if(j.Name.length>k._MAX_DISPLENGTH_FORUMNAME){j.SName=j.Name.substr(0,k._MAX_DISPLENGTH_FORUMNAME);j.SName=j.SName+"..."}else{j.SName=j.Name}b[b.length]=k._listLine(d,j)}return b.join("")},_getLabelLeftHtml:function(e,h,d,g){var b=this;var f='<div class="co-label jco-label-data forum-label {{none}} {{open}}" title="{{Name}}"><a class="toggle" href="#">+</a><span class="count">{{count}}</span><span class="label jco-label-name">{{Name}}</span><input type="hidden" class="jco-label-id" value="{{id}}"></div>';var c={};c.id=e;c.Name=h;c.count=""+d;if(c.id<=0){c.none="co-label-none"}else{c.none=""}if(g){c.open="open"}else{c.open=""}f=b._listLine(f,c);return f},_saveLabelOpen:function(){var b=this;var d="";var c=b.$mjListPageLeft.find(".co-listview-items");c.find(".jco-label-data").each(function(){if(a(this).hasClass("open")){if(d.length==0){d=a(this).find(".jco-label-id").val()}else{d=d+","+a(this).find(".jco-label-id").val()}}});desknets.forum.setOpenLabelIds(d)},_setTitleLabel:function(){var b=this;b._setTitle(b._getAreaTitle(b.$mjListPage))},_setLabelScrollEvent:function(){var b=this;var c=b.$mjListPageLeft.find(".co-listview-left-data");c.scroll(function(){desknets.forum.setLeftListPosition(jQuery(this).scrollTop())})},_setLabelScroll:function(){var c=this;var d=c.$mjListPageLeft.find(".co-listview-left-data");var b=desknets.forum.getLeftListPosition();if(b==0&&desknets.browser.firefox){b=1}d.scrollTop(b)},_getRestModule:function(){return desknets.forum.MODULE_API_FORUM},_getListCmd:function(){return desknets.forum.PAGE_FORUMINDEX},_getListExecCmd:function(){return desknets.forum.CMD_FORUMFORUMROOMLISTNEW},_getLabelGetCmd:function(){return desknets.forum.CMD_FORUMFORUMLISTLABEL},_getLabelEntryCmd:function(){return desknets.forum.CMD_FORUMPSETLABELENTRY},_getLabelDelCmd:function(){return desknets.forum.CMD_FORUMPSETDELLABEL},_getLabelOfForumMoveCmd:function(){return desknets.forum.CMD_FORUMMODASSIGNLABEL},});desknets.page(desknets.forum,"forumlist",desknets.forum.PageLabelListforum,{_mcListTemplateNewForum:null,$mjTableListNewForum:null,_getLabelAjaxSuccessOtherSet:function(d){var c=this;var b=c.$mjListPage.find(".forum-listview-forum");if(b.length==0){c._setUpMessage()}},_setUpMessage:function(){var c=this;var b=a("#jforum-topmsg");var d=false;if(b.hasClass("jforum-topmsg-manager")){d=true}c._setUpNoFolderMessage(d)},_setUpNoFolderMessage:function(d){var b=this;var c=desknets.Resource.forum.listnoforum_msg;var e="";if(!neo.isSet(d)||d==false){e=desknets.Resource.forum.listnoforum_user}if(d==true){param=a("#"+desknets.forum.FORUM_MSETINDEXID).find("a:first").attr("href");e='<a href="'+param+'">'+desknets.Resource.forum.listnoforum_manage+"</a>"}desknets.pageframe.viewTopMsg(c+"<br />"+e,"alert")},updateListHeight:function(){var b=this;desknets.listviewframe.updateListHeight(b.$mjListPage.find(".co-listview"),true,false)},_initListStartSet:function(){var b=this;b.callBase("_initListStartSet");b.$mjTableListNewForum=b.$mjListPage.find(".jforum-tbody-forumlist")},_initListEnd:function(){var b=this;b._initButtonNewRead();b.callBase("_initListEnd")},_initListStartTemplate:function(){var b=this;b.callBase("_initListStartTemplate");b._mcListTemplateNewForum=b.$mjTableListNewForum.html();b.$mjTableListNewForum.empty()},_initListStartModLink:function(){},_setItemsHref:function(){desknets.forum.setItemsHref(this.$mjTableList.add(this.$mjTableListNewForum))},_labelDelMultiParams:function(){var b=this;var c={};var d={};c=b.callBase("_labelDelMultiParams");d.cmd=b._getNewForumListCmd();c["3"]=d;return c},_moveLabelOfForumMultiParams:function(d,b){var c=this;var e={};var f={};e=c.callBase("_moveLabelOfForumMultiParams",d,b);f.cmd=c._getNewForumListCmd();e["3"]=f;return e},_initButtonNewRead:function(){var b=this;b.$mjListPage.find(".jforum-newread").click(function(e){e.preventDefault();var c="";var d=null;var f=null;c=desknets.Resource.forum.confirmation_newread;d=function(){if(f!=null){desknets.submitform.setDialogDisabled(f)}var h={};var g={};h=b._newReadMultiParams();b._mchkIDs=b._getListAjaxGetId();g=b._getListAjaxOptionsExec(f);b._sendRequestAjax(desknets.ajax.REQTYPE_MULTI,desknets.ajax.RESTYPE_JSON,h,g);return false};f=desknets.dialog.confirm(c,d)})},_newReadMultiParams:function(){var b=this;var d={};var c={};var f={};var e={};var g={};g.cmd=b._getNewReadCmd();g.mode="1";g.check="1";c=b.getListParamToObj();c.labelid="";f=b.getAddDataParam();f.cmd=b._getAddDataGetCmd();e.cmd=b._getNewForumListCmd();d["0"]=g;d["1"]=c;d["2"]=f;d["3"]=e;return d},_getListAjaxParams:function(d){var b=this;var e={};var c={};var g={};var f={};c=b.getListParamToObj();c.labelid="";g=b.getAddDataParam();g.cmd=b._getAddDataGetCmd();f.cmd=b._getNewForumListCmd();e["0"]=c;e["1"]=g;e["2"]=f;return e},_getListAjaxSuccessExecSplit:function(b){var c=[];if(typeof(b[3])=="object"){c[0]=b[1];c[1]=b[2];c[2]=b[3]}else{c=b}return c},_getListAjaxSuccess:function(c){var b=this;if(typeof(c[0])=="object"){if(c[0]["status"]!=desknets.RES_STATUS_SUCCESS){desknets.ajax.onError(c[0]["errorno"],c[0]["errormessage"])}else{b._getListAjaxSuccessNewArticle(c[0])}b._getListAjaxSuccessAdd(c)}else{b._getListAjaxSuccessNewArticle(c);b._getListAjaxSuccessAddData()}b._setItemsHref()},_getListAjaxSuccessAdd:function(c){var b=this;desknets.forum.setLeftListPosition(0);b.callBase("_getListAjaxSuccessAdd",c);if(c[2]["status"]!=desknets.RES_STATUS_SUCCESS){desknets.ajax.onError(c[2]["errorno"],c[2]["errormessage"])}else{b._getListAjaxSuccessNewForumData(c[2])}},_getListAjaxSuccessAddData:function(){var b=this;b.callBase("_getListAjaxSuccessAddData");if((typeof jsonRestForumNew)!="undefined"){b._getListAjaxSuccessNewForumData(jsonRestForumNew)}else{b._getAddDataAjaxNewForum()}},_getListAjaxSuccessNewArticle:function(i){var l=this;var h=desknets.ajax.getJsonItems(i);var k=[];var b=[];var f=0;var j=0;var e=l._mcListTemplate;var c="";if(h.length<=0){l.$mjListPage.find(".jforum-table-newlista").hide();l.$mjTableList.empty();l.$mjListPage.find(".co-nodata").show();c="0";l.$mjListPage.find(".jforum-read-all-area").hide()}else{l.$mjListPage.find(".jforum-table-newlista").show();l.$mjListPage.find(".co-nodata").hide();f=h.length;for(j=0;j<f;j++){k=h[j];if(j==0){k.borderline=""}else{k.borderline="forum-borderon"}if(neo.isSet(k.readtime)&&k.readtime.length>0){k["class-read"]=""}else{k["class-read"]="unread"}if(neo.isSet(k.status)&&(k.status==desknets.forum.DEF_STATUS_HIDE||k.status.length==0)){k.contr=desknets.Resource.forum.delete_submission;k.memo=desknets.Resource.forum.delete_submission;k["class-read"]=""}b[b.length]=l._listLine(e,k)}l.$mjTableList.empty();l.$mjTableList.html(b.join(""));l.$mjListPage.find(".forum-over-newtopic").hide();if(neo.isSet(i.allcnt)){var g=i.allcnt-h.length;if(g>0){var d="";d=desknets.Resource.forum.other_count;l.$mjListPage.find(".forum-over-newtopic").html(desknets.tmpl.replaceWordHtml(d,"count",g));l.$mjListPage.find(".forum-over-newtopic").show()}}}l._getListAjaxSuccessOtherSet(i);l._getListAjaxSuccessEnd()},_getListAjaxSuccessNewForumData:function(i){var l=this;var h=desknets.ajax.getJsonItems(i);var k=[];var b=[];var f=0;var j=0;var e=l._mcListTemplateNewForum;var c="";if(h.length<=0){l.$mjListPage.find(".form-top-newlist-forum").hide();l.$mjTableListNewForum.empty();c="0"}else{l.$mjListPage.find(".form-top-newlist-forum").show();f=h.length;for(j=0;j<f;j++){k=h[j];if(j==0){k.borderline=""}else{k.borderline="forum-borderon"}b[b.length]=l._listLine(e,k)}l.$mjTableListNewForum.empty();l.$mjTableListNewForum.html(b.join(""));l.$mjListPage.find(".forum-over-newforum").hide();if(neo.isSet(i.allcnt)){var g=i.allcnt-h.length;if(g>0){var d="";d=desknets.Resource.forum.other_count;l.$mjListPage.find(".forum-over-newforum").html(desknets.tmpl.replaceWordHtml(d,"count",g));l.$mjListPage.find(".forum-over-newforum").show()}}}},_getAddDataAjaxNewForum:function(){var b=this;var d={};var c={};d.cmd=b._getNewForumListCmd();c=b._getAddDataAjaxOptionsNewForum();c.url=desknets.getUrl(b._getRestModule());c.data=d;desknets.ajax.rest(c)},_getAddDataAjaxOptionsNewForum:function(){var b=this;var c={};c={success:function(e,d,f){b._getListAjaxSuccessNewForumData(e)}};return c},_replaceListLine:function(b,g,c){if(g=="cretime"||g=="latestentrytime"){var e=desknets.dateTime.dispDateTime(c[g],{type:"list"});var f=new RegExp("{{"+g+"}}","ig");b=b.replace(f,e)}if(g=="outline"||g=="memo"){var d=desknets.tmpl.dispStr(c[g]);b=desknets.tmpl.replaceWordHtml(b,g,d)}else{b=this.callBase("_replaceListLine",b,g,c)}return b},_hashUpdatePageView:function(d){var c=this;var g=desknets.paramanalyzer.getHashParams();if(d==desknets.forum.PAGE_FORUMTLIST){var f=a("#jco-m-topiclist-container").find(".jco-back-page-data");if(f.length>0&&!neo.isSet(g.init)){desknets.forum.forumtlist._getListAjax(g.row)}else{if(f.length>0&&neo.isSet(g.init)&&g.init==desknets.forum.DEF_INIT_TOP){c.mhashBackCmd=desknets.forum.PAGE_FORUMINDEX;c.mhashIdBack="jco-m-list-container";desknets.forum.forumtlist.mBackCmd=c.mhashBackCmd;desknets.forum.forumtlist.mIdBack=c.mhashIdBack;desknets.forum.forumtlist._getListAjax(g.row)}else{if(neo.isSet(g.init)&&g.init==desknets.forum.DEF_INIT_TOP){c.mhashBackCmd=desknets.forum.PAGE_FORUMINDEX;c.mhashIdBack="jco-m-list-container"}desknets.forum.forumtlist.initPage(c.mhashBackCmd,c.mhashIdBack)}}}else{if(d==desknets.forum.PAGE_FORUMALIST){var f=a("#jco-m-articlelist-container").find(".jco-back-page-data");if(f.length>0&&!neo.isSet(g.init)){desknets.forum.forumalist._getListAjax(g.row)}else{if(neo.isSet(g.init)&&g.init==desknets.forum.DEF_INIT_TOP){c.mhashBackCmd=desknets.forum.PAGE_FORUMINDEX;c.mhashIdBack="jco-m-list-container";desknets.forum.forumalist.initPage(c.mhashBackCmd,c.mhashIdBack)}else{if(neo.isSet(g.init)&&g.init==desknets.forum.DEF_INIT_TOPIC){var e=desknets.forum.PAGE_FORUMTLIST;var b="jco-m-topiclist-container";desknets.forum.forumalist.initPage(e,b)}else{desknets.forum.forumalist.initPage(c.mhashBackCmd,c.mhashIdBack)}}}}else{if(d==desknets.forum.PAGE_FORUMSEARCH){desknets.forum.setLeftListPosition(0);desknets.forum.forumsearch.initPage(desknets.forum.PAGE_FORUMINDEX,"jco-m-list-container");c.mhashBackErrCmd=c.mhashBackCmd;c.mhashIdErrBack=c.mhashIdBack;c.mhashBackCmd=desknets.forum.PAGE_FORUMSEARCH;c.mhashIdBack="jco-m-search-container"}else{c.callBase("_hashUpdatePageView",d)}}}},_getMainCmd:function(){return desknets.forum.PAGE_FORUMINDEX},_getRestModule:function(){return desknets.forum.MODULE_API_FORUM},_getListCmd:function(){return desknets.forum.PAGE_FORUMINDEX},_getListExecCmd:function(){return desknets.forum.CMD_FORUMPOSTLISTNEW},_getNewForumListCmd:function(){return desknets.forum.CMD_FORUMFORUMROOMLISTNEW},_getNewReadCmd:function(){return desknets.forum.CMD_FORUMNEWREAD},});desknets.page(desknets.forum,"cabinetregist",desknets.cabinetregist,{mIdForum:"",mIdTopic:"",mIdArticle:"",mNameForum:"",mNameTopic:"",$mTargetArticle:null,setTargetId:function(c,d){var b=this;b.mIdForum=c;b.mIdTopic=d},setTargetName:function(c,d){var b=this;b.mNameForum=c;b.mNameTopic=d},_setClickHandlerCabRegist:function(){var b=this;b.$area.detail.delegate(".jco-cab-regist","click",function(c){c.preventDefault();b.$mTargetArticle=a(this).parents(".forum-article-item");b.mIdArticle=b.$mTargetArticle.find(".jforum-article-id").val();b.boNotAttach=false;b.$dialog.detail.dialog("open");if(!b.boview){b.boview=true;desknets.dialog.setFirstDialogOpen(b.$dialog)}})},_getRestAttachPrm:function(){var b=this;var c={};c.cmd=b._getRestAttachCmd("detail");c.fid=b.mIdForum;c.tid=b.mIdTopic;c.id=b.mIdArticle;return c},_getTitle:function(){var b=this;return b.$mTargetArticle.find(".jforum-article-name").val()},_sendCabinet:function(b){var d=this;var e=d._getRestCabinet(b,"detail");if(!d.$mTargetArticle.find(".forum-article-replies").hasClass("none")){var f=function(h){d.sendCabinetAjax(h,"detail")};c=d._getCommentRec(b,f,e)}else{var g=e.viewdata;var c="";g=d._replaceTemplate(g,"reply",c,true);e.viewdata=g;if(typeof e=="object"){d.sendCabinetAjax(e,"detail")}}},_makeTemplate:function(m,l){var j=this;var b=j.mNameForum+" > "+j.mNameTopic;l=j._replaceTemplate(l,"title",b,true);var c=j.$mTargetArticle.find(".forum-article-username:first").text();l=j._replaceTemplate(l,"contr",c,true);var g=j.$mTargetArticle.find(".forum-article-message:first").html();l=j._replaceTemplate(l,"memo",g,false);var d=j.$mTargetArticle.find(".forum-article-date:first").text();l=j._replaceTemplate(l,"cretime",d,true);var f=j.$mTargetArticle.find(".forum-article-attach");var h="";var e="";if(f.hasClass("none")){h="none"}else{var k=f.find(".jforum-article-attach-list").html();var i=a("<div>"+k+"</div>");desknets.attachDisp.removeAttachAlink(i);e=i.html()}l=j._replaceTemplate(l,"attach",h,true);l=j._replaceTemplate(l,"attachlist",e,false);return l},_replaceTemplate:function(d,c,g,e){var b=this;var f="";if(e){f=desknets.escape(g);f=desknets.escapeValue(f);f=desknets.escapeSpace(f)}else{f=g}return desknets.tmpl.replaceWordHtml(d,c,f)},_getTemplateCommentRec:function(){var b='<li class="forum-article-reply">  <div class="forum-article-username">{{contr}}</div>  <div class="forum-article-message">{{memo}}</div>  <table class="forum-article-replies-attach none">    <tr>      <th class=""><span class="forum-article-replies-attach-title">'+desknets.Resource.attachTitle+'<span class="co-colon-span">:</span></span></th>      <td class="jforum-article-replies-attach-list">        <span class="jforum-article-replies-attach-item">        </span>      </td>    </tr>  </table>  <div class="forum-article-meta">    <div class="forum-article-date">{{cretime}}</div>  </div></li><!-- .forum-topic-reply -->';return b},_getCommentRec:function(f,g,d){var c=this;var b="";b=c._getListCommentAjaxSuccess(f);var e=a("<ul></ul>");e.append(b);desknets.htmlparts.convertHrefInText(e.find(".forum-article-message"));b=e.html();var h=d.viewdata;h=c._replaceTemplate(h,"reply",b,false);d.viewdata=h;if(typeof d=="object"){g(d)}return b},_getListCommentAjaxSuccess:function(g){var d=this;var i=desknets.ajax.getJsonItems(g);var f=[];var c=[];var e=d._getTemplateCommentRec();var h=-1;var b=i.length;h=b-1;for(;h>=0;h--){f=i[h];c[c.length]=d._listLineComment(e,f)}return c.join("")},_listLineComment:function(e,f){var d=this;var b="";var c=false;if(typeof f=="object"){for(b in f){if(b=="cretime"){var g=desknets.dateTime.dispDateTime(f[b],{type:"list"});e=d._replaceTemplate(e,b,g,true)}else{if(b=="memo"){var g=desknets.tmpl.dispStr(f[b]);e=d._replaceTemplate(e,b,g,false)}else{if(b=="attach"){c=true;continue}else{e=d._replaceTemplate(e,b,f[b],true)}}}}var h=a("<ul />").html(e);if(c){d._getListCommentAttachAjaxSuccess(f,h)}e=h.html()}return e},_getListCommentAttachAjaxSuccess:function(c,f){var b=this;var e=desknets.ajax.getItems(c.attach.item);var d=desknets.attachDisp.disp(c.attach);f.find(".jforum-article-replies-attach-list").html(d);if(e.length>0){f.find(".forum-article-replies-attach").removeClass("none")}else{f.find(".forum-article-replies-attach").addClass("none")}},_getCommentCmd:function(){return desknets.forum.CMD_FORUMCOMMENTLIST},});desknets.page(desknets.forum,"forumsearch",desknets.PageListBatSearchBase,{_initListStart:function(){var b=this;b.callBase("_initListStart");var c=b.$mjListPage;var d=desknets.paramanalyzer.getHashParams();c.find('input[name="srch_key"]').val(d.srch_key);c.find('input[name="sdate"]').val(d.sdate);c.find('input[name="edate"]').val(d.edate);c.find('select[name="sw_target"]').val(d.sw_target)},_initListStartModLink:function(){},_setItemsHref:function(){desknets.forum.setItemsHref(this.$mjTableList)},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".co-pageback").click(function(c){c.preventDefault();b.dispBackListPage()})},_getListAjaxSuccess:function(c){var b=this;b.callBase("_getListAjaxSuccess",c);b._setItemsHref()},_replaceListLine:function(b,f,c){if(f=="cretime"){var d=desknets.dateTime.dispDateTime(c[f],{type:"list"});var e=new RegExp("{{"+f+"}}","ig");b=b.replace(e,d)}else{b=this.callBase("_replaceListLine",b,f,c)}return b},_getListCmd:function(){return desknets.forum.PAGE_FORUMSEARCH},_getListExecCmd:function(){return desknets.forum.CMD_FORUMSEARCH},_getStopBatSearchCmd:function(){return desknets.forum.CMD_FORUMSEARCHSTOP},_getSearchConditionParams:function(){var b=[];b.push("srch_key");b.push("sdate");b.push("edate");b.push("sw_target");b.push("srch_filecontents");return b},_getRestModule:function(){return desknets.forum.MODULE_API_FORUM},});desknets.forum.BaseTopicList={_mcListTemplate2:null,_mcListTemplate3:null,mbAnonymityUse:false,_sDelFlg:"0",msfid:"",_topicRefCmd:desknets.forum.PAGE_FORUMALIST,init:function(){var b=this;this.callBase("init")},_initListStart:function(){var b=this;desknets.forum.dialogTopicEntry.createDialog(b.$mjListPage,function(d,c){b._entryTopic(d,c)});b.$mjListPage.find(".co-table-list").hide();b.$mjListPage.find(".co-nodata").hide();b.callBase("_initListStart")},_initListStartTemplate:function(){var c=this;c.callBase("_initListStartTemplate");var b=c.$mjListPage.find(".jforum-tbody-list-stat2");c._mcListTemplate2=b.html();b.remove();var d=c.$mjListPage.find(".jforum-tbody-list-stat3");c._mcListTemplate3=d.html();d.remove()},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".jforum-list-del-submit").click(function(c){b._sDelFlg="0";b._listDelSubmit(c)});b.$mjListPage.find(".jforum-list-running-submit").click(function(c){b._sDelFlg="1";b._listDelSubmit(c)});b.$mjListPage.find(".jforum-list-stop-submit").click(function(c){b._sDelFlg="2";b._listDelSubmit(c)});b.$mjListPage.find(".jforum-list-readonly-submit").click(function(c){b._sDelFlg="3";b._listDelSubmit(c)});b.$mjListPage.find(".jforum-list-sort-link").click(function(e){e.preventDefault();var d=b.$mjListPage.find(".jco-back-page-data");var c=a(this).data("field");d.find('input[name="fldsort"]').val(c);b._listPage("0")})},_delNoChkMessage:function(){var b=this;if(b._sDelFlg=="1"){return desknets.Resource.forum.running_nochecked}else{if(b._sDelFlg=="2"){return desknets.Resource.forum.stop_nochecked}else{if(b._sDelFlg=="3"){return desknets.Resource.forum.readonly_nochecked}}}return b.callBase("_delNoChkMessage")},inputAddPage:function(d){var c=this;d.preventDefault();var b=c._getTargetForumId();desknets.forum.dialogTopicEntry.showDialog(b,c.mbAnonymityUse)},_entryTopic:function(d,c){var b=this;var e={};e.cmd=b._getTopicEntryCmd();a.extend(e,c);desknets.ajax.rest({url:desknets.getUrl(b._getRestModule()),data:e,success:function(g,f,h){if(d!=null){desknets.submitform.clearDialogDisabled(d);d.dialog("close")}b._getListAjax(b._getListRow())},error:function(g,f,h){desknets.ajax.onError(g.status,h);desknets.submitform.clearDialogDisabled(d)},})},_getDelAddPrm:function(){var b=this;var c={};c.fid=b._getTargetForumId();if(b._sDelFlg!="0"){c.status=b._sDelFlg}return c},_getListAjaxSuccess:function(c){var b=this;b.callBase("_getListAjaxSuccess",c);b._setItemsHref()},_getListAjaxSuccessOtherSet:function(d){var b=this;var c=d.anonymouse;if(d.readonly==1){b.$mjListPage.find(".jco-list-add-page").attr("disabled",true);b.$mjListPage.find(".jforum-list-running-submit").attr("disabled",true);b.$mjListPage.find(".jforum-list-readonly-submit").attr("disabled",true);b.$mjListPage.find(".jforum-list-stop-submit").attr("disabled",true);b.$mjListPage.find(".jforum-list-del-submit").attr("disabled",true)}else{b.$mjListPage.find(".jco-list-add-page").attr("disabled",false);b.$mjListPage.find(".jforum-list-running-submit").attr("disabled",false);b.$mjListPage.find(".jforum-list-readonly-submit").attr("disabled",false);b.$mjListPage.find(".jforum-list-stop-submit").attr("disabled",false);b.$mjListPage.find(".jforum-list-del-submit").attr("disabled",false)}if(c=="1"){b.mbAnonymityUse=true}else{b.mbAnonymityUse=false}b._setTargetForumId(d.id);b._selName=d.Name},_getListAjaxSuccessEnd:function(){var b=this;b.callBase("_getListAjaxSuccessEnd");b._setTargetForumId(b.msfid);if(desknets.forum.isSortUpdate()){b.$mjListPage.find(".forum-list-sort-update").show();b.$mjListPage.find(".forum-list-sort-new").hide()}else{b.$mjListPage.find(".forum-list-sort-update").hide();b.$mjListPage.find(".forum-list-sort-new").show()}},_listLine:function(d,e){var c=this;var f=false;var b=e.status;if(b=="2"){d=c._mcListTemplate3}else{if(b=="3"){d=c._mcListTemplate2}}if(neo.isSet(e["new"])){e["new"]="new"}else{e["new"]=""}if(neo.isSet(e.latestentrytime)&&e.latestentrytime.length>0){e.latestentrytime=desknets.dateTime.dispDateTime(e.latestentrytime,{type:"list"})}else{e.latestentrytime=""}d=this.callBase("_listLine",d,e);return d},_setItemsHref:function(){var b=this;b.$mjTableList.find("tr").each(function(){var c=a(this);var d={cmd:b._topicRefCmd,fid:b._getTargetForumId(),tid:c.find(".jco-id").val(),init:desknets.forum.DEF_INIT_TOPIC};c.find(".jco-modlink").attr("href","#"+desknets.getNeoParam(d))})},inputDispPage:function(e){var d=this;var c=d._getTargetForumId();var b=e;desknets.forum.changeLocationToArticleList(d,c,b,null,desknets.forum.DEF_INIT_TOPIC)},inputModPage:function(c){var b=this;b.inputDispPage(c)},_setTargetForumId:function(d){var b=this;var c=b.$mjListPage.find(".jco-back-page-data");c.find('input[name="fid"]').val(d);b.msfid=d},_getTargetForumId:function(){var b=this;var c=b.$mjListPage.find(".jco-back-page-data");return c.find('input[name="fid"]').val()},_getRestModule:function(){return desknets.forum.MODULE_API_FORUM},_getListCmd:function(){return desknets.forum.PAGE_FORUMTLIST},_getListExecCmd:function(){return desknets.forum.CMD_FORUMTOPICLIST},_getDelCmd:function(){var b=this;if(b._sDelFlg!="0"){return desknets.forum.CMD_FORUMTOPICSTATUSSETCONF}return desknets.forum.CMD_FORUMTOPICDELCONF},_getDelExecCmd:function(){var b=this;if(b._sDelFlg!="0"){return desknets.forum.CMD_FORUMTOPICSTATUSSET}return desknets.forum.CMD_FORUMTOPICDEL},_getTopicEntryCmd:function(){return desknets.forum.CMD_FORUMTOPICENTRY}};desknets.page(desknets.forum,"baseforumtlist",desknets.forum.PageLabelListforum,desknets.forum.BaseTopicList);desknets.page(desknets.forum,"forumtlist",desknets.forum.baseforumtlist,{_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".co-pageback").click(function(c){c.preventDefault();b.dispBackListPage()})},_getIdListPage:function(){return"jco-m-topiclist-container"},_getIdListPageForm:function(){return"topiclistfrm"},});desknets.forum.BaseArticleList={_DEF_TEXTAREAHEIGHT_ARTICLE:57,_MAX_TEXTAREAHEIGHT_ARTICLE:-1,_DEF_TEXTAREAHEIGHT_COMMENT:28,_MAX_TEXTAREAHEIGHT_COMMENT:-1,mbAnonymityUse:false,miTopicStatus:1,miReadOnly:0,miAttachUse:0,mDispDefComment:2,_mcTemplateInputAttach:null,_mcListTemplateComment:null,_mboHighlightMode:true,init:function(){var c=this;var b=a("#jco-m-articlelist-container").find(".jco-back-page-data");this.callBase("init")},_initArticleInputEvent:function(){var b=this;b.$mjListPage.find(".forum-article-post-input").delegate("textarea","mouseup",function(){b.updateListHeight()})},_resizeLeftFrameHeight:function(f){var e=this;var i=f.find(".co-listview-list").height();var g=desknets.listviewframe.VAL_LISTVIEWFRAME_MINHEIGHT+desknets.listviewframe.VAL_LISTVIEWFRAME_HEAD;if(i<g){i=g}var b=a(window).height()-f.offset().top-desknets.listviewframe.VAL_LISTVIEWFRAME_BOTTOMBTN;if(i<b){i=b}f.find(".co-listview-left").height(i);var d=i;var c=f.find(".co-listview-left-title");if(neo.isSet(c)&&c.length>0){if(c.height()>0){d=d-desknets.listviewframe.VAL_LISTVIEWFRAME_HEAD}}var h=f.find(".co-listview-left-subtitle");if(neo.isSet(h)&&h.length>0){if(h.height()>0){d=d-desknets.listviewframe.VAL_LISTVIEWFRAME_HEAD}}f.find(".co-listview-left-data").height(d)},updateListHeight:function(){var b=this;b._resizeLeftFrameHeight(b.$mjListPage.find(".co-listview"))},_initInputAreaArticle:function(){var b=this;var c=b.$mjListPage.find(".jforum-article-post");var e=c.find(".forum-article-post-text");var d=c.find(".jforum-article-entry-anonymity");e.val("");if(desknets.browser.msie||desknets.browser.msie8){e.css({"overflow-y":"hidden","overflow-x":"hidden"})}else{e.css({overflow:"hidden"})}d.removeAttr("checked");b._initInputAreaAttach(c)},_initInputAreaComment:function(d){var b=this;var c=d.find(".forum-article-replies-input");var e=d.find(".jforum-comment-entry-anonymity");c.val("");if(desknets.browser.msie||desknets.browser.msie8){c.css({"overflow-y":"hidden","overflow-x":"hidden"})}else{c.css({overflow:"hidden"})}c.height(b._DEF_TEXTAREAHEIGHT_COMMENT);e.removeAttr("checked");b._initInputAreaAttach(d)},_initInputAreaAttach:function(e){var d=this;var c=e.find(".jforum-attach-list");if(d.miAttachUse==1){c.empty();c.html(d._mcTemplateInputAttach);var b=d._getAttach();b.init(d.$mjListPage,true,function(){d._resizeLeftFrameHeight(d.$mjListPage.find(".co-listview"))});e.find(".jforum-attach-title").show();e.find(".jforum-attach-list").show()}else{e.find(".jforum-attach-title").hide();e.find(".jforum-attach-list").hide()}},_initListStartSet:function(){var c=this;var b=c.$mjListPage.find(".jforum-article-post").find(".jforum-attach-list");c._mcTemplateInputAttach=b.html();b.empty();var d=c.$mjListPage.find(".forum-article-replies");c._mcListTemplateComment=d.html();d.empty();this.callBase("_initListStartSet")},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".co-pageback").click(function(c){c.preventDefault();b.dispBackListPage()});b.$mjListPage.find(".jforum-list-sort-link").click(function(e){e.preventDefault();var d=b.$mjListPage.find(".jco-back-page-data");var c=a(this).data("field");d.find('input[name="fldsort"]').val(c);b._listPage("0")})},_initListEnd:function(){var b=this;b._initArticleEvent();b._initRepInputEvent();b._initOtherEvent();b._initArticleInputEvent();this.callBase("_initListEnd")},_initArticleEvent:function(){var c=this;var b=c.$mjListPage.find(".jforum-article-post");b.delegate(".forum-article-post-link","click",function(f){f.preventDefault();var g=a(this).siblings(".forum-article-post-input");var d={};d.cmd=desknets.forum.CMD_FORUMATTACHDELTEMP;desknets.ajax.rest({url:desknets.getUrl(c._getRestModule()),data:d,success:function(h,e,i){c._closeAllInputArea();c._openArtilceInputArea(true);if(c._isOpenArticleInputArea(g)){c._initInputAreaArticle();g.find(".forum-article-post-text").focus()}c.updateListHeight()},})});b.delegate("textarea.forum-article-post-text","keyup",function(d){if(desknets.browser.firefox){c._textareaResize(a(d.target),c._DEF_TEXTAREAHEIGHT_ARTICLE,c._MAX_TEXTAREAHEIGHT_ARTICLE,8)}else{c._textareaResize(a(d.target),c._DEF_TEXTAREAHEIGHT_ARTICLE,c._MAX_TEXTAREAHEIGHT_ARTICLE,2)}});b.delegate(".forum-article-post-submit","click",function(h){h.preventDefault();var d=a(this).parents(".forum-article-post-input");var f=c.$mjListPage.find(".jco-back-page-data");var g=f.find('input[name="fid"]').val();var i=f.find('input[name="tid"]').val();c._entryArticle(g,i,d)});b.delegate(".forum-article-close-submit","click",function(d){d.preventDefault();c._openArtilceInputArea(false)})},_openArtilceInputArea:function(d){var c=this;var b=c.$mjListPage.find(".jforum-article-post");b.find(".forum-article-post-text").height(c._DEF_TEXTAREAHEIGHT_ARTICLE);if(d){b.find(".forum-article-post-input").show()}else{b.find(".forum-article-post-input").hide()}c.updateListHeight()},_openCommentInputArea:function(c,d){var b=this;if(d){c.show()}else{c.hide()}b.updateListHeight()},_closeAllInputArea:function(){var c=this;var b=c.$mjListPage.find(".jforum-article-post");if(c._isOpenArticleInputArea(b.find(".forum-article-post-input"))){c._openArtilceInputArea(false)}c.$mjListPage.find(".forum-article-replies-post-input").each(function(d,e){if(c._isOpenCommentInputArea(a(e))){c._openCommentInputArea(a(e),false)}})},_isOpenInputArea:function(c){var b=this;if(c.css("display")==="block"){return true}return false},_isOpenArticleInputArea:function(c){var b=this;return b._isOpenInputArea(c)},_isOpenCommentInputArea:function(c){var b=this;return b._isOpenInputArea(c)},_initRepInputEvent:function(){var b=this;var c=b.$mjListPage.find(".forum-article-list");c.delegate(".forum-msg-comment","click",function(f){f.preventDefault();a(this).closest("li.forum-article-item").find(".forum-article-replies-post-link").click()});var d=b.$mjListPage.find("textarea.forum-article-replies-input");c.delegate(".forum-article-replies-post-link","click",function(h){h.preventDefault();var g=a(this).parents(".jforum-article-replies-post").find(".forum-article-replies-post-input");if(b._isOpenCommentInputArea(g)){return}var f={};f.cmd=desknets.forum.CMD_FORUMATTACHDELTEMP;desknets.ajax.rest({url:desknets.getUrl(b._getRestModule()),data:f,success:function(i,e,j){b._closeAllInputArea();b._openCommentInputArea(g,true);if(b._isOpenCommentInputArea(g)){b._initInputAreaComment(g);g.find(".forum-article-replies-input").focus()}b.updateListHeight()},})});c.delegate("textarea.forum-article-replies-input","keypress",function(h){if((h.which&&h.which==13)||(h.keyCode&&h.keyCode==13)){if(!h.shiftKey){var g=a(this).parents(".forum-article-item").find(".jforum-article-id").val();var f=a(this).parents(".forum-article-replies-post-input");f.find(".forum-article-replies-input").blur();b._entryComment(g,f);return false}}});c.delegate("textarea.forum-article-replies-input","keyup",function(f){if(desknets.browser.firefox){b._textareaResize(a(f.target),b._DEF_TEXTAREAHEIGHT_COMMENT,b._MAX_TEXTAREAHEIGHT_COMMENT,8)}else{b._textareaResize(a(f.target),b._DEF_TEXTAREAHEIGHT_COMMENT,b._MAX_TEXTAREAHEIGHT_COMMENT,2)}});c.delegate("textarea.forum-article-replies-input","mouseup",function(){b.updateListHeight()});c.delegate("input.jforum-comment-entry-anonymity","keypress",function(h){if((h.which&&h.which==13)||(h.keyCode&&h.keyCode==13)){if(!h.shiftKey){var g=a(this).parents(".forum-article-item").find(".jforum-article-id").val();var f=a(this).parents(".forum-article-replies-post-input");b._entryComment(g,f);return false}}});c.delegate(".forum-article-replies-post-submit","click",function(h){h.preventDefault();var g=a(this).parents(".forum-article-item").find(".jforum-article-id").val();var f=a(this).parents(".forum-article-replies-post-input");b._entryComment(g,f)});c.delegate(".forum-article-replies-close-submit","click",function(g){g.preventDefault();var f=a(this).parents(".forum-article-replies-post-input");b._openCommentInputArea(f,false)})},_textareaResize:function(k,d,e,b){var m=this;var g=d;var j=e;var f=b;var l=0;var c=true;if(e<0){c=false}var h=parseInt(k.css("maxHeight"));if(h>0&&h<j){j=h}var i=parseInt(k.get(0).clientHeight)+f;if(i>j){j=i}if(k.val().length==0){l=g}else{if(!desknets.browser.msie||desknets.browser.msie11){k.height(g)}l=parseInt(k.get(0).scrollHeight)+f}if(l<g){l=g}if(c&&l>j){if(desknets.browser.msie||desknets.browser.msie8){k.css({"overflow-y":"scroll","overflow-x":"hidden"})}else{k.css({overflow:"auto"})}l=j}else{if(desknets.browser.msie||desknets.browser.msie8){k.css({"overflow-y":"hidden","overflow-x":"hidden"})}else{k.css({overflow:"hidden"})}}k.height(l);m.updateListHeight()},_initOtherEvent:function(){var b=this;var c=b.$mjListPage.find(".forum-article-list");c.delegate(".forum-article-delete","click",function(i){i.preventDefault();var f=a(this).parents(".forum-article-item");var d=b.$mjListPage.find(".jco-back-page-data");var h=d.find('input[name="fid"]').val();var j=d.find('input[name="tid"]').val();var g=a(this).parents(".forum-article-item").find(".jforum-article-id").val();b._deleteArticle(f,h,j,g)});c.delegate(".forum-comment-delete","click",function(k){k.preventDefault();var f=a(this).parents(".forum-article-item");var i=a(this).parents(".forum-article-reply");var d=b.$mjListPage.find(".jco-back-page-data");var j=d.find('input[name="fid"]').val();var l=d.find('input[name="tid"]').val();var h=a(this).parents(".forum-article-item").find(".jforum-article-id").val();var g=a(this).parents(".forum-article-reply").find(".jforum-comment-id").val();b._deleteComment(f,i,j,l,h,g)});b._setClickHandlerCabinet(c);c.delegate(".forum-article-replies-showall","click",function(f){f.preventDefault();var d=a(this).parents(".forum-article-item");b._getListCommentAjax(d,true)});c.delegate(".forum-article-replies-hidecom","click",function(f){f.preventDefault();var d=a(this).parents(".forum-article-item");b._getListCommentAjax(d,false)})},_setClickHandlerCabinet:function(c){var b=this;var d=b.$mjListPage.find(".jco-back-page-data");var f=d.find('input[name="fid"]').val();var g=d.find('input[name="tid"]').val();var e={copymodule:b._getRestModule(),copycmd:b._getCopyAttachCmd(),cabtemplatename:b._getCabRegistHTML()};b._initCabinetregist(c,e,false);b._setCabinetregistTargetId(f,g)},_getListAjaxParams:function(d){var b=this;var e={};var c={};var f={};var g={};c=b.getListParamToObj();c.row=d;f=b.getAddDataParam();f.cmd=b._getAddDataGetCmd();e["0"]=c;e["1"]=f;g=desknets.attach.ext.getListParam();if(neo.isSet(g)){g.cmd=b._getAttachExtCmd();e["2"]=g}return e},_getListAjaxSuccess:function(d){var b=this;var c=d["0"]["anonymouse"];if(c=="1"){b.mbAnonymityUse=true}else{b.mbAnonymityUse=false}b.miTopicStatus=d["0"]["tstatus"];b.miReadOnly=d["0"]["readonly"];b.miAttachUse=d["0"]["attachuse"];this.callBase("_getListAjaxSuccess",d)},_getListAjaxSuccessAdd:function(c){var b=this;b.callBase("_getListAjaxSuccessAdd",c);if(neo.isSet(c["2"])){if(c["2"]["status"]!=desknets.RES_STATUS_SUCCESS){desknets.ajax.onError(c["2"]["errorno"],c["2"]["errormessage"])}else{desknets.attach.ext.saveList(c["2"])}}},_listLine:function(e,i){var k=this;var d="";var j=false;var f=false;var h=false;var c=false;if(typeof i=="object"){for(d in i){if(d=="list"){f=true;continue}else{if(d=="attach"){j=true;continue}else{if(d=="photo"){h=true}else{if(d=="new"){c=true;continue}}}}e=k._replaceListLine(e,d,i)}var g=new RegExp("{{new}}","ig");if(c){e=e.replace(g,"new")}else{e=e.replace(g,"")}e=k._setUserImg(e,h);var b=a("<ul />").html(e);k._setDeleteIcon(b.find(".forum-article-delete"),i);if(j){k._getListAttachAjaxSuccess(i,b)}if(f){k._getListCommentAjaxSuccess(i,b,k.mDispDefComment)}e=b.html()}return e},_setUserImg:function(d,b){var c=this;if(b){var e=new RegExp("{{userimgnone}}","ig");d=d.replace(e,"")}else{var e=new RegExp("{{userimg}}","ig");d=d.replace(e,"");e=new RegExp("{{userimgnone}}","ig");d=d.replace(e,"forum-article-userimg-none")}return d},_replaceListLine:function(c,g,d){if(g=="memo"){var e=desknets.tmpl.dispStr(d[g]);c=desknets.tmpl.replaceWordHtml(c,g,e)}else{if(g=="photo"){var b='<img class="forum-article-userimg" src="{{photo}}" />';var f=new RegExp("{{photo}}","ig");b=b.replace(f,d[g]);f=new RegExp("{{userimg}}","ig");c=c.replace(f,b)}else{if(g=="cretime"){var e=desknets.dateTime.dispDateTime(d[g],{type:"list"});var f=new RegExp("{{"+g+"}}","ig");c=c.replace(f,e)}else{c=this.callBase("_replaceListLine",c,g,d)}}}return c},_getListAttachAjaxSuccess:function(g,b){var o=this;var d=desknets.ajax.getItems(g.attach.item);var m=[];var c=[];var k=0;var l=o.$mjListPage.find(".jco-back-page-data");var j=l.find('input[name="fid"]').val();var f=l.find('input[name="tid"]').val();var i=b.find(".jforum-article-id").val();var e=desknets.getUrl(o._getModule());var h={cmd:o._getRefAttachCmd(),fid:j,tid:f,id:i};var n=desknets.attachDisp.disp(g.attach,o._getModule(),h);b.find(".jforum-article-attach-list").html(n);if(d.length>0){b.find(".forum-article-attach").removeClass("none")}else{b.find(".forum-article-attach").addClass("none")}},_getListCommentAttachAjaxSuccess:function(i,b,e){var q=this;var f=desknets.ajax.getItems(i.attach.item);var o=[];var c=[];var n=0;var m=q.$mjListPage.find(".jco-back-page-data");var l=m.find('input[name="fid"]').val();var h=m.find('input[name="tid"]').val();var k=e;var d=b.find(".jforum-comment-id").val();var g=desknets.getUrl(q._getModule());var j={cmd:q._getRefCommentAttachCmd(),fid:l,tid:h,aid:k,id:d};var p=desknets.attachDisp.disp(i.attach,q._getModule(),j);b.find(".jforum-article-replies-attach-list").html(p);if(f.length>0){b.find(".forum-article-replies-attach").removeClass("none")}else{b.find(".forum-article-replies-attach").addClass("none")}},_getListCommentAjax:function(b,c){var i=this;var e={};var j={};var h=i.$mjListPage.find(".jco-back-page-data");var g=h.find('input[name="fid"]').val();var d=h.find('input[name="tid"]').val();var f=b.find(".jforum-article-id").val();e.cmd=i._getListCommentExecCmd();e.fid=g;e.tid=d;e.aid=f;j={success:function(l,k,m){if(c){i._getListCommentAjaxSuccess(l,b,-1);b.find(".forum-article-replies-showall").addClass("none");b.find(".forum-article-replies-hidecom").removeClass("none")}else{i._getListCommentAjaxSuccess(l,b,i.mDispDefComment);b.find(".forum-article-replies-showall").removeClass("none");b.find(".forum-article-replies-hidecom").addClass("none")}i.updateListHeight()}};i._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_JSON,e,j)},_getListCommentAjaxSuccess:function(h,b,d){var l=this;var g=desknets.ajax.getJsonItems(h);var k=[];var c=[];var e=l._mcListTemplateComment;var j=-1;var i=b.find(".jforum-article-id").val();var f=g.length;if(d>0&&d<f){j=d-1}else{j=f-1}for(;j>=0;j--){k=g[j];c[c.length]=l._listLineComment(e,k,i)}if(g.length>l.mDispDefComment){l._setListComment(b,c.join(""),g.length,true)}else{l._setListComment(b,c.join(""),g.length,false)}if(g.length>0){b.find(".forum-article-replies").removeClass("none")}else{b.find(".forum-article-replies").addClass("none")}desknets.htmlparts.convertHrefInText(b.find(".forum-article-message"))},_listLineComment:function(e,i,f){var k=this;var d="";var h=false;var c=false;var j=false;if(typeof i=="object"){for(d in i){if(d=="photo"){h=true}else{if(d=="new"){c=true;continue}else{if(d=="attach"){j=true;continue}}}e=k._replaceListLine(e,d,i)}var g=new RegExp("{{new}}","ig");if(c){e=e.replace(g,"new")}else{e=e.replace(g,"")}e=k._setUserImg(e,h);var b=a("<ul />").html(e);k._setDeleteIcon(b.find(".forum-comment-delete"),i);if(j){k._getListCommentAttachAjaxSuccess(i,b,f)}e=b.html()}return e},_setListComment:function(h,g,f,b){var c=this;h.find(".forum-article-replies").html(g);var e=desknets.tmpl.replaceWordChk(desknets.Resource.forum.comment_list_open,"count",f);h.find(".jforum-comment-list-open").text(e);var d=desknets.tmpl.replaceWordChk(desknets.Resource.forum.comment_list_close,"count",c.mDispDefComment);h.find(".jforum-comment-list-close").text(d);if(b){h.find(".forum-article-replies-showall").removeClass("off");h.find(".forum-article-replies-hidecom").removeClass("off")}else{h.find(".forum-article-replies-showall").addClass("off");h.find(".forum-article-replies-hidecom").addClass("off")}},_setDeleteIcon:function(e,c){var b=this;var d=c.isdelete;if(d==1){e.removeClass("off")}else{e.addClass("off")}},_getListAjaxSuccessOtherSet:function(c){var b=this;b._selName=c.forumname;b.$mjListPage.find(".forum-topic-name").text(c.topicname);b._setCabinetregistTargetName(c.forumname,c.topicname);if(b.miTopicStatus==3){b.$mjListPage.find(".forum-topic-title").addClass("readonly")}else{b.$mjListPage.find(".forum-topic-title").removeClass("readonly")}if(b.miReadOnly==1){b.$mjListPage.find(".jforum-article-post").hide();b.$mjListPage.find(".forum-msg-comment").hide();b.$mjListPage.find(".jforum-article-replies-post").hide()}else{b.$mjListPage.find(".jforum-article-post").show();b.$mjListPage.find(".forum-msg-comment").show();b.$mjListPage.find(".jforum-article-replies-post").show()}if(b.mbAnonymityUse){b.$mjListPage.find(".forum-entry-anonymity").show()}else{b.$mjListPage.find(".forum-entry-anonymity").hide()}b._openArtilceInputArea(false);desknets.htmlparts.convertHrefInText(b.$mjListPage.find(".forum-article-message"))},_getListAjaxSuccessEnd:function(){var b=this;b.callBase("_getListAjaxSuccessEnd");if(desknets.forum.isSortUpdate()){b.$mjListPage.find(".forum-list-sort-update").show();b.$mjListPage.find(".forum-list-sort-new").hide();b._mboHighlightMode=true}else{b.$mjListPage.find(".forum-list-sort-update").hide();b.$mjListPage.find(".forum-list-sort-new").show();b._mboHighlightMode=false}},_entryArticle:function(f,g,d){var b=this;desknets.submitform.setDisabled(b.$mjListPage);var h=d.find(".forum-article-post-text");var e=d.find(".jforum-article-entry-anonymity");var c={};c.cmd=b._getArticleEntryCmd();c.fid=f;c.tid=g;c.memo=h.val();c.contr="";if(b.mbAnonymityUse&&e.attr("checked")){c.anonymouse="1"}desknets.ajax.rest({url:desknets.getUrl(b._getRestModule()),data:c,success:function(k,i,m){var l=function(){b._cleanArticleId();if(b._getListRow()!="0"){b._listPage("0")}else{b._getListAjax(b._getListRow())}b._openArtilceInputArea(false)};if(!!k.noticeerror){var j=desknets.dialog.alert(k.noticeerror,{extraClass:"co-msg-r",type:"warn"});j.bind("dialogclose",function(n){desknets.dialog.deleteById("warn");l()});return}l()},complete:function(j,i){desknets.submitform.clearDisabled(b.$mjListPage)}})},_deleteArticle:function(d,e,i,g){var b=this;var f=null;var h={};var c=function(){if(f!=null){desknets.submitform.setDialogDisabled(f)}var j=b._getParamDeleteArticle(d,e,i,g);desknets.ajax.rest({url:desknets.getUrl(b._getRestModule()),data:j,success:function(l,k,m){b._getListAjax(b._getListRow());f.dialog("close")},})};f=desknets.dialog.confirm(b._getMessageDeleteArticle(d),c,h)},_getParamDeleteArticle:function(d,e,g,f){var c=this;var b={};b.cmd=c._getArticleDelCmd();b.fid=e;b.tid=g;b.id=f;b.status=desknets.forum.DEF_STATUS_HIDE;return b},_getMessageDeleteArticle:function(b){return desknets.Resource.Message.com_del_conf},_entryComment:function(b,d){var k=this;desknets.submitform.setDisabled(k.$mjListPage);var i=k.$mjListPage.find(".jco-back-page-data");var h=i.find('input[name="fid"]').val();var f=i.find('input[name="tid"]').val();var c=d.parents(".forum-article-item");var j=d.find(".forum-article-replies-input");var e=d.find(".jforum-comment-entry-anonymity");var g={};g.cmd=k._getCommentEntryCmd();g.fid=h;g.tid=f;g.aid=b;g.memo=j.val();g.contr="";if(k.mbAnonymityUse&&e.attr("checked")){g.anonymouse="1"}desknets.ajax.rest({url:desknets.getUrl(k._getRestModule()),data:g,success:function(n,l,p){var o=function(){if(k._mboHighlightMode){if(k._getListRow()!="0"){k._listPage("0")}else{k._getListAjax(k._getListRow())}}else{if(c.find(".forum-article-replies-showall").hasClass("none")){k._getListCommentAjax(c,true)}else{k._getListCommentAjax(c,false)}}k._openCommentInputArea(d,false)};if(!!n.noticeerror){var m=desknets.dialog.alert(n.noticeerror,{extraClass:"co-msg-r",type:"warn"});m.bind("dialogclose",function(q){desknets.dialog.deleteById("warn");o()});return}o()},complete:function(m,l){desknets.submitform.clearDisabled(k.$mjListPage)}})},_deleteComment:function(d,k,f,i,c,g){var j=this;var e=null;var b={};var h=function(){if(e!=null){desknets.submitform.setDialogDisabled(e)}var l=j._getParamDeleteComment(d,k,f,i,c,g);desknets.ajax.rest({url:desknets.getUrl(j._getRestModule()),data:l,success:function(n,m,o){if(d.find(".forum-article-replies-showall").hasClass("none")){j._getListCommentAjax(d,true)}else{j._getListCommentAjax(d,false)}e.dialog("close")},})};e=desknets.dialog.confirm(j._getMessageDeleteComment(d,k),h,b)},_getParamDeleteComment:function(d,h,f,i,g,e){var c=this;var b={};b.cmd=c._getCommentDelCmd();b.fid=f;b.tid=i;b.aid=g;b.id=e;b.status=desknets.forum.DEF_STATUS_HIDE;return b},_getMessageDeleteComment:function(b,c){return desknets.Resource.Message.com_del_conf},_entryCabinetArticle:function(d,f,e){var c=this;var b="記事のキャビネットアイコンのクリック 会議室ID=["+d+"] トピックID=["+f+"] 記事ID=["+e+"]";window.alert(b)},_cleanArticleId:function(){var b=this;var c={};c=desknets.paramanalyzer.getHashParams();c.aid="";b._setLocationHash(c,true)},_initCabinetregist:function(d,e,b){var c=this;desknets.forum.cabinetregist.init(d,e,b)},_setCabinetregistTargetId:function(c,d){var b=this;desknets.forum.cabinetregist.setTargetId(c,d)},_setCabinetregistTargetName:function(c,d){var b=this;desknets.forum.cabinetregist.setTargetName(c,d)},_getSearchPageParam:function(){if(!this.boGetHtmlSingle){return desknets.paramanalyzer.getHashParams()}else{var c=desknets.paramanalyzer.getHashParam("fid");var b={fid:c};return b}return{}},_getIdListPage:function(){return"jco-m-articlelist-container"},_getIdListPageForm:function(){return"articlelistfrm"},_getRestModule:function(){return desknets.forum.MODULE_API_FORUM},_getListCmd:function(){return desknets.forum.PAGE_FORUMALIST},_getListExecCmd:function(){return desknets.forum.CMD_FORUMARTICLELIST},_getListCommentExecCmd:function(){return desknets.forum.CMD_FORUMCOMMENTLIST},_getRefAttachCmd:function(){return desknets.forum.CMD_FORUMVIEWATTACH},_getRefCommentAttachCmd:function(){return desknets.forum.CMD_FORUMVIEWCOMMENTATTACH},_getCopyAttachCmd:function(){return desknets.forum.CMD_FORUMCOPYATTACH},_getCabRegistHTML:function(){return desknets.forum.HTML_CABREGIST_FORUM},_getArticleEntryCmd:function(){return desknets.forum.CMD_FORUMARTICLEENTRY},_getArticleDelCmd:function(){return desknets.forum.CMD_FORUMARTICLESTATUSSET},_getCommentEntryCmd:function(){return desknets.forum.CMD_FORUMCOMMENTENTRY},_getCommentDelCmd:function(){return desknets.forum.CMD_FORUMCOMMENTSTATUSSET},_getAttachExtCmd:function(){return desknets.forum.CMD_FORUMATTEXTLIST},_getAttach:function(){return desknets.forum.attach},};desknets.page(desknets.forum,"baseforumalist",desknets.forum.PageLabelListforum,desknets.forum.BaseArticleList);desknets.page(desknets.forum,"forumalist",desknets.forum.baseforumalist,{});app.addInitialAction(function(){desknets.forum.init()})})(jQuery);