/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.visitorset={MODULE_MAIN_VISITOR:"zvisitor",MODULE_API_VISITOR:"zrvisitor",PAGE_VISITORINDEX:"visitorindex",PAGE_VISITORPSETGEN:"visitorpsetgen",PAGE_VISITORMSETINDEX:"visitormsetindex",CMD_VISITORMSETINDEX:"visitormsetcmdindex",CMD_VISITORMSETMODSTATUS:"visitormsetcmdmodsts",PAGE_VISITORMSETINFO:"visitormsetinfo",CMD_VISITORMSETINFO:"visitormsetcmdinfo",CMD_VISITORMSETINFOMODSTATUS:"visitormsetcmdinfomodsts",PAGE_VISITORMSETUSERLIST:"visitormsetuserlist",CMD_VISITORMSETUSERLIST:"visitormsetcmduserlist",PAGE_VISITORMSETSEARCH:"visitormsetsearch",CMD_VISITORMSETSEARCH:"visitormsetcmdsearch",PAGE_VISITORMSETPRINT:"visitormsetprint",PAGE_VISITORMSETSEARCHPRINT:"visitormsetprintsearch",PAGE_VISITORMSETLOCATION:"visitormsetlocation",CMD_VISITORMSETLOCATION:"visitormsetcmdlocation",PAGE_VISITORMSETLOCATIONADD:"visitormsetlocationadd",CMD_VISITORMSETLOCATIONADD:"visitormsetcmdlocationadd",CMD_VISITORMSETLOCATIONDEL:"visitormsetcmdlocationdel",CMD_VISITORMSETCMDLOCATIONMOVE:"visitormsetcmdlocationmove",PAGE_VISITORMSETRECEPT:"visitormsetrecept",CMD_VISITORMSETRECEPT:"visitormsetcmdrecept",PAGE_VISITORMSETRECEPTADD:"visitormsetreceptusersel",CMD_VISITORMSETRECEPTADD:"visitormsetcmdreceptusersel",PAGE_VISITORMSETSTATE:"visitormsetstate",CMD_VISITORMSETSTATE:"visitormsetcmdstate",PAGE_VISITORMSETSTATEADD:"visitormsetstateadd",CMD_VISITORMSETSTATEADD:"visitormsetcmdstateadd",CMD_VISITORMSETSTATEDEL:"visitormsetcmdstatedel",CMD_VISITORMSETCMDSTATEMOVE:"visitormsetcmdstatemove",PAGE_VISITORSETADMIN:"visitorsetadmin",PAGE_VISITORSETGEN:"visitorsetgen",PAGE_VISITORSETMANAGER:"visitorsetmanager",init:function(){var b=a("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(b);if(b=="visitormsetzeroindex"){desknets.pageframe.setFuncSel(desknets.visitorset.PAGE_VISITORMSETINDEX)}desknets.hashobserver.init(desknets.visitorset);if(b==desknets.visitorset.PAGE_VISITORPSETGEN){desknets.visitorset.psetgen.init()}else{if(b==desknets.visitorset.PAGE_VISITORMSETINDEX){desknets.visitorset.visitormsetindex.init()}else{if(b==desknets.visitorset.PAGE_VISITORMSETLOCATION){desknets.visitorset.visitormsetlocation.init()}else{if(b==desknets.visitorset.PAGE_VISITORMSETRECEPT){desknets.visitorset.visitormsetrecept.init()}else{if(b==desknets.visitorset.PAGE_VISITORMSETSTATE){desknets.visitorset.visitormsetstate.init()}else{if(b=="visitorsetadmin"){a("#jco-m-sub-title").html(a(".jco-title").val())}else{if(b==desknets.visitorset.PAGE_VISITORSETGEN){desknets.visitorset.setgen.init()}else{if(b==desknets.visitorset.PAGE_VISITORSETMANAGER){desknets.visitorset.visitorsetmanager.init()}}}}}}}}if(b.substr(0,11)=="visitorpset"){desknets.visitor.subwin.init()}else{desknets.visitorset.msetsubwin.init()}}};desknets.page(desknets.visitorset,"msetsubwin",desknets.visitor.subwin,{_getMainCmd:function(){return desknets.visitorset.PAGE_VISITORMSETINDEX},_getSearchCmd:function(){return desknets.visitorset.PAGE_VISITORMSETSEARCH},_getPrintCmd:function(){return desknets.visitorset.PAGE_VISITORMSETPRINT},_getSearchPrintCmd:function(){return desknets.visitorset.PAGE_VISITORMSETSEARCHPRINT},_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR}});desknets.page(desknets.visitorset,"visitormsetindex",desknets.visitor.visitorindex,{_modVisitorStatus:function(b){var c=this;c._listModStatus(desknets.visitorset.CMD_VISITORMSETMODSTATUS,b)},_hashUpdatePageView:function(c){var b=this;var d=desknets.paramanalyzer.getHashParams();if(c==desknets.visitorset.PAGE_VISITORMSETSEARCH){if(a("#jco-m-search-container").find(".jco-title").length>0){desknets.visitorset.visitormsetsearch._getListAjax(d.row)}else{desknets.visitorset.visitormsetsearch.initPage(desknets.visitorset.PAGE_VISITORMSETINDEX,"jco-m-list-container")}b.mhashBackErrCmd=b.mhashBackCmd;b.mhashIdErrBack=b.mhashIdBack;b.mhashBackCmd=c;b.mhashIdBack="jco-m-search-container"}},_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getListCmd:function(){return desknets.visitorset.PAGE_VISITORMSETINDEX},_getListExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETINDEX},_getListModClass:function(){return desknets.visitorset.visitormsetinfo},_getListDispCmd:function(){return desknets.visitorset.PAGE_VISITORMSETUSERLIST},_getListModCmd:function(){return desknets.visitorset.PAGE_VISITORMSETINFO},_getListDispClass:function(){return desknets.visitorset.visitormsetuserlist},_getListSearchCmd:function(){return desknets.visitorset.PAGE_VISITORMSETSEARCH},_getModExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETINFOMODSTATUS}});desknets.page(desknets.visitorset,"visitormsetinfo",desknets.visitor.visitorinfo,{_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getDispExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETINFO},_getModExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETINFOMODSTATUS}});desknets.page(desknets.visitorset,"visitormsetuserlist",desknets.visitor.visitoruserlist,{_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getListCmd:function(){return desknets.visitorset.PAGE_VISITORMSETUSERLIST},_getListExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETUSERLIST}});desknets.page(desknets.visitorset,"visitormsetsearch",desknets.visitor.visitorsearch,{_getListDispCmd:function(){return desknets.visitorset.PAGE_VISITORMSETUSERLIST},_getListModCmd:function(){return desknets.visitorset.PAGE_VISITORMSETINFO},_getListCmd:function(){return desknets.visitorset.PAGE_VISITORMSETSEARCH},_getListExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETSEARCH}});desknets.page(desknets.visitorset,"psetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.visitorset.PAGE_VISITORINDEX}});desknets.page(desknets.visitorset,"visitormsetlocation",desknets.PageInputList,{_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getListCmd:function(){return desknets.visitorset.PAGE_VISITORMSETLOCATION},_getListExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETLOCATION},_getMoveExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETCMDLOCATIONMOVE},_getListAddCmd:function(){return desknets.visitorset.PAGE_VISITORMSETLOCATIONADD},_getListEntryClass:function(){return desknets.visitorset.visitormsetlocationadd},_getListModCmd:function(){return desknets.visitorset.PAGE_VISITORMSETLOCATIONADD},_getListModClass:function(){return desknets.visitorset.visitormsetlocationadd},_getDelExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETLOCATIONDEL}});desknets.page(desknets.visitorset,"visitormsetlocationadd",desknets.PageInputBase,{_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getAddExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETLOCATIONADD},_getModExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETLOCATIONADD},_getDelExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETLOCATIONDEL}});desknets.page(desknets.visitorset,"visitormsetrecept",desknets.PageInputList,{_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getListCmd:function(){return desknets.visitorset.PAGE_VISITORMSETRECEPT},_getListExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETRECEPT},_getListModCmd:function(){return desknets.visitorset.PAGE_VISITORMSETRECEPTADD},_getListModClass:function(){return desknets.visitorset.visitormsetreceptusersel}});desknets.page(desknets.visitorset,"visitormsetreceptusersel",desknets.PageInputBase,{_$root:null,_$receptRoot:null,_$recept:null,_initSet:function(c){var b=this;b.callBase("_initSet",c);b._initGroupSelectDialog();if(a(".jvis-sel-items-receptlist").find(".co-table-set").find("tr").length<=0){a(".jvis-sel-items-receptlist").hide()}},_initGroupSelectDialog:function(){var c=this;var d;c._$root=a("#jvis-m-receptlist-page");c._$receptRoot=c._$root.find(".jvis-sel-items-receptlist").parent();c._$recept=c._$receptRoot.find(".jco-sel-items");c._$root.find("form").formSetUp({date:false});d='<tr><td class="co-td icon"><input type="hidden" name="uid" value="{{id}}" /><a class="co-btn co-btn-close" href="#" title="'+desknets.Resource.deselectLabel+'">'+desknets.Resource.deselectLabel+'</a></td><td class="co-td"><a href="#" class="jvis-recept-uname-text jco-sel-item jco-ref-dialog-link" data-id="{{id}}" data-type="mset" data-name="{{name}}" data-refid="user{{id}}" title="{{name}}">{{name}}</a><td class="co-td co-busyo" title="{{summaryAsText}}">{{summary}}</td></tr>';var b=desknets.chooser.getItemsFromElement(c._$receptRoot,{itemFilter:function(g,e){var f=e.closest("tr").find(".jvis-recept-gname-text").text();var h=desknets.stripTags(e.closest("tr").find(".jvis-recept-gname-text").text());h=desknets.escapeValue(h);g.summary=f;g.summaryAsText=h;return g}});desknets.chooser.setUpEntry(c._$receptRoot,b,{dialogID:"jvis-select-user-to-dialog",dialogOptions:c._getChooserOptions(),initCreate:true,template:d,change:c._onChangeSelectUser})},_getChooserOptions:function(){return{allGroup:"choosable",unassignGroup:"choosable",cmdusers:desknets.CMD_CHOOSERMSETUSERSEL}},_onChangeSelectUser:function(){var b=this;var c=a(".jvis-sel-items-receptlist").find("table").find("tr");if(c.length>0){a(".jvis-sel-items-receptlist").show()}else{a(".jvis-sel-items-receptlist").hide()}},_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getAddExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETRECEPTADD}});desknets.page(desknets.visitorset,"visitormsetstate",desknets.PageInputList,{_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getListCmd:function(){return desknets.visitorset.PAGE_VISITORMSETSTATE},_getListExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETSTATE},_getMoveExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETCMDSTATEMOVE},_getListAddCmd:function(){return desknets.visitorset.PAGE_VISITORMSETSTATEADD},_getListEntryClass:function(){return desknets.visitorset.visitormsetstateadd},_getListModCmd:function(){return desknets.visitorset.PAGE_VISITORMSETSTATEADD},_getListModClass:function(){return desknets.visitorset.visitormsetstateadd},_getDelExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETSTATEDEL}});desknets.page(desknets.visitorset,"visitormsetstateadd",desknets.PageInputBase,{_getRestModule:function(){return desknets.visitorset.MODULE_API_VISITOR},_getAddExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETSTATEADD},_getModExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETSTATEADD},_getDelExecCmd:function(){return desknets.visitorset.CMD_VISITORMSETSTATEDEL}});desknets.page(desknets.visitorset,"setgen",desknets.PageSet,{_getNextCmd:function(){return desknets.visitorset.PAGE_VISITORSETADMIN}});desknets.page(desknets.visitorset,"visitorsetmanager",desknets.PageAdmin,{_getNextCmd:function(){return desknets.visitorset.PAGE_VISITORSETADMIN}});app.addInitialAction(function(){desknets.visitorset.init()})})(jQuery);