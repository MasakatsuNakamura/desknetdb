/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.forumset={MODULE_FORUM:"zforum",MODULE_API_FORUM:"zrforum",PAGE_FORUMINDEX:"forumlist",PAGE_FORUMPSETGEN:"forumpsetgen",PAGE_FORUMPSETREAD:"forumpsetread",PAGE_FORUMPSETLABEL:"forumpsetlabel",PAGE_FORUMPSETLABELENTRY:"forumpsetlabelentry",PAGE_FORUMMSETFORUMLIST:"forummsetlist",PAGE_FORUMMSETFORUMENTRY:"forummsetforumentry",PAGE_FORUMMSETALIST:"forummsetalist",PAGE_FORUMMSETACCSLOG:"forummsetaccslog",PAGE_FORUMMSETACCSLOGDEL:"forummsetaccslogdel",PAGE_FORUMMSETACCESS:"forummsetaccess",PAGE_FORUMMSETSEARCH:"forummsetsearch",PAGE_FORUMSETADMIN:"forumsetadmin",PAGE_FORUMSETGEN:"forumsetgen",PAGE_FORUMSETMANAGER:"forumsetmanager",CMD_FORUMARTICLESTATUSSETCONF:"forumcmdarticlestatussetconf",CMD_FORUMARTICLESTATUSSET:"forumcmdarticlestatusset",CMD_FORUMCOMMENTSTATUSSETCONF:"forumcmdcommentstatussetconf",CMD_FORUMCOMMENTSTATUSSET:"forumcmdcommentstatusset",CMD_FORUMPSETGEN:"forumpsetcmdgen",CMD_FORUMPSETREAD:"forumpsetcmdread",CMD_FORUMPSETLABEL:"forumpsetcmdlabel",CMD_FORUMPSETLABELENTRY:"forumpsetcmdlabelentry",CMD_FORUMPSETDELLABEL:"forumpsetcmddellabel",CMD_FORUMPSETMVLABEL:"forumpsetcmdmvlabel",CMD_FORUMMSETFORUMLIST:"forummsetcmdforumlist",CMD_FORUMMSETFORUMENTRY:"forummsetcmdforumentry",CMD_FORUMMSETDELFORUM:"forummsetcmddelforum",CMD_FORUMMSETFORUMSTATUSSET:"forummsetcmdforumstatusset",CMD_FORUMMSETSEARCH:"forummsetcmdsearch",CMD_FORUMMSETSEARCHSTOP:"forummsetcmdsearchstop",CMD_FORUMMSETBATSEARCH:"forummsetbatsrch",CMD_FORUMMSETCOPYATTACH:"forummsetcmdcopyattach",CMD_FORUMMSETTOPICLIST:"forummsetcmdtopiclist",CMD_FORUMMSETTOPICENTRY:"forummsetcmdtopicentry",CMD_FORUMMSETTOPICDELCONF:"forummsetcmdtopicdelconf",CMD_FORUMMSETTOPICDEL:"forummsetcmdtopicdel",CMD_FORUMMSETTOPICSTATUSSETCONF:"forummsetcmdtopicstatussetconf",CMD_FORUMMSETTOPICSTATUSSET:"forummsetcmdtopicstatusset",CMD_FORUMMSETARTICLELIST:"forummsetcmdarticlelist",CMD_FORUMMSETARTICLEENTRY:"forummsetcmdarticleentry",CMD_FORUMMSETARTICLEDELCONF:"forummsetcmdarticledelconf",CMD_FORUMMSETARTICLEDEL:"forummsetcmdarticledel",CMD_FORUMMSETARTICLESTATUSSETCONF:"forummsetcmdarticlestatussetconf",CMD_FORUMMSETARTICLESTATUSSET:"forummsetcmdarticlestatusset",CMD_FORUMMSETCOMMENTLIST:"forummsetcmdcommentlist",CMD_FORUMMSETCOMMENTENTRY:"forummsetcmdcommententry",CMD_FORUMMSETCOMMENTDELCONF:"forummsetcmdcommentdelconf",CMD_FORUMMSETCOMMENTDEL:"forummsetcmdcommentdel",CMD_FORUMMSETCOMMENTSTATUSSETCONF:"forummsetcmdcommentstatussetconf",CMD_FORUMMSETCOMMENTSTATUSSET:"forummsetcmdcommentstatusset",CMD_FORUMMSETACCSLOG:"forummsetcmdaccslog",CMD_FORUMMSETACCSLOGDEL:"forummsetcmdaccslogdel",CMD_FORUMMSETREFATTACH:"forummsetdispattach",CMD_FORUMMSETVIEWATTACH:"forummsetviewattach",CMD_FORUMMSETVIEWCOMMENTATTACH:"forummsetviewcommentattach",CMD_FORUMSETGEN:"forumsetcmdgen",CMD_FORUMSETMANAGER:"forumsetcmdmanager",mLeftListPosition:0,init:function(){var b=a("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(b);if(b==desknets.forumset.PAGE_FORUMPSETGEN){desknets.forumset.forumpsetgen.init();desknets.forum.subwin.init()}else{if(b==desknets.forumset.PAGE_FORUMPSETREAD){desknets.forumset.forumpsetarticleread.init();desknets.forum.subwin.init()}else{if(b==desknets.forumset.PAGE_FORUMPSETLABEL){desknets.hashobserver.init(desknets.forumset);desknets.forumset.forumpsetlabel.init();desknets.forum.subwin.init()}else{if(b==desknets.forumset.PAGE_FORUMMSETFORUMLIST){desknets.hashobserver.init(desknets.forumset);desknets.forumset.forummsetlist.init();desknets.forumset.subwin.init()}else{if(b==desknets.forumset.PAGE_FORUMMSETACCSLOG){desknets.hashobserver.init(desknets.forumset);desknets.forumset.forummsetaccslog.init();desknets.forumset.subwin.init()}else{if(b==desknets.forumset.PAGE_FORUMMSETACCSLOGDEL){desknets.forumset.forummsetaccslogdel.init();desknets.forumset.subwin.init()}else{if(b==desknets.forumset.PAGE_FORUMSETADMIN){}else{if(b==desknets.forumset.PAGE_FORUMSETGEN){desknets.forumset.forumsetgen.init()}else{if(b==desknets.forumset.PAGE_FORUMSETMANAGER){desknets.forumset.forumsetmanager.init()}}}}}}}}}},changeLocationToTopicList:function(b,c,e){var d={};var f="";var g="";d.cmd=desknets.forumset.PAGE_FORUMMSETFORUMLIST;d.fid=c;d._=desknets.createRandomId();if(neo.isSet(e)&&e!=desknets.forum.DEF_INIT_NONE){d.init=e}b._inputPage(d)},changeLocationToArticleList:function(c,e,d,b,g){var f={};var h="";var i="";f.cmd=desknets.forumset.PAGE_FORUMMSETALIST;f.fid=e;f.tid=d;if(neo.isSet(b)){f.aid=b}f._=desknets.createRandomId();if(neo.isSet(g)&&g!=desknets.forum.DEF_INIT_NONE){f.init=g}c._inputPage(f)},changeLocationToInitTop:function(b,e,d,g){var f=[];var h=desknets.getUrl(desknets.forum.MODULE_FORUM);f.cmd=desknets.forum.PAGE_FORUMINDEX;var c=desknets.getNeoParam(f);h=h+"?"+c;desknets.execLocation(h)},setLeftListPosition:function(c){var b=this;b.mLeftListPosition=c},getLeftListPosition:function(){var b=this;return b.mLeftListPosition},};desknets.page(desknets.forumset,"subwin",desknets.forum.subwin,{_getMainCmd:function(){return desknets.forumset.PAGE_FORUMMSETFORUMLIST},_getSearchCmd:function(){return desknets.forumset.PAGE_FORUMMSETSEARCH},});desknets.forumset.input={};desknets.page(desknets.forumset.input,"user",null,{$entry:null,page:null,_$entryUser:null,_isLoaded:false,_chooser:null,init:function(b){this.page=b;this.$entry=b.$mjPage;this._$entryUser=this.$entry.find(this._getEntryAreaName());this._setUpEntry()},open:function(){this._$entryUser.find(".jco-sel-btn").click()},_setUpEntry:function(){var b=this;var d=b._$entryUser.children("td");var c=a("#"+b._getDialogName());b.updateElement();b._chooser=desknets.chooser.setUpEntry(d,b._getTargets(),{dialogID:b._getDialogName(),dialogOptions:b._getChooserOptions(),extraVars:{user:{keyName:b._getEntryKeyName()}},change:function(){b.updateElement()}});this._isLoaded=true},_getTargets:function(){var c=this;var b=[];b=desknets.chooser.getItemsFromElement(c._$entryUser.find(".co-selmulti-items-scroll"));return b},updateElement:function(){var b=this._$entryUser.find(this._getEntryItemsName());if(this._isLoaded||b.length>0){this._$entryUser.show()}if(b.length<=0){this._$entryUser.hide()}},_getChooserOptions:function(){return{allGroup:"choosable",chooseTarget:["user"],unassignGroup:"choosable",cmdusers:desknets.CMD_CHOOSERMSETUSERSEL,}},_getDialogName:function(){return"jforum-entry-other-to-dialog"},_getEntryAreaName:function(){return".jforum-row-other-to"},_getEntryItemsName:function(){return".jforum-otherto-choose-items > .co-selitem"},_getEntryKeyName:function(){return"otherto"},_getEntryDescriptionName:function(){return".jforum-otherto-groups"},});desknets.page(desknets.forumset,"attach",desknets.forum.attach,{_getDownLoadCmd:function(){return desknets.forumset.CMD_FORUMMSETREFATTACH},});desknets.page(desknets.forumset,"DialogAccessForum",desknets.DialogAccess,{init:function(d,c){var b=this;b._boAddOnly=true;b.callBase("init",d,c)},_setTitle:function(c,b){},});desknets.page(desknets.forumset,"PageForumEntry",desknets.PageInputBase,{_initSet:function(){var b=this;b.callBase("_initSet");b._setUpDialog()},_setUpDialog:function(){var b=this;desknets.forumset.input.user.init(b);b._createDialogAccess();b.$mjPage.find(".co-ebtnarea").delegate(".jforum-pop-button","click",function(c){c.preventDefault();if(a(this).hasClass("usel")){desknets.forumset.input.user.open()}else{if(a(this).hasClass("acc")){desknets.forumset.DialogAccessForum.openDialog()}}})},_createDialogAccess:function(){var b=this;var e=desknets.paramanalyzer.getHashParam("id");var c={cmd:b._getAccessPageCmd(),id:e,};var d={idFldName:"aid",area:a("#jforum-entry-access"),module:b._getRestModule(),param:c,dialoghtml:a("#jforum-entry-access-items"),msetcmd:true,afteraccchg:function(){b._setviewAccessSetting(b)},bosubmitcommit:false,};desknets.forumset.DialogAccessForum.setUp(d);b._setviewAccessSetting(b)},_setviewAccessSetting:function(c){var b=c.$mjPage.find(".jforum-row-access");var d=b.find(".co-selmulti-items > .co-selitem");if(d.length>0){b.show()}else{b.hide()}},_getRestModule:function(){return desknets.forumset.MODULE_API_FORUM},_getDelExecCmd:function(){return desknets.forumset.CMD_FORUMMSETDELFORUM},_getAddExecCmd:function(){return desknets.forumset.CMD_FORUMMSETFORUMENTRY},_getModExecCmd:function(){var b=this;return b._getAddExecCmd()},_getAccessPageCmd:function(){var b=this;return desknets.forumset.PAGE_FORUMMSETACCESS},});desknets.page(desknets.forumset,"PageForumList",desknets.PageMultiList,{DEF_STATUS_RUN:"1",DEF_STATUS_STOP:"2",DEF_STATUS_READY:"3",$mjListPageLeft:null,_mcForumListTemplate:null,_selName:"",_tmplLabelTitle:'<span class="overflow">{{labelname}}</span>',_initListStart:function(){var b=this;b.$mjListPageLeft=b.$mjListPage.find(".co-listview-left");desknets.forum.dialogForumInfo.createDialog(b.$mjListPage,"mset");b._setLabelScrollEvent();b.callBase("_initListStart")},_initListStartTemplate:function(){var b=this;b.callBase("_initListStartTemplate");if(desknets.browser.tablet){b.$mjListPageLeft.find(".jforum-forum-setmenu").remove()}var c=b.$mjListPageLeft.find(".forum-mset-forumlist");b._mcForumListTemplate=c.html();c.empty()},_initListEnd:function(){var b=this;b._initForumEnd();b.callBase("_initListEnd");a(window).resize(function(){if(desknets.browser.tablet&&a(".co-pop-up-box.show").length>0){return}b.updateListHeight()})},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".forum-link-viewroom").click(function(d){d.preventDefault();var c=b._getTargetForumId();desknets.forum.dialogForumInfo.showDialog(c)})},changPage:function(){var b=this;b.callBase("changPage");b.updateListHeight()},updateListHeight:function(){var b=this;desknets.listviewframe.updateListHeight(b.$mjListPage.find(".co-listview"),true,true)},_initAddDataStart:function(){var b=this;b._setForumListClick();b._setForumPulldownIconClock()},_setForumListClick:function(){var b=this;var c=b.$mjListPageLeft.find(".co-listview-items");c.delegate(".jforum-forum-item","click",function(d){d.preventDefault();var e=a(this).data("fid");desknets.forumset.changeLocationToTopicList(b,e,desknets.forum.DEF_INIT_TOP)})},_initForumEnd:function(){var b=this;desknets.listviewframe.setLeftTitleMenu(b.$mjListPageLeft.find(".co-listview-left-title"));b.$mjListPage.find(".jforum-forum-add").click(function(c){c.preventDefault();b._clickForumAdd()});b.$mjListPageLeft.find(".jforum-forum-mod").click(function(c){c.preventDefault();var d=b._getTargetForumId();b._clickForumMod(d)});b.$mjListPageLeft.find(".jforum-forum-running").click(function(c){c.preventDefault();var d=b._getTargetForumId();b._clickForumSts(d,b.DEF_STATUS_RUN)});b.$mjListPageLeft.find(".jforum-forum-stop").click(function(c){c.preventDefault();var d=b._getTargetForumId();b._clickForumSts(d,b.DEF_STATUS_STOP)});b.$mjListPageLeft.find(".jforum-forum-del").click(function(c){c.preventDefault();var d=b._getTargetForumId();b._clickForumDel(d)})},onSetSelectFolder:function(e,d){var c=this;var b=true;var f=true;if(e){if(d==c.DEF_STATUS_STOP||d==c.DEF_STATUS_READY){b=false}else{f=false}c._setForumEditButton(false,b,f)}else{c._setForumEditButton(true,b,f)}},_setForumEditButton:function(d,b,f){var c=this;var e=c.$mjListPageLeft.find(".co-listview-left-subtitle");e.find(".jforum-forum-mod").attr("disabled",d);e.find(".jforum-forum-running").attr("disabled",b);e.find(".jforum-forum-stop").attr("disabled",f);e.find(".jforum-forum-del").attr("disabled",d)},_setForumInfoLink:function(c){var b=this;if(!c){b.$mjListPage.find(".forum-link-viewroom").show()}else{b.$mjListPage.find(".forum-link-viewroom").hide()}},_setForumInfoLink:function(){var b=this;var c=b.$mjListPageLeft.find(".forum-listview-forum.on");if(neo.isSet(c)&&c.length>0){b.$mjListPage.find(".forum-link-viewroom").show()}else{b.$mjListPage.find(".forum-link-viewroom").hide()}},_getAddDataAjaxSuccess:function(c){var b=this;b._getForumAjaxSuccess(c);this._setTitleLabel()},_getForumAjaxSuccess:function(h){var k=this;var g=desknets.ajax.getJsonItems(h);var j=[];var b=[];var e=k._mcForumListTemplate;var c=k.$mjListPageLeft.find(".co-listview-items");var d=0;var i=0;var f=k._getTargetForumId();d=g.length;for(i=0;i<d;i++){j=g[i];if(j.fstatus==k.DEF_STATUS_STOP||j.fstatus==k.DEF_STATUS_READY){j.fsts="off"}else{j.fsts=""}if(j.id==f){j.fsel="on"}else{j.fsel=""}b[b.length]=k._listLine(e,j)}c.empty();c.append(b.join(""));k._setForumInfoLink();k._setForumPulldownIcon();k._setLabelScroll()},_setForumPulldownIcon:function(){var b=this;if(desknets.browser.tablet){return}var c=b.$mjListPageLeft.find(".co-listview-items");c.find(".forum-listview-forum").hover(function(){a(this).find(".co-listview-item-setlink").show()},function(){a(this).find(".co-listview-item-setlink").hide();a(this).find(".co-listview-item-setmenu").hide()})},_setForumPulldownIconClock:function(){var b=this;if(desknets.browser.tablet){return}var c=b.$mjListPageLeft.find(".co-listview-items");c.delegate(".co-listview-item-setlink","click",function(i){var d=a(this);var g=b.$mjListPageLeft.find(".co-listview-left-data");var f=g.offset();var j=d.offset();var k=a("<div />").css({height:"100%"});var h=d.parent();i.preventDefault();var e=h.find(".co-listview-item-setmenu");k.appendTo(g);if(desknets.browser.chrome){k.height(k.height()-b.VAL_TREE_ADDSCROLL)}if((j.top+e.height()+h.height()-f.top)>k.height()-1){e.css("top",(e.outerHeight()*-1)-d.height()+5)}else{e.css("top",0)}k.remove();e.toggle()});c.delegate(".jforum-forum-set-mod","click",function(d){d.preventDefault();var e=a(this).parents().find(".jforum-forum-item").data("fid");b._clickForumMod(e)});c.delegate(".jforum-forum-set-running","click",function(d){d.preventDefault();var e=a(this).parents().find(".jforum-forum-item").data("fid");b._clickForumSts(e,b.DEF_STATUS_RUN)});c.delegate(".jforum-forum-set-stop","click",function(d){d.preventDefault();var e=a(this).parents().find(".jforum-forum-item").data("fid");b._clickForumSts(e,b.DEF_STATUS_STOP)});c.delegate(".jforum-forum-set-del","click",function(d){d.preventDefault();var e=a(this).parents().find(".jforum-forum-item").data("fid");b._clickForumDel(e)})},_getSelectForumName:function(e){var c=this;var b;var d=c.$mjListPageLeft.find(".co-listview-items");d.find(".forum-listview-forum").each(function(){var f=a(this).find(".jforum-forum-item").data("fid");if(f==e){b=a(this).find(".forum").text()}});return b},_clickForumAdd:function(){var b=this;var c={};c.cmd=desknets.forumset.PAGE_FORUMMSETFORUMENTRY;b._inputPage(c)},_clickForumMod:function(c){var b=this;var d={};d.cmd=desknets.forumset.PAGE_FORUMMSETFORUMENTRY;d.id=c;b._inputPage(d)},_clickForumSts:function(e,d){var c=this;var b="";var h="";var g=null;var f=null;h=c._getSelectForumName(e);if(d==c.DEF_STATUS_RUN){b=desknets.tmpl.replaceWord(desknets.Resource.forum.confirmation_runningforum,"ForumName",h)}else{if(d==c.DEF_STATUS_STOP){b=desknets.tmpl.replaceWord(desknets.Resource.forum.confirmation_stopforum,"ForumName",h)}}g=function(){if(f!=null){desknets.submitform.setDialogDisabled(f)}if(!c._boDelSingle()){var k={};var j={};k=c._forumStsModMultiParams(e,d);c._mchkIDs=c._getListAjaxGetId();j=c._getForumAjaxOptionsExec(f);c._sendRequestAjax(desknets.ajax.REQTYPE_MULTI,desknets.ajax.RESTYPE_JSON,k,j);return false}else{var i={};var k={};var j={};i=c._forumStsModMultiParams(e,d);k=i["0"];c._mchkIDs=c._getListAjaxGetId();j=c._getForumAjaxOptions(f);c._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_JSON,k,j);return false}};f=desknets.dialog.confirm(b,g)},_clickForumDel:function(d){var c=this;var b="";var g="";var e=null;var f=null;g=c._getSelectForumName(d);b=desknets.tmpl.replaceWord(desknets.Resource.forum.confirmation_delforum,"ForumName",g);e=function(){if(f!=null){desknets.submitform.setDialogDisabled(f)}if(!c._boDelSingle()){var j={};var i={};j=c._forumDelMultiParams(d);c._mchkIDs=c._getListAjaxGetId();i=c._getForumAjaxOptionsExec(f);c._sendRequestAjax(desknets.ajax.REQTYPE_MULTI,desknets.ajax.RESTYPE_JSON,j,i);return false}else{var h={};var j={};var i={};h=c._forumDelMultiParams(d);j=h["0"];c._mchkIDs=c._getListAjaxGetId();i=c._getForumAjaxOptions(f);c._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_JSON,j,i);return false}};f=desknets.dialog.confirm(b,e)},_forumDelMultiParams:function(e){var c=this;var f={};var d={};var g={};var b={};b.cmd=c._getForumDelCmd();b.id=e;d=c.getListParamToObj();g.cmd=c._getForumGetCmd();f["0"]=b;f["1"]=d;f["2"]=g;return f},_forumStsModMultiParams:function(f,d){var b=this;var g={};var c={};var h={};var e={};e.cmd=b._getForumStsModCmd();e.id=f;e.fstatus=d;c=b.getListParamToObj();h.cmd=b._getForumGetCmd();g["0"]=e;g["1"]=c;g["2"]=h;return g},_getForumAjaxOptionsExec:function(d){var b=this;var c={};c={success:function(g,e,h){b.setNotChangeHash(false);var f=desknets.getInputDataToUrl(b.$mjListPage.find(".jco-back-page-data"));f=f+"&cmd="+b._getListCmd();b._setLocationHash(f,true);b._getListAjaxSuccessExec(g)},complete:function(g,e,f){if(d!=null){desknets.submitform.clearDialogDisabled(d);d.dialog("close")}}};return c},_getForumAjaxOptions:function(d){var b=this;var c={};c={success:function(f,e,g){b.setNotChangeHash(false);b._listPage(b._getListRow())},complete:function(g,e,f){if(d!=null){desknets.submitform.clearDialogDisabled(d);d.dialog("close")}}};return c},_hashUpdatePageView:function(c){var b=this;var d=desknets.paramanalyzer.getHashParams();if(c==desknets.forumset.PAGE_FORUMMSETFORUMENTRY){desknets.forumset.PageForumEntry.initPage(b.mhashBackCmd,b.mhashIdBack)}else{b.callBase("_hashUpdatePageView",c)}},_setTargetForumId:function(d){var b=this;var c=b.$mjListPage.find(".jco-back-page-data");c.find('input[name="fid"]').val(d)},_getTargetForumId:function(){var b=this;var c=b.$mjListPage.find(".jco-back-page-data");return c.find('input[name="fid"]').val()},_getAreaTitle:function(b){var d=this;var c=d._tmplLabelTitle;c=desknets.tmpl.replaceWordChk(c,"labelname",d._selName);if(neo.isSet(d._selName,{blank:false})){c=" > "+c}return d.callBase("_getAreaTitle",b)+c},_setTitleLabel:function(){var b=this;b._setTitle(b._getAreaTitle(b.$mjListPage))},_setLabelScrollEvent:function(){var b=this;var c=b.$mjListPageLeft.find(".co-listview-left-data");c.scroll(function(){desknets.forumset.setLeftListPosition(jQuery(this).scrollTop())})},_setLabelScroll:function(){var c=this;var d=c.$mjListPageLeft.find(".co-listview-left-data");var b=desknets.forumset.getLeftListPosition();if(b==0&&desknets.browser.firefox){b=1}d.scrollTop(b)},_getRestModule:function(){return desknets.forumset.MODULE_API_FORUM},_getListCmd:function(){return desknets.forumset.PAGE_FORUMMSETFORUMLIST},_getAddDataGetCmd:function(){return this._getForumGetCmd()},_getLabelGetCmd:function(){return this._getForumGetCmd()},_getForumGetCmd:function(){return desknets.forumset.CMD_FORUMMSETFORUMLIST},_getForumDelCmd:function(){return desknets.forumset.CMD_FORUMMSETDELFORUM},_getForumStsModCmd:function(){return desknets.forumset.CMD_FORUMMSETFORUMSTATUSSET},});desknets.page(desknets.forumset,"cabinetregist",desknets.forum.cabinetregist,{_getCommentCmd:function(){return desknets.forumset.CMD_FORUMMSETCOMMENTLIST},});desknets.page(desknets.forumset,"forumpsetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.forumset.PAGE_FORUMINDEX}});desknets.page(desknets.forumset,"forumpsetarticleread",desknets.PageSet,{_onAjaxFormSuccess:function(d){var b=this;var e={};var g=b._getModule();var f=b._getNextCmd();var h=desknets.getUrl(g);e.cmd=f;var c=desknets.getNeoParam(e);h=h+"?"+c+"#ntwi=1";desknets.execLocation(h)},_getNextCmd:function(){return desknets.forumset.PAGE_FORUMINDEX}});desknets.page(desknets.forumset,"forumpsetlabel",desknets.PageInputList,{_replaceListLine:function(c,e,d){var b=this;if(e=="labelassigncnt"){c=b._replaceLabelAssignCntLine(c,e,d)}else{c=b.callBase("_replaceListLine",c,e,d)}return c},_replaceLabelAssignCntLine:function(c,f,d){var b="";if(d[f]!==""){b=desknets.numberFormat(parseInt(d[f],10))}var e=new RegExp("{{"+f+"}}","ig");c=c.replace(e,b);return c},_getRestModule:function(){return desknets.forumset.MODULE_API_FORUM},_getListCmd:function(){return desknets.forumset.PAGE_FORUMPSETLABEL},_getListExecCmd:function(){return desknets.forumset.CMD_FORUMPSETLABEL},_getListAddCmd:function(){return desknets.forumset.PAGE_FORUMPSETLABELENTRY},_getListModCmd:function(){return desknets.forumset.PAGE_FORUMPSETLABELENTRY},_getDelExecCmd:function(){return desknets.forumset.CMD_FORUMPSETDELLABEL},_getMoveExecCmd:function(){return desknets.forumset.CMD_FORUMPSETMVLABEL},_getListEntryClass:function(){return desknets.forumset.forumpsetlabelentry},_getListModClass:function(){return desknets.forumset.forumpsetlabelentry}});desknets.page(desknets.forumset,"forumpsetlabelentry",desknets.PageInputBase,{_getRestModule:function(){return desknets.forumset.MODULE_API_FORUM},_getDelExecCmd:function(){return desknets.forumset.CMD_FORUMPSETDELLABEL},_getAddExecCmd:function(){return desknets.forumset.CMD_FORUMPSETLABELENTRY},_getModExecCmd:function(){var b=this;return b._getAddExecCmd()}});desknets.page(desknets.forumset,"baseforummsetlist",desknets.forumset.PageForumList,desknets.forum.BaseTopicList);desknets.page(desknets.forumset,"forummsetlist",desknets.forumset.baseforummsetlist,{_topicRefCmd:desknets.forumset.PAGE_FORUMMSETALIST,init:function(){var b=this;b.mBackCmd="";b.mIdBack="jco-m-list-container";desknets.forumset.setLeftListPosition(0);b.callBase("init")},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".co-pageback").click(function(c){c.preventDefault();b.dispBackListPage()})},inputDispPage:function(e){var d=this;var c=d._getTargetForumId();var b=e;desknets.forumset.changeLocationToArticleList(d,c,b,null,desknets.forum.DEF_INIT_TOPIC)},dispBackListPage:function(){var b=this;if(neo.isSet(b.mBackCmd)&&b.mBackCmd.length>0){b.callBase("dispBackListPage")}else{desknets.forumset.changeLocationToInitTop()}},_hashUpdateListPage:function(c){var b=this;var d=c.cmd;if(d==desknets.forumset.PAGE_FORUMMSETFORUMLIST){if(neo.isSet(c.init)){if(c.init==desknets.forum.DEF_INIT_NOW){b.mBackCmd=desknets.forumset.PAGE_FORUMMSETSEARCH;b.mIdBack="jco-m-search-container";desknets.forumset.setLeftListPosition(0)}else{if(c.init==desknets.forum.DEF_INIT_TOP){b.mBackCmd="";b.mIdBack="jco-m-list-container"}}}}b.callBase("_hashUpdateListPage",c)},_hashUpdatePageView:function(d){var c=this;var g=desknets.paramanalyzer.getHashParams();if(d==desknets.forumset.PAGE_FORUMMSETALIST){var f=a("#jco-m-articlelist-container").find(".jco-back-page-data");if(f.length>0&&!neo.isSet(g.init)){desknets.forumset.forummsetalist._getListAjax(g.row)}else{if(neo.isSet(g.init)&&g.init==desknets.forum.DEF_INIT_TOP){c.mhashBackCmd=desknets.forumset.PAGE_FORUMMSETFORUMLIST;c.mhashIdBack="jco-m-list-container";desknets.forumset.forummsetalist.initPage(c.mhashBackCmd,c.mhashIdBack)}else{if(neo.isSet(g.init)&&g.init==desknets.forum.DEF_INIT_TOPIC){var e=desknets.forumset.PAGE_FORUMMSETFORUMLIST;var b="jco-m-list-container";desknets.forumset.forummsetalist.initPage(e,b)}else{desknets.forumset.forummsetalist.initPage(c.mhashBackCmd,c.mhashIdBack)}}}}else{if(d==desknets.forumset.PAGE_FORUMMSETSEARCH){desknets.forumset.setLeftListPosition(0);desknets.forumset.forummsetsearch.initPage(desknets.forumset.PAGE_FORUMMSETFORUMLIST,"jco-m-list-container");c.mhashBackErrCmd=c.mhashBackCmd;c.mhashIdErrBack=c.mhashIdBack;c.mhashBackCmd=desknets.forumset.PAGE_FORUMMSETSEARCH;c.mhashIdBack="jco-m-search-container"}else{c.callBase("_hashUpdatePageView",d)}}},_getListAjaxSuccessOtherSet:function(c){var b=this;if(neo.isSet(c.id)&&c.id>0){b.onSetSelectFolder(true,c.fstatus)}else{b.onSetSelectFolder(false)}b.callBase("_getListAjaxSuccessOtherSet",c)},_getIdListPageForm:function(){return"topiclistfrm"},_getRestModule:function(){return desknets.forumset.MODULE_API_FORUM},_getListCmd:function(){return desknets.forumset.PAGE_FORUMMSETFORUMLIST},_getListExecCmd:function(){return desknets.forumset.CMD_FORUMMSETTOPICLIST},_getDelCmd:function(){var b=this;if(b._sDelFlg!="0"){return desknets.forumset.CMD_FORUMMSETTOPICSTATUSSETCONF}return desknets.forumset.CMD_FORUMMSETTOPICDELCONF},_getDelExecCmd:function(){var b=this;if(b._sDelFlg!="0"){return desknets.forumset.CMD_FORUMMSETTOPICSTATUSSET}return desknets.forumset.CMD_FORUMMSETTOPICDEL},_getTopicEntryCmd:function(){return desknets.forumset.CMD_FORUMMSETTOPICENTRY},});desknets.page(desknets.forumset,"baseforummsetalist",desknets.forumset.PageForumList,desknets.forum.BaseArticleList);desknets.page(desknets.forumset,"forummsetalist",desknets.forumset.baseforummsetalist,{_initOtherEvent:function(){var b=this;b.callBase("_initOtherEvent");var c=b.$mjListPage.find(".forum-article-list");c.delegate(".forum-article-disp","click",function(i){i.preventDefault();var f=a(this).parents(".forum-article-item");var d=b.$mjListPage.find(".jco-back-page-data");var h=d.find('input[name="fid"]').val();var j=d.find('input[name="tid"]').val();var g=a(this).parents(".forum-article-item").find(".jforum-article-id").val();b._dispArticle(f,h,j,g)});c.delegate(".forum-comment-disp","click",function(k){k.preventDefault();var f=a(this).parents(".forum-article-item");var i=a(this).parents(".forum-article-reply");var d=b.$mjListPage.find(".jco-back-page-data");var j=d.find('input[name="fid"]').val();var l=d.find('input[name="tid"]').val();var h=a(this).parents(".forum-article-item").find(".jforum-article-id").val();var g=a(this).parents(".forum-article-reply").find(".jforum-comment-id").val();b._dispComment(f,i,j,l,h,g)})},_setDeleteIcon:function(d,c){var b=this;var e=null;b.callBase("_setDeleteIcon",d,c);if(d.hasClass("forum-article-delete")){e=d.siblings(".forum-article-disp")}else{e=d.siblings(".forum-comment-disp")}b._setDispIcon(e,c)},_getParamDeleteArticle:function(d,e,g,f){var c=this;var b={};b.cmd=c._getArticleDelCmd();b.fid=e;b.tid=g;b.id=f;return b},_getMessageDeleteArticle:function(c){var b=this;return b.callBase("_getMessageDeleteArticle",c)},_getParamDeleteComment:function(d,h,f,i,g,e){var c=this;var b={};b.cmd=c._getCommentDelCmd();b.fid=f;b.tid=i;b.aid=g;b.id=e;return b},_getMessageDeleteComment:function(c,d){var b=this;return b.callBase("_getMessageDeleteArticle",c)},_initCabinetregist:function(d,e,b){var c=this;desknets.forumset.cabinetregist.init(d,e,b)},_setCabinetregistTargetId:function(c,d){var b=this;desknets.forumset.cabinetregist.setTargetId(c,d)},_setCabinetregistTargetName:function(c,d){var b=this;desknets.forumset.cabinetregist.setTargetName(c,d)},_getRestModule:function(){return desknets.forumset.MODULE_API_FORUM},_getListCmd:function(){return desknets.forumset.PAGE_FORUMMSETALIST},_getListExecCmd:function(){return desknets.forumset.CMD_FORUMMSETARTICLELIST},_getListCommentExecCmd:function(){return desknets.forumset.CMD_FORUMMSETCOMMENTLIST},_getArticleEntryCmd:function(){return desknets.forumset.CMD_FORUMMSETARTICLEENTRY},_getArticleDelCmd:function(){return desknets.forumset.CMD_FORUMMSETARTICLEDEL},_getCommentEntryCmd:function(){return desknets.forumset.CMD_FORUMMSETCOMMENTENTRY},_getCommentDelCmd:function(){return desknets.forumset.CMD_FORUMMSETCOMMENTDEL},_setDispIcon:function(f,d){var c=this;var b=d.status;var e=".forum-article-item";if(f.hasClass("forum-comment-disp")){e=".forum-article-reply"}if(b==desknets.forum.DEF_STATUS_HIDE){f.removeClass("on");f.addClass("off");f.parents(e).addClass("disp-off");f.attr("title",desknets.Resource.forum.setshow)}else{f.removeClass("off");f.addClass("on");f.parents(e).removeClass("disp-off");f.attr("title",desknets.Resource.forum.sethide)}},_dispArticle:function(c,d,i,g){var b=this;var f=null;var h={};var e=function(){if(f!=null){desknets.submitform.setDialogDisabled(f)}var j=b._getParamDispArticle(c,d,i,g);desknets.ajax.rest({url:desknets.getUrl(b._getRestModule()),data:j,success:function(l,k,m){b._getListAjax(b._getListRow());f.dialog("close")},})};f=desknets.dialog.confirm(b._getMessageDispArticle(c),e,h)},_getParamDispArticle:function(d,e,g,f){var b=this;var c={};c.cmd=b._getArticleDispCmd();c.fid=e;c.tid=g;c.id=f;if(d.hasClass("disp-off")){c.status=desknets.forum.DEF_STATUS_SHOW}else{c.status=desknets.forum.DEF_STATUS_HIDE}return c},_getMessageDispArticle:function(b){var c="";if(b.hasClass("disp-off")){c=desknets.Resource.forum.confirmation_show}else{c=desknets.Resource.forum.confirmation_hide}return c},_dispComment:function(d,k,f,i,c,h){var j=this;var e=null;var b={};var g=function(){if(e!=null){desknets.submitform.setDialogDisabled(e)}var l=j._getParamDispComment(d,k,f,i,c,h);desknets.ajax.rest({url:desknets.getUrl(j._getRestModule()),data:l,success:function(n,m,o){if(d.find(".forum-article-replies-showall").hasClass("none")){j._getListCommentAjax(d,true)}else{j._getListCommentAjax(d,false)}e.dialog("close")},})};e=desknets.dialog.confirm(j._getMessageDispComment(d,k),g,b)},_getParamDispComment:function(d,h,f,i,g,e){var b=this;var c={};c.cmd=b._getCommentDispCmd();c.fid=f;c.tid=i;c.aid=g;c.id=e;if(h.hasClass("disp-off")){c.status=desknets.forum.DEF_STATUS_SHOW}else{c.status=desknets.forum.DEF_STATUS_HIDE}return c},_getMessageDispComment:function(b,c){if(c.hasClass("disp-off")){smessage=desknets.Resource.forum.confirmation_show}else{smessage=desknets.Resource.forum.confirmation_hide}return smessage},_getArticleDispCmd:function(){return desknets.forumset.CMD_FORUMMSETARTICLESTATUSSET},_getCommentDispCmd:function(){return desknets.forumset.CMD_FORUMMSETCOMMENTSTATUSSET},_getRefAttachCmd:function(){return desknets.forumset.CMD_FORUMMSETVIEWATTACH},_getRefCommentAttachCmd:function(){return desknets.forumset.CMD_FORUMMSETVIEWCOMMENTATTACH},_getCopyAttachCmd:function(){return desknets.forumset.CMD_FORUMMSETCOPYATTACH},_getAttach:function(){return desknets.forumset.attach},});desknets.page(desknets.forumset,"forummsetsearch",desknets.forum.forumsearch,{getLocationFormParam:function(){var b=this;var c={};c=this.callBase("getLocationFormParam");if(neo.isSet(c)){c.init=desknets.forum.DEF_INIT_TOP}return c},_setItemsHref:function(){desknets.forum.setItemsHref(this.$mjTableList,{forum:desknets.forumset.PAGE_FORUMMSETFORUMLIST,topic:desknets.forumset.PAGE_FORUMMSETALIST})},_getListCmd:function(){return desknets.forumset.PAGE_FORUMMSETSEARCH},_getListExecCmd:function(){return desknets.forumset.CMD_FORUMMSETSEARCH},_getStopBatSearchCmd:function(){return desknets.forumset.CMD_FORUMMSETSEARCHSTOP},});desknets.page(desknets.forumset,"forummsetaccslog",desknets.PageListBase,{_mcTotalTemplate:null,_mcListTemplate2:null,_initListStartSet:function(){var b=this;b.$mjListPage.find("input[type=button].jforum-button-search").click(function(d){d.preventDefault();var f=b.$mjListPage.find("select[name=id]").val();if(!neo.isSet(f,{blank:false})){var c=desknets.Resource.forum.unselectedForum;desknets.dialog.alert(c,{type:"warn"})}else{b._changeAccessLogDispPage()}});a(".co-searchaera-open").click(function(c){c.preventDefault();a(this).closest(".co-actionwrap").prev(".co-searchaera").removeClass("close")});b.callBase("_initListStartSet")},_initListStartTemplate:function(){var b=this;b._mcTotalTemplate=b.$mjListPage.find(".jforum-total").text();b.callBase("_initListStartTemplate");b._mcListTemplate='<tr class="forumad-accscount-row"><td>{{date}}</td><td>'+desknets.Resource.forum.count+"</td></tr>";b._mcListTemplate2='<tr class="forumad-accscount-row"><td>{{date}}</td><td><table class="forumad-accscount-graph"><tr class="forumad-accscount-row"><td class="countbar" style="width:{{graph}}px;">&nbsp;<br></td><td>'+desknets.Resource.forum.count+"</td></tr></table></td></tr>"},_listLine:function(c,e){var b=this;var d=c;if(e.graph!="0"){d=b._mcListTemplate2}return b.callBase("_listLine",d,e)},_getListAjaxSuccessOtherSet:function(c){var b=this;var f=this._getListAjaxSuccessData(c);var d=b.$mjListPage.find(".co-searchaera");var e=b.$mjListPage.find(".jforum-listaera");b._setSearchAeraData(d,c);b._setTotalAeraData(e,c);if(f.length<=0){d.removeClass("close");e.hide()}else{d.addClass("close");e.show()}},_setSearchAeraData:function(d,c){var b=this;if(typeof c.id!="undefined"){d.find('select[name="id"]').val(c.id)}if(typeof c.type!="undefined"){d.find('select[name="type"]').val(c.type)}if(typeof c.range!="undefined"){d.find('select[name="range"]').val(c.range)}},_setTotalAeraData:function(f,e){var d=this;var b=[];if(typeof e.allcount!="undefined"){b.allcount=e.allcount}else{b.allcount=""}if(typeof e.passday!="undefined"){b.passday=e.passday}else{b.passday=""}if(typeof e.average!="undefined"){b.average=e.average}else{b.average=""}var c=d._mcTotalTemplate;c=d._replaceListLine(c,"allcount",b);c=d._replaceListLine(c,"passday",b);c=d._replaceListLine(c,"average",b);f.find(".jforum-total").text(c)},_hashUpdatePageView:function(c){var b=this;var d=desknets.paramanalyzer.getHashParams();if(c==desknets.forumset.PAGE_FORUMMSETACCSLOG){b._getListAjax(d.row)}else{b.callBase("_hashUpdatePageView",c)}},_changeAccessLogDispPage:function(){var b=this;var e="";var c={};var d=b.$mjListPage.find(".co-searchaera");e=desknets.forumset.PAGE_FORUMMSETACCSLOG;c.cmd=e;c.id=d.find('select[name="id"]').val();c.type=d.find('select[name="type"]').val();c.range=d.find('select[name="range"]').val();c._=desknets.createRandomId();b._setLocationHash(c)},_getIdListPageForm:function(){return"frm"},_getRestModule:function(){return desknets.forumset.MODULE_API_FORUM},_getListExecCmd:function(){return desknets.forumset.CMD_FORUMMSETACCSLOG},});desknets.page(desknets.forumset,"forummsetaccslogdel",desknets.PageSet,{$mjContent:null,init:function(){var b=this;b.$mjContent=a(".co-m-content");b.callBase("init");b._initButton()},_initButton:function(){var b=this;a(".jforum-button-run").click(function(c){c.preventDefault();if(b._checkClickButtonRun()){var d=desknets.dialog.confirm(desknets.Resource.Message.forum_log_del_run,function(){a("#frm").submit()})}})},_checkClickButtonRun:function(){var b=this;if(!b.$mjContent.find('input[name="delall"]').attr("checked")){desknets.dialog.alert(desknets.Resource.Message.forum_log_del_nochecked,{type:"warn"});return false}return true},_getNextCmd:function(){return desknets.forumset.PAGE_FORUMMSETFORUMLIST}});desknets.page(desknets.forumset,"forumsetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.forumset.PAGE_FORUMSETADMIN}});desknets.page(desknets.forumset,"forumsetmanager",desknets.PageAdmin,{_getSetCondition:function(){return false},_getNextCmd:function(){return desknets.forumset.PAGE_FORUMSETADMIN}});app.addInitialAction(function(){desknets.forumset.init()})})(jQuery);