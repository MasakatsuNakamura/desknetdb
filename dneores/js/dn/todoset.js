/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.todoset={CMD_TODOPSETLABELLIST:"todopsetcmdlabellist",CMD_TODOPSETLABELDEL:"todopsetcmdlabeldelete",CMD_TODOPSETLABELENTRY:"todopsetcmdlabelentry"};a.extend(desknets.todoset,{PAGE_TODOLIST:"todolist",PAGE_TODOPSETGEN:"todopsetgen",PAGE_TODOPSETALARM:"todopsetalarm",PAGE_TODOPSETACCESS:"todopsetaccess",PAGE_TODOPSETLABELLIST:"todopsetlabellist",PAGE_TODOPSETLABELENTRY:"todopsetlabelentry",CMD_TODOPSETACCESS:"todopsetaccess",CMD_TODOPSETACCENTRY:"todopsetaccessentry",CMD_TODOPSETACCESSDELCONF:"todopsetaccessdelconf",CMD_TODOPSETLABELMV:"todopsetcmdlabelmove",PAGE_TODOMSETINDEX:"todomsetindex",PAGE_TODOMSETLIST:"todomsetlist",PAGE_TODOMSETACCESS:"todomsetaccess",PAGE_TODOMSETACCENTRY:"todomsetaccessentry",PAGE_TODOMSETTASKREF:"todomsettaskref",PAGE_TODOMSETTASKENTRY:"todomsettaskentry",PAGE_TODOMSETTASKDEL:"todomsettaskdelete",PAGE_TODOMSETTASKCOMPLETE:"todomsettaskcomplete",CMD_TODOMSETINDEX:"todomsetcmdindex",CMD_TODOMSETLIST:"todomsetcmdlist",CMD_TODOMSETACCESS:"todomsetcmdaccess",CMD_TODOMSETTASKREF:"todomsetcmdtaskref",CMD_TODOMSETTASKENTRY:"todomsetcmdtaskentry",CMD_TODOMSETTASKDEL:"todomsetcmdtaskdelete",CMD_TODOMSETTASKCOMPLETE:"todomsetcmdtaskcomplete",CMD_TODOMSETDISPATTACH:"todomsetdispattach",CMD_TODOPSETACCESS:"todosetcmdaccess",CMD_TODOPSETACCESSDEL:"todosetcmdaccessentry",PAGE_TODOSETADMIN:"todosetadmin",PAGE_TODOSETGEN:"todosetgen",PAGE_TODOSETMANAGER:"todosetmanager",FIELD_TODOMSETTITLENAME:"uname",init:function(){var b=this;var d;var c;var e=a("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(e);if(e.substr(0,8)=="todopset"){if(e==b.PAGE_TODOPSETGEN){desknets.todoset.todopsetgen.init()}if(e==b.PAGE_TODOPSETALARM){desknets.todoset.todopsetalarm.init()}if(e==b.PAGE_TODOPSETACCESS){desknets.todoset.todopsetaccess.init()}if(e==b.PAGE_TODOPSETLABELLIST){desknets.hashobserver.init(desknets.todoset);desknets.todoset.todopsetlabellist.init()}desknets.todo.subwin.init();desknets.todo.subwinuser.init()}if(e==b.PAGE_TODOMSETINDEX){desknets.hashobserver.init(desknets.todoset);desknets.todoset.todomsetindex.init()}if(e==b.PAGE_TODOMSETACCESS){desknets.hashobserver.init(desknets.todoset);desknets.todoset.todomsetaccess.init()}if(e==b.PAGE_TODOSETADMIN){desknets.todoset.todosetadmin.init()}if(e==b.PAGE_TODOSETGEN){desknets.todoset.todosetgen.init()}if(e==b.PAGE_TODOSETMANAGER){desknets.todoset.todosetmanager.init()}}});(function(b){desknets.page(desknets.todoset,"todopsetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.todoset.PAGE_TODOLIST}})})(jQuery);desknets.page(desknets.todoset,"todopsetalarm",desknets.PageSet,{init:function(){var c=this;c._initToDoReminderErr();c.callBase("init");var b={minuteStep:30,required:true};desknets.timePicker.create(a(c._mIdPageForm).find("#jtodo-pset-sendtime"),b)},_getNextCmd:function(){return desknets.todoset.PAGE_TODOLIST},_initToDoReminderErr:function(){var c="";var b=desknets.pageframe.getTopMsg();c=a("#co-topmsg-text-set").html();if(c.length!=0){desknets.pageframe.viewTopMsg(c,"alert")}}});(function(b){desknets.page(desknets.todoset,"todopsetaccess",desknets.PageAccess,{init:function(){var c=this;c._boAddOnly=true;c.callBase("init")},_getNextCmd:function(){return desknets.todo.PAGE_TODOLIST},_getChoosePrivateGroup:function(){return"readonly"},_getSelDialogOptions:function(){var c=this;var e={allGroup:"readonly",unassignGroup:"readonly"};var d=c.callBase("_getSelDialogOptions");b.extend(d,e);return d}})})(jQuery);(function(b){desknets.page(desknets.todoset,"todopsetlabellist",desknets.PageInputList,{_getListCmd:function(){return desknets.todoset.PAGE_TODOPSETLABELLIST},_getListExecCmd:function(){return desknets.todoset.CMD_TODOPSETLABELLIST},_getListAddCmd:function(){return desknets.todoset.PAGE_TODOPSETLABELENTRY},_getListModCmd:function(){return desknets.todoset.PAGE_TODOPSETLABELENTRY},_getDelExecCmd:function(){return desknets.todoset.CMD_TODOPSETLABELDEL},_getMoveExecCmd:function(){return desknets.todoset.CMD_TODOPSETLABELMV},_getListEntryClass:function(){return desknets.todoset.todopsetlabelentry},_getListModClass:function(){return desknets.todoset.todopsetlabelentry}})})(jQuery);(function(b){desknets.page(desknets.todoset,"todopsetlabelentry",desknets.PageInputBase,{_getAddExecCmd:function(){return desknets.todoset.CMD_TODOPSETLABELENTRY},_getModExecCmd:function(){return this._getAddExecCmd()},_getDelExecCmd:function(){return desknets.todoset.CMD_TODOPSETLABELDEL}})})(jQuery);desknets.page(desknets.todoset,"todomsetindex",desknets.PageInputList,{_initListStart:function(){var b=this;b.callBase("_initListStart");var c={assign:true,onSelectGroupHide:true};var d={allGroup:"choosable",unassignGroup:"choosable"};desknets.page.groupSelect.init(c,d)},_initListStartModLink:function(){},_replaceListLine:function(c,f,e){var b=this;if(f==desknets.user.KEY_ASSIGNGROUP){var d=[];d=desknets.user.getListAssignGroups(e[f].Name);c=desknets.tmpl.replaceWordHtml(c,f,d.assign);c=desknets.tmpl.replaceWordHtml(c,"assigntitle",d.assigntitle);return c}return b.callBase("_replaceListLine",c,f,e)},_listLine:function(c,d){var b=this;c=b.callBase("_listLine",c,d);if(!neo.isSet(d[desknets.user.KEY_ASSIGNGROUP])){c=desknets.tmpl.replaceWordHtml(c,desknets.user.KEY_ASSIGNGROUP,"&nbsp;");c=desknets.tmpl.replaceWordHtml(c,"assigntitle","&nbsp;")}return c},_getListAjaxSuccess:function(c){var b=this;b.callBase("_getListAjaxSuccess",c);desknets.page.groupSelect.editSelectedGroup(a(".jco-sel-items"),c)},initParamsFromHash:function(c){var b=this;var d="";var e=desknets.paramanalyzer.getHashParams();d=c.cmd;if(!neo.isSet(d)||d==b._getListCmd()){b._hashUpdateListPage(c)}else{if(d==b._getListDispCmd()){b._hashUpdateDispPage()}else{b._hashUpdateList(d)}}},_hashUpdateDispPage:function(){var b=this;desknets.todoset.todomsettaskref.initPage(b._getMSetListCmd(),b._getIdMSetListPage())},_hashUpdateList:function(d){var c=this;var e=desknets.paramanalyzer.getHashParams();var b;if(d==c._getMSetListCmd()){b="#"+c._getIdMSetListPage();if(a(b).find(".jco-title").length>0){desknets.todoset.todomsetlist._getListAjax(e.row)}else{desknets.todoset.todomsetlist.initPage(c.mhashBackCmd,c.mhashIdBack)}c.mhashBackCmd=c._getListCmd();c.mhashIdBack=c._getIdListPage()}},_getMSetListCmd:function(){return desknets.todoset.PAGE_TODOMSETLIST},_getIdMSetListPage:function(){return"jtodo-m-list-container"},_getListCmd:function(){return desknets.todoset.PAGE_TODOMSETINDEX},_getListExecCmd:function(){return desknets.todoset.CMD_TODOMSETINDEX},_getListDispCmd:function(){return desknets.todoset.PAGE_TODOMSETTASKREF}});desknets.page(desknets.todoset,"todomsetlist",desknets.todo.listcom,{mMSetUserName:null,mUserID:null,_getFieldsCheckScroll:function(){return["uid"]},_listMoveScroll:function(){this._setClearScrollPosition();this.callBase("_listMoveScroll")},_initListEnd:function(){var b=this;var c="";var d=desknets.paramanalyzer.getHashParams();if(neo.isSet(d)&&neo.isSet(d.complete)){b.$mjListPage.find('select[name="complete"]').val(d.complete)}b.callBase("_initListEnd")},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".jtodo-complete").change(function(c){c.preventDefault();b.MSetListStatusEnd(c)});b.$mjListPage.find(".jco-list-del-submit").click(function(c){c.preventDefault();b._listDelSubmit(c)})},_getListAjaxSuccess:function(e){var c=this;var b=desknets.ajax.getItems(e.target.item);if(b.length==0){c.mMSetUserName=""}if(b[0].val){c.mMSetUserName=b[0].val}var d=desknets.paramanalyzer.getHashParams();if(neo.isSet(d.uid)&&d.uid.length>0){c.mUserID=d.uid}c.callBase("_getListAjaxSuccess",e)},_getListAjaxSuccessEnd:function(){var c=this;var d={};var e="";var b=["0","1","2"];c.callBase("_getListAjaxSuccessEnd");d=desknets.paramanalyzer.getHashParams();e=d.complete;if(a.inArray(e,b)<0){e="2"}c.$mjListPage.find(".jtodo-complete").val(e)},MSetListStatusEnd:function(){var c=this;var d=desknets.paramanalyzer.getHashParams();var b=c.$mjListPage.find('select[name="complete"]').val();if(b){d.complete=b}c._setLocationHash(d)},_listLine:function(c,d){var b=this;c=desknets.tmpl.replaceWord(c,"uid",b.mUserID);return b.callBase("_listLine",c,d)},_getAddPageParam:function(){var b={};var c=desknets.paramanalyzer.getHashParams();b.uid=c.uid;return b},_getDelAddPrm:function(){var b=this;var c={};var d=desknets.paramanalyzer.getHashParams();c.uid=d.uid;c.complete=d.complete;return c},_getSearchExecParam:function(){var b=this;var d=a("#jco-m-list-container").find(".jco-back-page-data");var c=b.callBase("_getSearchExecParam");if(!neo.isSet(c.num,{blank:false})){c.num=d.find('input[name="tasknum"]').val()}return c},_setTitle:function(d,b){var c=this;var b={};b.uname=c.mMSetUserName;var e=desknets.todo.mFormTitle;d=d+e;c.callBase("_setTitle",d,b)},_getModPageParam:function(){var b=this;return this._getAddPageParam()},_getDispPageParam:function(){var b=this;return this._getAddPageParam()},_getIdListPage:function(){return"jtodo-m-list-container"},_getIdListPageForm:function(){return"listfrmmset"},_getListCmd:function(){return desknets.todoset.PAGE_TODOMSETLIST},_getListExecCmd:function(){return desknets.todoset.CMD_TODOMSETLIST},_getListDispCmd:function(){return desknets.todoset.PAGE_TODOMSETTASKREF},_getListDispClass:function(){return desknets.todoset.todomsettaskref},_getDelExecCmd:function(){return desknets.todoset.CMD_TODOMSETTASKDEL},});desknets.page(desknets.todoset,"todomsettaskref",desknets.todo.todotaskref,{_getDispDataParam:function(){var b=this;var c={};c=desknets.paramanalyzer.getHashParams();c.cmd=this._getDispExecCmd();return c},getLocationFormParam:function(){var c=this;var d={};var b="";d=c.callBase("getLocationFormParam");desknets.todo.CheckParamSetHash(d);return d},_getIdPage:function(){return"jco-m-disp-page"},_getDispExecCmd:function(){return desknets.todoset.CMD_TODOMSETTASKREF},_getDelExecCmd:function(){return desknets.todoset.CMD_TODOMSETTASKDEL},_getDelPrm:function(){var b={};var c=desknets.paramanalyzer.getHashParams();b.uid=c.uid;return b},TaskRefGetAttachDownloadParams:function(c){var b={};b=desknets.todo.TaskRefGetAttachParams(c);b.cmd=desknets.todoset.CMD_TODOMSETDISPATTACH;return b},TaskRefAddTitleCreateString:function(){var b=this;var d="";var c=b.mTargetName;if(c==null){return""}return desknets.todo.mFormTitle}});(function(b){desknets.page(desknets.todoset,"todomsetaccess",desknets.msetaccess,{_getListModClass:function(){var c=this;return c._getListEntryClass()},_getListCmd:function(){return desknets.todoset.PAGE_TODOMSETACCESS},_getListExecCmd:function(){return desknets.todoset.CMD_TODOMSETACCESS},_getListAddCmd:function(){return desknets.todoset.PAGE_TODOMSETACCENTRY},_getListModCmd:function(){var c=this;return c._getListAddCmd()},_getDelExecCmd:function(){return desknets.todoset.CMD_TODOMSETACCDEL},_getListEntryClass:function(){return desknets.todoset.todomsetaccessentry}})})(jQuery);(function(b){desknets.page(desknets.todoset,"todomsetaccessentry",desknets.msetaccessentry,{initPage:function(e,d){var c=this;c._boAddOnly=true;c.callBase("initPage",e,d)}})})(jQuery);desknets.page(desknets.todoset,"todosetadmin",desknets.PageBase,{});desknets.page(desknets.todoset,"todosetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.todoset.PAGE_TODOSETADMIN}});desknets.page(desknets.todoset,"todosetmanager",desknets.PageAdmin,{_getSetCondition:function(){return false},_getNextCmd:function(){return desknets.todoset.PAGE_TODOSETADMIN}});app.addInitialAction(function(){desknets.todoset.init()})})(jQuery);