/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.cost={_mhelpudl:"",_madminflg:"",_mflowid:null,micostmaxcnt:100,midetailmaxcnt:100,miconunder:'<span class="cost-icon-under">&nbsp;</span>',misListOpen:false,getUrl:function(){return desknets.getUrl("zrcost")},isShown:function(){var b=this;return b.misListOpen},getApiModule:function(){return"zrcost"},costOpenGetDefOption:function(){var b=this;var c={};c.data={};c.data.id="";c.data.title="";c.data.seldate="";c.data.meisai={};c.data.meisai.item=[];return c},costModOpenGet:function(e,d,c){var b=this;desknets.ajax.rest({url:desknets.cost.getUrl(),data:{cmd:"costcmddetailindex",id:e},success:function(g,f,h){b.costModOpen(g,d,c)},})},costModOpen:function(e,d,c){var b=this;var f={};f.starttime=d.starttime;f.data=e.list.item;if(d.bosch===true){f.bosch=d.bosch}f.oncomplete=function(g,h){b.costOnComplete(g,d,h);if(!!c){c.dialog("close")}};desknets.cost.input.open(f)},costOnComplete:function(o,i,c){if(!o.id){o.id=-1}var n={};n.id=o.id;if(o.meisai.item.length==0){n.cmd="costcmddel"}else{n.cmd="costcmdentry";n.seldate=o.seldate;n.title=o.title;n.total_amount=o.total_amount;if(!!i.sid_sch){n.sid_sch=i.sid_sch}var b=[];var q=[];var f=[];var g=[];var h=[];var m=[];var l=[];var p=[];var j=[];var e=[];var d=[];var k=[];a.each(o.meisai.item,function(r,s){b[b.length]=s.id;q[q.length]=s.dtype;f[f.length]=s.sid_acc;g[g.length]=s.acc_name;h[h.length]=s.amount;m[m.length]=s.memo;l[l.length]=s.dep_st_name;p[p.length]=s.dep_st_kbn;j[j.length]=s.dep_st_busname;e[e.length]=s.arv_st_name;d[d.length]=s.arv_st_kbn;k[k.length]=s.arv_st_busname});n[o.id+"_id"]=b;n[o.id+"_dtype"]=q;n[o.id+"_sid_acc"]=f;n[o.id+"_acc_name"]=g;n[o.id+"_amount"]=h;n[o.id+"_memo"]=m;n[o.id+"_dep_st_name"]=l;n[o.id+"_dep_st_kbn"]=p;n[o.id+"_dep_st_busname"]=j;n[o.id+"_arv_st_name"]=e;n[o.id+"_arv_st_kbn"]=d;n[o.id+"_arv_st_busname"]=k}desknets.ajax.rest({url:desknets.cost.getUrl(),data:n,success:function(s,r,t){if(typeof(i.onComplete)=="function"){i.onComplete()}c.dialog("close");if(typeof(i.oncomplete)=="function"){i.oncomplete()}},traditional:true})},costDelTmpAtt:function(){var b=this;desknets.ajax.rest({url:desknets.cost.getUrl(),data:{cmd:"costcmdentrydelatt"},success:function(d,c,e){},})},costDelCopyTmpAtt:function(f,d){var b=this;var c={};c["0"]={cmd:"costcmdentrydelatt"};c["1"]={cmd:"costcmdentrycopyatt",id:f,sid_sch:d};var e=desknets.ajax.arrayToMultiCmdData(c);desknets.ajax.rest({url:desknets.cost.getUrl(),data:e,success:function(h,g,i){},})},cleanDate:function(c){var b=this;if(!c){return}c.removeClass("ui-invalid-mismatch ui-invalid ui-invalid-range-underflow ui-invalid-range-overflow")},getDateErrorMessage:function(g){var d="";var b=null;var e=g.datepicker("option","dateFormat");var c=g.datepicker("option","minDate");var f=g.datepicker("option","maxDate");if(g.hasClass("ui-invalid-range-underflow")&&!!c){d=a.datepicker.formatDate(e,c);b=desknets.Resource.Message.com_underflow_date}else{if(g.hasClass("ui-invalid-range-overflow")&&!!f){d=a.datepicker.formatDate(e,f);b=desknets.Resource.Message.com_overflow_date}else{if(g.hasClass("ui-invalid")){b=desknets.Resource.Message.com_invalid_date}}}if(!!b){b=desknets.tmpl.replaceWordHtml(b,"value",d)}return b},getSetting:function(d,b){var c=this;if(c._madminflg!=""){if(typeof d=="function"){d(c._madminflg)}if(typeof b=="function"){b(c._mhelpudl)}}else{c._getSettingData(d,b)}},_getSettingData:function(d,b){var c=this;desknets.ajax.rest({url:desknets.cost.getUrl(),data:{cmd:"costcmdgetsetting"},success:function(f,e,g){c._mhelpudl=f.helpurl;c._madminflg=f.userlevel;if(typeof d=="function"){d(c._madminflg)}if(typeof b=="function"){b(c._mhelpudl)}},})},getSettingFlow:function(c){var b=this;if(b._mflowid!==null){if(typeof c=="function"){c(b._mflowid)}}else{b._getSettingFlowData(c)}},_getSettingFlowData:function(c){var b=this;desknets.ajax.rest({url:desknets.cost.getUrl(),data:{cmd:"costcmdgenref"},success:function(e,d,f){b._mflowid=e.sid_flow;if(typeof c=="function"){c(b._mflowid)}},})},setComboxSize:function(d){var b=this;if(desknets.browser.msie9){var e=a("#"+d.data("for"));if(e.height()>=parseInt(e.css("max-height"),10)-5){var c=d.closest(".co-combox").width()+18;e.css("width",c+"px")}else{var c=d.closest(".co-combox").width();e.css("width",c+"px")}}},};desknets.cost.holiday={_items:{},boChkHoliday:function(c){var b=this;var d=c.substring(0,4);if(!!b._items[d]&&!!b._items[d][c]){return true}return false},getHoliday:function(b,e,c){var j=this;var d=Number(b);var i=Number(e);var g=false;for(var h=d;h<=i;h++){var f=String(h);if(!j._items[f]){g=true;break}}if(g){j._get(d,i,c)}else{c()}},_get:function(d,c,e){var b=this;desknets.ajax.rest({url:desknets.getUrl("dneor"),data:{cmd:"schholidaylist",startdate:String(d)+"0101",enddate:String(c)+"1231"},success:function(f){for(var g=d;g<=c;g++){var h=String(g);b._items[h]={}}b._add(desknets.ajax.getJsonItems(f))},complete:e})},_add:function(c){var b=this;a.each(c,function(e,g){var f=Number(g.year);var i=Number(g.id);var d=String(f*10000+i);var h=d.substring(0,4);b._items[h][d]=g.Name})},};desknets.cost.search={mobjcmd:{search:"costcmdsrchrindex",history:"costcmdsrchhindex",},$mdialog:null,_mHistory:"",_monComplete:null,_stype:"teiki",_objSearch:{},mbobackStationSel:false,_mvia:'<tr class="tmp-via"><th>'+desknets.Resource.cost.via+'<span class="co-colon-span">:</span></th><td><div class="co-combox"><input type="text" value="" class="co-combox-text" name="via"><a class="co-combox-arrow co-drop-down-button cost-combox-arrow" data-for="cost-combox-list-via-{{count}}" data-align="right">'+desknets.Resource.cost.history+'</a><ul class="co-pop-up-box co-combox-list cost-combox-list" id="cost-combox-list-via-{{count}}">{{li}}</ul></div><a href="#" class="del" title="'+desknets.Resource.delLabel+'" tabindex="-1"></a></td></tr>',_mresultheader:'<li data-view="#tab-res-list-{{number}}"><div class="number">{{number}}</div><div class="point"><span title="{{fast}}" class="cost-route-icon {{fastclass}}"></span><span title="{{mind}}" class="cost-route-icon {{mindclass}}"></span><span title="{{ease}}" class="cost-route-icon {{easeclass}}"></span></div></li>',_mresultlist:'<tr data-view="#tab-res-list-{{number}}" data-number="{{number}}" class="routine"><th class="tab"><div class="number">{{number}}</div><div class="point"><span title="{{fast}}" class="cost-route-icon {{fastclass}}"></span><span title="{{mind}}" class="cost-route-icon {{mindclass}}"></span><span title="{{ease}}" class="cost-route-icon {{easeclass}}"></span></div></th><td><span class="sum">{{date}}</span><span class="time">{{time}}</span><span class="price">&nbsp;{{price}}&nbsp;{{ic}}</span><span class="change">&nbsp;{{change}}</span><span class="distance">&nbsp;{{distance}}</span></td></tr>',_mresultdata:'<div class="tab-content" id="tab-res-list-{{number}}"><div class="res-switch"><div class="cost-check" data-view=".jcost-temp"><label>'+desknets.Resource.cost.fare+'</label></div><div class="cost-check last" data-view=".jcost-regular"><label>'+desknets.Resource.cost.regular+'</label></div><div class="cost-check last" data-view=".jcost-routine"><label>'+desknets.Resource.cost.routine+'</label></div></div>{{costtemp}}{{costregular}}{{costpass}}<div class="res-footer"><button class="cost-btn">{{costbtn}}</button></div></div>',_mcosttemp:'<div class="jcost-res-data cost-temp jcost-temp"><div class="summary">{{date}}<br />{{time}}<span class="price" data-price="{{priceset}}">&nbsp;{{price}}&nbsp;{{ic}}</span>&nbsp;{{change}}&nbsp;{{distance}}</div><ul class="res-details">{{details}}</ul></div>',_mcostregular:'<div class="jcost-res-data cost-temp cost-regular jcost-regular"><div class="summary">{{date}}<br />{{time}}<span class="price" data-price="{{priceset}}">&nbsp;{{price}}&nbsp;{{ic}}</span>&nbsp;{{change}}&nbsp;{{distance}}</div><ul class="res-details">{{details}}</ul></div>',_mcostpass:'<div class="jcost-res-data cost-pass jcost-routine"><div class="scroll"><table><thead><tr><th colspan="4">'+desknets.Resource.cost.commuting+'</th></tr><tr><th class="co-width-300">'+desknets.Resource.cost.section+"</th><th>"+desknets.Resource.cost.month1+'</th><th class="co-width-100">'+desknets.Resource.cost.month3+'</th><th class="co-width-100">'+desknets.Resource.cost.month6+"</th></tr></thead><tbody>{{teiki}}</tbody></table></div></div>",_mcostpassnodata:'<div class="jcost-res-data cost-pass jcost-routine"><div class="scroll cost-routine-nodata">'+desknets.Resource.cost.cost_routine_nodata_msg+"</div></div>",_mteiki:'<tr class="jcost-routine-data" data-from="{{from}}" data-to="{{to}}" data-rosen="{{rosen}}"><th>{{rosen}}<br />{{from}}'+desknets.Resource.kara+"{{to}}</th><td>{{price1}}</td><td>{{price3}}</td><td>{{price6}}</td></tr>",_mteikitotal:'<tr class="total"><th>'+desknets.Resource.cost.total+"</th><td>{{price1}}</td><td>{{price3}}</td><td>{{price6}}</td></tr>",_mstation:'<li class="station {{class}}"><div class="time">{{totime}}{{mati}}{{fromtime}}</div><div class="icon" title="{{icon}}">{{icon}}</div><dl><dt>{{station}}</dt><dd>{{fromext}}</dd><dd>{{fromtoPlatform}}</dd></dl></li><li class="between"><div class="time">{{time}}</div><div class="cost-icon-connect type{{between}}" title="{{betweenname}}">&nbsp;</div><div class="connection">{{connection}}</div><div class="line">{{lineName}} {{josyaText}}</div><div class="price">{{price}}&nbsp;{{ic}}{{tokkyu}}</div></li>',_mstationgoal:'<li class="station goal"><div class="time" title="{{totime}}">{{totime}}</div><div class="icon" title="{{icon}}">{{icon}}</div><dl><dt>{{station}}</dt><dd>&nbsp;</dd><dd>{{fromtoPlatform}}</dd></dl></li>',mbetweenname:{},miconroutename:{},open:function(c){var b=this;if(typeof(c.oncomplete)=="function"){b._monComplete=c.oncomplete;b._stype=c.type}else{b._monComplete=null;b._stype="teiki"}if(b.$mdialog==null){b._makeDialog(c)}else{b._setOpen(c)}},_setOpen:function(d){var b=this;var g=b.$mdialog.find(".search-main");var e=desknets.Resource.cost.title_cost_add;if(!!d.title){e=d.title}b.$mdialog.parent("div").find(".ui-dialog-title").text(e);if(d.mod===true){b.$mdialog.addClass("cost-mod")}else{b.$mdialog.removeClass("cost-mod")}b.$mdialog.find(".search").show();b.$mdialog.find(".result-wrap").hide();b.$mdialog.find(".search-main").show();b.$mdialog.find(".search-sub").hide();if(b._stype=="teiki"){b.$mdialog.find(".search-close").hide();b.$mdialog.find(".btn-via").hide();b.$mdialog.find(".search-main").addClass("teiki")}else{b.$mdialog.find(".search-close").show();b.$mdialog.find(".btn-via").show();b.$mdialog.find(".search-main").removeClass("teiki")}if(g.find(".setmore").hasClass("on")){g.find(".setmore").removeClass("on");g.find(".details").hide()}var f=b.$mdialog.find('input[name="start"]');f.val(d.data.dep_st_name);desknets.setDataAttr(f,"kbn",d.data.dep_st_kbn);desknets.setDataAttr(f,"bus",d.data.dep_st_busname);var c=b.$mdialog.find('input[name="end"]');c.val(d.data.arv_st_name);desknets.setDataAttr(c,"kbn",d.data.arv_st_kbn);desknets.setDataAttr(c,"bus",d.data.arv_st_busname);b.$mdialog.find(".tmp-via").remove();b.setUpDateTime(d.setdatetime);if(d.bosch==true){g.find(".cost-cway-click").eq(1).click()}else{g.find(".cost-cway-click").eq(0).click()}g.find(".cost-cfp-click").eq(0).click();b.$mdialog.find('select[name="seat"]').val("0");b.$mdialog.dialog("open")},_makeDialog:function(c){var b=this;var d=function(){b.$mdialog=a("#cost-search");var e=b._getDialogOptions();b.$mdialog=desknets.dialog.setUp(b.$mdialog,e);desknets.submitform.setEnterSubmit(b.$mdialog);b.getHistory();b._setUpDialog(c);b.getIconConnect();b._setOpen(c);b.miconroutename.fast=b.$mdialog.find(".jcost-icon-route.fast").text();b.miconroutename.lowproce=b.$mdialog.find(".jcost-icon-route.lowproce").text();b.miconroutename.easy=b.$mdialog.find(".jcost-icon-route.easy").text()};a("body").append('<div id="cost-search"></div>');desknets.tmpl.load(a("#cost-search"),"cost/costsrch.html",d)},_setUpDialog:function(){var b=this;b.$mdialog.find(".setsearch").click(function(c){c.preventDefault();if(b.mbobackStationSel){b.$mdialog.find(".search").show();b.$mdialog.find(".result-wrap").hide();b.$mdialog.find(".search-main").hide();b.$mdialog.find(".search-sub").show()}else{b.$mdialog.find(".search").show();b.$mdialog.find(".result-wrap").hide();b.$mdialog.find(".search-main").show();b.$mdialog.find(".search-sub").hide()}});b.$mdialog.find(".search-submit .cost-btn").click(function(c){c.preventDefault();a(this).focus();b.getPrmSearch()});b.$mdialog.find(".search-close .cost-btn").click(function(c){c.preventDefault();a(this).focus();b.setRoute()});b._setUpDialogSearchMain();b._setUpDialogSearchSub();b._setUpDialogResult()},_getDialogOptions:function(){var b=this;var c=desknets.dialog.getDialogOption();c.width=700;c.title="";c.dialogClass=c.dialogClass+" cost cost-pop";c.buttons=[{text:desknets.Resource.cancelLabel,"class":"cost-btn cost-btn-2",click:function(){b.$mdialog.dialog("close")}}];return c},_setUpDialogSearchMain:function(){var b=this;var c=b.$mdialog.find(".search-main");b.$mdialog.find('input[name="start"]').change(function(){var d=a(this);desknets.setDataAttr(d,"kbn","");desknets.setDataAttr(d,"bus","")});b.$mdialog.find('input[name="end"]').change(function(){var d=a(this);desknets.setDataAttr(d,"kbn","");desknets.setDataAttr(d,"bus","")});c.find(".route-switch").click(function(e){e.preventDefault();var f=c.find(".jcost-start").find("input");var d=c.find(".jcost-end").find("input");var h={data:f.val(),kbn:desknets.getDataAttr(f,"kbn"),bus:desknets.getDataAttr(f,"bus")};var g={data:d.val(),kbn:desknets.getDataAttr(d,"kbn"),bus:desknets.getDataAttr(d,"bus")};f.val(g.data);d.val(h.data);desknets.setDataAttr(f,"kbn",g.kbn);desknets.setDataAttr(d,"kbn",h.kbn);desknets.setDataAttr(f,"bus",g.bus);desknets.setDataAttr(d,"bus",h.bus)});c.find(".list-route").on("click",".cost-combox-arrow",function(d){if(!desknets.browser.tablet){a(this).closest("div").find(".co-combox-text").focus()}desknets.cost.setComboxSize(a(this))});c.find(".list-route").on("click",".co-combox-item",function(d){d.preventDefault();var e=a(this);if(a(d.target).hasClass("co-combox-del")){b.delHistory(desknets.getDataAttr(e,"id"))}else{var f=e.closest(".co-combox").find("input");f.val(e.find("span").text());desknets.setDataAttr(f,"kbn",desknets.getDataAttr(e,"kbn"));desknets.setDataAttr(f,"bus",desknets.getDataAttr(e,"bus"))}desknets.popUp.hide(e)});c.find(".btn-via").click(function(f){f.preventDefault();var e=c.find(".tmp-via").length;if(e>=4){desknets.dialog.alert(desknets.Resource.cost.cost_via_over,{});return}var d=desknets.tmpl.replaceWordHtml(b._mvia,"count",e);d=desknets.tmpl.replaceWordHtml(d,"li",b._mHistory);c.find(".jcost-end").before(d);b._setHistoryEvent()});c.on("click",".del",function(d){d.preventDefault();a(this).closest("tr").remove()});c.find(".cost-cway-click").click(function(d){c.find(".cost-cway").removeClass("checked");var e=a(this).prev().addClass("checked").attr("checked",true);if(e.val()==3||e.val()==4){b.$mdialog.find(".jcost-chg-time").attr("disabled","disabled");b.$mdialog.find('select[name="shour"]').attr("disabled","disabled");b.$mdialog.find('select[name="sminute"]').attr("disabled","disabled")}else{b.$mdialog.find(".jcost-chg-time").removeAttr("disabled");b.$mdialog.find('select[name="shour"]').removeAttr("disabled");b.$mdialog.find('select[name="sminute"]').removeAttr("disabled")}});c.find(".setmore").click(function(d){d.preventDefault();a(this).toggleClass("on");c.find(".details").toggle()});c.find(".cost-cfp-click").click(function(d){c.find(".cost-cfp").removeClass("checked");a(this).prev().addClass("checked").attr("checked",true)});b.$mdialog.find(".jcost-chg-time").click(function(d){d.preventDefault();var e=a(this);if(e.attr("disabled")!="disabled"){b.chgDateTime(e.data("time"))}});desknets.htmlparts.setUpForm(b.$mdialog.find("form"))},chgDateTime:function(f){var d=this;var e=d.$mdialog.find('input[name="date"]').val();var h=d.$mdialog.find('select[name="shour"]').val();var c=d.$mdialog.find('select[name="sminute"]').val();var b=e.split("-");var g=new Date(b[0],Number(b[1])-1,b[2],h,c,0);g.setTime(g.getTime()+60*1000*f);d.setUpDateTime(g)},setUpDateTime:function(e){var c=this;if(!e){e=new Date()}var b=neo.dateTime.format("HH",e);var d=neo.dateTime.format("mm",e);c.$mdialog.find('select[name="shour"]').val(b);c.$mdialog.find('select[name="sminute"]').val(d);c.$mdialog.find(".co-datepicker").datepicker("setDate",e);desknets.cost.cleanDate(c.$mdialog.find(".co-datepicker"))},_setUpDialogSearchSub:function(){var b=this;var c=b.$mdialog.find(".search-sub");c.find(".cost-btn.back").click(function(d){d.preventDefault();b.$mdialog.find(".search-main").show();c.hide()})},_setUpDialogResult:function(){var b=this;var c=b.$mdialog.find(".result");c.find(".res-header").on("click","li",function(d){d.preventDefault();var e=a(this);c.find(".res-header li").removeClass("on");e.addClass("on");c.find(".tab-content").hide();a(desknets.getDataAttr(e,"view")).show()});c.find("#tab-res-list").on("click","tr",function(d){d.preventDefault();var e=a(this);var f=c.find(".res-header li");f.removeClass("on");f.eq(e.data("number")).addClass("on");c.find(".tab-content").hide();a(desknets.getDataAttr(e,"view")).show()});c.find(".cost-tab-contents").on("click",".cost-check",function(d){d.preventDefault();var f=a(this);var e=f.closest(".tab-content");if(f.hasClass("disabled")){return}e.find(".cost-check").removeClass("on");f.addClass("on");e.find(".jcost-res-data").hide();e.find(desknets.getDataAttr(f,"view")).show()});c.find(".cost-tab-contents").on("click",".cost-btn",function(e){e.preventDefault();var f=a(this);if(b._stype=="teiki"){b._onComplete(f)}else{var d=f.closest(".tab-content");var h=d.find(".cost-check.on").text();var g=null;if(b.$mdialog.hasClass("cost-mod")){g=desknets.Resource.cost.cost_tran_conf_mod_msg}else{g=desknets.Resource.cost.cost_tran_conf_add_msg}desknets.dialog.confirm(g,function(){b._onComplete(f)})}})},_onComplete:function(e){var d=this;var c=e.closest(".tab-content");var b={};d.setSearchHist();if(d._stype=="teiki"){b=[];if(c.find(".cost-routine-nodata").length>0){desknets.dialog.alert("W:"+desknets.Resource.cost.cost_routine_nodata_msg);return}c.find(".jcost-routine-data").each(function(){var g=a(this);var f={dep_st_name:desknets.getDataAttr(g,"from"),arv_st_name:desknets.getDataAttr(g,"to"),line_name:desknets.getDataAttr(g,"rosen")};b[b.length]=f})}else{b.amount=desknets.getDataAttr(c.find(desknets.getDataAttr(c.find(".cost-check.on"),"view")).find(".summary .price"),"price");b.dep_st_name=d._objSearch.dep_st_name;b.dep_st_kbn=d._objSearch.dep_st_kbn;b.dep_st_busname=d._objSearch.dep_st_busname;b.arv_st_name=d._objSearch.arv_st_name;b.arv_st_kbn=d._objSearch.arv_st_kbn;b.arv_st_busname=d._objSearch.arv_st_busname;b.acc_name=desknets.Resource.cost.cost}if(typeof(d._monComplete)=="function"){d._monComplete(b)}d.$mdialog.dialog("close")},getPrmSearch:function(){var b=this;var d={};var i=null;i=desknets.cost.getDateErrorMessage(b.$mdialog.find(".co-datepicker"));if(!!i){desknets.dialog.alert(i,{});return}d.cmd=b.mobjcmd.search;var c=null;c=b.$mdialog.find('input[name="start"]');d.dep_st_name=c.val();d.dep_st_kbn=desknets.getDataAttr(c,"kbn");d.dep_st_busname=desknets.getDataAttr(c,"bus");var g=0;b.$mdialog.find('input[name="via"]').each(function(){var j=a(this);g++;d["via"+g]=j.val();d["via"+g+"_st_kbn"]=desknets.getDataAttr(j,"kbn");d["via"+g+"_st_busname"]=desknets.getDataAttr(j,"bus")});c=b.$mdialog.find('input[name="end"]');d.arv_st_name=c.val();d.arv_st_kbn=desknets.getDataAttr(c,"kbn");d.arv_st_busname=desknets.getDataAttr(c,"bus");d.date=b.$mdialog.find('input[name="date"]').val();d.time=b.$mdialog.find('select[name="shour"]').val()+b.$mdialog.find('select[name="sminute"]').val();d.opt3=b.$mdialog.find('input[name="cway"]:checked').val();d.cfp=b.$mdialog.find('input[name="cfp"]:checked').val();d.opt1=b.$mdialog.find('select[name="seat"]').val();b.mbobackStationSel=false;if(b.$mdialog.find(".search-sub").css("display")=="block"){var e=b.$mdialog.find(".search-sub");var h="";var f=null;f=e.find(".jcost-search-sub-start option:selected");if(!!f){d.dep_st_name=f.val();d.dep_st_kbn=desknets.getDataAttr(f,"kbn");d.dep_st_busname=desknets.getDataAttr(f,"bus")}f=e.find(".jcost-search-sub-end option:selected");if(!!f){d.arv_st_name=f.val();d.arv_st_kbn=desknets.getDataAttr(f,"kbn");d.arv_st_busname=desknets.getDataAttr(f,"bus")}g=0;h=e.find("select.jcost-search-sub-via").each(function(){g++;f=a(this).find("option:selected");if(!!f){d["via"+g]=f.val();d["via"+g+"_st_kbn"]=desknets.getDataAttr(f,"kbn");d["via"+g+"_st_busname"]=desknets.getDataAttr(f,"bus")}});b.mbobackStationSel=true}b._execSearch(d)},setRoute:function(){var d=this;var c=d.$mdialog.find('input[name="start"]');var f=d.$mdialog.find('input[name="end"]');var b={};b.amount="";b.dep_st_name=c.val();b.dep_st_kbn=desknets.getDataAttr(c,"kbn");b.dep_st_busname=desknets.getDataAttr(c,"bus");b.arv_st_name=f.val();b.arv_st_kbn=desknets.getDataAttr(f,"kbn");b.arv_st_busname=desknets.getDataAttr(f,"bus");b.acc_name=desknets.Resource.cost.cost;var e=a.extend({},b);e.cmd="costcmdentrychkdetail";e.dtype="1";desknets.ajax.rest({url:desknets.cost.getUrl(),data:e,error:function(k,g,i){var l=i;var h=a.parseJSON(k.responseText);if(!!h.errmsgadd){var j={};j.msg=h.errormessage;j.fieldid=h.errmsgadd;j.fieldname=d.$mdialog.find(".jco-input-"+j.fieldid).text()+desknets.merrMsgConnect;l=desknets.getErrConvMsg(j)}desknets.ajax.onError(k.status,l)},success:function(h,g,i){if(typeof(d._monComplete)=="function"){d._monComplete(b)}d.$mdialog.dialog("close")},})},_execSearch:function(c){var b=this;desknets.ajax.rest({url:desknets.cost.getUrl(),data:c,error:function(h,d,f){var i=f;var e=a.parseJSON(h.responseText);if(!!e.errmsgadd){var g={};g.msg=e.errormessage;g.fieldid=e.errmsgadd;g.fieldname=b.$mdialog.find(".jco-input-"+g.fieldid).text()+desknets.merrMsgConnect;i=desknets.getErrConvMsg(g)}desknets.ajax.onError(h.status,i)},success:function(e,d,f){if(!!e.dep_st_name){b.$mdialog.find(".search").hide();b.$mdialog.find(".result-wrap").show();b._viewSearchExec(e)}else{b.$mdialog.find(".search-main").hide();b.$mdialog.find(".search-sub").show();b._viewSearchSelectStation(e)}},traditional:true})},_viewSearchSelectStation:function(e){var j=this;var f="";var g="";var c=false;var k=j.$mdialog.find(".search-sub");var b=k.find(".jcost-search-sub-start");var i=k.find(".jcost-search-sub-end");b.html("");i.html("");k.find(".jcost-search-sub-via").remove();g="";if(!a.isArray(e.departure.item)){e.departure.item=[e.departure.item]}a.each(e.departure.item,function(l,m){if(l==0){c=true}else{c=false}g=g+j._viewSearchSelectStationLine(m,c)});b.html(g);g="";if(!a.isArray(e.arrival.item)){e.arrival.item=[e.arrival.item]}a.each(e.arrival.item,function(l,m){if(l==0){c=true}else{c=false}g=g+j._viewSearchSelectStationLine(m,c)});i.html(g);var h=4;while(h>0){var d="via"+h;if(!!e[d]){g="";g=g+'<div class="jcost-search-sub-via">'+desknets.Resource.cost.via+'</div><select class="jcost-search-sub-via" size="10">';if(!a.isArray(e[d].item)){e[d].item=[e[d].item]}a.each(e[d].item,function(l,m){if(l==0){c=true}else{c=false}g=g+j._viewSearchSelectStationLine(m,c)});g=g+"</select>";b.after(g)}h--}},_viewSearchSelectStationLine:function(e,c){var d=this;var b='<option value="{{Name}}" data-kbn="{{kbn}}" data-bus="{{bus}}" {{selected}}>{{kbnview}}{{Nameview}}{{busview}}</option>';if(c===true){b=desknets.tmpl.replaceWordHtml(b,"selected",'selected="selected"')}else{b=desknets.tmpl.replaceWordHtml(b,"selected","")}b=desknets.tmpl.replaceWordHtml(b,"Nameview",desknets.tmpl.dispStr(e.st_name));b=desknets.tmpl.replaceWordHtml(b,"Name",desknets.escapeValue(e.st_name));b=desknets.tmpl.replaceWordHtml(b,"kbn",desknets.escapeValue(e.st_kbn));if(e.st_kbn=="R"){b=desknets.tmpl.replaceWordHtml(b,"kbnview","[T]")}else{b=desknets.tmpl.replaceWordHtml(b,"kbnview","["+desknets.tmpl.dispStr(e.st_kbn)+"]")}if(!!e.st_busname){b=desknets.tmpl.replaceWordHtml(b,"bus",desknets.escapeValue(e.st_busname));b=desknets.tmpl.replaceWordHtml(b,"busview"," ["+desknets.escapeValue(e.st_busname)+"]")}else{b=desknets.tmpl.replaceWordHtml(b,"bus","");b=desknets.tmpl.replaceWordHtml(b,"busview","")}return b},_viewSearchExec:function(d){var j=this;var g={};var f=j.$mdialog.find(".result");var b=f.find(".res-header ul");var e=f.find("#tab-res-list tbody");var i=f.find(".cost-tab-contents");b.find("li:not(:first)").remove();e.html("");i.html("");b.find("li").addClass("on");j._objSearch.dep_st_name=d.dep_st_name;j._objSearch.dep_st_kbn=d.dep_st_kbn;j._objSearch.dep_st_busname="";if(!!d.dep_st_busname){j._objSearch.dep_st_busname=d.dep_st_busname}j._objSearch.arv_st_name=d.arv_st_name;j._objSearch.arv_st_kbn=d.arv_st_kbn;j._objSearch.arv_st_busname="";if(!!d.arv_st_busname){j._objSearch.arv_st_busname=d.arv_st_busname}if(j.$mdialog.find('input[name="cfp"]:checked').val()=="1"){j._objSearch.ic=true}else{j._objSearch.ic=false}var h=1;for(h=1;h<=4;h++){var c="via"+h;if(!!d[c+"_st_name"]){j._objSearch[c+"_st_name"]=d[c+"_st_name"]}else{j._objSearch[c+"_st_name"]=""}if(!!d[c+"_st_kbn"]){j._objSearch[c+"_st_kbn"]=d[c+"_st_kbn"]}else{j._objSearch[c+"_st_kbn"]=""}if(!!d[c+"_st_busname"]){j._objSearch[c+"_st_busname"]=d[c+"_st_busname"]}else{j._objSearch[c+"_st_busname"]=""}}if(!a.isArray(d.route.item)){d.route.item=[d.route.item]}if(!a.isArray(d.seisan.item)){d.seisan.item=[d.seisan.item]}if(!a.isArray(d.teiki.item)){d.teiki.item=[d.teiki.item]}a.each(d.route.item,function(u,q){var A=u+1;var F=d.seisan.item[u];var D=d.teiki.item[u];var J=null;if(F==""){J=q}else{J=F}var w="";w=j._mresultheader;w=desknets.tmpl.replaceWordHtml(w,"number",A);var x="";var v="";if(J.hayai=="1"){x=j.miconroutename.fast;v="fast"}var z="";var y="";if(J.yasui=="1"){z=j.miconroutename.lowproce;y="lowproce"}var C="";var K="";if(J.raku=="1"){C=j.miconroutename.easy;K="easy"}w=desknets.tmpl.replaceWordHtml(w,"fast",x);w=desknets.tmpl.replaceWordHtml(w,"mind",z);w=desknets.tmpl.replaceWordHtml(w,"ease",C);w=desknets.tmpl.replaceWordHtml(w,"fastclass",v);w=desknets.tmpl.replaceWordHtml(w,"mindclass",y);w=desknets.tmpl.replaceWordHtml(w,"easeclass",K);b.append(w);var G="";w="";var l=true;w=j._mresultdata;w=desknets.tmpl.replaceWordHtml(w,"number",A);if(j.$mdialog.hasClass("cost-mod")){w=desknets.tmpl.replaceWordHtml(w,"costbtn",desknets.Resource.cost.modroute)}else{w=desknets.tmpl.replaceWordHtml(w,"costbtn",desknets.Resource.cost.addroute)}g=j._getLine(j._mcosttemp,q,false);w=desknets.tmpl.replaceWordHtml(w,"costtemp",g.html);l=g.kyori;if(j._stype!="teiki"){if(F!=""){g=j._getLine(j._mcostregular,F,true);w=desknets.tmpl.replaceWordHtml(w,"costregular",g.html);l=g.kyori}else{w=desknets.tmpl.replaceWordHtml(w,"costregular","")}}else{w=desknets.tmpl.replaceWordHtml(w,"costregular","")}var s="";if(l){s=Number(J.kyori)/10;s=s+" km"}var B="";var m=J.hiyou;if(j._objSearch.ic&&J.icExist=="1"){B=desknets.Resource.cost.ic;m=J.icHiyou}var t=j._mresultlist;t=desknets.tmpl.replaceWordHtml(t,"number",A);t=desknets.tmpl.replaceWordHtml(t,"fast",x);t=desknets.tmpl.replaceWordHtml(t,"mind",z);t=desknets.tmpl.replaceWordHtml(t,"ease",C);t=desknets.tmpl.replaceWordHtml(t,"fastclass",v);t=desknets.tmpl.replaceWordHtml(t,"mindclass",y);t=desknets.tmpl.replaceWordHtml(t,"easeclass",K);t=desknets.tmpl.replaceWordHtml(t,"date",j.viewDate(q.fromDate,q.fromTime,q.toDate,q.toTime,""));t=desknets.tmpl.replaceWordHtml(t,"time",j.viewMinute(J.jikan));t=desknets.tmpl.replaceWordHtml(t,"price",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(m,10))));t=desknets.tmpl.replaceWordHtml(t,"ic",B);t=desknets.tmpl.replaceWordHtml(t,"change",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.change,"change",desknets.numberFormat(parseInt(J.norikaeCnt,10))));t=desknets.tmpl.replaceWordHtml(t,"distance",s);e.append(t);if(j._stype=="teiki"){var r="";if(D.meisai!=""){r=j._mcostpass;var o="";var I=0;var H=0;var E=0;var p=false;var n=false;var k=false;if(!a.isArray(D.meisai.item)){D.meisai.item=[D.meisai.item]}a.each(D.meisai.item,function(N,Q){var M=j._mteiki;var L=Q.price1;var P=Q.price3;var O=Q.price6;if(Number(L)<0){L=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price","--")}else{if(L=="0"){L=desknets.cost.miconunder}else{L=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(L,10)));I=I+Number(Q.price1);p=true}}if(Number(P)<0){P=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price","--")}else{if(P=="0"){P=desknets.cost.miconunder}else{P=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(P,10)));H=H+Number(Q.price3);n=true}}if(Number(O)<0){O=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price","--")}else{if(O=="0"){O=desknets.cost.miconunder}else{O=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(O,10)));E=E+Number(Q.price6);k=true}}M=desknets.tmpl.replaceWordHtml(M,"rosen",desknets.tmpl.dispStr(Q.rosen));M=desknets.tmpl.replaceWordHtml(M,"from",desknets.tmpl.dispStr(Q.from));M=desknets.tmpl.replaceWordHtml(M,"to",desknets.tmpl.dispStr(Q.to));M=desknets.tmpl.replaceWordHtml(M,"price1",L);M=desknets.tmpl.replaceWordHtml(M,"price3",P);M=desknets.tmpl.replaceWordHtml(M,"price6",O);o=o+M});G=j._mteikitotal;if(p){I=desknets.numberFormat(parseInt(I,10))}else{I="--"}if(n){H=desknets.numberFormat(parseInt(H,10))}else{H="--"}if(k){E=desknets.numberFormat(parseInt(E,10))}else{E="--"}G=desknets.tmpl.replaceWordHtml(G,"price1",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",I));G=desknets.tmpl.replaceWordHtml(G,"price3",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",H));G=desknets.tmpl.replaceWordHtml(G,"price6",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",E));o=o+G}else{r=j._mcostpassnodata}r=desknets.tmpl.replaceWordHtml(r,"teiki",o);w=desknets.tmpl.replaceWordHtml(w,"costpass",r)}else{w=desknets.tmpl.replaceWordHtml(w,"costpass","")}i.append(w);i.find("#tab-res-list-"+A).find(".cost-check").each(function(L,M){if(j._stype=="teiki"){if(L==1){a(this).hide()}else{if(L==2){a(this).click()}}}else{if(L==0){if(F==""){a(this).click()}}else{if(L==1){if(F!=""){a(this).click()}else{a(this).addClass("disabled")}}else{if(L==2){a(this).hide()}}}}})});f.find("#tab-res-list").show()},_getLine:function(i,u,p){var n=this;var t=true;var d="";var g="";var c="";var o="";var h="";var f="";var m="";var k="";var q="";var l="";var r="";var e="";if(!a.isArray(u.path.item)){k=[u.path.item]}else{k=u.path.item}a.each(k,function(z,A){var x="";var B="";if(z==0){x="start";B=desknets.Resource.cost.departure}r="";if(l!=""){r=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.line,"line",l)+"&nbsp;"+desknets.Resource.cost.arriving}if(A.fromPlatform!=""){if(r!=""){r=r+"<br />"}r=r+desknets.tmpl.replaceWordHtml(desknets.Resource.cost.line,"line",A.fromPlatform)+"&nbsp;"+desknets.Resource.cost.departure}var E=A.lineName;if(E==""){E=A.rosen}var y="";var v=A.untin;var D=A.untintuusan;if(n._objSearch.ic&&A.icExist=="1"){y=desknets.Resource.cost.ic;v=A.icUntin;D=A.icUntintuusan}if(v==0){if(D=="84"){q=desknets.Resource.cost.nothingregular}else{if(Number(D)>=1&&Number(D)<=83){q=desknets.cost.miconunder;y=""}else{q=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(v,10)))}}}else{q=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(v,10)))}if(!p&&c!=""){o='<div title="{{totime}}">{{totime}}</div>';o=desknets.tmpl.replaceWordHtml(o,"totime",desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,c)+"&nbsp;"+desknets.Resource.cost.arriving)}else{o=""}if(!p&&A.mati!=""&&z!=0){f='<span title="{{mati}}">{{mati}}</span>';f=desknets.tmpl.replaceWordHtml(f,"mati","("+desknets.tmpl.replaceWordHtml(desknets.Resource.cost.minute,"minute",desknets.numberFormat(parseInt(A.mati,10)))+")")}else{f=""}e="";if(!p){e='<div title="{{fromtime}}">{{fromtime}}</div>';e=desknets.tmpl.replaceWordHtml(e,"fromtime",desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,A.fromTime)+"&nbsp;"+desknets.Resource.cost.departure)}else{e=""}var C="";var w="";if(n._objSearch.ic&&A.icExist=="1"){w=A.icTokkyu}else{w=A.tokkyu}if(!!w&&w!="0"&&!!A.seatName){C="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;["+desknets.tmpl.dispStr(A.seatName)+'<span class="co-colon-span">:</span>'+desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(w,10)))+"]"}var F=n._mstation;F=desknets.tmpl.replaceWordHtml(F,"class",x);F=desknets.tmpl.replaceWordHtml(F,"totime",o);F=desknets.tmpl.replaceWordHtml(F,"mati",f);F=desknets.tmpl.replaceWordHtml(F,"fromtime",e);F=desknets.tmpl.replaceWordHtml(F,"icon",B);F=desknets.tmpl.replaceWordHtml(F,"station",desknets.tmpl.dispStr(A.from));F=desknets.tmpl.replaceWordHtml(F,"fromtoPlatform",r);if(A.fromExt=="※"){F=desknets.tmpl.replaceWordHtml(F,"fromext","")}else{F=desknets.tmpl.replaceWordHtml(F,"fromext",desknets.tmpl.dispStr(A.fromExt))}F=desknets.tmpl.replaceWordHtml(F,"time",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.minute,"minute",desknets.numberFormat(parseInt(A.jikan,10))));F=desknets.tmpl.replaceWordHtml(F,"connection","");F=desknets.tmpl.replaceWordHtml(F,"lineName",desknets.tmpl.dispStr(E));F=desknets.tmpl.replaceWordHtml(F,"ic",y);F=desknets.tmpl.replaceWordHtml(F,"price",q);F=desknets.tmpl.replaceWordHtml(F,"josyaText",A.josyaText);F=desknets.tmpl.replaceWordHtml(F,"tokkyu",C);F=desknets.tmpl.replaceWordHtml(F,"between",A.rosensyubetu);F=desknets.tmpl.replaceWordHtml(F,"betweenname",n.mbetweenname[A.rosensyubetu]);g=A.to;c=A.toTime;l=A.toPlatform;d=d+F;if(t){if(A.rosenCorp=="高速Ｂ"||A.rosenCorp=="連絡Ｂ"||A.rosenCorp=="航路"){t=false}}});r="";if(l!=""){r=desknets.tmpl.replaceWordHtml(desknets.Resource.cost.line,"line",l)+"&nbsp;"+desknets.Resource.cost.arriving}if(!p&&c!=""){o=desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,c)+"&nbsp;"+desknets.Resource.cost.arriving}else{o=""}m=n._mstationgoal;m=desknets.tmpl.replaceWordHtml(m,"station",desknets.tmpl.dispStr(g));m=desknets.tmpl.replaceWordHtml(m,"totime",o);m=desknets.tmpl.replaceWordHtml(m,"icon",desknets.Resource.cost.arriving);m=desknets.tmpl.replaceWordHtml(m,"fromtoPlatform",r);d=d+m;var j="";var b=u.hiyou;if(n._objSearch.ic&&u.icExist=="1"){j=desknets.Resource.cost.ic;b=u.icHiyou}var s="";if(t){s=Number(u.kyori)/10;s=s+" km"}if(p){i=desknets.tmpl.replaceWordHtml(i,"date","")}else{i=desknets.tmpl.replaceWordHtml(i,"date",n.viewDate(u.fromDate,u.fromTime,u.toDate,u.toTime,"dayview"))}i=desknets.tmpl.replaceWordHtml(i,"time",n.viewMinute(u.jikan));i=desknets.tmpl.replaceWordHtml(i,"price",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(b,10))));i=desknets.tmpl.replaceWordHtml(i,"priceset",b);i=desknets.tmpl.replaceWordHtml(i,"ic",j);i=desknets.tmpl.replaceWordHtml(i,"change",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.change,"change",desknets.numberFormat(parseInt(u.norikaeCnt,10))));i=desknets.tmpl.replaceWordHtml(i,"distance",s);i=desknets.tmpl.replaceWordHtml(i,"details",d);return{html:i,kyori:t}},getIconConnect:function(){var b=this;b.$mdialog.find(".jcost-icon-connect").each(function(){var c=a(this);b.mbetweenname[desknets.getDataAttr(c,"id")]=c.text()})},getHistory:function(){var b=this;desknets.ajax.rest({url:desknets.cost.getUrl(),data:{cmd:b.mobjcmd.history},success:function(d,c,e){b.getHistorySet(d)},})},getHistorySet:function(c){var b=this;var d=desknets.ajax.getJsonItems(c);b._mHistory="";a.each(d,function(f,g){var e='<li class="co-combox-item hasDel" data-id="{{id}}" data-kbn="{{st_kbn}}" data-bus="{{st_busname}}"><a href="#" class="co-combox-del" title="{{del}}">x</a><span>{{st_name}}</span></li>';e=desknets.tmpl.replaceWordHtml(e,"del",desknets.Resource.delLabel);e=desknets.tmpl.replaceWordHtml(e,"id",desknets.escapeValue(g.id));e=desknets.tmpl.replaceWordHtml(e,"st_name",desknets.tmpl.dispStr(g.st_name));e=desknets.tmpl.replaceWordHtml(e,"st_kbn",desknets.escapeValue(g.st_kbn));e=desknets.tmpl.replaceWordHtml(e,"st_busname",desknets.escapeValue(g.st_busname));b._mHistory=b._mHistory+e});b._setHistory()},_setHistory:function(){var b=this;b.$mdialog.find(".co-combox-list").html(b._mHistory);b._setHistoryEvent()},_setHistoryEvent:function(){var b=this;var d=b.$mdialog.find(".search-main");var c=d.find(".list-route").find(".cost-combox-arrow");if(b._mHistory==""){c.removeClass("co-drop-down-button")}else{c.addClass("co-drop-down-button")}},delHistory:function(e){var b=this;var c={};c["0"]={cmd:"costcmddelsrchhist",id:e};c["1"]={cmd:b.mobjcmd.history};var d=desknets.ajax.arrayToMultiCmdData(c);desknets.ajax.rest({url:desknets.cost.getUrl(),data:d,success:function(g,f,h){if(g["1"]["status"]=="ok"){b.getHistorySet(g["1"])}},})},setSearchHist:function(){var c=this;var d={};var g=0;d[g]={cmd:"costcmdentrysrchhist",st_name:c._objSearch.dep_st_name,st_kbn:c._objSearch.dep_st_kbn,st_busname:c._objSearch.dep_st_busname,old:"1"};g++;var b=1;for(b=1;b<=4;b++){var f="via"+b;if(!!c._objSearch[f+"_st_name"]){d[g]={cmd:"costcmdentrysrchhist",st_name:c._objSearch[f+"_st_name"],st_kbn:c._objSearch[f+"_st_kbn"],st_busname:c._objSearch[f+"_st_busname"],old:"1"};g++}}d[g]={cmd:"costcmdentrysrchhist",st_name:c._objSearch.arv_st_name,st_kbn:c._objSearch.arv_st_kbn,st_busname:c._objSearch.arv_st_busname};g++;d[g]={cmd:c.mobjcmd.history};var e=desknets.ajax.arrayToMultiCmdData(d);desknets.ajax.rest({url:desknets.cost.getUrl(),data:e,success:function(i,h,j){if(i[g]["status"]=="ok"){c.getHistorySet(i[g])}},})},viewDate:function(c,e,b,f,d){if(c==b){if(d=="dayview"){return desknets.dateTime.dispDateTime(c,"dateFormat_mmdd")+" "+desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,e)+" - "+desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,f)}else{return desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,e)+" - "+desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,f)}}if(d=="dayview"){return desknets.dateTime.dispDateTime(c,"dateFormat_mmdd")+" "+desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,e)+" - "+desknets.dateTime.dispDateTime(b,"dateFormat_mmdd")+" "+desknets.dateTime.formatHour(desknets.Resource.shortTimeFormat,f)}return desknets.dateTime.dispDateTime(c+e,{type:"list"})+" - "+desknets.dateTime.dispDateTime(b+f,{type:"list"})},viewMinute:function(f){var b="";var e=Number(f);var d=e%60;var c=(e-d)/60;if(c>0&&d>0){b=desknets.Resource.cost.hourminute}else{if(c>0&&d==0){b=desknets.Resource.cost.hour}else{b=desknets.Resource.cost.minute}}b=desknets.tmpl.replaceWordHtml(b,"hour",c);b=desknets.tmpl.replaceWordHtml(b,"minute",d);return b},};desknets.cost.input={$mdialog:null,_$line:null,_monComplete:null,slisttmpltran:'<li class="item-auto {{class}} jcost-transportation" data-id="{{id}}" data-amount="{{amount}}"data-dep_st_name="{{dep_st_name}}" data-dep_st_kbn="{{dep_st_kbn}}" data-dep_st_busname="{{dep_st_busname}}" data-arv_st_name="{{arv_st_name}}"  data-arv_st_kbn="{{arv_st_kbn}}" data-arv_st_busname="{{arv_st_busname}}"><a href="#" class="del" title="'+desknets.Resource.delLabel+'"></a><div class="name">{{acc_nameview}}</div><div class="comment">{{memoview}}</div><div class="price">{{amountview}}</div></li>',slisttmpl:'<li class="item-man jcost-expense" data-id="{{id}}" data-amount="{{amount}}" data-sid_acc="{{sid_acc}}" data-file="{{file}}" data-acc_name="{{acc_name}}" data-memo="{{memo}}"><a href="#" class="del" title="'+desknets.Resource.delLabel+'"></a><div class="name">{{acc_nameview}}</div><div class="comment {{file}}">{{memoview}}</div><div class="price">{{amountview}}</div></li>',_midetailid:0,_micostid:0,_mtime:"",_mbosch:false,open:function(c){var b=this;if(typeof(c.oncomplete)=="function"){b._monComplete=c.oncomplete}else{b._monComplete=null}if(b.$mdialog==null){b._makeDialog(c)}else{b._setOpen(c)}},_setOpen:function(c){var b=this;b._delAllDetail();if(!c.data.id){b._micostid--;c.data.id=b._micostid;if(c.boMulti!==true){desknets.cost.costDelTmpAtt()}}else{if(c.boMulti!==true){desknets.cost.costDelCopyTmpAtt(c.data.id)}}b.$mdialog.find('input[name="id"]').val(c.data.id);if(Number(c.data.id)<0){b.$mdialog.parent("div").find(".ui-dialog-title").text(desknets.Resource.cost.title_input_add)}else{b.$mdialog.parent("div").find(".ui-dialog-title").text(desknets.Resource.cost.title_input_mod)}if(c.boMulti===true){b.$mdialog.parent("div").find(".ui-dialog-buttonset").find(".cost-btn").eq(1).text(desknets.Resource.OKButtonLabel)}else{if(Number(c.data.id)<0){b.$mdialog.parent("div").find(".ui-dialog-buttonset").find(".cost-btn").eq(1).text(desknets.Resource.addLabel)}else{b.$mdialog.parent("div").find(".ui-dialog-buttonset").find(".cost-btn").eq(1).text(desknets.Resource.modLabel)}}b.$mdialog.find(".co-datepicker").datepicker("setDate",neo.dateTime.parse(c.data.seldate));desknets.cost.cleanDate(b.$mdialog.find(".co-datepicker"));b.$mdialog.find('input[name="title"]').val(c.data.title);var d=b.$mdialog.find(".cost-list-cost .jcost-list-data");if(!a.isArray(c.data.meisai.item)){c.data.meisai.item=[c.data.meisai.item]}a.each(c.data.meisai.item,function(f,g){var e="";if(!!g.dep_st_name){e=b.getLineTransportation(g)}else{e=b.getLineExpense(g)}d.append(e)});b._chgCostTotal();if(b.$mdialog.find(".cost-list-cost .jcost-list-data").find("li").length==0){b.$mdialog.closest(".cost-pop").find(".cost-btn-del").hide()}else{b.$mdialog.closest(".cost-pop").find(".cost-btn-del").show()}b._mtime=c.starttime;if(c.bosch===true){b._mbosch=true}else{b._mbosch=false}b.$mdialog.dialog("open")},_makeDialog:function(c){var b=this;var d=function(){b.$mdialog=a("#cost-input");var e=b._getDialogOptions();b.$mdialog=desknets.dialog.setUp(b.$mdialog,e);b._setUpDialog(c);b._setOpen(c)};a("body").append('<div id="cost-input"></div>');desknets.tmpl.load(a("#cost-input"),"cost/costinput.html",d)},_setUpDialog:function(d){var b=this;var c=function(e){b.$mdialog.find(".cost-hplink").attr("href",e)};desknets.cost.getSetting(null,c);desknets.htmlparts.setUpForm(b.$mdialog.find("form"));b.$mdialog.on("click",".jcost-transportation",function(e){e.preventDefault();var f=a(e.target);if(f.hasClass("del")){a(this).closest("li").remove();b._chgCostTotal();return}if(f.hasClass("cost-err-detail")){desknets.dialog.alert(f.find('input[name="errmsg"]').val(),{type:"warn"})}else{if(a(this).hasClass("cost-btn")){if(!b._chkAddDetail()){return}}b._openTransportationDialog(a(this))}});b.$mdialog.on("click",".jcost-expense",function(e){e.preventDefault();if(a(e.target).hasClass("del")){a(this).closest("li").remove();b._chgCostTotal();return}if(a(this).hasClass("cost-btn")){if(!b._chkAddDetail()){return}}b._openExpenseDialog(a(this))});b.$mdialog.find(".jcost-del").click(function(f){f.preventDefault();var e=desknets.dialog.confirm(desknets.Resource.cost.cost_detailalldel_conf,function(){b._delAllDetail();b._chgCostTotal()})})},_getDialogOptions:function(){var b=this;var c=desknets.dialog.getDialogOption();var d={};d=[{text:desknets.Resource.delLabel,"class":"cost-btn cost-btn-del",click:function(){var e=desknets.dialog.confirm(desknets.Resource.Message.com_del_conf,function(){b._delAllDetail();b._execOkClick()})}},{text:desknets.Resource.OKButtonLabel,"class":"cost-btn",click:function(){if(b._confOkClick()){b._confOkClickAjaxChk()}}},{text:desknets.Resource.CancelButtonLabel,"class":"cost-btn cost-btn-2",click:function(){a(this).dialog("close")}}];c.title=desknets.Resource.cost.title_input;c.dialogClass="dn-dialog cost cost-pop";c.width=700;c.buttons=d;return c},_chkAddDetail:function(){var b=this;if(b.$mdialog.find(".cost-list-cost .jcost-list-data").find("li").length>=desknets.cost.midetailmaxcnt){desknets.dialog.alert(desknets.tmpl.replaceWordHtml(desknets.Resource.cost.cost_notadddetail,"count",desknets.cost.midetailmaxcnt),{});return false}return true},_delAllDetail:function(){var b=this;b.$mdialog.find(".cost-list-cost .jcost-list-data").find("li").remove()},_confOkClick:function(){var b=this;if(b.$mdialog.find(".cost-list-cost .jcost-list-data").find("li").length==0){desknets.dialog.alert(desknets.Resource.cost.cost_input_no_data,{});return false}return true},_confOkClickAjaxChk:function(){var b=this;var d=null;d=desknets.cost.getDateErrorMessage(b.$mdialog.find(".jco-input-seldate"));if(!!d){desknets.dialog.alert(d,{});return}var c={};c.cmd="costcmdentrychk";c.seldate=b.$mdialog.find('input[name="seldate"]').val();c.title=b.$mdialog.find('input[name="title"]').val();c.total_amount=desknets.getDataAttr(b.$mdialog.find(".cost-total strong"),"price");desknets.ajax.rest({url:desknets.cost.getUrl(),data:c,error:function(i,e,g){var j=g;var f=a.parseJSON(i.responseText);if(!!f.errmsgadd){var h={};h.msg=f.errormessage;h.fieldid=f.errmsgadd;h.fieldname=desknets.getErrFieName(b.$mdialog,h.fieldid);j=desknets.getErrConvMsg(h)}desknets.ajax.onError(i.status,j)},success:function(f,e,g){b._execOkClick()},})},_execOkClick:function(){var c=this;var b={};b.meisai={};b.meisai.item=[];b.id=c.$mdialog.find('input[name="id"]').val();b.seldate=c.$mdialog.find('input[name="seldate"]').val();b.title=c.$mdialog.find('input[name="title"]').val();b.total_amount=desknets.getDataAttr(c.$mdialog.find(".cost-total strong"),"price");c.$mdialog.find(".cost-list-cost .jcost-list-data").find("li").each(function(){var e={};var d=a(this);e.id=desknets.getDataAttr(d,"id");e.amount=desknets.getDataAttr(d,"amount");var f=desknets.getDataAttr(d,"dep_st_name");if(!!f){e.dtype="1";e.dep_st_name=desknets.getDataAttr(d,"dep_st_name");e.dep_st_kbn=desknets.getDataAttr(d,"dep_st_kbn");e.dep_st_busname=desknets.getDataAttr(d,"dep_st_busname");e.arv_st_name=desknets.getDataAttr(d,"arv_st_name");e.arv_st_kbn=desknets.getDataAttr(d,"arv_st_kbn");e.arv_st_busname=desknets.getDataAttr(d,"arv_st_busname");e.sid_acc="";e.acc_name=desknets.Resource.cost.cost;e.memo="";e.attach=""}else{e.dtype="2";e.dep_st_name="";e.dep_st_kbn="";e.dep_st_busname="";e.arv_st_name="";e.arv_st_kbn="";e.arv_st_busname="";e.sid_acc=desknets.getDataAttr(d,"sid_acc");e.acc_name=desknets.getDataAttr(d,"acc_name");e.memo=desknets.getDataAttr(d,"memo");e.attach=desknets.getDataAttr(d,"file")}b.meisai.item[b.meisai.item.length]=e});if(typeof(c._monComplete)=="function"){c._monComplete(b,c.$mdialog)}else{c.$mdialog.dialog("close")}},_chgCostTotal:function(){var b=this;var d=0;var e=false;b.$mdialog.find(".cost-list-cost .jcost-list-data").find("li").each(function(){d=d+Number(desknets.getDataAttr(a(this),"amount"));e=true});var c=b.$mdialog.find(".cost-total strong");if(e){desknets.setDataAttr(c,"price",d);c.html(desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(d,10))));b.$mdialog.find(".co-table-list.nodata").hide();b.$mdialog.find(".co-table-list-scroll").show()}else{c.html(desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price","--"));b.$mdialog.find(".co-table-list.nodata").show();b.$mdialog.find(".co-table-list-scroll").hide()}},_openTransportationDialog:function(g){var j=this;var c={oncomplete:function(k){j._makeTransportationOk(k)},};c.data={};if(!g.hasClass("cost-btn")){j._$line=g;c.data["dep_st_name"]=desknets.getDataAttr(g,"dep_st_name");c.data["dep_st_kbn"]=desknets.getDataAttr(g,"dep_st_kbn");c.data["dep_st_busname"]=desknets.getDataAttr(g,"dep_st_busname");c.data["arv_st_name"]=desknets.getDataAttr(g,"arv_st_name");c.data["arv_st_kbn"]=desknets.getDataAttr(g,"arv_st_kbn");c.data["arv_st_busname"]=desknets.getDataAttr(g,"arv_st_busname");c.title=desknets.Resource.cost.title_cost_mod;c.mod=true}else{j._$line=null;c.title=desknets.Resource.cost.title_cost_add;c.mod=false}var i=j.$mdialog.find('input[name="seldate"]').val();var d="";var h="";if(!!j._mtime&&j._mtime.length==4){d=j._mtime.substring(0,2);h=j._mtime.substring(2,4)}var b=null;if(!!i){var e=i.split("-");if(!!d){b=new Date(e[0],Number(e[1])-1,e[2],d,h)}else{var f=new Date();b=new Date(e[0],Number(e[1])-1,e[2],f.getHours(),f.getMinutes())}}else{b=new Date()}c.setdatetime=b;c.bosch=j._mbosch;desknets.cost.search.open(c)},_makeTransportationOk:function(b){var d=this;if(d._$line==null){var c=d.getLineTransportation(b);d.$mdialog.find(".cost-list-cost .jcost-list-data").append(c)}else{var e=d._$line;desknets.setDataAttr(e,"dep_st_name",b.dep_st_name);desknets.setDataAttr(e,"dep_st_kbn",b.dep_st_kbn);desknets.setDataAttr(e,"dep_st_busname",b.dep_st_busname);desknets.setDataAttr(e,"arv_st_name",b.arv_st_name);desknets.setDataAttr(e,"arv_st_kbn",b.arv_st_kbn);desknets.setDataAttr(e,"arv_st_busname",b.arv_st_busname);desknets.setDataAttr(e,"amount",b.amount);e.find(".comment").html(desknets.tmpl.dispStr(b.dep_st_name)+" - "+desknets.tmpl.dispStr(b.arv_st_name));if(!!b.amount){e.removeClass("unsearched");e.find(".price").html(desknets.numberFormat(parseInt(b.amount,10)))}else{e.addClass("unsearched");e.find(".price").html(desknets.Resource.cost.nosearch)}}d._chgCostTotal()},getLineTransportation:function(f){var c=this;var b="";b=c.slisttmpltran;var g="";if(!!f.id){g=desknets.escapeValue(f.id)}var d="unsearched";var e=desknets.Resource.cost.nosearch;if(!!f.amount){d="";e=desknets.numberFormat(parseInt(f.amount,10))}else{if(!!f.status_code){e='<a class="co-msg-r cost-err-detail" href="#">'+desknets.Resource.cost.searcherr+'<input type="hidden" name="errmsg" value="'+desknets.tmpl.dispStr(f.status_codemsg)+'"></a>'}}b=desknets.tmpl.replaceWordHtml(b,"id",g);b=desknets.tmpl.replaceWordHtml(b,"amount",f.amount);b=desknets.tmpl.replaceWordHtml(b,"class",d);b=desknets.tmpl.replaceWordHtml(b,"amountview",e);b=desknets.tmpl.replaceWordHtml(b,"acc_name",desknets.escapeValue(f.acc_name));b=desknets.tmpl.replaceWordHtml(b,"acc_nameview",desknets.tmpl.dispStr(f.acc_name));b=desknets.tmpl.replaceWordHtml(b,"dep_st_name",desknets.escapeValue(f.dep_st_name));b=desknets.tmpl.replaceWordHtml(b,"dep_st_kbn",desknets.escapeValue(f.dep_st_kbn));b=desknets.tmpl.replaceWordHtml(b,"dep_st_busname",desknets.escapeValue(f.dep_st_busname));b=desknets.tmpl.replaceWordHtml(b,"arv_st_name",desknets.escapeValue(f.arv_st_name));b=desknets.tmpl.replaceWordHtml(b,"arv_st_kbn",desknets.escapeValue(f.arv_st_kbn));b=desknets.tmpl.replaceWordHtml(b,"arv_st_busname",desknets.escapeValue(f.arv_st_busname));b=desknets.tmpl.replaceWordHtml(b,"memoview",desknets.tmpl.dispStr(f.dep_st_name)+" - "+desknets.tmpl.dispStr(f.arv_st_name));return b},_openExpenseDialog:function(d){var b=this;var c={oncomplete:function(e){b._makeExpenseDialogOk(e)},};c.data={};if(!d.hasClass("cost-btn")){b._$line=d;c.data["costid"]=b.$mdialog.find('input[name="id"]').val();c.data["id"]=desknets.getDataAttr(d,"id");c.data["attach"]=desknets.getDataAttr(d,"file");c.data["acc_name"]=desknets.getDataAttr(d,"acc_name");c.data["memo"]=desknets.getDataAttr(d,"memo");c.data["amount"]=desknets.getDataAttr(d,"amount");c.data["sid_acc"]=desknets.getDataAttr(d,"sid_acc")}else{b._$line=null;b._midetailid--;c.data["costid"]=b.$mdialog.find('input[name="id"]').val();c.data["id"]=b._midetailid;c.data["attach"]="";c.data["acc_name"]="";c.data["memo"]="";c.data["amount"]="";c.data["sid_acc"]=""}desknets.cost.inputexp.open(c)},_makeExpenseDialogOk:function(b){var d=this;if(d._$line==null){var c=d.getLineExpense(b);d.$mdialog.find(".cost-list-cost .jcost-list-data").append(c)}else{var e=d._$line;desknets.setDataAttr(e,"id",b.id);desknets.setDataAttr(e,"sid_acc",b.sid_acc);if(b.attachdel=="1"){desknets.setDataAttr(e,"file","");e.find(".comment").removeClass("hasFile")}if(b.attach=="1"){desknets.setDataAttr(e,"file","hasFile");e.find(".comment").addClass("hasFile")}desknets.setDataAttr(e,"acc_name",b.acc_name);desknets.setDataAttr(e,"memo",b.memo);desknets.setDataAttr(e,"amount",b.amount);e.find(".name").html(desknets.tmpl.dispStr(b.acc_name));e.find(".comment").html(desknets.tmpl.dispStr(b.memo));e.find(".price").html(desknets.numberFormat(parseInt(b.amount,10)))}d._chgCostTotal()},getLineExpense:function(d){var c=this;var b="";b=c.slisttmpl;if(!!d.attach){b=desknets.tmpl.replaceWordHtml(b,"file","hasFile")}else{b=desknets.tmpl.replaceWordHtml(b,"file","")}b=desknets.tmpl.replaceWordHtml(b,"sid_acc",d.sid_acc);b=desknets.tmpl.replaceWordHtml(b,"memo",desknets.escapeValue(d.memo));b=desknets.tmpl.replaceWordHtml(b,"memoview",desknets.tmpl.dispStr(d.memo));b=desknets.tmpl.replaceWordHtml(b,"acc_name",desknets.escapeValue(d.acc_name));b=desknets.tmpl.replaceWordHtml(b,"acc_nameview",desknets.tmpl.dispStr(d.acc_name));b=desknets.tmpl.replaceWordHtml(b,"id",desknets.escapeValue(d.id));b=desknets.tmpl.replaceWordHtml(b,"amount",d.amount);b=desknets.tmpl.replaceWordHtml(b,"amountview",desknets.numberFormat(parseInt(d.amount,10)));return b},};desknets.cost.inputexp={mformurl:"",mobjcmd:{expensepull:"costcmdaccindex",expensefiledel:"costcmddelattach",},_monComplete:null,$mdialog:null,mpricechg:"",open:function(c){var b=this;b.mformurl="zrcost."+desknets.getExtension();if(typeof(c.oncomplete)=="function"){b._monComplete=c.oncomplete}else{b._monComplete=null}if(b.$mdialog==null){b._makeDialog(c)}else{b._setOpen(c)}},_setOpen:function(d){var b=this;b._setOpenDialog(d);b.$mdialog.find(".jcost-cost-id").val(d.data.costid);b.$mdialog.find(".jcost-expense-id").val(d.data.id);if(Number(d.data.id)>0){b.$mdialog.find('input[name="id"]').val(d.data.id)}else{b.$mdialog.find('input[name="id"]').val("")}var h=b.$mdialog.find(".jcost-expense-name");h.val(d.data.acc_name);desknets.setDataAttr(h,"id",d.data.sid_acc);var f=b.$mdialog.find(".co-combox-list");f.find(".co-combox-item").removeClass("on");if(!!d.data.sid_acc){f.find(".co-combox-item").each(function(){var i=a(this);if(desknets.getDataAttr(i,"id")==d.data.sid_acc){i.addClass("on");return false}})}b.$mdialog.find(".jcost-expense-comment").val(d.data.memo);b.$mdialog.find(".jcost-expense-price").val(d.data.amount);b.$mdialog.find(".jcost-expense-filechk").attr("checked",false);b.$mdialog.find(".jcost-file").html('<input type="file" name="attach" size="40">');if(!!d.data.attach){var c=b.$mdialog.find(".co-image-box.edit");c.show();var g=desknets.getUrl("zcost");g=g+"?cmd=costdispattach&fno=1&costid="+d.data.costid+"&detailid="+d.data.id+"&id=";if(Number(d.data.id)>0){g=g+d.data.id}var e=new Date().getTime();g=g+"&"+e;c.find("a").attr("href",g);c.find("img").attr("src",g);b.$mdialog.find(".uset-entry-image-edit").find("label").show();b.$mdialog.find(".dn-image-del-guide").show()}else{b.$mdialog.find(".co-image-box.edit").hide();b.$mdialog.find(".uset-entry-image-edit").find("label").hide();b.$mdialog.find(".dn-image-del-guide").hide()}b.$mdialog.dialog("open")},_setOpenDialog:function(c){var b=this;var f=b.$mdialog.parent("div");var e=f.find(".ui-dialog-title");var d=f.find(".ui-dialog-buttonset").find(".cost-btn");if(!!c.data.acc_name){e.text(desknets.Resource.cost.title_expenses_mod);d.eq(0).text(desknets.Resource.modLabel)}else{e.text(desknets.Resource.cost.title_expenses_add);d.eq(0).text(desknets.Resource.addLabel)}},_makeDialog:function(c){var b=this;var d=function(){b.$mdialog=a("#cost-input-exp");var e=b._getDialogOptions();b.$mdialog=desknets.dialog.setUp(b.$mdialog,e);desknets.submitform.setEnterSubmit(b.$mdialog);b._setUpDialog(c);b._setOpen(c)};a("body").append('<div id="cost-input-exp"></div>');desknets.tmpl.load(a("#cost-input-exp"),"cost/costinputexp.html",d)},_setUpDialog:function(c){var b=this;b._initPull();b.$mdialog.find(".cost-combox-arrow").click(function(){var d=a(this);var e=a(this).closest("div");e.find(".co-combox-text").focus();desknets.cost.setComboxSize(a(this))});b._initFormRequestAjax()},_getDialogOptions:function(){var b=this;var c=desknets.dialog.getDialogOption();c.width=650;c.title=desknets.Resource.cost.title_expenses_add;c.dialogClass=c.dialogClass+" cost cost-pop";c.buttons=[{text:desknets.Resource.OKButtonLabel,"class":"cost-btn",click:function(){b.mpricechg=b.chgHalfNumber(b.$mdialog.find(".jcost-expense-price").val());if(!b._saveExpenseChk()){return}var e=b.$mdialog.find(".jcost-expense-name");var d={cmd:"costcmdentrychkdetail",dtype:"2",acc_name:e.val(),sid_acc:desknets.getDataAttr(e,"id"),memo:b.$mdialog.find(".jcost-expense-comment").val(),amount:b.mpricechg};desknets.ajax.rest({url:desknets.cost.getUrl(),data:d,error:function(j,f,h){var k=h;var g=a.parseJSON(j.responseText);if(!!g.errmsgadd){var i={};i.msg=g.errormessage;i.fieldid=g.errmsgadd;i.fieldname=desknets.getErrFieName(b.$mdialog,i.fieldid);k=desknets.getErrConvMsg(i)}desknets.ajax.onError(j.status,k)},success:function(g,f,h){b._saveExpenseClick()},})}},{text:desknets.Resource.cancelLabel,"class":"cost-btn cost-btn-2",click:function(){b.$mdialog.dialog("close")}}];return c},_initPull:function(){var b=this;desknets.ajax.rest({url:desknets.cost.getUrl(),data:{cmd:b.mobjcmd.expensepull},success:function(f,e,h){var j=desknets.ajax.getJsonItems(f);var d="";a.each(j,function(k,m){var l="";if(!!m.code){l=" ("+desknets.tmpl.dispStr(m.code)+")"}d=d+'<li class="co-combox-item cost-combox-'+m.id+'" data-id="'+m.id+'" data-note="'+desknets.escapeValue(m.memo)+'"><span>'+desknets.tmpl.dispStr(m.Name)+"</span>"+l+"</li>"});var g=b.$mdialog.find(".co-combox-list");if(d==""){b.$mdialog.find(".cost-combox-arrow").removeClass("co-drop-down-button");g.hide()}else{b.$mdialog.find(".cost-combox-arrow").addClass("co-drop-down-button")}g.html(d);g.attr("id","jcost-combox-list");var i=b.$mdialog.find(".jcost-expense-name");i.change(function(){var k=a(this);desknets.setDataAttr(i,"id","");g.find(".co-combox-item").removeClass("on")});g.find(".co-combox-item").click(function(){var k=a(this);i.val(k.find("span").text());g.find(".co-combox-item").removeClass("on");k.addClass("on");desknets.setDataAttr(i,"id",desknets.getDataAttr(k,"id"));desknets.popUp.hide(a(this))});var c=a('<div class="co-combox-note"></div>');if(!desknets.browser.tablet){g.on("hover",".co-combox-item",function(l){var k=desknets.getDataAttr(a(this),"note");if(!!k){if(l.type==="mouseenter"){c.html(desknets.tmpl.dispStr(k)).css({top:l.pageY,left:l.pageX}).appendTo(a("body"))}else{if(l.type==="mouseleave"){c.remove()}}}else{c.remove()}}).on("mousemove",".co-combox-item",function(k){c.css({top:k.pageY,left:k.pageX})})}},})},_initFormRequestAjax:function(){var b=this;var c={};var d=b.$mdialog.find('form[name="inputcostfrm"]');d.attr("action",b.mformurl);c={dataType:"xml",success:function(f,e,g){b._onComplete()},};desknets.ajax.submitForm(d,c);b.$mdialog.find('input[type="submit"]').hide()},_saveExpenseChk:function(){var b=this;if(!desknets.validation.isNumber(b.mpricechg)){var c={};c.fieldid="price";c.fieldname=b.$mdialog.find(".jcost-expense-price-title").text()+desknets.merrMsgConnect;c.msg=desknets.Resource.Message.com_invalid_number;desknets.dialog.alert(desknets.getErrConvMsg(c));return false}return true},_saveExpenseClick:function(){var b=this;if(b.$mdialog.find(".jcost-expense-filechk").attr("checked")||(!!b.$mdialog.find('input[name="attach"]').val()&&b.$mdialog.find(".uset-entry-image-edit").find("label").css("display")!="none")){var c={cmd:b.mobjcmd.expensefiledel,costid:b.$mdialog.find(".jcost-cost-id").val(),detailid:b.$mdialog.find(".jcost-expense-id").val(),fno:"1"};if(Number(c.detailid)>0){c.id=c.detailid}desknets.ajax.rest({url:desknets.cost.getUrl(),data:c,success:function(e,d,f){if(!!b.$mdialog.find('input[name="attach"]').val()){b.$mdialog.find('input[type="submit"]').submit()}else{b._onComplete()}},})}else{if(!!b.$mdialog.find('input[name="attach"]').val()){b.$mdialog.find('input[type="submit"]').submit()}else{b._onComplete()}}},_onComplete:function(){var c=this;var b={};var d=c.$mdialog.find(".jcost-expense-name");b.id=c.$mdialog.find(".jcost-expense-id").val();b.acc_name=d.val();b.sid_acc=desknets.getDataAttr(d,"id");b.memo=c.$mdialog.find(".jcost-expense-comment").val();b.amount=c.mpricechg;b.attach="";if(!!c.$mdialog.find(".jcost-expense-file").find('input[name="attach"]').val()){b.attach="1"}b.attachdel="";if(c.$mdialog.find(".jcost-expense-filechk").attr("checked")){b.attachdel="1"}if(typeof(c._monComplete)=="function"){c._monComplete(b)}c.$mdialog.dialog("close")},chgHalfNumber:function(c){var b=String(c).replace(/[０-９]/g,function(d){return String.fromCharCode(d.charCodeAt(0)-65248)});return b},};desknets.cost.inputsel={_monComplete:null,$mdialog:null,open:function(c){var b=this;if(typeof(c.oncomplete)=="function"){b._monComplete=c.oncomplete}else{b._monComplete=null}if(b.$mdialog==null){b._makeDialog(c)}else{b._setOpen(c)}},_setOpen:function(d){var c=this;var b="";a.each(d.data.list,function(e,h){var g='<tr class="item-sum" data-id="{{id}}"><td class="fulldate">{{seldate}}</td><td title="{{title}}">{{titleview}}</td><td class="co-td-num price">{{total_amount}}</td></tr>';g=desknets.tmpl.replaceWordHtml(g,"id",desknets.escapeValue(h.id));var f=neo.dateTime.format(desknets.Resource.longDateFormat,neo.dateTime.parse(h.seldate));g=desknets.tmpl.replaceWordHtml(g,"seldate",f);g=desknets.tmpl.replaceWordHtml(g,"title",desknets.escapeValue(h.title));g=desknets.tmpl.replaceWord(g,"titleview",h.title);g=desknets.tmpl.replaceWordHtml(g,"total_amount",desknets.numberFormat(parseInt(h.total_amount,10)));b=b+g});c.$mdialog.find("tbody").html(b);c.$mdialog.dialog("open")},_makeDialog:function(c){var b=this;var d=function(){b.$mdialog=a("#cost-input-sel");var e=b._getDialogOptions();b.$mdialog=desknets.dialog.setUp(b.$mdialog,e);b._setUpDialog(c);b._setOpen(c)};a("body").append('<div id="cost-input-sel"></div>');desknets.tmpl.load(a("#cost-input-sel"),"cost/costsel.html",d)},_setUpDialog:function(c){var b=this;b.$mdialog.find("tbody").on("click","tr",function(d){d.preventDefault();if(typeof(b._monComplete)=="function"){b._monComplete(desknets.getDataAttr(a(this),"id"),b.$mdialog)}})},_getDialogOptions:function(){var b=this;var c=desknets.dialog.getDialogOption();var d={};d=[{text:desknets.Resource.closeLabel,"class":"cost-btn cost-btn-2",click:function(){a(this).dialog("close")}}];c.title=desknets.Resource.cost.title_inputsel;c.dialogClass="dn-dialog cost cost-pop";c.width=400;c.buttons=d;return c},};desknets.cost.list={$mdialog:null,_mlistdate:'<tr><td class="date {{class}}"><small>{{date1}}</small>{{date2}}</td><td>{{data}}</td></tr>',_mlistdata:'<ul data-id="{{id}}"><li class="item-sum"><div class="name">{{name}}</div><div class="price">{{price}}</div></li>{{detail}}</ul>',_mlistdetail:'<li class="{{class}} {{classamount}}"><div class="name">{{name}}</div><div class="comment {{attach}}">{{comment}}</div><div class="price">{{price}}</div></li>',_mattach:'<table class="cost-list-file"><tbody><tr>{{th}}</tr><tr>{{td}}</tr></tbody></table>',_mattachth:'<th><div class="date">{{date}}</div><div class="cost-list-file-detail"><table><tbody><tr><th><span class="co-colon">'+desknets.Resource.cost.title+'</span></th><td>{{name}}</td></tr><tr><th><span class="co-colon">'+desknets.Resource.cost.subject+'</span></th><td>{{subject}}</td></tr><tr><th><span class="co-colon">'+desknets.Resource.cost.commnt+'</span></th><td>{{commnt}}</td></tr><tr><th><span class="co-colon">'+desknets.Resource.cost.pricelabel+"</span></th><td>{{price}}</td></tr></tbody></table></div></th>",_mattachtd:'<td><img src="{{url}}?cmd=costdispattach&id={{id}}&costid={{costid}}&detailid={{id}}&fno=1&filename={{filename}}"></td>',_mtotal:0,_mmonthold:"",_msdate:"",_medata:"",open:function(){var b=this;desknets.cost.misListOpen=true;if(b.$mdialog==null){b._makeDialog()}else{b._setOpen()}},_setOpen:function(c){var b=this;var d=b.$mdialog.find(".co-datepicker");if(!b.$mdialog.find('input[name="startdate"]').val()||!!desknets.cost.getDateErrorMessage(d.eq(0))){b._setOpenSatrtDate(d)}if(!b.$mdialog.find('input[name="enddate"]').val()||!!desknets.cost.getDateErrorMessage(d.eq(1))){b._setOpenEndDate(d)}desknets.cost.cleanDate(d);if(b.$mdialog.find('input[name="startdate"]').val()>b.$mdialog.find('input[name="enddate"]').val()){b._setOpenSatrtDate(d);b._setOpenEndDate(d)}b.$mdialog.dialog("open");b.search()},_setOpenSatrtDate:function(d){var b=this;var c=new Date();var e=new Date(c.getFullYear(),c.getMonth(),1);d.eq(0).datepicker("setDate",e)},_setOpenEndDate:function(e){var c=this;var d=new Date();var b=new Date(d.getFullYear(),d.getMonth()+1,0);e.eq(1).datepicker("setDate",b)},_makeDialog:function(){var b=this;var c=function(){b.$mdialog=a("#jcost-costlist");var d=b._getDialogOptions();b.$mdialog=desknets.dialog.setUp(b.$mdialog,d);b._setUpDialog();b._setOpen()};a("body").append('<div id="jcost-costlist"></div>');desknets.tmpl.load(a("#jcost-costlist"),"cost/costlist.html",c)},_setUpDialog:function(){var c=this;c._setUpSettingBtn();var f={};f.oncomplete=function(){c.search()};c.$mdialog.find(".jcost-open").click(function(h){h.preventDefault();var i=desknets.cost.costOpenGetDefOption();i.oncomplete=function(j,k){desknets.cost.costOnComplete(j,f,k)};desknets.cost.input.open(i)});c.$mdialog.find(".jcost-search-data").click(function(h){h.preventDefault();if(a(this).hasClass("disabled")){return}var i=desknets.dialog.confirm(desknets.Resource.cost.cost_search_exec,function(){var j={cmd:"costcmdsearchexec",sdate:c._msdate,edate:c._medate};desknets.ajax.rest({url:desknets.cost.getUrl(),data:j,success:function(l,k,m){c._chkExecSearch()},})})});c.$mdialog.find(".cost-list-sum tbody").on("click","ul",function(h){var i=a(h.target);if(i.hasClass("cost-err-detail")){desknets.dialog.alert(i.find('input[name="errmsg"]').val(),{type:"warn"})}else{desknets.cost.costModOpenGet(desknets.getDataAttr(a(this),"id"),f)}});c.$mdialog.find(".co-msg-download").click(function(l){l.preventDefault();var j=c._msdate;var k=c._medate;j=j.replace(/-/g,"");k=k.replace(/-/g,"");var m=parseInt(j,10);var i=parseInt(k,10);if(!neo.isSet(j,{blank:false})||!neo.isSet(k,{blank:false})){desknets.dialog.alert(desknets.Resource.cost.expdateexists,{type:"warn"});return}if(m>i){desknets.dialog.alert(desknets.Resource.cost.expdateerr,{type:"warn"});return}var h=desknets.getUrl("zcost")+"?cmd=costexport";h=h+"&sdate="+c._msdate+"&edate="+c._medate;desknets.execLocation(h)});if(desknets.pageframe.isShownMenu("flow")){desknets.cabinetregist.geTemplate(null,"cost.html");desknets.cost.getSettingFlow();c.$mdialog.find(".co-msg-workflow").click(function(h){h.preventDefault();desknets.cost.getSettingFlow(function(i){desknets.ajax.rest({url:desknets.cost.getUrl(),async:false,data:{cmd:"costcmdflowentry",html:desknets.tmpl.replaceWordHtml(desknets.cabinetregist.loadFiles["cost.html"],"body",c._getCostHtml()),sdate:c._msdate,edate:c._medate,},success:function(k,j,l){var m=desknets.getUrl("zflow")+"?cmd=flowindex#cmd=flowentry&link=1&fid="+i;desknets.execLocation(m,"_blank")},})})});c.$mdialog.find(".jcost-use-workflow").show()}else{c.$mdialog.find(".jcost-use-workflow").hide()}if(desknets.pageframe.isShownMenu("cab")){var b=function(i,h){return desknets.tmpl.replaceWordHtml(h,"body",c._getCostHtml())};var g=function(){var h=desknets.Resource.cost.cabtitle;h=desknets.tmpl.replaceWordHtml(h,"startdate",neo.dateTime.format(desknets.Resource.dateFormat,neo.dateTime.parse(c._msdate)));h=desknets.tmpl.replaceWordHtml(h,"enddate",neo.dateTime.format(desknets.Resource.dateFormat,neo.dateTime.parse(c._medate)));return h};var e=function(){var h={};h.cmd="costcmdcopyattach";h.sdate=c._msdate;h.edate=c._medate;return h};var d={copymodule:desknets.cost.getApiModule(),copycmd:"costcmdcopyattach",copyprm:e,cabmaketemplate:b,cabtitle:g,cabtemplatename:"cost.html",id:"cost"};desknets.cabinetregist.init(c.$mdialog,d,false);c.$mdialog.find(".jcost-use-cab").show()}else{c.$mdialog.find(".jcost-use-cab").hide()}c.$mdialog.find(".jcost-print").click(function(h){h.preventDefault();c._onClickPrint(h,false)});c.$mdialog.find(".jcost-print-att").click(function(h){h.preventDefault();c._onClickPrint(h,true)});desknets.htmlparts.setUpForm(c.$mdialog.find("form"));c.$mdialog.find(".btn-search").click(function(h){h.preventDefault();c.search()})},_getDialogOptions:function(){var b=this;var c=desknets.dialog.getDialogOption();c.width=700;c.title=desknets.Resource.cost.title_costlist;c.dialogClass=c.dialogClass+" cost cost-pop";c.close=function(){desknets.cost.misListOpen=false};c.buttons=[{text:desknets.Resource.closeLabel,"class":"cost-btn cost-btn-2",click:function(){b.$mdialog.dialog("close")}}];return c},_onClickPrint:function(d,c){var b=this;d.preventDefault();if(!c){desknets.print.setPrintHtmlCostFunc=function(e,f){b._makePrint(e,f);return true}}else{desknets.print.setPrintHtmlCostFunc=function(f,k){b._makePrintAtt(f,k);if(!desknets.browser.chrome&&desknets.browser.ie){return true}else{var h=k.$("#jco-print-body").find("img");var e=h.length;var l=0;h.each(function(){a("<img>").load(function(){l++}).attr("src",a(this).attr("src"))});var j=0;var i=0;var g=setInterval(function(){j++;if(e<=l||j>10){clearInterval(g);k.print()}},500)}}}desknets.print.initPrintOpen({prm:{execcmd:"cost"}})},_makePrint:function(c,d){var b=this;d.$("#jco-print-body").html(b._getCostHtml())},_getCostHtml:function(){var j=this;var g='<div class="dn-preview-header"><div class="co-fright">{{start}} - {{end}}</div><h1 class="dn-preview-title">'+desknets.Resource.cost.title_costlist+"</h1></div>";g=desknets.tmpl.replaceWordHtml(g,"start",neo.dateTime.format(desknets.Resource.dateFormat,neo.dateTime.parse(j._msdate)));g=desknets.tmpl.replaceWordHtml(g,"end",neo.dateTime.format(desknets.Resource.dateFormat,neo.dateTime.parse(j._medate)));var d=a("<div>"+j.$mdialog.find(".jco-cab-template").html()+"</div>");var i=d.find(".cost-list-sum");var h=i.eq(0);var c=h.find("th");var b='<thead><tr><th class="date">'+c.eq(0).text()+'</th><th><div class="co-fright">'+c.eq(2).text()+"</div>"+c.eq(1).text()+"</th></tr></thead>";h.remove();var f=i.eq(1);i.find("tbody").before(b);d.find(".cost-list-cost").remove();var e=d.find(".co-table-list-scroll");d.find(".cost-examples").before(e.html());e.remove();d.find(".hasFile").prepend("["+desknets.Resource.cost.attach+"]");d.find(".hasFile").removeClass("hasFile");d.find(".cost-err-detail").closest(".price").html(desknets.Resource.cost.searcherr);return g+'<div class="cost cost-print">'+d.html()+"</div>"},_makePrintAtt:function(c,d){var b=this;var f=function(g){b._makePrintAttHtml(g,c,d)};var e=true;if(desknets.browser.ipad){e=false}b.searchCostList(f,e,true)},_makePrintAttHtml:function(e,k,b){var j=this;var f='<div class="dn-preview-header"><div class="co-fright">{{start}} - {{end}}</div><h1 class="dn-preview-title">'+desknets.Resource.cost.title_costlist+'<span class="co-colon-span">:</span>'+desknets.Resource.cost.title_filelist+"</h1></div>";f=desknets.tmpl.replaceWordHtml(f,"start",neo.dateTime.format(desknets.Resource.dateFormat,neo.dateTime.parse(j._msdate)));f=desknets.tmpl.replaceWordHtml(f,"end",neo.dateTime.format(desknets.Resource.dateFormat,neo.dateTime.parse(j._medate)));var g=desknets.ajax.getJsonItems(e);var i=0;var c="";var d="";var h="";a.each(g,function(n,o){if(!!o.attach){i++;var p=j._mattachth;var l=j._mattachtd;var m=neo.dateTime.parse(o.seldate);p=desknets.tmpl.replaceWordHtml(p,"date",neo.dateTime.format(desknets.Resource.dateFormat,m));p=desknets.tmpl.replaceWordHtml(p,"name",desknets.tmpl.dispStr(o.title));p=desknets.tmpl.replaceWordHtml(p,"subject",desknets.tmpl.dispStr(o.acc_name));p=desknets.tmpl.replaceWordHtml(p,"commnt",desknets.tmpl.dispStr(o.memo));p=desknets.tmpl.replaceWordHtml(p,"price",desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(parseInt(o.amount,10))));l=desknets.tmpl.replaceWordHtml(l,"url",desknets.getUrl("zcost"));l=desknets.tmpl.replaceWordHtml(l,"id",o.id);l=desknets.tmpl.replaceWordHtml(l,"costid",o.SID_ASSIGN);l=desknets.tmpl.replaceWordHtml(l,"filename",o.attach.item.attachdisp);c=c+p;d=d+l;if(i%2==0){h=j._mattach;h=desknets.tmpl.replaceWordHtml(h,"th",c);h=desknets.tmpl.replaceWordHtml(h,"td",d);f=f+h;c="";d=""}}});if(c!=""){c=c+'<th class="nodata">&nbsp;</th>';d=d+'<td class="nodata">&nbsp;</td>';h=j._mattach;h=desknets.tmpl.replaceWordHtml(h,"th",c);h=desknets.tmpl.replaceWordHtml(h,"td",d);f=f+h;c="";d=""}b.$("#jco-print-body").addClass("cost-print").html(f)},search:function(){var c=this;var g=null;c.$mdialog.find(".co-datepicker").each(function(){g=desknets.cost.getDateErrorMessage(a(this));if(!!g){return false}});if(!!g){desknets.dialog.alert(g,{});return}var e=c.$mdialog.find('input[name="startdate"]').val().substring(0,4);var b=c.$mdialog.find('input[name="enddate"]').val().substring(0,4);var d=function(h){c.setCostList(h)};var f=function(){c.searchCostList(d,true)};desknets.cost.holiday.getHoliday(e,b,f)},searchCostList:function(f,e,b){var c=this;var d={cmd:"costcmdsrchindex"};if(b===true){d.sdate=c._msdate;d.edate=c._medate}else{d.sdate=c.$mdialog.find('input[name="startdate"]').val();d.edate=c.$mdialog.find('input[name="enddate"]').val()}desknets.ajax.rest({async:e,url:desknets.cost.getUrl(),data:d,success:function(h,g,i){c._msdate=d.sdate;c._medate=d.edate;f(h)},})},setCostList:function(c){var b=this;var d=desknets.ajax.getJsonItems(c);b._mtotal=0;if(d.length==0){b.$mdialog.find(".co-table-list-scroll").hide();b.$mdialog.find(".cost-list-cost").show();b.$mdialog.find(".co-table-list-scroll").find("tbody").html("");b._mtotal=""}else{b.setCostListData(d)}if(neo.isSet(c[desknets.RES_TAG_MSGGETLIMIT])){desknets.pageframe.viewTopMsg(c[desknets.RES_TAG_MSGGETLIMIT],"info")}if(b.$mdialog.find(".co-table-list-scroll").find(".item-auto.unsearched").length>0){b.$mdialog.find(".jcost-search-data").removeClass("disabled")}else{b.$mdialog.find(".jcost-search-data").addClass("disabled")}if(b._mtotal===""){b.$mdialog.find(".cost-total strong").html(desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price","--"))}else{b.$mdialog.find(".cost-total strong").html(desknets.tmpl.replaceWordHtml(desknets.Resource.cost.price,"price",desknets.numberFormat(b._mtotal)))}},setCostListData:function(h){var j=this;var d=j.$mdialog.find(".co-table-list-scroll");d.show();j.$mdialog.find(".cost-list-cost").hide();var f="";var e="";var i="";var b="";var c="";var i="";var g=null;j._mmonthold="";a.each(h,function(l,n){if(b!=n.SID_ASSIGN&&g!=null){e=e+j.getCostLineData(g,i);i="";if(c!=n.seldate){f=f+j.getCostDatLineData(g,e);e=""}}b=n.SID_ASSIGN;c=n.seldate;var o=j._mlistdetail;if(n.dtype=="2"){o=desknets.tmpl.replaceWordHtml(o,"class","item-man");o=desknets.tmpl.replaceWordHtml(o,"comment",desknets.tmpl.dispStr(n.memo))}else{o=desknets.tmpl.replaceWordHtml(o,"class","item-auto");o=desknets.tmpl.replaceWordHtml(o,"comment",desknets.tmpl.dispStr(n.dep_st_name)+" - "+desknets.tmpl.dispStr(n.arv_st_name))}var k="";if(!!n.attach){k="hasFile"}var m="unsearched";var p=desknets.Resource.cost.nosearch;if(!!n.amount){m="";p=desknets.numberFormat(parseInt(n.amount,10))}else{if(!!n.status_code){p='<a class="co-msg-r cost-err-detail" href="#">'+desknets.Resource.cost.searcherr+'<input type="hidden" name="errmsg" value="'+desknets.tmpl.dispStr(n.status_codemsg)+'"></a>'}}o=desknets.tmpl.replaceWordHtml(o,"attach",k);o=desknets.tmpl.replaceWordHtml(o,"name",desknets.tmpl.dispStr(n.acc_name));o=desknets.tmpl.replaceWordHtml(o,"classamount",m);o=desknets.tmpl.replaceWordHtml(o,"price",p);i=i+o;g=n});if(i!=""){e=e+j.getCostLineData(g,i);i="";f=f+j.getCostDatLineData(g,e);e=""}d.find("tbody").html(f)},getCostLineData:function(b,f){var d=this;var e=parseInt(b.total_amount,10);d._mtotal=d._mtotal+e;var c=d._mlistdata;c=desknets.tmpl.replaceWordHtml(c,"id",b.SID_ASSIGN);c=desknets.tmpl.replaceWordHtml(c,"name",desknets.tmpl.dispStr(b.title));c=desknets.tmpl.replaceWordHtml(c,"price",desknets.numberFormat(e));c=desknets.tmpl.replaceWordHtml(c,"detail",f);return c},getCostDatLineData:function(b,h){var d=this;var e=neo.dateTime.parse(String(b.seldate));var c="";if(desknets.cost.holiday.boChkHoliday(String(b.seldate))){c="co-sunday"}else{var g=e.getDay();if(g==6){c="co-saturday"}else{if(g==0){c="co-sunday"}}}var f=neo.dateTime.format(desknets.Resource.shortYMFormat,e);if(d._mmonthold==f){f=""}else{d._mmonthold=f}var i=d._mlistdate;i=desknets.tmpl.replaceWordHtml(i,"class",c);i=desknets.tmpl.replaceWordHtml(i,"date1",f);i=desknets.tmpl.replaceWordHtml(i,"date2",neo.dateTime.format(desknets.Resource.dateFormat_dd,e));i=desknets.tmpl.replaceWordHtml(i,"data",h);return i},_setUpSettingBtn:function(){var b=this;var d=function(e){if(e=="2"||e=="1"){b.$mdialog.closest(".cost-pop").find(".ui-dialog-titlebar").append('<div class="settings"><a href="#" class="co-drop-down-button" data-align="right" data-for="cost-m-h-setting-menus" data-position="bottom" title="'+desknets.Resource.cost.setting+'" tabindex="-1">'+desknets.Resource.cost.setting+"</a></div>");if(desknets.pageframe.isShownMenu("flow")){b.$mdialog.find("#cost-workflow-open").find("a").click(function(f){f.preventDefault();desknets.cost.flow.open()})}else{b.$mdialog.find("#cost-workflow-open").remove()}b.$mdialog.find("#cost-subject-open").find("a").click(function(f){f.preventDefault();desknets.cost.subject.open()});b.$mdialog.find("#cost-manager-open").find("a").click(function(f){f.preventDefault();desknets.cost.manager.open()})}if(e=="1"){a("#cost-m-h-setting-menus").find(".co-m-h-setting-menu.adlink").remove()}};var c=function(e){b.$mdialog.find(".cost-hplink").attr("href",e)};desknets.cost.getSetting(d,c)},_chkExecSearch:function(){var b=this;var c={cmd:"costcmdsearchexec",execcheck:"1"};var f=desknets.Resource.Message.com_dialog_execmsg;f=desknets.tmpl.replaceWordHtml(f,"msg",desknets.Resource.cost.searchexec);var e={type:"message",extraMessage:desknets.Resource.Message.com_dialog_execaddmsg,extraClass:"co-loading-dialog"};b.$dialogexec=desknets.dialog.alert(f,e);desknets.submitform.setDialogDisabled(b.$dialogexec);var d=setInterval(function(){desknets.ajax.rest({dataType:desknets.ajax.RESTYPE_JSON,url:desknets.cost.getUrl(),data:c,success:function(i,g,j){if(i.execflg=="0"){clearInterval(d);b.$dialogexec.dialog("close");var h=function(){b.search()};if(neo.isSet(i.mymessage)||neo.isSet(i.message)){desknets.dialog.alert(b._makeErrorMsg(i),{type:"warn",close:h})}else{desknets.dialog.alert(b._successMessage(),{type:"message",close:h})}}},error:function(h,g,i){clearInterval(d);b.$dialogexec.dialog("close");desknets.ajax.onError(h.status,i)}})},5000)},_makeErrorMsg:function(d){var c=this;var b="";if(neo.isSet(d.mymessage)&&d.mymessage.length>0){b=d.mymessage}if(neo.isSet(d.message)&&d.message.length>0){if(neo.isSet(b)&&b.length>0){b=b+"\n"}b=b+d.message}return b},_successMessage:function(){return desknets.Resource.cost.searchend},_setListResultLink:function(){var b=this;b.$mjTableList.delegate(".doc-set-autoerror","click",function(c){c.preventDefault();var d=a(this).closest("tr").find("input.jco-id").val();b._createErrDetailDlg(d)})},};desknets.cost.flow={$mflowdialog:null,mflowurl:"zrflow",mobjcmd:{save:"costmsetcmdgen",get:"costcmdgenref",},mobjflowcmd:{list:"flowcmdformatlist",},open:function(){var b=this;if(b.$mflowdialog==null){b.make()}else{b.getData()}},make:function(){var b=this;var c=function(){b.$mflowdialog=a("#jcost-workflow");var d=desknets.dialog.getDialogOption();d.width=500;d.title=desknets.Resource.cost.title_flow;d.dialogClass=d.dialogClass+" cost cost-pop";d.buttons=[{text:desknets.Resource.modLabel,"class":"cost-btn",click:function(){if(b.$mflowdialog!=null){desknets.submitform.setDialogDisabled(b.$mflowdialog)}var e={};e.cmd=b.mobjcmd.save;e.sid_flow=b.$mflowdialog.find("select").val();desknets.ajax.rest({url:desknets.cost.getUrl(),data:e,success:function(g,f,h){desknets.submitform.clearDialogDisabled(b.$mflowdialog);b.$mflowdialog.dialog("close")},error:function(h,f,g){desknets.submitform.clearDialogDisabled(b.$mflowdialog);desknets.ajax.onError(h.status,g)},})}},{text:desknets.Resource.cancelLabel,"class":"cost-btn cost-btn-2",click:function(){b.$mflowdialog.dialog("close")}}];b.$mflowdialog=desknets.dialog.setUp(b.$mflowdialog,d);b.getData()};a("body").append('<div id="jcost-workflow"></div>');desknets.tmpl.load(a("#jcost-workflow"),"cost/workflow.html",c)},getData:function(){var b=this;var c={cmd:b.mobjflowcmd.list};desknets.ajax.rest({url:desknets.getUrl(b.mflowurl),data:c,success:function(g,f,k){var e=b.$mflowdialog.find("select");var i=desknets.ajax.getJsonItems(g);var h='<option value="">'+e.find("option").html()+"</option>";var d=i.length;for(var j=0;j<d;j++){var l=i[j];h=h+'<option value="'+l.id+'">'+desknets.tmpl.dispStr(l.Name)+"</option>"}e.html(h);b.openGet()},})},openGet:function(){var b=this;desknets.ajax.rest({url:desknets.cost.getUrl(),data:{cmd:b.mobjcmd.get},success:function(d,c,e){var f="";if(!!d.sid_flow){b.$mflowdialog.find("select option").each(function(){if(a(this).val()==d.sid_flow){f=d.sid_flow;return false}})}b.$mflowdialog.find("select").val(f);b.$mflowdialog.dialog("open")},})},};desknets.cost.subject={_mline:'<tr><td class="co-chk"><input type="checkbox" name="id" value="{{id}}"><input type="hidden" value="{{id}}" class="jco-id"></td><td class="name"><a href="#" title="{{nametitle}}">{{name}}</a></td><td class="code" title="{{codetitle}}">{{code}}</td></tr>',$mdialog:null,_allowInPageState:false,_listCheckState:"",_listSortable:null,mobjPager:{cnt:0,allcnt:0,start:0,view:100,},$msavedialog:null,mobjcmd:{list:"costmsetcmdaccindex",get:"costmsetcmdaccref",move:"costmsetcmdaccmv",save:"costmsetcmdaccentry",del:"costmsetcmdaccdel",},open:function(){var b=this;if(b.$mdialog==null){b.make()}else{b.$mdialog.dialog("open")}},make:function(){var b=this;var c=function(){b.$mdialog=a("#jcost-subject");var d=desknets.dialog.getDialogOption();d.width=700;d.title=desknets.Resource.cost.title_subject;d.dialogClass=d.dialogClass+" cost cost-pop";d.buttons=[{text:desknets.Resource.closeLabel,"class":"cost-btn cost-btn-2",click:function(){b.$mdialog.dialog("close")}}];b.$mdialog=desknets.dialog.setUp(b.$mdialog,d);b.setUp()};a("body").append('<div id="jcost-subject"></div>');desknets.tmpl.load(a("#jcost-subject"),"cost/subject.html",c)},setUp:function(){var b=this;b._initSave();b._initListSortable();b._initChk();b._getListAjax("0");b._initDel();b.$mdialog.dialog("open")},_initListSortable:function(){var b=this;b._listSortable=new desknets.ListSortable(b.$mdialog.find("form"),b._getListSortableOptions())},_getListSortableOptions:function(c){var b=this;return{disabled:false,url:desknets.cost.getUrl(),sortCmd:b.mobjcmd.move,sortParamFilter:function(d){return a.extend(d,{})},confirmMessage:desknets.Resource.Message.com_move_conf,getAdditionalData:function(){return a.extend({cmd:b.mobjcmd.list},{num:b.mobjPager.view,row:b.mobjPager.start})},start:function(){var e=b.$mdialog.find(".co-table-move-wrap");var d=e.find("table");e.css("height",d.height()+"px")},change:function(d){b._getListAjaxSuccess(d)},stop:function(){var d=b.$mdialog.find(".co-table-move-wrap");d.css("height","auto")}}},_initChk:function(){var b=this;var c=b.$mdialog.find("#cost-subject-tbody");c.delegate("input[type=checkbox]","click",function(d){b.$mdialog.find(".jco-checkbox-all").attr("checked",false);b._updateListCheckState("");if(a(this).attr("checked")){a(this).parent().parent().addClass("co-tr-selected")}else{a(this).parent().parent().removeClass("co-tr-selected")}});b.$mdialog.find(".jco-checkbox-all").click(function(e){var d=(a(this).attr("checked"))?true:false;c.find("input[type=checkbox]").attr("checked",d);if(d){c.find("tr").addClass("co-tr-selected")}else{c.find("tr").removeClass("co-tr-selected")}if(b.$mdialog.find(".jco-sort-change").css("display")!="block"){b._updateListCheckState(d?"inPage":"")}});b.$mdialog.find(".co-chk-cnt-some").find("a").click(function(d){d.preventDefault();b._updateListCheckState("all")});b.$mdialog.find(".co-chk-cnt-all").find("a").click(function(d){d.preventDefault();b._updateListCheckState("");c.find("input[type=checkbox]").attr("checked",false).end().find("tr").removeClass("co-tr-selected")})},_listAllChkClear:function(){this._updateListCheckState("")},_updateListCheckState:function(c){var d=this;var e=d.$mdialog.find(".co-chk-cnt-some");var f=d.$mdialog.find(".co-chk-cnt-all");var b=d.$mdialog.find(".jco-checkbox-all");if(c=="inPage"&&!this._allowInPageState){c="all"}if(c=="all"){e.hide();f.show();b.prop("checked",true)}else{if(c=="inPage"){e.show();f.hide();b.prop("checked",true)}else{e.hide();f.hide();b.prop("checked",false)}}this._listCheckState=c},_getListAjax:function(d){var b=this;var c={};c.cmd=b.mobjcmd.list;c.num=b.mobjPager.view;c.row=d;desknets.ajax.rest({url:desknets.cost.getUrl(),data:c,success:function(f,e,g){b._getListAjaxSuccess(f)},})},_getListAjaxSuccess:function(f){var e=this;var h=desknets.ajax.getJsonItems(f);var d=[];var b=0;var g=0;if(h.length<=0){e.$mdialog.find(".co-table-list").hide();e.$mdialog.find(".co-table-list-scroll").hide();e.$mdialog.find(".co-nodata").show()}else{e.$mdialog.find(".co-table-list").show();e.$mdialog.find(".co-table-list-scroll").show();e.$mdialog.find(".co-nodata").hide();b=h.length;for(g=0;g<b;g++){var c=e._mline;c=desknets.tmpl.replaceWordHtml(c,"id",desknets.tmpl.dispStr(h[g].id));c=desknets.tmpl.replaceWordHtml(c,"nametitle",desknets.escapeValue(h[g].Name));c=desknets.tmpl.replaceWordHtml(c,"name",desknets.tmpl.dispStr(h[g].Name));c=desknets.tmpl.replaceWordHtml(c,"codetitle",desknets.escapeValue(h[g].code));c=desknets.tmpl.replaceWordHtml(c,"code",desknets.tmpl.dispStr(h[g].code));d[d.length]=c}e.$mdialog.find(".co-table-list tbody").html(d.join(""))}e.mobjPager.cnt=g;e.mobjPager.allcnt=f.allcnt;e.mobjPager.start=f.row;e._listAllChkClear();e.setUpPageLink();e._listAllChkDataCnt();if(this._listSortable!=null){this._listSortable.fixListItems()}},setUpPageLink:function(){var c=this;var b={};b={getCount:c.mobjPager.cnt,allCount:c.mobjPager.allcnt,pageMaxView:c.mobjPager.view,startRow:c.mobjPager.start,clickFunc:function(d){c._getListAjax(d)}};desknets.Pager.output("#jcost-subject",".jco-pager",b)},_listAllChkDataCnt:function(){var b=this;var d=Number(b.mobjPager.cnt);var e=Number(b.mobjPager.allcnt);var c=desknets.Resource.Message.com_listchk_cnt_some_disp;c=desknets.tmpl.replaceWordLF(c,"num"," "+d+" ");b.$mdialog.find(".jco-span-chk-msg-page").html(c);c=desknets.Resource.Message.com_listchk_cnt_all_link;c=desknets.tmpl.replaceWordLF(c,"num",e+" ");b.$mdialog.find(".jco-span-chk-msg-all-link").html(c);c=desknets.Resource.Message.com_listchk_cnt_all_disp;c=desknets.tmpl.replaceWordLF(c,"num",e+" ");b.$mdialog.find(".jco-span-chk-msg-all").html(c);this._allowInPageState=e>d},_initSave:function(){var b=this;b.$mdialog.find(".jcost-list-add").click(function(c){c.preventDefault();b.openSave(null)});b.$mdialog.find("#cost-subject-tbody").on("click","a",function(c){c.preventDefault();b.openSave(a(this))})},openSave:function(c){var b=this;if(b.$msavedialog==null){b.makeSave(c)}else{b.openSaveDef(c)}},makeSave:function(c){var b=this;var d=function(){b.$msavedialog=a("#jcost-subject-add");var e=desknets.dialog.getDialogOption();e.width=500;e.title=desknets.Resource.cost.title_subject_add;e.dialogClass=e.dialogClass+" cost cost-pop";e.buttons=[{text:desknets.Resource.delLabel,"class":"cost-btn cost-btn-del",click:function(){var f=desknets.dialog.confirm(desknets.Resource.Message.com_del_conf,function(){if(b.$msavedialog!=null){desknets.submitform.setDialogDisabled(b.$msavedialog)}var g={};g.cmd=b.mobjcmd.del;g.id=b.$msavedialog.find('input[name="id"]').val();desknets.ajax.rest({url:desknets.cost.getUrl(),data:g,success:function(i,h,j){b._getListAjax(b.mobjPager.start);b.$msavedialog.dialog("close")},complete:function(j,h,i){desknets.submitform.clearDialogDisabled(b.$msavedialog)},})})}},{text:desknets.Resource.modLabel,"class":"cost-btn",click:function(){var f={};f.cmd=b.mobjcmd.save;f.id=b.$msavedialog.find('input[name="id"]').val();f.name=b.$msavedialog.find('input[name="Name"]').val();f.code=b.$msavedialog.find('input[name="code"]').val();f.memo=b.$msavedialog.find('textarea[name="body"]').val();if(b.$msavedialog!=null){desknets.submitform.setDialogDisabled(b.$msavedialog)}desknets.ajax.rest({url:desknets.cost.getUrl(),data:f,success:function(h,g,i){b._getListAjax(b.mobjPager.start);b.$msavedialog.dialog("close")},error:function(k,g,i){var l=i;var h=a.parseJSON(k.responseText);if(!!h.errmsgadd){var j={};j.msg=h.errormessage;j.fieldid=h.errmsgadd;j.fieldname=b.$msavedialog.find(".jco-input-"+j.fieldid).text()+desknets.merrMsgConnect;l=desknets.getErrConvMsg(j)}desknets.ajax.onError(k.status,l)},complete:function(i,g,h){desknets.submitform.clearDialogDisabled(b.$msavedialog)},})}},{text:desknets.Resource.cancelLabel,"class":"cost-btn cost-btn-2",click:function(){b.$msavedialog.dialog("close")}}];b.$msavedialog=desknets.dialog.setUp(b.$msavedialog,e);b.openSaveDef(c)};a("body").append('<div id="jcost-subject-add"></div>');desknets.tmpl.load(a("#jcost-subject-add"),"cost/subjectadd.html",d)},openSaveDef:function(d){var b=this;var e=b.$msavedialog.parent("div").find(".ui-dialog-buttonset").find(".cost-btn");if(d==null){b.$msavedialog.parent("div").find(".ui-dialog-title").text(desknets.Resource.cost.title_subject_add);e.eq(0).hide();e.eq(1).text(desknets.Resource.addLabel);b.$msavedialog.find('input[name="id"]').val("");b.$msavedialog.find('input[name="Name"]').val("");b.$msavedialog.find('input[name="code"]').val("");b.$msavedialog.find('textarea[name="body"]').val("");b.$msavedialog.dialog("open")}else{b.$msavedialog.parent("div").find(".ui-dialog-title").text(desknets.Resource.cost.title_subject_mod);e.eq(0).show();e.eq(1).text(desknets.Resource.modLabel);var c={};c.cmd=b.mobjcmd.get;c.id=d.closest("tr").find(".jco-id").val();desknets.ajax.rest({url:desknets.cost.getUrl(),data:c,success:function(g,f,h){b.$msavedialog.find('input[name="id"]').val(g.id);b.$msavedialog.find('input[name="Name"]').val(g.Name);b.$msavedialog.find('input[name="code"]').val(g.code);b.$msavedialog.find('textarea[name="body"]').val(g.memo);b.$msavedialog.dialog("open")},})}},_initDel:function(){var b=this;b.$mdialog.find(".jcost-list-del").click(function(d){d.preventDefault();var c=0;b.$mdialog.find("#cost-subject-tbody").find("input[type=checkbox]").each(function(){if(a(this).attr("checked")){c++;return false}});if(c<1){desknets.dialog.alert(desknets.Resource.Message.com_del_nochecked,{type:"warn"});return}var e=desknets.dialog.confirm(b._delConfMessage(),function(){b._listDel(e);return false})})},_delConfMessage:function(){var c=this;var b="";if(c.$mdialog.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message.com_del_allconf}else{if(c.$mdialog.find(".co-chk-cnt-some").css("display")=="block"){b=desknets.Resource.Message.com_del_someconf}else{b=desknets.Resource.Message.com_del_listconf}}return desknets.tmpl.replaceWordHtml(b,"count",c.$mdialog.find("#cost-subject-tbody").find("input[type=checkbox]:checked").length)},_listDel:function(f){var d=this;var c=[];var e={};var b={};if(f!=null){desknets.submitform.setDialogDisabled(f)}if(d.$mdialog.find(".co-chk-cnt-all").css("display")=="block"){c=desknets.PRM_VAL_ALLDEL}else{d.$mdialog.find('input[name="id"]:checked').each(function(){c[c.length]=a(this).val()})}b={};b.id=c;b.cmd=d.mobjcmd.del;desknets.ajax.rest({url:desknets.cost.getUrl(),data:b,success:function(h,g,i){d._getListAjax(d.mobjPager.start)},complete:function(i,g,h){if(f!=null){desknets.submitform.clearDialogDisabled(f);f.dialog("close")}},traditional:true});return},};desknets.cost.manager={$mdialog:null,_TYPE_USERDATA:"u",_TYPE_ROLEDATA:"r",_CSS_ICON_ROLE:"co-gicon-role",_CSS_ICON_ROLELOCK:"co-gicon-lock",_CSS_ICON_USER:"co-gicon-user",msAllManager:desknets.Resource.setAdminAllUser,open:function(){var b=this;if(b.$mdialog!=null){b.$mdialog.dialog("destroy");b.$mdialog=null}b._makeDialog()},_makeDialog:function(){var b=this;if(a("#jcost-costmanager").length==0){a("body").append('<div id="jcost-costmanager"></div>')}var c={};var d={cmd:"costsetcmdmanagerhtm"};c["0"]=d;desknets.ajax.rest({url:desknets.cost.getUrl(),dataType:"html",data:d,success:function(f,e,h){a("#jcost-costmanager").html(f);b.$mdialog=a("#jcost-costmanager");var g=b._getDialogOptions();b.$mdialog=desknets.dialog.setUp(b.$mdialog,g);b._setUpDialog()},})},_setUpDialog:function(){var b=this;b.$mdialog.find('input[type="submit"]').hide();var c="zrcost."+desknets.getExtension();b.$mdialog.find("form").attr("action",c);b.$mdialog.find(".co-tbody-list").find("tr").find("td").not(".co-busyo").not(".co-chk").addClass("co-width-300");b._listSet();b.$mdialog.find(".jcost-admin-usel").click(function(d){d.preventDefault();b._openAdminAssignSelDialog()});b.$mdialog.find(".jcost-del-button").click(function(d){d.preventDefault();b._listDel()});b._initListChk();b._initFormRequestAjax();b.$mdialog.dialog("open")},_getDialogOptions:function(){var b=this;var c=desknets.dialog.getDialogOption();c.width=700;c.title=desknets.Resource.cost.title_manager;c.dialogClass=c.dialogClass+" cost cost-pop";c.buttons=[{text:desknets.Resource.modLabel,"class":"cost-btn",click:function(){b.$mdialog.find('input[type="submit"]').submit()}},{text:desknets.Resource.cancelLabel,"class":"cost-btn cost-btn-2",click:function(){b.$mdialog.dialog("close")}}];return c},_initFormRequestAjax:function(){var b=this;objOption={success:function(d,c,e){desknets.dialog.alert(desknets.Resource.cost.cost_manager_mod,{});b.$mdialog.dialog("close")},};desknets.ajax.submitForm(b.$mdialog.find("form"),objOption)},_listSet:function(){var c=this;var b=c.$mdialog.find(".co-tbody-list");if(b.find("tr").length==0){c.$mdialog.find(".co-table-list").hide();c.$mdialog.find(".co-nodata").show()}else{c.$mdialog.find(".co-table-list").show();c.$mdialog.find(".co-nodata").hide();desknets.htmlparts.addStripeClass(b,"co-tr-even")}c.$mdialog.find(".co-chk-cnt-all").hide();c.$mdialog.find(".jco-checkbox-all").attr("checked",false);c.$mdialog.find("tr").removeClass("co-tr-selected");c.$mdialog.find("input[type=checkbox]").attr("checked",false)},_listDel:function(){var b=this;b.$mdialog.find(".co-tbody-list").find("input[type=checkbox]").each(function(){if(a(this).attr("checked")){a(this).parent().parent().remove()}});b._listSet()},_initListChk:function(){var b=this;b.$mdialog.find(".co-tbody-list").on("click","input[type=checkbox]",function(c){b.$mdialog.find(".jco-checkbox-all").attr("checked",false);b.$mdialog.find(".co-chk-cnt").find(".co-chk-cnt-all").hide();if(a(this).attr("checked")){a(this).parent().parent().addClass("co-tr-selected")}else{a(this).parent().parent().removeClass("co-tr-selected")}});b.$mdialog.find(".jco-checkbox-all").click(function(){var d=(a(this).attr("checked"))?true:false;var c=b.$mdialog.find(".co-tbody-list");b.$mdialog.find("input[type=checkbox]").attr("checked",d);if(d){c.find("tr").addClass("co-tr-selected")}else{c.find("tr").removeClass("co-tr-selected")}if(d){var f=c.find("tr").length;var e=desknets.Resource.Message.com_listchk_cnt_all_disp;e=desknets.tmpl.replaceWordLF(e,"num",f+" ");b.$mdialog.find(".co-chk-cnt").find(".co-chk-cnt-all").html(e);b.$mdialog.find(".co-chk-cnt").find(".co-chk-cnt-all").show()}else{b.$mdialog.find(".co-chk-cnt").find(".co-chk-cnt-all").hide()}})},_openAdminAssignSelDialog:function(){var b=this;var d;var c=b._getSelDialogOptions();d=desknets.chooser.open("jcost-sel-admin-items",c)},_getSelDialogOptions:function(){var c=this;var d={};var b=[];b=desknets.chooser.getItemsFromElement(c.$mdialog.find(".co-tbody-list"),{itemFilter:function(g,e){var f=e.closest("tr").find(".jco-adminset-description").html();g.summary=f;return g}});d={chooseTarget:["user","role"],choose:function(e){c._onSelectAdminAssignItems(e)},items:b,unassignGroup:"choosable",noAdministrators:true,cmdusers:desknets.CMD_CHOOSERMSETUSERSEL};return d},_onSelectAdminAssignItems:function(g){var i,f;var k=this;var d=k.$mdialog.find(".co-tbody-list").find("tr");var b="";var e="";var h;var c=g.length;var j=d.length;for(i=0;i<c;i++){h=false;e=g[i].id;b=g[i].type.substring(0,1);for(f=0;f<j;f++){if(d[f]!="undefined"&&a(d[f]).find('input[name="id"]').val()==b+e){h=true;delete d[f];break}}if(h){continue}k._createAdminRow(g[i].id,g[i].name,g[i].summary,g[i].type.substring(0,1),g[i].description)}for(f=0;f<j;f++){if(d[f]!="undefined"){a(d[f]).remove()}}k._listSet()},_createAdminRow:function(h,l,i,e,k){var j=this;var g="";var b="";var c=1;if(e==j._TYPE_ROLEDATA){if(parseInt(h,10)<=desknets.DBVAL_ROLE_LOCK_MAX){b=j._CSS_ICON_ROLELOCK}else{b=j._CSS_ICON_ROLE}}else{b=j._CSS_ICON_USER}var f=desknets.escape(l);f=desknets.escapeValue(f);f=desknets.escapeSpace(f);var d=desknets.tmpl.escapeWord(a("<div />").append(i).text());if(e==j._TYPE_USERDATA){k=desknets.escape(k);k=desknets.escapeValue(k)}g="<tr>";g=g+'<td class="co-chk"><input type="checkbox" name="_id" value="'+e+h+'" />';g=g+'<input type="hidden" name="id" value="'+e+h+'" />';g=g+'<input type="hidden" name="condition" value="'+e+h+"_"+c+'" />';g=g+"</td>";if(e==j._TYPE_ROLEDATA){g=g+'<td class="co-width-300"><span class="'+b+'">&nbsp;</span><span data-name="'+f+'" data-id="'+e+h+'" data-description="'+k+'" class="jco-adminset-name jco-sel-item" title="'+f+'">'+f+"</span></td>"}else{g=g+'<td class="co-width-300"><span class="'+b+'">&nbsp;</span><a href="#" data-name="'+f+'" data-id="'+e+h+'" data-description="'+k+'" class="jco-adminset-name jco-ref-dialog-link jco-sel-item" data-refid="user'+h+'" "title="'+f+'">'+f+"</a></td>"}g=g+'<td class="co-busyo"><span class="jco-adminset-description" title="'+d+'">'+i+"</span></td>";g=g+"</tr>";j.$mdialog.find(".co-tbody-list").append(g)},}})(jQuery);