/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){(function(b){desknets.tcardcom={time_nothing:"---",getStyleClassNameWeek:function(f,d,c){var e="";if(c=="1"){e="co-holiday"}else{if(f=="0"){e="co-sunday"}else{if(f=="6"){e="co-saturday"}else{if(d=="1"){e="co-holiday"}}}}return e},removeStyleClassNameWeek:function(c){var d="";if(c.hasClass("co-sunday")){c.removeClass("co-sunday")}if(c.hasClass("co-saturday")){c.removeClass("co-saturday")}if(c.hasClass("co-holiday")){c.removeClass("co-holiday")}},getClassNameTimeFlag:function(d,c){var e="tcard-normal";if(d=="1"){e="tcard-restgo"}else{if(d=="2"){e="tcard-outside"}else{if(d=="3"){e="tcard-edit"}else{if(d=="4"){if(c==true){e="tcard-late"}else{e="tcard-early"}}else{if(d=="5"){e="tcard-approval"}else{if(d=="6"){e="tcard-noentry"}}}}}}return e},getDispTimeStr:function(c,d,e){var f="";if(c.length>0){return c}if(d=="6"){f=e}return f},getAbsenceName:function(c){var d="";if(c=="1"){d=desknets.Resource.tcard.absence_normal}else{if(c=="2"){d=desknets.Resource.tcard.absence_condole}else{if(c=="3"){d=desknets.Resource.tcard.absence_paid}else{if(c=="4"){d=desknets.Resource.tcard.absence_compen}else{if(c=="5"){d=desknets.Resource.tcard.absence_other}}}}}return d},getLateName:function(c){var d="";if(c=="1"){d=desknets.Resource.tcard.time_late}else{if(c=="2"){d=desknets.Resource.tcard.time_approval}}return d},getLeaveearlyName:function(c){var d="";if(c=="1"){d=desknets.Resource.tcard.time_early}else{if(c=="2"){d=desknets.Resource.tcard.time_approval}}return d},createHtmlTimeRec:function(e,j,d,i){var c="";var g="";var f="";var h="";f=e[j];h=e[d];h=desknets.tcardcom.getDispTimeStr(h,f,i);c="";if(h.length>0){g=desknets.tcardcom.getClassNameTimeFlag(f,d.match(/stime/i)?true:false);c='<span class="{{sclass}}">{{stime}}</span>';c=desknets.tmpl.replaceWordHtml(c,"sclass",g);c=desknets.tmpl.replaceWordHtml(c,"stime",h)}return c},createHtmlNoteRec:function(f,e,h,d){var g="";var c="";if((f.length>0)||(e.length>0)){g="";if(f.length>0){g=g+"["+f+"]";if(e.length>0){g=g+"&nbsp;-&nbsp;"}}if(e.length>0){g=g+e}if(d){c='<span class="{{acStyleClass}}">{{str}}</span><br />'}else{c='<span class="{{acStyleClass}}" title="{{str}}">{{str}}</span><br />'}c=desknets.tmpl.replaceWordHtml(c,"acStyleClass",h);c=desknets.tmpl.replaceWordHtml(c,"str",g)}return c},}})(jQuery);(function(b){desknets.tcard={MODULE_TCARD:"ztcard",MODULE_API_TCARD:"zrtcard",PAGE_TCARDLIST:"tcardindex",PAGE_TCARDENTRY:"tcardentry",PAGE_TCARDREPORTANNUAL:"tcardreportannual",PAGE_TCARDWEEKSITUATION:"tcardweeksituation",CMD_TCARDSTAMP:"tcardcmdstamp",CMD_TCARDENTRY:"tcardcmdentry",CMD_TCARDINDEX:"tcardcmdindex",CMD_TCARDTICK:"tcardcmdtick",CMD_TCARDREPORTMONTH:"tcardcmdreportmonth",CMD_TCARDREPORTANNUAL:"tcardcmdreportannual",CMD_TCARDWEEKSITUATION:"tcardcmdweeksituation",CMD_TCARDPSETGEN:"tcardpsetcmdgen",CMD_TCARDEXPORT:"tcardcmdexport",CMD_TCARDEXPORTANNUAL:"tcardcmdexportannual",ERRORNO_TCARDSAVEOVER:-2606,init:function(){var c=b("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(c);if(c==desknets.tcard.PAGE_TCARDLIST){desknets.hashobserver.init(desknets.tcard);desknets.tcard.tcardindex.init();desknets.tcard.subwin.init()}else{if(c==desknets.tcard.PAGE_TCARDREPORTANNUAL){desknets.hashobserver.init(desknets.tcard);desknets.tcard.tcardreportannual.init();desknets.tcard.subwin.init()}else{if(c==desknets.tcard.PAGE_TCARDWEEKSITUATION){desknets.hashobserver.init(desknets.tcard);desknets.tcard.tcardweeksituation.init();desknets.tcard.subwin.init()}}}},}})(jQuery);(function(b){desknets.page(desknets,"PageListBaseDayChange",desknets.PageListBase,{BTN_TODAY:".jtcard-change-today",BTN_CHANGEMONTH:".jtcard-change-month",m_oBackupHash:{},m_sTargetDate:"",_initListStart:function(){var c=this;c.m_oBackupHash=desknets.paramanalyzer.getHashParams();c.callBase("_initListStart");c._appendEventHandlerChangeDay()},_appendEventHandlerChangeDay:function(){var d=this;var e=d._getToDayButtonName();d.$mjListPage.find(e).click(function(g){g.preventDefault();var f=desknets.pageframe.getServerDate();d._changeTargetDate(neo.dateTime.format("yyyyMMdd",f))});var c=d._getChangeDayButtonName();d.$mjListPage.find(c).click(function(g){g.preventDefault();var f=b(this).attr("href").replace(/#/,"");f=d._computeChangeDate(d.m_sTargetDate,f);d._changeTargetDate(f)})},_changeTargetDate:function(e,f){var c=this;c.m_oBackupHash=desknets.paramanalyzer.getHashParams();var d={};d=desknets.paramanalyzer.getHashParams();d.cmd=this._getListCmd();d.date=""+e;this._setLocationHash(d,f)},_getListAjaxOptions:function(){var c=this;var d=c.callBase("_getListAjaxOptions");d.error=function(f,e,g){c.onError(f.status,g)};return d},onError:function(d,e){var c=this;if(d!=desknets.tcard.ERRORNO_TCARDSAVEOVER){c.callBase("onError",d,e)}else{var g=desknets.dialog.alert(e,{errorNo:d});var f={close:function(i){var h=g.hasClass("warn")?"warn":"error";desknets.dialog.deleteById(h);c._setLocationHash(c.m_oBackupHash)}};g.dialog(f)}},_getListAjaxSuccessOtherSet:function(d){var c=this;c.m_sTargetDate=d.date;c._listheader(d);c.$mjListPage.find(".jco-back-page-data").find('input[name="date"]').val(d.date);c.callBase("_getListAjaxSuccessOtherSet",d)},_listheader:function(c){return},_computeChangeDate:function(d,e){var c=desknets.dateTime.computeMonth(d,e);return c},_getToDayButtonName:function(){return this.BTN_TODAY},_getChangeDayButtonName:function(){return this.BTN_CHANGEMONTH},})})(jQuery);(function(b){desknets.page(desknets,"PageBaseMulti",desknets.PageBase,{init:function(){var c=this;c.callBase("init")},_getMultiAjax:function(){var c=this;var g={};var f={};var e={};var d={};f=c.getDataParam1();f.cmd=c.getDataParamCmd1();e=c.getDataParam2();e.cmd=c.getDataParamCmd2();g["0"]=f;g["1"]=e;d=c._getMultiAjaxOptions();c._sendRequestAjax(desknets.ajax.REQTYPE_MULTI,desknets.ajax.RESTYPE_JSON,g,d)},_sendRequestAjax:function(c,e,i,j){var d=this;var g;var f;var h;if(!neo.isSet(e)){e=desknets.ajax.RESTYPE_JSON}if(c==desknets.ajax.REQTYPE_SINGLE){if(!neo.isSet(i)){i=d.getSingleRequest()}if(!neo.isSet(i.cmd)){return false}h=i}else{if(!neo.isSet(i)){i=d.getMultiRequest()}if(!neo.isSet(i)||!neo.isSet(i["0"])){return false}h=desknets.ajax.arrayToMultiCmdData(i)}g=d._getRestModule();f=desknets.getUrl(g);desknets.ajax.rest({dataType:e,url:f,data:h,success:function(l,k,m){if(neo.isSet(j)&&b.isFunction(j.success)){j.success(l)}else{d.onSuccess(l)}},complete:function(m,k,l){if(neo.isSet(j)&&b.isFunction(j.complete)){j.complete(m,k,l)}d._onComplete()}});return true},_getMultiAjaxOptions:function(){var c=this;var d={};d={success:function(f,e,g){c._getMultiAjaxSuccess(f)}};return d},_getMultiAjaxSuccess:function(d){var c=this;if(typeof(d[0])=="object"){if(d[0]["status"]!=desknets.RES_STATUS_SUCCESS){desknets.ajax.onError(d[0]["errorno"],d[0]["errormessage"])}else{c.getDataAjaxSuccess1(d[0])}if(d[1]["status"]!=desknets.RES_STATUS_SUCCESS){desknets.ajax.onError(d[1]["errorno"],d[1]["errormessage"])}else{c.getDataAjaxSuccess2(d[1])}}},getDataAjaxSuccess1:function(c){},getDataAjaxSuccess2:function(c){},getDataParamCmd1:function(){return""},getDataParam1:function(){return{}},getDataParamCmd2:function(){return""},getDataParam2:function(){return{}},})})(jQuery);desknets.tcard.PageBaseTcardList={m_iTimeCardForm:"",m_iListLineCount:0,m_bFromTheMiddle:false,_getListAjaxSuccess:function(c){var b=this;m_iListLineCount=0;m_bFromTheMiddle=false;b.callBase("_getListAjaxSuccess",c)},_listheader:function(d){var b=this;var e=d.timecardform;b.m_iTimeCardForm=Number(e);var c=b.$mjListPage.find(".jtcard-month-head");c.find(".jtcard-fld-targetdate").text(d.targetdate)},_listLine:function(c,j){var l=this;var h="";var g="";var b="";var k="";var e="";var f=desknets.Resource.dateFormat_dd;var d=neo.dateTime.parse(j.date);var i=neo.dateTime.format("dd",d);if(m_iListLineCount==0&&i!=1){f=desknets.Resource.dateFormat_mmdd;m_bFromTheMiddle=true}else{if(m_bFromTheMiddle==true&&i==1){f=desknets.Resource.dateFormat_mmdd}}var h=neo.dateTime.format(f,d);c=desknets.tmpl.replaceWordHtml(c,"datefmt",h);h=desknets.tcardcom.getStyleClassNameWeek(j.weekid,j.rest,j.holiday);c=desknets.tmpl.replaceWordHtml(c,"class-week",h);h=desknets.tcardcom.createHtmlTimeRec(j,"stimeflag","stime",desknets.Resource.tcard.time_noinput);if(h==""){h="&nbsp;"}c=desknets.tmpl.replaceWordHtml(c,"stime",h);k=desknets.tcardcom.createHtmlTimeRec(j,"outtimeflag1","outtime1","");e=desknets.tcardcom.createHtmlTimeRec(j,"intimeflag1","intime1","");if(k.length>0||e.length>0){g=k+"<br />";b=e+"<br />"}if(l.m_iTimeCardForm==8){k=desknets.tcardcom.createHtmlTimeRec(j,"outtimeflag2","outtime2","");e=desknets.tcardcom.createHtmlTimeRec(j,"intimeflag2","intime2","");if(k.length>0||e.length>0){g=g+k+"<br />";b=b+e+"<br />"}k=desknets.tcardcom.createHtmlTimeRec(j,"outtimeflag3","outtime3","");e=desknets.tcardcom.createHtmlTimeRec(j,"intimeflag3","intime3","");if(k.length>0||e.length>0){g=g+k+"<br />";b=b+e+"<br />"}}if(g==""){g="&nbsp;"}c=desknets.tmpl.replaceWordHtml(c,"outtime",g);if(b==""){b="&nbsp;"}c=desknets.tmpl.replaceWordHtml(c,"intime",b);h=desknets.tcardcom.createHtmlTimeRec(j,"etimeflag","etime",desknets.Resource.tcard.time_noinput);if(h==""){h="&nbsp;"}c=desknets.tmpl.replaceWordHtml(c,"etime",h);h=l._createHtmlNote(j);if(h==""){h="&nbsp;"}c=desknets.tmpl.replaceWordHtml(c,"Note",h);c=l.callBase("_listLine",c,j);m_iListLineCount=m_iListLineCount+1;return c},_createHtmlNote:function(k){var l=this;var j="";var g="";var d="";var b="";var c="";var e="";var f="";var h="";var i="";d=k.absencereason;j=desknets.tcardcom.getAbsenceName(d);b=desknets.tmpl.escapeWord(k.absencereasonfree);if((j.length>0)||(b.length>0)){g=g+desknets.tcardcom.createHtmlNoteRec(j,b,"tcard-normal")}c=k.late;j=desknets.tcardcom.getLateName(c);e=desknets.tmpl.escapeWord(k.sreason);if((j.length>0)||(e.length>0)){if(c=="2"){g=g+desknets.tcardcom.createHtmlNoteRec(j,e,"tcard-approval")}else{g=g+desknets.tcardcom.createHtmlNoteRec(j,e,"tcard-late")}}f=k.leaveearly;j=desknets.tcardcom.getLeaveearlyName(f);h=desknets.tmpl.escapeWord(k.ereason);if((j.length>0)||(h.length>0)){if(f=="2"){g=g+desknets.tcardcom.createHtmlNoteRec(j,h,"tcard-approval")}else{g=g+desknets.tcardcom.createHtmlNoteRec(j,h,"tcard-early")}}if(neo.isSet(k.Note)&&k.Note.length>0){i=desknets.tmpl.dispStr(k.Note)}if(i.length>0){g=g+'<span class="tcard-normal" title="{{title}}">{{snote}}</span><br />';g=desknets.tmpl.replaceWordHtml(g,"snote",i);g=desknets.tmpl.replaceWord(g,"title",k.Note)}return g},_initPrintLink:function(){var b=this;var c={};c.cgiurl="zhtml";c.cgiprm={cmd:"printhtml",fldlang:desknets.Resource.code,execcmd:"tcardprint",};var d=function(e,g){var f=b._getPrintDataParam();var h=true;if(desknets.browser.ipad){h=false}desknets.ajax.rest({async:h,url:desknets.getUrl(b._getRestModule()),data:f,success:function(j,i,l){var k=b._buildPrintHtmlBody(e,g,j);g.$("#jco-print-body").html(k);g.$("a").each(function(){var n=a(this);var o=n.attr("class");var m=n.html();n.replaceWith('<span class="'+o+'">'+m+"</span>")});g.print()}});return false};desknets.print.init(b.$mjListPage,d,c)},_buildPrintHtmlBody:function(n,c,l){var m=this;var j=[];var i=null;j[j.length]='<div id="tcard-preview">';var g=m._getTemplatePrintHtmlBodyHeader();var b=n.find(".jtcard-fld-targetdate").text();g=m._setPrintHtmlBodyHeader(g,b,l);j[j.length]=g;var e='<div class="dn-preview-main"><table class="co-table-list tcard-timecard-table">{{Datail}}</table></div>';var k=n.find(".co-table-list").html();j[j.length]=desknets.tmpl.replaceWordHtml(e,"Datail",k);var f=m._getTemplatePrintHtmlBodyFooter();f=m._setPrintHtmlBodyFooter(f,l);var d=desknets.dateTime.current;var h=neo.dateTime.format(desknets.Resource.dateTimeFormat,d);h=h+desknets.Resource.tcard.create;var i=new RegExp("{{credate}}","ig");f=f.replace(i,h);j[j.length]=f;j[j.length]="</div>";return j.join("")},_getTemplatePrintHtmlBodyHeader:function(){var b='<div class="dn-preview-header"><div class="tcard-preview-header-left"><h1 class="tcard-preview-title">{{title}}<br />{{targetdate}}</h1><table class="tcard-table"><tr><th class="co-th">{{title_username}}</th><td class="co-td">{{username}}</td></tr><tr><th class="co-th">{{title_groupname}}</th><td class="co-td">{{groupname}}</td></tr></table></div><div class="tcard-preview-header-right"><table id="tcard-view-signs"><tr><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th><th>&nbsp;</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></table></div></div>';b=desknets.tmpl.replaceWordHtml(b,"title",desknets.Resource.tcard.print_title);b=desknets.tmpl.replaceWordHtml(b,"title_username",desknets.Resource.tcard.username);b=desknets.tmpl.replaceWordHtml(b,"title_groupname",desknets.Resource.tcard.groupname);return b},_getTemplatePrintHtmlBodyFooter:function(){var b='<div class="dn-preview-footer"><table class="tcard-table"><tr><th class="tcard-th" rowspan="2">{{title_total_workday}}</th><th class="tcard-th">{{title_total_day}}</th><td class="tcard-td co-td-num">{{total_workday}}</td><th class="tcard-th" rowspan="2">{{title_total_overday}}</th><th class="tcard-th">{{title_total_day}}</th><td class="tcard-td co-td-num">{{total_overday}}</td><th class="tcard-th" rowspan="2">{{title_total_restday}}</th><th class="tcard-th">{{title_total_day}}</th><td class="tcard-td co-td-num">{{total_restday}}</td></tr><tr><th class="tcard-th">{{title_total_time}}</th><td class="tcard-td co-td-num">{{total_worktime}}</td><th class="tcard-th">{{title_total_time}}</th><td class="tcard-td co-td-num">{{total_overtime}}</td><th class="tcard-th">{{title_total_time}}</th><td class="tcard-td co-td-num">{{total_resttime}}</td></tr></table><table class="tcard-table"><tr><th class="tcard-th">{{title_total_late}}</th><th class="tcard-th">{{title_total_leaveearly}}</th><th class="tcard-th">{{title_total_absence}}</th><th class="tcard-th">{{title_total_congorcond}}</th><th class="tcard-th">{{title_total_paidvacation}}</th><th class="tcard-th">{{title_total_compeholiday}}</th><th class="tcard-th">{{title_total_other}}</th><th class="tcard-th">{{title_total_nodata}}</th></tr><tr><td class="tcard-td co-td-num">{{total_late}}</td><td class="tcard-td co-td-num">{{total_leaveearly}}</td><td class="tcard-td co-td-num">{{total_absence}}</td><td class="tcard-td co-td-num">{{total_congorcond}}</td><td class="tcard-td co-td-num">{{total_paidvacation}}</td><td class="tcard-td co-td-num">{{total_compeholiday}}</td><td class="tcard-td co-td-num">{{total_other}}</td><td class="tcard-td co-td-num">{{total_nodata}}</td></tr></table><p class="co-tright">{{credate}}</p></div>';objRep=new RegExp("{{title_total_workday}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_workday);objRep=new RegExp("{{title_total_overday}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_overday);objRep=new RegExp("{{title_total_restday}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_restday);objRep=new RegExp("{{title_total_day}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_day);objRep=new RegExp("{{title_total_time}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_time);objRep=new RegExp("{{title_total_late}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_late);objRep=new RegExp("{{title_total_leaveearly}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_leaveearly);objRep=new RegExp("{{title_total_absence}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_absence);objRep=new RegExp("{{title_total_congorcond}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_congorcond);objRep=new RegExp("{{title_total_paidvacation}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_paidvacation);objRep=new RegExp("{{title_total_compeholiday}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_compeholiday);objRep=new RegExp("{{title_total_other}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_other);objRep=new RegExp("{{title_total_nodata}}","ig");b=b.replace(objRep,desknets.Resource.tcard.total_nodata);return b},_setPrintHtmlBodyHeader:function(c,d,b){var e="";objRep=new RegExp("{{targetdate}}","ig");c=c.replace(objRep,d);c=desknets.tmpl.replaceWord(c,"username",b.Name);c=desknets.tmpl.replaceWord(c,"groupname",b.evgname);return c},_setPrintHtmlBodyFooter:function(c,b){objRep=new RegExp("{{total_workday}}","ig");c=c.replace(objRep,b.workday);objRep=new RegExp("{{total_worktime}}","ig");c=c.replace(objRep,b.worktime);objRep=new RegExp("{{total_overday}}","ig");c=c.replace(objRep,b.overday);objRep=new RegExp("{{total_overtime}}","ig");c=c.replace(objRep,b.overtime);objRep=new RegExp("{{total_restday}}","ig");c=c.replace(objRep,b.restday);objRep=new RegExp("{{total_resttime}}","ig");c=c.replace(objRep,b.resttime);objRep=new RegExp("{{total_late}}","ig");c=c.replace(objRep,b.late);objRep=new RegExp("{{total_leaveearly}}","ig");c=c.replace(objRep,b.leaveearly);objRep=new RegExp("{{total_absence}}","ig");c=c.replace(objRep,b.absence);objRep=new RegExp("{{total_congorcond}}","ig");c=c.replace(objRep,b.congorcond);objRep=new RegExp("{{total_paidvacation}}","ig");c=c.replace(objRep,b.paidvacation);objRep=new RegExp("{{total_compeholiday}}","ig");c=c.replace(objRep,b.compeholiday);objRep=new RegExp("{{total_other}}","ig");c=c.replace(objRep,b.other);objRep=new RegExp("{{total_nodata}}","ig");c=c.replace(objRep,b.nodata);return c},_getPrintDataParam:function(){var b=this;var c={};c.cmd=b._getPrintDataCmd();c.date=b.m_sTargetDate;return c},_getPrintDataCmd:function(){return desknets.tcard.CMD_TCARDREPORTMONTH},_getIdListPageForm:function(){return"tcadlistfrm"},};(function(b){desknets.page(desknets.tcard,"subwin",desknets.PageBaseMulti,{init:function(){var c=this;c.callBase("init")},reload:function(){var c=this;c._getMultiAjax()},_getListCmd:function(){return desknets.tcard.PAGE_TCARDLIST},_getRestModule:function(){return desknets.tcard.MODULE_API_TCARD},getDataAjaxSuccess1:function(c){$ototal=b(".jtcard-total-area");if(typeof c=="object"){for(cKey in c){var d=".jtcard-total-"+cKey+"1";$ototal.find(d).text(c[cKey])}}return},getDataAjaxSuccess2:function(c){$ototal=b(".jtcard-total-area");if(typeof c=="object"){for(cKey in c){var d=".jtcard-total-"+cKey+"2";$ototal.find(d).text(c[cKey])}}return},getDataParamCmd1:function(){return desknets.tcard.CMD_TCARDREPORTMONTH},getDataParam1:function(){var c={};c.addmonth="-1";return c},getDataParamCmd2:function(){return desknets.tcard.CMD_TCARDREPORTMONTH},getDataParam2:function(){var c={};return c},})})(jQuery);(function(b){desknets.page(desknets.tcard,"tcardentry",desknets.PageInputBase,{_initSet:function(d){var c=this;this.callBase("_initSet",d);if(!c.$mjPage.find(".jtcard-entry-type").hasClass("none")){desknets.timePicker.create(c.$mjPage.find('input[name="updatestime"]'));desknets.timePicker.create(c.$mjPage.find('input[name="updateouttime1"]'));desknets.timePicker.create(c.$mjPage.find('input[name="updateintime1"]'));if(c.$mjPage.find(".jtcard-entry-type").hasClass("eight")){desknets.timePicker.create(c.$mjPage.find('input[name="updateouttime2"]'));desknets.timePicker.create(c.$mjPage.find('input[name="updateintime2"]'));desknets.timePicker.create(c.$mjPage.find('input[name="updateouttime3"]'));desknets.timePicker.create(c.$mjPage.find('input[name="updateintime3"]'))}desknets.timePicker.create(c.$mjPage.find('input[name="updateetime"]'))}},_getRestModule:function(){return desknets.tcard.MODULE_API_TCARD},_getAddExecCmd:function(){return desknets.tcard.CMD_TCARDENTRY},_getModExecCmd:function(){var c=this;return c._getAddExecCmd()},})})(jQuery);(function(b){desknets.page(desknets.tcard,"basetcardindex",desknets.PageMultiList,desknets.tcard.PageBaseTcardList);desknets.page(desknets.tcard,"tcardindex",desknets.tcard.basetcardindex,{m_oBackupHash:"",m_sTargetDate:"",init:function(){var c=b("#jco-m-list-container").find(".jco-back-page-data");c.find('input[name="row"]').remove();c.find('input[name="fldsort"]').remove();c.find('input[name="order"]').remove();c.find('input[name="num"]').remove();c.find('input[name="gid"]').remove();c.find('input[name="prid"]').remove();this.callBase("init");this._appendEventHandler()},_appendEventHandler:function(){var c=this;c._initPrintLink();c.$mjListPage.find(".jco-list-dl-submit").click(function(f){var d=desknets.tcard.MODULE_TCARD+"."+desknets._msExtension;var e=desknets.tcard.CMD_TCARDEXPORT;c.$mjListPage.find('form[name="listfrm"]').attr("action",d);c.$mjListPage.find('input[name="cmd"]').val(e)});c.$mjListPage.find(".jtcard-btn-stime").click(function(d){d.preventDefault();c._callApiTcardCmdTick("go")});c.$mjListPage.find(".jtcard-btn-outtime").click(function(d){d.preventDefault();c._callApiTcardCmdTick("out")});c.$mjListPage.find(".jtcard-btn-intime").click(function(d){d.preventDefault();c._callApiTcardCmdTick("return")});c.$mjListPage.find(".jtcard-btn-etime").click(function(d){d.preventDefault();c._callApiTcardCmdTick("leave")});b(".jtcard-change-today").click(function(d){d.preventDefault();var e=desknets.pageframe.getServerDate();c._changeTargetDate(neo.dateTime.format("yyyyMMdd",e))});b(".jtcard-change-month").click(function(d){d.preventDefault();var e=b(this).attr("href").replace(/#/,"");e=desknets.dateTime.computeMonth(c.m_sTargetDate,e);c._changeTargetDate(e)})},_callApiTcardCmdTick:function(e){var c=this;var d={};d.cmd=desknets.tcard.CMD_TCARDSTAMP;d.mode=e;desknets.ajax.rest({url:desknets.getUrl(c._getRestModule()),data:d,success:function(g,f,h){c._getListAjax(c._getListRow())},traditional:true})},_changeTargetDate:function(e,f){var c=this;c.m_oBackupHash=desknets.paramanalyzer.getHashParams();var d={};d=desknets.paramanalyzer.getHashParams();d.cmd=this._getListCmd();d.date=""+e;this._setLocationHash(d,f)},getListParamToObj:function(){var d=this.callBase("getListParamToObj");var c=desknets.paramanalyzer.getHashParams();c.cmd=this._getListExecCmd();return c},onError:function(d,e){var c=this;if(d!=desknets.tcard.ERRORNO_TCARDSAVEOVER){c.callBase("onError",d,e)}else{var g=desknets.dialog.alert(e,{errorNo:d});var f={close:function(i){var h=g.hasClass("warn")?"warn":"error";desknets.dialog.deleteById(h);c._setLocationHash(c.m_oBackupHash)}};g.dialog(f)}},_getListAjaxSuccess:function(d){var c=this;if(typeof(d[0])=="object"){if(d[0]["status"]==desknets.RES_STATUS_SUCCESS){c._listheader(d[0])}}else{c._listheader(d)}c.callBase("_getListAjaxSuccess",d)},_listheader:function(d){var c=this;c.callBase("_listheader",d);c.$mjListPage.find(".jco-back-page-data").find('input[name="date"]').val(d.date);c.m_sTargetDate=d.date},inputModPage:function(d){var c=this;c.inputDispPage(d)},_getRestModule:function(){return desknets.tcard.MODULE_API_TCARD},_getListCmd:function(){return desknets.tcard.PAGE_TCARDLIST},_getListExecCmd:function(){return desknets.tcard.CMD_TCARDINDEX},_getListDispCmd:function(){return desknets.tcard.PAGE_TCARDENTRY},_getListDispClass:function(){return desknets.tcard.tcardentry},_initAddDataStart:function(){},_getAddDataAjaxSuccess:function(j){var k=this;var i="";var h=k.$mjListPage.find(".jtcard-timeinput-head");h.find(".jtcard-fld-tickdate").text(j.tickdate);h.find(".jtcard-fld-workstime").text(j.workstime);h.find(".jtcard-fld-worketime").text(j.worketime);var g=k.$mjListPage.find(".tcard-table-timeinput");if(j.stimetsts=="1"){g.find(".jtcard-btn-stime").hide();g.find(".jtcard-lbl-stime").show()}else{g.find(".jtcard-btn-stime").show();g.find(".jtcard-lbl-stime").hide()}if(j.outtimetsts=="1"){g.find(".jtcard-btn-outtime").hide();g.find(".jtcard-lbl-outtime").show()}else{g.find(".jtcard-btn-outtime").show();g.find(".jtcard-lbl-outtime").hide()}if(j.intimetsts=="1"){g.find(".jtcard-btn-intime").hide();g.find(".jtcard-lbl-intime").show()}else{g.find(".jtcard-btn-intime").show();g.find(".jtcard-lbl-intime").hide()}if(j.etimetsts=="1"){g.find(".jtcard-btn-etime").hide();g.find(".jtcard-lbl-etime").show()}else{g.find(".jtcard-btn-etime").show();g.find(".jtcard-lbl-etime").hide()}if(j.absence>"0"){g.find(".jtcard-today-time").hide();g.find(".jtcard-today-absence").show()}else{g.find(".jtcard-today-time").show();g.find(".jtcard-today-absence").hide()}var e=j.absencereason;i=desknets.tcardcom.getAbsenceName(e);var c=desknets.tmpl.escapeWord(j.absencereasonfree);if((i.length>0)||(c.length>0)){i=desknets.tcardcom.createHtmlNoteRec(i,c,"tcard-normal")}g.find(".jtcard-fld-absence").html(i);i=desknets.tcardcom.createHtmlTimeRec(j,"stimeflag","stime","");if(i==""){i=desknets.tcardcom.time_nothing}g.find(".jtcard-fld-stime").html(i);var d=j.late;i=desknets.tcardcom.getLateName(d);if(i.length>0){if(d=="2"){i="&nbsp;"+desknets.tcardcom.createHtmlNoteRec(i,"","tcard-approval",false)}else{i="&nbsp;"+desknets.tcardcom.createHtmlNoteRec(i,"","tcard-late",false)}}g.find(".jtcard-fld-late").html(i);i=desknets.tcardcom.createHtmlTimeRec(j,"outtimeflag","outtime","");if(i==""){i=desknets.tcardcom.time_nothing}g.find(".jtcard-fld-outtime").html(i);i=desknets.tcardcom.createHtmlTimeRec(j,"intimeflag","intime","");if(i==""){i=desknets.tcardcom.time_nothing}g.find(".jtcard-fld-intime").html(i);i=desknets.tcardcom.createHtmlTimeRec(j,"etimeflag","etime","");if(i==""){i=desknets.tcardcom.time_nothing}g.find(".jtcard-fld-etime").html(i);var f=j.leaveearly;i=desknets.tcardcom.getLeaveearlyName(f);if(i.length>0){if(f=="2"){i="&nbsp;"+desknets.tcardcom.createHtmlNoteRec(i,"","tcard-approval",false)}else{i="&nbsp;"+desknets.tcardcom.createHtmlNoteRec(i,"","tcard-early",false)}}g.find(".jtcard-fld-leaveearly").html(i);desknets.tcard.subwin.reload()},_getAddDataGetCmd:function(){return desknets.tcard.CMD_TCARDTICK},getAddDataParam:function(){return{}},_listMoveScroll:function(){var d=this._getListCmd();var c=b(document);if(desknets.browser.msie8){c=b(window)}desknets.scrollManager.setScrollPosition(d,c,{y:0,delay:10})}})})(jQuery);(function(b){desknets.page(desknets.tcard,"tcardreportannual",desknets.PageListBaseDayChange,{BTN_CHANGEYEAR:".jtcard-change-year",m_iworkday:0,m_iworktime:0,m_ioverday:0,m_iovertime:0,m_irestday:0,m_iresttime:0,m_ilate:0,m_ileaveearly:0,m_iabsence:0,m_icongorcond:0,m_ipaidvacation:0,m_icompeholiday:0,m_iother:0,m_inodata:0,init:function(){var c=b("#jco-m-list-container").find(".jco-back-page-data");c.find('input[name="row"]').remove();c.find('input[name="fldsort"]').remove();c.find('input[name="order"]').remove();c.find('input[name="num"]').remove();c.find('input[name="gid"]').remove();c.find('input[name="prid"]').remove();this.callBase("init");this._appendEventHandler()},_appendEventHandler:function(){var c=this;c.$mjListPage.find(".jco-list-dl-submit").click(function(f){var d=desknets.tcard.MODULE_TCARD+"."+desknets._msExtension;var e=desknets.tcard.CMD_TCARDEXPORTANNUAL;c.$mjListPage.find('form[name="listfrm"]').attr("action",d);c.$mjListPage.find('input[name="cmd"]').val(e)})},_getListAjaxSuccess:function(d){var c=this;c._clearTotalVal();c.callBase("_getListAjaxSuccess",d)},_getListAjaxSuccessOtherSet:function(d){var c=this;c._dispTotalVal();desknets.tcard.subwin.reload();c.callBase("_getListAjaxSuccessOtherSet",d)},_listheader:function(e){var d=this;var c=d.$mjListPage.find(".jtcard-list-head");c.find(".jtcard-fld-targetdate").text(e.targetdate)},_replaceListLine:function(d,f,e){var c=this;d=c.callBase("_replaceListLine",d,f,e);c._countTotalVal(f,e);return d},_clearTotalVal:function(){var c=this;c.m_iworkday=0;c.m_iworktime=0;c.m_ioverday=0;c.m_iovertime=0;c.m_irestday=0;c.m_iresttime=0;c.m_ilate=0;c.m_ileaveearly=0;c.m_iabsence=0;c.m_icongorcond=0;c.m_ipaidvacation=0;c.m_icompeholiday=0;c.m_iother=0;c.m_inodata=0},_countTotalVal:function(f,d){var c=this;var e=desknets.escape(d[f]);if(f=="workday"){c.m_iworkday+=e-0}else{if(f=="worktime"){c.m_iworktime+=c._convertTimeVal(e)}else{if(f=="overday"){c.m_ioverday+=e-0}else{if(f=="overtime"){c.m_iovertime+=c._convertTimeVal(e)}else{if(f=="restday"){c.m_irestday+=e-0}else{if(f=="resttime"){c.m_iresttime+=c._convertTimeVal(e)}else{if(f=="late"){c.m_ilate+=e-0}else{if(f=="leaveearly"){c.m_ileaveearly+=e-0}else{if(f=="absence"){c.m_iabsence+=e-0}else{if(f=="congorcond"){c.m_icongorcond+=e-0}else{if(f=="paidvacation"){c.m_ipaidvacation+=e-0}else{if(f=="compeholiday"){c.m_icompeholiday+=e-0}else{if(f=="other"){c.m_iother+=e-0}else{if(f=="nodata"){c.m_inodata+=e-0}}}}}}}}}}}}}}},_convertTimeVal:function(e){var g=e.split(":");var d=g[0]-0;var f=g[1]-0;var c=(d*60)+f;return c},_convertTimeString:function(d){var c=0;var e=0;var g=0;var f="";c=d-0;g=c%60;c-=g;if(c>0){e=c/60}if(g<10){f=e+":0"+g}else{f=e+":"+g}return f},_dispTotalVal:function(){var d=this;var c=d.$mjListPage.find(".jtcard-list-total");c.find(".jtcard-fld-workday").text(d.m_iworkday);c.find(".jtcard-fld-worktime").text(d._convertTimeString(d.m_iworktime));c.find(".jtcard-fld-overday").text(d.m_ioverday);c.find(".jtcard-fld-overtime").text(d._convertTimeString(d.m_iovertime));c.find(".jtcard-fld-restday").text(d.m_irestday);c.find(".jtcard-fld-resttime").text(d._convertTimeString(d.m_iresttime));c.find(".jtcard-fld-late").text(d.m_ilate);c.find(".jtcard-fld-leaveearly").text(d.m_ileaveearly);c.find(".jtcard-fld-absence").text(d.m_iabsence);c.find(".jtcard-fld-congorcond").text(d.m_icongorcond);c.find(".jtcard-fld-paidvacation").text(d.m_ipaidvacation);c.find(".jtcard-fld-compeholiday").text(d.m_icompeholiday);c.find(".jtcard-fld-other").text(d.m_iother);c.find(".jtcard-fld-nodata").text(d.m_inodata)},_getChangeDayButtonName:function(){return this.BTN_CHANGEYEAR},_getRestModule:function(){return desknets.tcard.MODULE_API_TCARD},_getListCmd:function(){return desknets.tcard.PAGE_TCARDREPORTANNUAL},_getListExecCmd:function(){return desknets.tcard.CMD_TCARDREPORTANNUAL},})})(jQuery);(function(b){desknets.page(desknets.tcard,"tcardweeksituation",desknets.PageListBaseDayChange,{BTN_CHANGEWEEK:".jtcard-change-week",init:function(){var c=b("#jco-m-list-container").find(".jco-back-page-data");c.find('input[name="fldsort"]').remove();c.find('input[name="order"]').remove();c.find('input[name="prid"]').remove();this.callBase("init");desknets.page.groupSelect.init({},{allGroup:"choosable",unassignGroup:"choosable"})},_setListStyle:function(e){var d=this;var f=d.$mjTableList;var g="co-tr-even";var c=f.children();c.removeClass(g);c.filter(":nth-child(4n-1)").addClass(g);c.filter(":nth-child(4n)").addClass(g)},_getListAjaxSuccessOtherSet:function(d){var c=this;desknets.page.groupSelect.editSelectedGroup(c.$mjListPage.find(".jco-sel-items"),d);c.callBase("_getListAjaxSuccessOtherSet",d)},_initListEnd:function(){var c=this;desknets.tcard.subwin.reload();c.callBase("_initListEnd")},_listheader:function(h){var e=this;var j="";var d=e.$mjListPage.find(".jtcard-list-head");d.find(".jtcard-fld-targetdate").text(h.targetdate);var i=e.$mjListPage.find(".tcard-table-list");for(icnt=1;icnt<=7;icnt++){var g=neo.dateTime.parse(h["date"+icnt]);var c=neo.dateTime.format(desknets.Resource.dateFormat_mmdd,g);var f="#jtcard-fld-date"+icnt;i.find(f).text(c);desknets.tcardcom.removeStyleClassNameWeek(b(f));j=desknets.tcardcom.getStyleClassNameWeek(h["weekid"+icnt],h["rest"+icnt],h["holiday"+icnt]);b(f).addClass(j)}},_listLine:function(d,e){var c=this;var g="";g=e.Name;d=desknets.tmpl.replaceWord(d,"Name",g);for(var f=1;f<=7;f++){d=c._listLineTimeField(d,e,f)}return d},_listLineTimeField:function(e,i,f){var p=this;var s="";var w="absence"+f;var l="stime"+f;var z="stimeflag"+f;var u="late"+f;var y="etime"+f;var g="etimeflag"+f;var x="leaveearly"+f;var m="rowspan"+f;var j="stime"+f;var t="late"+f;var v="etime"+f;var q="leaveearly"+f;var r=".jtcard-etime"+f;var n=i[w];if(n>"0"){e=desknets.tmpl.replaceWordHtml(e,m,'rowspan="2"');var d=b("<div />").html(e);var o=d.find(r);o.remove();e=d.html();s=desknets.tcardcom.getAbsenceName(n);var h='<span title="{{str}}">{{str}}</span>';h=desknets.tmpl.replaceWordHtml(h,"str",s);e=desknets.tmpl.replaceWordHtml(e,j,h);e=desknets.tmpl.replaceWordHtml(e,u,"")}else{e=desknets.tmpl.replaceWordHtml(e,m,"");s=desknets.tcardcom.createHtmlTimeRec(i,z,l,"");if(s==""){s=desknets.tcardcom.time_nothing}e=desknets.tmpl.replaceWordHtml(e,j,s);var c=i[u];s=desknets.tcardcom.getLateName(c);if(s.length>0){if(c=="2"){s="&nbsp;"+desknets.tcardcom.createHtmlNoteRec(s,"","tcard-approval",false)}else{s="&nbsp;"+desknets.tcardcom.createHtmlNoteRec(s,"","tcard-late",false)}}e=desknets.tmpl.replaceWordHtml(e,t,s);s=desknets.tcardcom.createHtmlTimeRec(i,g,y,"");if(s==""){s=desknets.tcardcom.time_nothing}e=desknets.tmpl.replaceWordHtml(e,v,s);var k=i[x];s=desknets.tcardcom.getLeaveearlyName(k);if(s.length>0){if(k=="2"){s="&nbsp;"+desknets.tcardcom.createHtmlNoteRec(s,"","tcard-approval")}else{s="&nbsp;"+desknets.tcardcom.createHtmlNoteRec(s,"","tcard-early")}}e=desknets.tmpl.replaceWordHtml(e,q,s)}return e},_computeChangeDate:function(d,e){var c=desknets.dateTime.moveDate(d,e);return c},_getChangeDayButtonName:function(){return this.BTN_CHANGEWEEK},_getRestModule:function(){return desknets.tcard.MODULE_API_TCARD},_getListCmd:function(){return desknets.tcard.PAGE_TCARDWEEKSITUATION},_getListExecCmd:function(){return desknets.tcard.CMD_TCARDWEEKSITUATION},})})(jQuery);app.addInitialAction(function(){desknets.tcard.init()})})(jQuery);