/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.memoutil={_tmplManu:'<span title="{{title}}">{{value}}</span>',_tmplAuto:'<div title="{{title}}" class="memo-sch">{{value}}</div>',_tmplAutoEvent:'<div title="{{title}}" class="memo-sch">{{icon}}{{value}}</div>',_editArray:["event","place","date","memo"],_tmplOpts:{sameDateDisp:false,dateTimeDisp:true},_$dialog:null,_otherto:null,_DIALOG_ID:"memo-entry-dialog",PAGE_MEMOENTRY:"memoentrytarget",CMD_MEMOENTRY:"memocmdentry",getWhereContactClass:function(d){var b="memo-tel-other";var c={"1":"memo-tel-company","2":"memo-tel-naisen","3":"memo-tel-phone"};if(neo.isSet(d)&&neo.isSet(c[d])){b=c[d]}return b},editWhereListLine:function(d,i,b){var j=this;var g;if(!!b){g=b}else{g=j._editArray}i.contactClass=j.getWhereContactClass(i.contactflg);if(neo.isSet(i.allcnt)){if(i.allcnt!="0"){var e=desknets.ajax.getItems(i.list.item);a.each(e,function(l,m){a.each(g,function(n,o){if(o=="event"){i[o]=j._replaceWhereSchEvent(i[o],m)}else{if(o=="place"){i[o]=j._replaceWhereSchPlace(i[o],m)}else{if(o=="date"){i[o]=j._replaceWhereSchDate(i[o],m)}else{if(o=="memo"){i[o]=j._replaceWhereSchMemo(i[o],m)}}}}})});var c=Number(i.allcnt)-e.length;if(c>0){var k=desknets.tmpl.replaceWordChk(desknets.Resource.Message.com_memo_where_schmore,"morecnt",c);var h=desknets.tmpl.replaceWordChk(j._tmplAuto,"title",k);h=desknets.tmpl.replaceWordChk(h,"value",k);var f=desknets.tmpl.replaceWordChk(j._tmplAuto,"title","");f=desknets.tmpl.replaceWordChkHtml(f,"value","&nbsp;");a.each(g,function(l,m){if(l==0){i[m]=i[m]+h}else{i[m]=i[m]+f}})}delete i.list}else{a.each(g,function(l,m){i[m]="&nbsp;"})}}else{if(neo.isSet(i.where,{blank:false})){i.place="["+i.where+"]"+i.place}a.each(g,function(m,n){var l=j._tmplManu;l=desknets.tmpl.replaceWordChk(l,"title",i[n]);l=desknets.tmpl.replaceWordChk(l,"value",i[n]);i[n]=l})}return i},setWhereListStyle:function(c){if(desknets.browser.msie8&&!!c){var b=0;var d=c.find("tr");a.each(d,function(e,g){var f=a(this).find("td").eq(2).find(".memo-sch");if(neo.isSet(f)&&f.length>2){f.eq(2).addClass("memo-sch-more")}b=e});d.eq(b).addClass("memo-list-lasttr")}},entryDialogInit:function(c,b,d){if(!!d){this._DIALOG_ID=d}this.entryDialogDestroy();this._otherto={id:c,name:b};this._sendSchMemoAjaxGetHtml()},entryDialogDestroy:function(){if(this._$dialog){desknets.dialog.deleteById(this._DIALOG_ID);this._$dialog=null}},_replaceWhereSchEvent:function(c,e){var b=this;var f="";var g=b._tmplAutoEvent;var d=desknets.cal.getSubject(e.event,e.detail);if(!neo.isSet(c)){c=""}f=desknets.cal.tmpl.getIconsAsText(e)+d;g=desknets.tmpl.replaceWordChk(g,"title",f);g=desknets.tmpl.replaceWordChk(g,"value",d.length>0?d:" ");g=desknets.tmpl.replaceWordChkHtml(g,"icon",desknets.cal.tmpl.getIconsAsHtml(e));return c+g},_replaceWhereSchPlace:function(d,e){var c=this;var f=c._tmplAuto;var b=desknets.cal.getSubject(e.place,e.other);if(!neo.isSet(d)){d=""}f=desknets.tmpl.replaceWordChk(f,"title",b);f=desknets.tmpl.replaceWordChk(f,"value",b.length>0?b:" ");return d+f},_replaceWhereSchDate:function(d,e){var b=this;var f=b._tmplAuto;var c=desknets.cal.tmplList.getRowHtml("{{date}}",e,b._tmplOpts);if(!neo.isSet(d)){d=""}f=desknets.tmpl.replaceWordChkHtml(f,"title",c);f=desknets.tmpl.replaceWordChkHtml(f,"value",c.length>0?c:"&nbsp;");return d+f},_replaceWhereSchMemo:function(d,e){var c=this;var f=c._tmplAuto;var b=e.memo;if(!neo.isSet(d)){d=""}f=desknets.tmpl.replaceWordChk(f,"title",neo.isSet(b)?b:"");f=desknets.tmpl.replaceWordChk(f,"value",neo.isSet(b,{blank:false})?b:" ");return d+f},_sendSchMemoAjaxGetHtml:function(){var b=this;var c=desknets.getUrl(desknets.MODULE_API_MAIN);var d=desknets.ajax.arrayToMultiCmdData(this._getSchMemoAjaxParamGetHtml());desknets.ajax.rest({id:this._DIALOG_ID,url:c,data:d,type:"POST",success:function(f,e,g){b._onSuccessSchMemoGetHtml(f)},error:function(g,f,e){if(f!="abort"){desknets.ajax.onError(g.status,e)}}})},_getSchMemoAjaxParamGetHtml:function(){var c;var b={};var d=0;c={};c.cmd=this.PAGE_MEMOENTRY;c.uid=this._otherto.id;b[d]=c;d++;return b},_onSuccessSchMemoGetHtml:function(c){var b=0;var d;d=this._setSchMemoDlgHtml(c[b]);if(!d){return}b++;this._$dialog.dialog("open");var e=this._$dialog.find(".jco-input-whom");desknets.watermark.set(e);e.removeAttr("title");e.blur()},_setSchMemoDlgHtml:function(e){var d=e.html;if(!neo.isSet(d)){return false}var c=a(d).find(".co-mainarea").find(".co-etable");var b=a("<form></form>").append(c);b.find(".jsch-memo-dlg-target").text(this._otherto.name);this._$dialog=desknets.dialog.make(this._DIALOG_ID,this._getDialogOption());this._$dialog.append(b);desknets.comMemo.setTagColorVal(this._$dialog);return true},_getDialogOption:function(){var b=this;var e={};e[desknets.Resource.OKButtonLabel]=function(){desknets.submitform.setDialogDisabled(b._$dialog);b._sendSchMemoAjaxAddMemo()};e[desknets.Resource.CancelButtonLabel]=function(){b._$dialog.dialog("close")};var d=desknets.dialog.getDialogOption();var c={title:desknets.Resource.Message.com_memo_dialogtitle,width:600,buttons:e,close:function(){neo.ajax.abort(b._DIALOG_ID,true)}};a.extend(d,c);return d},_sendSchMemoAjaxAddMemo:function(){var b=this;var c=desknets.getUrl(desknets.MODULE_API_MAIN);var d=this._getSchMemoAjaxParamAddMemo();desknets.ajax.rest({id:this._DIALOG_ID,url:c,data:d,type:"POST",success:function(f,e,g){b._$dialog.dialog("close");desknets.submitform.clearDialogDisabled(b._$dialog)},error:function(g,f,e){if(f!="abort"){desknets.ajax.onError(g.status,e);desknets.submitform.clearDialogDisabled(b._$dialog)}},errorconvmsg:function(e,f){var g=desknets.getErrField(e,f);g.fieldname=desknets.getErrFieName(b._$dialog,g.fieldid);return desknets.getErrConvMsg(g)}})},_getSchMemoAjaxParamAddMemo:function(){var b;b={};b.cmd=this.CMD_MEMOENTRY;b.otherto=this._otherto.id;form=this._$dialog.find("form").formToArrayEx();a.extend(b,form);if(!b.tag){b.tag=desknets.comMemo.VAL_MEMO_TAGOFF}return b}};desknets.memo={CMD_MEMORECEINDEX:"memoreceindex",CMD_MEMOSENDINDEX:"memosendindex",CMD_MEMORECEREFER:"memocmdreferreceive",CMD_MEMOSENDREFER:"memocmdrefersend",CMD_MEMOENTRY:"memocmdentry",CMD_MEMORECEDELETE:"memocmddelreceive",CMD_MEMOSENDDELETE:"memocmddelsend",CMD_MEMOTAGSET:"memocmdtag",CMD_MEMOWHEREREFER:"memowhererefer",CMD_MEMOWHEREENTRY:"memocmdwhereentry",VAL_MEMO_TAGDELCOLOR:"0",VAL_MEMO_TAGADDCOLOR:"3",};a.extend(desknets.memo,{PAGE_MEMORECEINDEX:"memoreceive",PAGE_MEMOSENDINDEX:"memosend",PAGE_MEMOENTRY:"memoentry",PAGE_MEMORECEREFER:"memoreferreceive",PAGE_MEMOSENDREFER:"memorefersend",PAGE_MEMOINDEX:"memoindex",PAGE_MEMOWHEREENTRY:"memowhereentry",CMD_MEMO:"memocmd",CMD_MEMOREADED:"memocmdreaded",CMD_MEMOLISTCNT:"memolistcnt",CMD_MEMOWHEREINNDEX:"memowhereindex",funcID:null,init:function(){var c=this;var b=a("#jco-pv-funcid").val();this.setFuncID(b);if(b==c.PAGE_MEMOINDEX){desknets.hashobserver.init(desknets.memo,"desknets.memo");desknets.memo.memoindex.init();desknets.tags.memo.setUpFuncAfterAjax(c.changeMainContent)}},setFuncID:function(b){this.funcID=b},getFuncID:function(){return this.funcID},setSendDelConfDialog:function(c){var d=null;var e=desknets.Resource.Message.memo_addmsg_senddel;var b={};if(!neo.isSet(c)||!neo.isSet(c.confmsg)){return}b.extraMessage=e;b.extraClass="co-msg-b";d=desknets.dialog.confirm(c.confmsg,function(){if(neo.isSet(c.delFunc)&&a.isFunction(c.delFunc)){c.delFunc(d);return false}},b);return d},changeMainContent:function(c,d){if(c.data("module")!="memo"){return true}var b=desknets.paramanalyzer.getHashParams();if(!neo.isSet(b.cmd)){b.cmd=""}if(b.cmd==desknets.memo.PAGE_MEMORECEINDEX){a("#jmemo-m-memolist-page").find(".co-btn-update").click()}if(b.cmd==desknets.memo.PAGE_MEMORECEREFER){if(b.id==a.trim(c.data("did"))){a(".co-select-menu-text").html(a(".tag-disp-options:first").find("a:first").html());a('input[name="tagcolor"]').val("0")}}return true}});desknets.memo.edit={_tmplTag:'<span class="co-select-menu-text"><span title="{{tagtext}}" class="co-tag-select-item {{tagcolor}}">{{tagtext}}</span></span>',_tmplSchNavi:'<div class="memo-sch-navi"><a title="'+desknets.Resource.Pager.msgPagePrev+'" href="#" class="prev off">'+desknets.Resource.Pager.msgPagePrev+'</a><a title="'+desknets.Resource.Pager.msgPageNext+'" href="#" class="next">'+desknets.Resource.Pager.msgPageNext+'</a><span class="navi">'+desknets.Resource.memo.schnavi+"</span></div>",editDispTagIcon:function(b){var c=this;var d=c._tmplTag;var f={"0":"x","1":desknets.Resource.memo.memotagset};var e={"0":"none","1":"yellow"};d=desknets.tmpl.replaceWordHtml(d,"tagtext",f[b]);d=desknets.tmpl.replaceWordHtml(d,"tagcolor",e[b]);return d},editDispWhereRefer:function(c,f){var b=this;var d=f.wmode&&f.wmode!="2";var e=c.find(".memo-where-disp");e.empty();if(!d){c.find(".jmemo-wheredisp-tmpl").tmpl(f).appendTo(e);c.find(".memo-mod").show()}else{b._editDispWhereAutoRefer(c,f);e.find(".memo-sch").hide().filter('[data-num="1"]').show();c.find(".memo-mod").hide()}},_editDispWhereAutoRefer:function(d,i){var c=this;var e=0;var f=[];var b=false;var g=d.find(".memo-where-disp");if(i&&i.list){f=desknets.ajax.getItems(i.list.item)}else{i.date="";i.memo="";f[0]=i;b=true}var h=d.find(".jmemo-wheredisp-tmpl");a.each(f,function(j,k){k.event=desknets.cal.getSubject(k.event,k.detail);k.place=desknets.cal.getSubject(k.place,k.other);if(!b){k.date=desknets.cal.tmplList.getRowHtml("{{date}}",k,desknets.memoutil._tmplOpts)}e=j+1;k.dnum=e;k.contactflg=i.contactflg;k.contact=i.contact;k.icon=desknets.cal.tmpl.getIconsAsHtml(k);d.find(".jmemo-wheredisp-tmpl").tmpl(k).appendTo(g)});if(e>1){g.prepend(desknets.tmpl.replaceWordChkHtml(c._tmplSchNavi,"allcnt",e))}g.html('<div class="memo-schs">'+g.html()+"</div>")}};desknets.page(desknets.memo,"memoindex",desknets.PageListBase,{_tmplManu:'<span title="{{title}}">{{value}}</span>',_tmplAuto:'<div title="{{title}}" class="memo-sch">{{value}}</div>',_tmplAutoEvent:'<div title="{{title}}" class="memo-sch">{{icon}}{{value}}</div>',_tmplDlgMemo:'<a href="#" class="co-fright co-msg-memo">{{memoRes}}</a>',_profDlg:null,_listSch:["event","place","date","memo"],_bomemocnt:false,valMemoBproc:null,boMemoBproc:true,_initSet:function(){var c=this;var e=desknets.paramanalyzer.getLocationHash();var d=c.$mjListPage.find("select.jmemo-list-switch");var b=c.$mjListPage.find(".jmemo-mainarea");d.change(function(){var f=a(this).val();c._onChangeWhereMode(f,false)});if(e==""){c._onChangeWhereMode(null,false)}c._tmplDlgMemo=desknets.tmpl.replaceWordHtml(c._tmplDlgMemo,"memoRes",desknets.Resource.memo.memo);c._setUpUserProfDialog();c.callBase("_initSet");b.delegate(".memo-sch-navi>.prev","click",function(j){var g=a(this);var k=g.closest(".memo-schs");j.preventDefault();if(g.is(".off")){return}var h=k.find(".curr");var i=+h.text()-1;var f=+k.find(".max").text();if(i>0){k.find(".memo-sch").hide().filter("[data-num="+i+"]").show();h.text(i)}if(i===1){g.addClass("off")}g.siblings(".next").removeClass("off")});b.delegate(".memo-sch-navi>.next","click",function(j){var g=a(this);var k=g.closest(".memo-schs");j.preventDefault();if(g.is(".off")){return}var h=k.find(".curr");var i=+h.text()+1;var f=+k.find(".max").text();if(i<=f){k.find(".memo-sch").hide().filter("[data-num="+i+"]").show();h.text(i)}if(i===f){g.addClass("off")}g.siblings(".prev").removeClass("off")})},_setUpUserProfDialog:function(){var b=this;var d=function(e){b._setMemoEntryLink(e)};if(!neo.isSet(b._profDlg)){var c={linkClass:"jmemo-ref-dialog-link",dlgId:"jmemo-ref-dialog-",uLdentClass:"jmemo-userprof-dialog",uMakeFunc:d,uTmplObj:desknets.refDialog.$_tmpl};b._profDlg=new desknets.RefDialog();b._profDlg.userProfSetUp(c,b.$mjListPage)}},_setMemoEntryLink:function(c){var b=this;c.find(".co-userprof-spec").prepend(b._tmplDlgMemo);c.delegate(".co-msg-memo","click",function(d){d.preventDefault();var e=c.find('input[name="uid"]').val();b._hashUpdateMemoEntry(e);c.dialog("close")})},_onChangeWhereMode:function(h,g){var b=this;var f={};var e={};b._bomemocnt=g;if(neo.isSet(h)){if(b.$mjListPage.find("div.memo-where-disp").find(".jmemo-wheredisp").length>0){f["0"]=b._getParamsWhereModeChange(h);f["1"]=b._getParamsWhereRefer()}else{f["0"]=b._getParamsWhereRefer();b._bomemocnt=false}}else{if((typeof jsonCntMemo)=="undefined"){b._bomemocnt=true}f["0"]=b._getParamsWhereRefer();if(!!b._bomemocnt){f["1"]=b._getParamsMemoCnt()}else{b._onSuccessMemoListCnt()}}if(a.isEmptyObject(f)){return}var d=desknets.ajax.arrayToMultiCmdData(f);var c=desknets.getUrl(b._getRestModule());desknets.ajax.rest({dataType:desknets.ajax.RESTYPE_JSON,url:c,data:d,success:function(j,i,k){if(!!b._bomemocnt){b._onSuccessMemoListCnt(j["1"])}b._onSuccessWhereRefer(j)},detectMultiError:true})},_getParamsWhereModeChange:function(b){var c={};c.cmd=desknets.memo.CMD_MEMOWHEREENTRY;c.wmode=b;return c},_getParamsMemoCnt:function(){var b={};b.cmd=desknets.memo.CMD_MEMOLISTCNT;return b},_getParamsWhereRefer:function(){var b={};b.cmd=desknets.memo.CMD_MEMOWHEREREFER;return b},_onSuccessMemoListCnt:function(d){var c=this;var f={};var b=c.$mjListPage.find("#memo-whereabouts-links");if(!neo.isSet(d)||a.isEmptyObject(d)){if((typeof jsonCntMemo)!="undefined"){a.extend(f,jsonCntMemo)}else{return}}else{a.extend(f,d)}b.find(".jmemo-rececnt").text(f.rececnt);var e=b.find(".jmemo-noreadcnt");e.text(f.noreadcnt);if(f.noreadcnt!=="0"){e.parent().addClass("memo-list-noread")}else{e.parent().removeClass("memo-list-noread")}b.find(".jmemo-sendcnt").text(f.sendcnt)},_onSuccessWhereRefer:function(e){var c=this;var d,f;var b=["1","2"];if(neo.isSet(e["1"])&&!c._bomemocnt){d=e["1"]}else{d=e["0"]}desknets.memo.edit.editDispWhereRefer(c.$mjListPage,d);f=d.wmode;if(a.inArray(f,b)<0){f="1"}c.$mjListPage.find(".jmemo-list-switch").val(f)},_initListEnd:function(){var b=this;b.callBase("_initListEnd");var c={assign:true};var d={allGroup:"choosable",choosePrivateGroup:true,unassignGroup:"choosable"};desknets.page.groupSelect.init(c,d);b._setEventMemoTop()},_getListAjaxSuccess:function(c){var b=this;b.callBase("_getListAjaxSuccess",c);desknets.page.groupSelect.editSelectedGroup(b.$mjListPage.find(".jco-sel-items"),c)},initParamsFromHash:function(c){var b=this;var e="",f="";if(b.boMemoBproc==true){b.valMemoBproc=null}e=c.cmd;f=c.row;if(!neo.isSet(e)||e==b._getListCmd()){b._onChangeWhereMode(null,true);b._hashUpdateListPage(c)}else{if(e==b._getListAddCmd()){b._hashUpdateAddPage()}else{if(e==b._getReceiveCmd()){var d=a("#jmemo-m-memolist-page").find("#jco-pv-funcid");if(neo.isSet(d)&&d.val()==e){desknets.memo.memoreceiveindex._getListAjax(f)}else{desknets.memo.memoreceiveindex.initPage(b._getListCmd(),b._getIdListPage())}if(neo.isSet(c.bproc,{blank:false})){b.valMemoBproc=c.bproc;b.boMemoBproc=false}b.mhashBackCmd=e;b.mhashIdBack="jmemo-m-memolist-page"}else{if(e==b._getSendCmd()){var d=a("#jmemo-m-memolist-page").find("#jco-pv-funcid");if(neo.isSet(d)&&d.val()==e){desknets.memo.memosendindex._getListAjax(f)}else{desknets.memo.memosendindex.initPage(b._getListCmd(),b._getIdListPage())}b.mhashBackCmd=e;b.mhashIdBack="jmemo-m-memolist-page"}else{if(e==desknets.memo.PAGE_MEMOENTRY){if(b.mhashBackCmd==""||b.mhashIdBack==""){b.mhashBackCmd=b._getListCmd();b.mhashIdBack=b._getIdListPage()}else{if(b.mhashBackCmd==desknets.memo.PAGE_MEMOSENDREFER){b.mhashBackCmd=b._getSendCmd();b.mhashIdBack="jmemo-m-memolist-page"}}desknets.memo.memoentry.initPage(b.mhashBackCmd,b.mhashIdBack,b.valMemoBproc)}else{if(e==desknets.memo.PAGE_MEMORECEREFER){desknets.memo.memorecedisp.initPage(b._getReceiveCmd(),"jmemo-m-memolist-page");b.mhashBackCmd=e;b.mhashIdBack="jco-m-disp-page"}else{if(e==desknets.memo.PAGE_MEMOSENDREFER){desknets.memo.memosenddisp.initPage(b._getSendCmd(),"jmemo-m-memolist-page");b.mhashBackCmd=e;b.mhashIdBack="jco-m-disp-page"}}}}}}}},_setEventMemoTop:function(){var b=this;b.$mjListPage.find(".jmemo-mainarea").delegate(".jmemo-entry-link","click",function(d){var c=a(this);var e;d.preventDefault();e=c.next().val();b._hashUpdateMemoEntry(e)})},_hashUpdateMemoEntry:function(c){var b=this;var d={};d.cmd=desknets.memo.PAGE_MEMOENTRY;if(neo.isSet(c,{blank:false})){d.uid=c}b._setLocationHash(d)},_listLine:function(d,e){var c=this;var b=desknets.memoutil.editWhereListLine(d,e,c._listSch);return c.callBase("_listLine",d,b)},_setListStyle:function(c){var b=this;desknets.memoutil.setWhereListStyle(b.$mjTableList);b.callBase("_setListStyle",c)},_replaceListLine:function(c,e,d){var b=this;if(a.inArray(e,b._listSch)>=0){c=desknets.tmpl.replaceWordChkHtml(c,e,d[e])}else{c=b.callBase("_replaceListLine",c,e,d)}return c},_getListCmd:function(){return desknets.memo.PAGE_MEMOINDEX},_getListExecCmd:function(){return desknets.memo.CMD_MEMOWHEREINNDEX},_getListAddCmd:function(){return desknets.memo.PAGE_MEMOWHEREENTRY},_getListEntryClass:function(){return desknets.memo.memowhereentry},_getReceiveCmd:function(){return desknets.memo.PAGE_MEMORECEINDEX},_getSendCmd:function(){return desknets.memo.PAGE_MEMOSENDINDEX}});desknets.page(desknets.memo,"memowhereentry",desknets.PageInputBase,{_getAddExecCmd:function(){return desknets.memo.CMD_MEMOWHEREENTRY}});desknets.page(desknets.memo,"memoindexcom",desknets.PageListBase,{initPage:function(d,c){var b=this;b.boGetHtmlSingle=false;b.callBase("initPage",d,c)},_getSearchExecParam:function(){var b=this;var e=a("#jco-m-list-container").find(".jco-back-page-data");var d=desknets.paramanalyzer.getHashParams();var c=b.callBase("_getSearchExecParam");if(!neo.isSet(d.num,{blank:false})){c.num=e.find('input[name="memonum"]').val()}return c},getListParamToObj:function(){var b=this;var d=b.callBase("getListParamToObj");var c=desknets.paramanalyzer.getHashParams();if(!neo.isSet(c.fldsort,{blank:false})){d.fldsort="updtime";d.order="-1"}b._mobjParams.fldsort=d.fldsort;b._mobjParams.order=d.order;return d},_initListEndButton:function(){var b=this;b.$mjListPage.find(".co-pageback").click(function(c){c.preventDefault();b.dispBackListPage()});b.callBase("_initListEndButton")},_replaceListLine:function(c,g,d){var b=this;if(g==="updtime"){var e="";var f;e=desknets.dateTime.dispDateTime(d.updtime,{type:"list"});c=desknets.tmpl.replaceWordHtml(c,g,e)}else{c=b.callBase("_replaceListLine",c,g,d)}return c},_getIdListPage:function(){return"jmemo-m-memolist-page"},_getListAddCmd:function(){return desknets.memo.PAGE_MEMOENTRY},_getListModCmd:function(){return this._getListAddCmd()},_getListEntryClass:function(){return desknets.memo.memoentry},_getListModClass:function(){return this._getListEntryClass()}});desknets.page(desknets.memo,"memoentry",desknets.PageInputBase,{VAL_MEMO_TAGON:"1",VAL_MEMO_TAGOFF:"0",CLASS_MEMO_TAGON:"yellow",CLASS_MEMO_TAGOFF:"none",valMemoBproc:null,initPage:function(e,d,c){var b=this;if(neo.isSet(c,{blank:false})){b.valMemoBproc=c}else{b.valMemoBproc=null}b.callBase("initPage",e,d)},changPage:function(){var b=this;b.callBase("changPage");var c=b.$mjPage.find(".jco-input-whom");desknets.watermark.set(c);c.removeAttr("title");b._setMemoTagColorVal();b._setUserSelDialog()},_setMemoTagColorVal:function(){var b=this;var d=b.$mjPage.find(".co-select-menu");var f=d.find(".co-tag-select-item");var c="";var g=d.find('input[name="tag"]').val();if(g==b.VAL_MEMO_TAGON){c=b.CLASS_MEMO_TAGON}else{c=b.CLASS_MEMO_TAGOFF}f.addClass(c);var e=b.$mjPage.find("#co-entry-tag-options").find("span.jco-tag-select-item."+c).text();f.text(e);f.attr("title",e)},_setUserSelDialog:function(){var c=this;var b=desknets.chooser.getItemsFromElement(c.$mjPage.find(".jco-input-otherto"));var d={chooseTarget:["user"],allGroup:"choosable",choosePrivateGroup:true,unassignGroup:"choosable"};desknets.chooser.setUpEntry(a("#"+c._getIdPage()),b,{dialogID:"jmemo-usersel-chooser-dialog",initCreate:true,dialogOptions:d,extraVars:{user:{keyName:"otherto"}}})},_inputDelConfSubmit:function(d){var b=this;var c={confmsg:b._delConfMessage(),delFunc:function(e){b._inputDelSubmit(e)}};desknets.memo.setSendDelConfDialog(c)},_inputAjaxFormOption:function(){var b=this;var c=b.callBase("_inputAjaxFormOption");c.success=function(g,d,h){var e=b.getLocationMyCreateParam();if(!!g.noticeerror){var f=desknets.dialog.alert(g.noticeerror,{extraMessage:g.msgadd,extraClass:"co-msg-r",type:"warn"});f.bind("dialogclose",function(i){desknets.dialog.deleteById("warn");b._setLocationHash(e)});return}else{if(neo.isSet(e)){b._setLocationHash(e)}}};return c},getLocationMyCreateParam:function(){var b=this;var c={};var d=a("#jco-m-list-container").find(".jco-back-page-data");c.num=d.find('input[name="memonum"]').val();c.cmd=desknets.memo.PAGE_MEMOSENDINDEX;if(neo.isSet(b.valMemoBproc,{blank:false})){c.bproc=b.valMemoBproc}b.valMemoBproc=null;return c},_getAddExecCmd:function(){return desknets.memo.CMD_MEMOENTRY},_getModExecCmd:function(){var b=this;return b._getAddExecCmd()},_getDelExecCmd:function(){return desknets.memo.CMD_MEMOSENDDELETE}});desknets.page(desknets.memo,"memodispcom",desknets.PageDispBase,{_initSet:function(c){var b=this;b._initSetCabinetRegist();b.callBase("_initSet",c)},_initSetCabinetRegist:function(){var b=this;var c={copymodule:b._getRestModule(),copycmd:desknets.memo.CMD_MEMO,cabsparetitle:b.$mjPage.find('input[name="reqdetail"]').val()};desknets.cabinetregist.init(b.$mjPage,c,true)},_getSearchExecParam:function(){var b=this;var d=a("#jco-m-list-container").find(".jco-back-page-data");var c=desknets.paramanalyzer.getHashParams();arPrm=b.callBase("_getSearchExecParam");if(!neo.isSet(c.num,{blank:false})){arPrm.num=d.find('input[name="memonum"]').val()}return arPrm},_initListEndButton:function(){var b=this;b.$mjListPage.find(".co-pageback").click(function(c){c.preventDefault();b.dispBackListPage()});b.callBase("_initListEndButton")}});desknets.page(desknets.memo,"memoreceiveindex",desknets.memo.memoindexcom,{FLG_MEMO_READED:"1",FLG_MEMO_DELTAG:"2",_tmplTag:'<span class="co-select-menu-text"><span title="'+desknets.Resource.memo.memotagset+'" class="co-tag-select-item yellow">'+desknets.Resource.memo.memotagset+"</span></span>",_buttonFlg:"0",_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b._createEventCondition()},_listDelSubmit:function(d){var b=this;var c=a(d.target);if(c.hasClass("readed")){b._buttonFlg=b.FLG_MEMO_READED}else{if(c.hasClass("deltag")){b._buttonFlg=b.FLG_MEMO_DELTAG}else{b._buttonFlg="0"}}b.callBase("_listDelSubmit",d)},_createEventCondition:function(){var b=this;b.$mjListPage.find(".jmemo-sel-condition").change(function(){b.$mjListPage.find(".jco-back-page-data").find('input[name="cnd"]').val(a(this).val());b._listPage("0")})},_replaceListLine:function(c,f,d){var b=this;var e="";if(f=="tag"){if(d[f]=="1"){e=b._tmplTag}else{e="&nbsp;"}c=desknets.tmpl.replaceWordHtml(c,f,e)}else{if(f=="readed"){if(d[f]=="0"){e="memo-list-noread"}c=desknets.tmpl.replaceWordHtml(c,f,e)}else{c=b.callBase("_replaceListLine",c,f,d)}}return c},getListParamToObj:function(){var b=this;var d=b.callBase("getListParamToObj");var c=desknets.paramanalyzer.getHashParams();if(!neo.isSet(c.cnd,{blank:false})){d.cnd="1"}b._mobjParams.cnd=d.cnd;return d},_getListAjaxSuccessEnd:function(){var c=this;var d={};var e="";var b=["0","1","2"];c.callBase("_getListAjaxSuccessEnd");d=desknets.paramanalyzer.getHashParams();e=d.cnd;if(a.inArray(e,b)<0){e="1"}c.$mjListPage.find(".jmemo-sel-condition").val(e)},_delNoChkMessage:function(){var b=this;if(b._buttonFlg==b.FLG_MEMO_READED){return desknets.Resource.Message.memo_readed_nocecked}else{if(b._buttonFlg==b.FLG_MEMO_DELTAG){return desknets.Resource.Message.memo_deltag_nocecked}}return b.callBase("_delNoChkMessage")},_delConfMessage:function(){var c=this;var b="";var d={};if(c._buttonFlg==c.FLG_MEMO_READED){d.all="memo_readed_allconf";d.some="memo_readed_someconf";d.list="memo_readed_listconf"}else{if(c._buttonFlg==c.FLG_MEMO_DELTAG){d.all="memo_deltag_allconf";d.some="memo_deltag_someconf";d.list="memo_deltag_listconf"}else{return c.callBase("_delConfMessage")}}if(c.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message[d.all]}else{if(c.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){b=desknets.Resource.Message[d.some]}else{b=desknets.Resource.Message[d.list]}}return desknets.tmpl.replaceWordHtml(b,"count",c._getListCheckCount())},_getDelAddPrm:function(){var b=this;var c={};a.extend(c,b.callBase("_getDelAddPrm"));if(b._buttonFlg==b.FLG_MEMO_DELTAG){c.tagcolor=desknets.memo.VAL_MEMO_TAGDELCOLOR}c.cnd=b.$mjListPage.find(".jmemo-sel-condition").val();return c},_getListAjaxSuccess:function(d){var b=this;var c=b._mcListTemplate;var e="";var f=desknets.paramanalyzer.getHashParams();if(neo.isSet(f.uid,{blank:false})){e="&uid="+f.uid}b._mcListTemplate=desknets.tmpl.replaceWordHtml(b._mcListTemplate,"userid",e);b.callBase("_getListAjaxSuccess",d);b._mcListTemplate=c},_getListAjaxSuccessExec:function(c){var b=this;b.callBase("_getListAjaxSuccessExec",c);b._buttonFlg="0"},_getIdListPageForm:function(){return"recelistfrm"},_getListExecCmd:function(){return desknets.memo.CMD_MEMORECEINDEX},_getListCmd:function(){return desknets.memo.PAGE_MEMORECEINDEX},_getDelExecCmd:function(){var b=this;if(b._buttonFlg==b.FLG_MEMO_READED){return desknets.memo.CMD_MEMOREADED}else{if(b._buttonFlg==b.FLG_MEMO_DELTAG){return desknets.memo.CMD_MEMOTAGSET}}return desknets.memo.CMD_MEMORECEDELETE},_getListDispCmd:function(){return desknets.memo.PAGE_MEMORECEREFER},_getListDispClass:function(){return desknets.memo.memorecedisp}});desknets.page(desknets.memo,"memorecedisp",desknets.memo.memodispcom,{changPage:function(){var b=this;b.callBase("changPage");desknets.tagDisp.initTagEvent(desknets.MODULE_API_MAIN,b._getMemoRefTagParam())},_initHtmlTmplSet:function(c){var b=this;b.callBase("_initHtmlTmplSet",c);b.$mjPage.find(".jmemo-ref-send").remove()},_getMemoRefTagParam:function(){var b=desknets.paramanalyzer.getHashParams();b.cmd=desknets.memo.CMD_MEMOTAGSET;return b},_getDelExecCmd:function(){return desknets.memo.CMD_MEMORECEDELETE},_getDispExecCmd:function(){return desknets.memo.CMD_MEMORECEREFER}});desknets.page(desknets.memo,"memosendindex",desknets.memo.memoindexcom,{_replaceListLine:function(d,h,e){var c=this;var g;var f="";if(h==="othertolist"){f=desknets.tmpl.dispItems(e[h]);var b=desknets.ajax.getItems(e[h].item);if(b.length!=Number(e.othertoallcnt)){f=f+",&#x0A;"+desknets.Resource.com_overitemcnt}d=desknets.tmpl.replaceWordHtml(d,"otherto",f)}else{d=c.callBase("_replaceListLine",d,h,e)}return d},_setDelConfirm:function(d){var b=this;var c={confmsg:d,delFunc:function(e){b._listDel(true,e)}};desknets.memo.setSendDelConfDialog(c)},_getIdListPageForm:function(){return"sendlistfrm"},_getListExecCmd:function(){return desknets.memo.CMD_MEMOSENDINDEX},_getListCmd:function(){return desknets.memo.PAGE_MEMOSENDINDEX},_getDelExecCmd:function(){return desknets.memo.CMD_MEMOSENDDELETE},_getListDispCmd:function(){return desknets.memo.PAGE_MEMOSENDREFER},_getListDispClass:function(){return desknets.memo.memosenddisp}});desknets.page(desknets.memo,"memosenddisp",desknets.memo.memodispcom,{_initHtmlTmplSet:function(c){var b=this;b.callBase("_initHtmlTmplSet",c);b.$mjPage.find(".jmemo-ref-rece").remove()},_inputDelConfSubmit:function(d){var b=this;var c={confmsg:b._delConfMessage(),delFunc:function(e){b._inputDelSubmit(e)}};desknets.memo.setSendDelConfDialog(c)},_getDispModCmd:function(){return desknets.memo.PAGE_MEMOENTRY},_getDelExecCmd:function(){return desknets.memo.CMD_MEMOSENDDELETE},_getDispExecCmd:function(){return desknets.memo.CMD_MEMOSENDREFER}});app.addInitialAction(function(){desknets.memo.init()})})(jQuery);