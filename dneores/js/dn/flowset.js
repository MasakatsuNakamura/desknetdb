/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2017 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.flowset={MODULE_API_FLOW:"zrflow",MODULE_API_DOC:"zrdoc",PAGE_FLOWPSETGEN:"flowpsetgen",CMD_FLOWPSETGEN:"flowpsetcmdgen",CMD_FLOWPSETFORMAT:"flowpsetformat",PAGE_FLOWPSETFORMATENTRY:"flowpsetformatentry",CMD_FLOWPSETFORMATENTRY:"flowpsetcmdformatentry",CMD_FLOWPSETEDITFORMAT:"flowpsetcmdeditformat",CMD_FLOWPSETDELFORMAT:"flowpsetdelformat",CMD_FLOWPSETMVFORMAT:"flowpsetmvformat",CMD_FLOWPSETFORMATIMPORT:"flowpsetcmdformatimport",CMD_FLOWPSETFORMATEXPORT:"flowpsetcmdformatexport",CMD_FLOWPSETROUTE:"flowpsetroute",PAGE_FLOWPSETROUTEENTRY:"flowpsetrouteentry",CMD_FLOWPSETROUTEENTRY:"flowpsetcmdrouteentry",CMD_FLOWPSETEDITROUTE:"flowpsetcmdeditroute",CMD_FLOWPSETDELROUTE:"flowpsetdelroute",CMD_FLOWPSETMVROUTE:"flowpsetmvroute",CMD_FLOWPSETFORMROUTEEDIT:"flowpsetcmdformeroute",PAGE_ASETROUTE_LIST:"flowasetroute",CMD_ASETROUTE_LIST:"flowasetroute",PAGE_ASETROUTE_ENTRY:"flowasetrouteentry",CMD_ASETROUTE_ENTRY:"flowasetcmdrouteentry",CMD_ASETROUTE_MOVE:"flowasetmvroute",CMD_ASETROUTE_DEL:"flowasetcmddelroute",PAGE_ASETROUTE_ACCESS:"flowasetrouteaccess",PAGE_ASETAPPLICATE_LIST:"flowasetapplicate",CMD_ASETAPPLICATE_LIST:"flowasetapplicate",PAGE_ASETAPPLICATE_ENTRY:"flowasetapplicateentry",CMD_ASETAPPLICATE_ENTRY:"flowasetcmdapplicateentry",CMD_ASETAPPLICATE_MOVE:"flowasetmvapplicate",CMD_ASETAPPLICATE_DEL:"flowasetcmddelapplicate",CMD_ASETAPPLICATE_PREVIEW:"flowcmdpreviewapplicate",PAGE_ASETAPPLICATE_ACCESS:"flowasetapplicateaccess",CMD_ASETFORMAT_REFEDIT:"flowasetcmdeditformat",CMD_ASETFORM_ROUTEEDIT:"flowasetcmdformeroute",CMD_ASETROUTE_REFEDIT:"flowasetcmdeditroute",CMD_FLOWMSETFORMATLIST:"flowmsetcmdformatlist",CMD_DOCFOLDERLIST:"docfolderlist",CMD_DOCFOLDERLISTCHILD:"docfolderlistchild",CMD_FLOWASETFORMATIMPORT:"flowasetcmdformatimport",CMD_FLOWASETFORMATEXPORT:"flowasetcmdformatexport",CMD_FLOWMSETEDITROUTEROLELIST:"flowmsetcmdeditrouterolelist",PAGE_FLOWROUTEACCESS:"flowmsetrouteaccess",CMD_FLOWROUTEACCESSAUTHLIST:"flowmsetrouteaccesslist",PAGE_FLOWMSETLIST:"flowmsetindex",CMD_FLOWMSETLIST:"flowmsetcmdindex",CMD_FLOWMSETCMDDEL:"flowmsetcmddel",CMD_FLOWMSETCMDDELCONF:"flowmsetcmddelconf",CMD_FLOWMSETCANCEL:"flowmsetcmdcomplete",CMD_FLOWMSETCANCELCONF:"flowmsetcmdcompleteconf",CMD_FLOWMSETREMAND:"flowmsetcmdremand",CMD_FLOWMSETREMANDCONF:"flowmsetcmdremandconf",PAGE_FLOWMSETDISP:"flowmsetdisp",CMD_FLOWMSETDISP:"flowmsetcmddisp",PAGE_FLOWMSETSEARCH:"flowmsetsearch",CMD_FLOWMSETSEARCH:"flowmsetcmdsearch",CMD_FLOWMSETSEARCHINDEX:"flowmsetcmdsearchindex",CMD_FLOWMSETSTOPSEARCH:"flowmsetcmdsearchstop",CMD_FLOWDOWNLOAD:"flowmsetdownload",CMD_FLOWDOWNLOADSEARCH:"flowmsetdownloadsearch",PAGE_FLOWMSETSERNO:"flowmsetserno",PAGE_FLOWMSETSERNOENTRY:"flowmsetsernoentry",CMD_FLOWMSETSERNOENTRY:"flowmsetcmdsernoentry",CMD_FLOWMSETSERNODEL:"flowmsetcmdsernodel",CMD_FLOWMSETSERNODELCONF:"flowmsetcmdsernodelconf",CMD_FLOWMSETSERNODELENTRYCONF:"flowmsetcmdsernodelconfentry",CMD_FLOWMSETMVSERNO:"flowmsetcmdmvserno",PAGE_FLOWMSETGRPAUTH:"flowmsetgrpauth",CMD_FLOWMSETGRPAUTH:"flowmsetcmdgrpauth",CMD_FLOWMSETGRPAUTHON:"flowmsetcmdgrpauthon",CMD_FLOWMSETGRPAUTHOFF:"flowmsetcmdgrpauthoff",CMD_FLOWMSETGRPAUTHGRPTREE:"flowmsetcmdgrpauthgrptree",CMD_FLOWMSETGRPAUTHGRPS:"flowmsetcmdgrpauthgrps",CMD_FLOWMSETFORCEDEND:"flowmsetcmdforcedend",CMD_FLOWMSETFORCEDENDCONF:"flowmsetcmdforcedendconf",PAGE_FLOWSETADMIN:"flowsetadmin",PAGE_FLOWSETGEN:"flowsetgen",CMD_FLOWSETGEN:"flowsetcmdgen",PAGE_FLOWSETMANAGER:"flowsetmanager",PRM_VAL_ALLCANCEL:"all",init:function(){var b,c;var d=a("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(d);desknets.hashobserver.init(desknets.flowset);if(d in desknets.flowset){desknets.flowset[d].init()}if(d.match("flowmset")){desknets.flowset.subwin.init()}else{if(d.match("flowpset")){desknets.flow.subwin.init()}}}};desknets.flowset.absence={};desknets.flowset.formatentry={};(function(b){desknets.page(desknets.flowset,"subwin",desknets.flow.subwin,{_getMainCmd:function(){return desknets.flowset.PAGE_FLOWMSETLIST},_getSearchCmd:function(){return desknets.flowset.PAGE_FLOWMSETSEARCH},"":null})})(jQuery);(function(b){desknets.page(desknets.flowset,"DialogAccess",desknets.DialogAccess,{_getAccessListDefRow:function(){var c;c='<td class="comad-td-access">'+desknets.Resource.acceccOpen+"</td>";return c},addClassListBody:function(){var d=this;var c=d._$listTable.find(".co-tbody-list");var e=c.find("tr");e.each(function(){var f=b(this).find("td");f.eq(1).addClass("co-td-acc-user-1of4");f.eq(2).addClass("co-td-acc-busyo-1of4");f.eq(3).addClass("co-td-gcond")})}})})(jQuery);(function(b){desknets.page(desknets.flowset.absence,"user",null,{$entry:null,id:"user",page:null,_$entryUser:null,_isLoaded:false,init:function(c){this.page=c;this.$entry=c.$mjPage;this._$entryUser=this.$entry.find(".jflow-row-comm");this._setUpEntry()},open:function(){this._$entryUser.find(".jco-sel-btn").click()},_setUpEntry:function(){var d=this;var f=d._$entryUser.children("td");var e=b("#jflow-entry-comm-dialog");var c=desknets.chooser.getItemsFromElement(f);desknets.chooser.setUpEntry(f,c,{dialogID:"jflow-entry-comm-dialog",dialogOptions:d._getChooserOptions(),extraVars:{user:{keyName:"comm"}},change:function(){d._updateTargets()}});this._isLoaded=true},_getTargets:function(){var c=[];this._$entryUser.find(".jco-sel-items>input").each(function(){c.push({id:this.value,type:"user",name:b(this).data("name"),description:""})});return c},_updateTargets:function(){return},_getChooserOptions:function(){return{choosePrivateGroup:"choosable",allGroup:"choosable",chooseTarget:["user"],unassignGroup:"choosable",mode:"single"}}})})(jQuery);(function(b){desknets.page(desknets.flow.input,"format",null,{_dialogId:"jflow-format-select-dialog",_inputFieldName:"format-id",$dialog:null,$tabPagers:null,$tabPages:null,$tabButtons:null,selectedTabIndex:null,options:{},_options:{allItem:false,allItemLabel:desknets.Resource.chooser.allGroupName,privatetab:true,manage:false,onOk:null,onCancel:null,perPage:100},previewDialog:null,_TMPL_DIALOG:"flow/flow.input.format.html",_CLS_PAGER:"jflow-pager-",_CLS_PREVIEW_LINK:"jflow-preview-link",_DIALOG_TITLE:desknets.Resource.flow.select_format,init:function(c){this.destroy();this.options=b.extend({},this._options,c)},destroy:function(){if(this.$dialog){this.$dialog.dialog("destroy");this.$dialog=null}b("#"+this._dialogId).remove();this.$tabPagers=null;this.$tabPages=null;this.$tabButtons=null;this.selectedTabIndex=null;this.options={}},open:function(){if(this.$dialog==null){this.$dialog=b("<div />").attr("id",this._dialogId).appendTo(document.body);desknets.tmpl.load(this.$dialog,this._TMPL_DIALOG,b.proxy(function(){desknets.dialog.setUp(this.$dialog,this._getDialogOptions());this._buildContents();this.$dialog.dialog("open");desknets.dialog.setFirstDialogOpen(this.$dialog)},this),{})}else{this.$dialog.dialog("open").find('input[type="button"]').blur();this.$dialog.find(":radio:checked").attr("checked",false)}return this.$dialog},_buildContents:function(){var d=this._CLS_PAGER;this.selectedTabIndex=null;this.$tabButtons=this.$dialog.find(".co-pop-tab-list > li.co-pop-tab-item");this.$tabPages=this.$dialog.find(".co-pop-tab > .co-pop-tab-content");var c=this.$dialog.find(".jco-pager");b.each(this.$tabButtons,function(e,f){b("<div />").appendTo(c).addClass("co-page").addClass(d+e)});this.$tabPagers=c.find(".co-page");this.previewDialog=desknets.flow.input.format.preview;this.previewDialog.init(null);this.$tabButtons.bind("click",b.proxy(this._onClickTabButton,this));this.$dialog.delegate("."+this._CLS_PREVIEW_LINK,"click",b.proxy(this._onClickFormatName,this));if(this.options.privatetab){this.$dialog.find('li[data-value="usr"]').show()}else{this.$dialog.find('li[data-value="usr"]').hide()}this._changeTab(0)},_updateFormatList:function(e){var f=this._inputFieldName;var d=this._CLS_PREVIEW_LINK;var g=[];var c;c=e.list.item;c=c==null?[]:c;c=b.isArray(c)?c:[c];b.each(c,function(j,k){g[g.length]="<tr>";g[g.length]='<td class="co-chk"><input type="radio" name="';g[g.length]=f;g[g.length]='" value="';g[g.length]=k.id;g[g.length]='"></td>';g[g.length]="<td>";if(k.id!="all"){g[g.length]='<a href="#" class="'+d+'">'}g[g.length]=desknets.tmpl.escapeWord(k.Name);if(k.id!="all"){g[g.length]="</a>"}g[g.length]="</td>";g[g.length]="</tr>"});var h=this.$tabPages.eq(this.selectedTabIndex);var i=h.find("tbody");i.empty();i.html(g.join(""));desknets.htmlparts.addStripeClass(i,"co-tr-even");h.find(".jflow-nodata").toggle(c.length<=0);h.find(".co-table-list-scroll").toggle(c.length>0)},_updatePager:function(g,d){var c=this,e=this._getResultsPerPage();var f=this.$tabPagers.eq(this.selectedTabIndex);desknets.Pager.output(f.parent(),"."+this._CLS_PAGER+this.selectedTabIndex,{getCount:Math.min(d-g,e),allCount:d,pageMaxView:e,startRow:g,clickFunc:function(h){c._changePage((h/e)+1)}})},_changePage:function(c){this._ajaxFormatListGet(c)},_changeTab:function(c){if(this.selectedTabIndex===c){return}this.$tabButtons.eq(this.selectedTabIndex).removeClass("on");this.$tabPages.eq(this.selectedTabIndex).hide();this.$tabPagers.eq(this.selectedTabIndex).hide();this.selectedTabIndex=c;this.$tabButtons.eq(this.selectedTabIndex).addClass("on");this.$tabPages.eq(this.selectedTabIndex).show();this.$tabPagers.eq(this.selectedTabIndex).show();this._onChangeTab()},_onClickTabButton:function(f){f.preventDefault();var c=b(f.target).closest("li").data("value");var d=0;b.each(this.$tabButtons,function(e,g){if(b(g).data("value")===c){d=e;return false}});this._changeTab(d)},_onChangeTab:function(){if(this.$tabPages.eq(this.selectedTabIndex).find("tbody>tr").length>0){return}this._ajaxFormatListGet(1)},_onClickFormatName:function(f){f.preventDefault();var d=this._getFormatInfoOf(b(f.target));var c=this.previewDialog;this._ajaxFormatDetailGet(d.formatType,d.formatId,function(g,e,h){c.open(g.html)})},_onClickOk:function(f){var c=this;var d=this._getSelectedInfo();if(!d){desknets.dialog.alert(desknets.Resource.Message.flow_format_noselected,{type:"warn"});return}if(this.options.onOk){this.options.onOk(d)}this.$dialog.dialog("close")},_onClickCancel:function(c){if(this.options.onCancel){this.options.onCancel(c)}this.$dialog.dialog("close")},_onAjaxLoadFormatList:function(d,c,e){this._updateFormatList(d);this._updatePager(d.row,d.allcnt)},_getFormatInfoOf:function(e){var d=e.closest("tr");if(d.length<=0){return null}var c=this.$tabPages.eq(this.selectedTabIndex);var h=this.$tabButtons.eq(this.selectedTabIndex).data("value");var g=h;var i=d.find("input[name="+this._inputFieldName+"]").val();var f=d.text();return{tabName:h,formatType:g,formatId:i,formatName:f}},_getSelectedInfo:function(){var c=this.$tabPages.eq(this.selectedTabIndex);var d=c.find("input[name="+this._inputFieldName+"]:checked").closest("tr");if(d.length<=0){return null}return this._getFormatInfoOf(d)},_ajaxFormatListGet:function(c){var d=this;var h=null;var f=this._getResultsPerPage();h=desknets.flow.CMD_FLOWFORMATLIST;if(!!d.options.manage){h=desknets.flowset.CMD_FLOWMSETFORMATLIST}var g=this.$tabButtons.eq(this.selectedTabIndex).data("value");var e=desknets.getUrl(desknets.flow.MODULE_API_FLOW);var i={cmd:h,formattype:g,num:f,row:(c-1)*f,order:"1",draft:"0"};d._ajaxRestPrefilter(i,d.options);desknets.ajax.rest({url:e,data:i,type:"POST",success:function(k,j,l){d._ajaxRestPostfilter(i,k,d.options);d._onAjaxLoadFormatList(k,j,l)},})},_ajaxRestPrefilter:function(e,c){if(b.isArray(e)){for(var d=0;d<e.length;d++){this._ajaxRestPrefilterSingle(e[d],c)}}else{this._ajaxRestPrefilterSingle(e,c)}},_ajaxRestPrefilterSingle:function(d,c){d.row=!!d.row?d.row:0;d.num=!!d.num?d.num:100;if(!!c.allItem){this._ajaxRestPrefilterAllGroup(d,c)}},_ajaxRestPrefilterAllGroup:function(d,c){if(d.row>0){d.row--}else{if(d.num>0){d.num--}}},_ajaxRestPostfilter:function(f,e,c){if(b.isArray(f)){for(var d=0;d<f.length;d++){this._ajaxRestPostfilterSingle(f[d],e[d],c)}}else{this._ajaxRestPostfilterSingle(f,e,c)}},_ajaxRestPostfilterSingle:function(e,d,c){this._ajaxRestPostfilterCommon(e,d,c);if(!!c.allItem){this._ajaxRestPostfilterAllGroup(e,d,c)}},_ajaxRestPostfilterCommon:function(f,d,c){var e=Number(d.allcnt);var g=Number(d.row);d.list={item:desknets.ajax.getJsonItems(d)};d.allcnt=!!e?e:d.list.item.length;if(g>0&&g!=f.row){d.list.item=[]}},_ajaxRestPostfilterAllGroup:function(e,d,c){d.row++;d.allcnt++;if(e.row==0){d.list.item.unshift({id:"all",Name:c.allItemLabel})}},_ajaxFormatDetailGet:function(c,e,d){if(c=="usr"){desknets.flow.ajaxUserFormatGet(e,d)}else{desknets.flow.ajaxFormatGet(e,d)}},_getResultsPerPage:function(){return this.options.perPage},_getDialogOptions:function(){var e={};e[desknets.Resource.OKButtonLabel]=b.proxy(this._onClickOk,this);e[desknets.Resource.CancelButtonLabel]=b.proxy(this._onClickCancel,this);var c=desknets.dialog.getDialogOption();var d={buttons:e,dialogClass:"dn-dialog",resizable:false,draggable:true,title:this._DIALOG_TITLE,width:"600",height:"auto"};b.extend(c,d);return c},"":{},})})(jQuery);(function(b){desknets.page(desknets.flow.input,"route",null,{_dialogId:"jflow-route-select-dialog",_inputFieldName:"route-id",$dialog:null,options:{},_options:{onOk:null,onCancel:null,targetFormatObj:null},_TMPL_DIALOG:"flow/flow.input.route.html",_DIALOG_TITLE:desknets.Resource.flow.select_route,init:function(c){this.destroy();this.options=b.extend({},this._options,c)},destroy:function(){if(this.$dialog){this.$dialog.dialog("destroy");this.$dialog=null}b("#"+this._dialogId).remove();this.options={}},setTargetFormatObj:function(c){var d=this.options.targetFormatObj;if(!d){d={}}if(!c){c={}}if(d.type==c.type&&d.name==c.name&&d.id==c.id){return}d.type=c.type;d.name=c.name;d.id=c.id;this.options.targetFormatObj=d;if(!!this.$dialog){this.$dialog.find("tbody").empty()}},open:function(){if(this.$dialog==null){this.$dialog=b("<div />").attr("id",this._dialogId).appendTo(document.body)}if(this._isContentsIncomplete()){desknets.tmpl.load(this.$dialog,this._TMPL_DIALOG,b.proxy(function(){desknets.dialog.setUp(this.$dialog,this._getDialogOptions());this._buildContents();this.$dialog.dialog("open");desknets.dialog.setFirstDialogOpen(this.$dialog)},this),{})}else{this.$dialog.dialog("open").find('input[type="button"]').blur();this.$dialog.find(":checkbox:checked").attr("checked",false)}return this.$dialog},_buildContents:function(){this._ajaxRouteListGet()},_isContentsIncomplete:function(){return !this.$dialog||this.$dialog.find("tbody").children().length==0},_ajaxRouteListGet:function(){var c=desknets.getUrl(desknets.flow.MODULE_API_FLOW);var d={cmd:desknets.flow.CMD_FLOWROUTELIST,};if(!!this.options.targetFormatObj&&!!this.options.targetFormatObj.id&&this.options.targetFormatObj.type=="pub"){d.formatid=this.options.targetFormatObj.id}else{if(!!this.options.targetFormatObj&&!!this.options.targetFormatObj.id&&this.options.targetFormatObj.type=="usr"){d.formatid="_"}}desknets.ajax.rest({url:c,data:d,type:"POST",success:b.proxy(function(f,e,g){this._updateRouteList(f)},this)})},_updateRouteList:function(d){var f=this._inputFieldName;var e=[];var c;c=d.list.item;c=c==null?[]:c;c=b.isArray(c)?c:[c];b.each(c,function(h,i){e[e.length]="<tr>";e[e.length]='<td class="co-chk"><input type="checkbox" name="';e[e.length]=f;e[e.length]='" value="';e[e.length]=i.id;e[e.length]='" data-type="';e[e.length]=i.routetype;if(!!i.formatid){e[e.length]='" data-fid="';e[e.length]=i.formatid}e[e.length]='"></td>';e[e.length]="<td><span>";e[e.length]=desknets.tmpl.escapeWord(i.Name);if(i.routetype=="usr"){e[e.length]=desknets.tmpl.escapeWord(desknets.Resource.flow["private"])}e[e.length]="</span></td>";e[e.length]="</tr>"});var g=this.$dialog.find("tbody");g.empty();g.html(e.join(""));desknets.htmlparts.addStripeClass(g,"co-tr-even");this.$dialog.find(".jflow-nodata").toggle(c.length<=0);this.$dialog.find(".co-table-list-scroll").toggle(c.length>0);this.updteSelectedFormatMsg();if(!!this.options.targetFormatObj&&!!this.options.targetFormatObj.id){g.find("[data-fid="+this.options.targetFormatObj.id+"]").closest("tr").addClass("flow-recommend")}},updteSelectedFormatMsg:function(){var c=this.$dialog.find(".targetFormat");var d="";var e=this.options.targetFormatObj;if(!!e&&e.type=="pub"){d=desknets.Resource.flow.asterisk+" ["+e.name+"]"+desknets.Resource.flow.at_select}c.text(d)},_onClickOk:function(d){var c=this._getSelectedInfos();if(!c||c.length<=0){desknets.dialog.alert(desknets.Resource.Message.flow_route_noselected);return}if(!!this.options.onOk){this.options.onOk(c)}this.$dialog.dialog("close")},_onClickCancel:function(c){if(!!this.options.onCancel){this.options.onCancel(c)}this.$dialog.dialog("close")},_getRouteInfoOf:function(e){var d=e.closest("tr");if(d.length<=0){return null}var f=d.find("input[name="+this._inputFieldName+"]").attr("data-type");var g=d.find("input[name="+this._inputFieldName+"]").val();var c=d.find("td span").text();return{routeType:f,routeId:g,routeName:c}},_getSelectedInfos:function(){var d=[];var f=this.$dialog.find("input[name="+this._inputFieldName+"]:checked").closest("tr");if(f.length<=0){return null}for(var c=0;c<f.length;c++){var e=f.eq(c);d.push(this._getRouteInfoOf(e))}return d},_getDialogOptions:function(){var e={};e[desknets.Resource.OKButtonLabel]=b.proxy(this._onClickOk,this);e[desknets.Resource.CancelButtonLabel]=b.proxy(this._onClickCancel,this);var d=desknets.dialog.getDialogOption();var c={buttons:e,dialogClass:"dn-dialog",resizable:false,draggable:true,title:this._DIALOG_TITLE,width:"500",height:"auto",close:function(){neo.ajax.abort(self._dialogId,true)}};b.extend(d,c);return d},"":{},})})(jQuery);(function(b){desknets.page(desknets.flow.input.format,"preview",null,{_dialogId:"jflow-format-preview-dialog",_inputFieldName:"format-id",$dialog:null,options:{},_options:{onOk:null,onCancel:null},_htmlPreview:null,_TMPL_DIALOG:"flow/flow.input.format.preview.html",_DIALOG_TITLE:desknets.Resource.preview,init:function(c){this.destroy();this.options=b.extend({},this._options,c)},destroy:function(){if(this.$dialog){this.$dialog.dialog("destroy");this.$dialog=null}b("#"+this._dialogId).remove();this._htmlPreview=null;this.options={}},open:function(c){this._htmlPreview=c;if(this.$dialog==null){this.$dialog=b("<div />").attr("id",this._dialogId).appendTo(document.body);desknets.tmpl.load(this.$dialog,this._TMPL_DIALOG,b.proxy(function(){desknets.dialog.setUp(this.$dialog,this._getDialogOptions());this._buildContents();this.$dialog.dialog("open");desknets.dialog.setFirstDialogOpen(this.$dialog)},this),{})}else{this.$dialog.dialog("open").find('input[type="button"]').blur()}return this.$dialog},_getDialogOptions:function(){var e={};e[desknets.Resource.CloseButtonLabel]=b.proxy(this._onClickCancel,this);var c=desknets.dialog.getDialogOption();var d={buttons:e,dialogClass:"dn-dialog",resizable:false,draggable:true,title:this._DIALOG_TITLE,width:"741",height:"auto",open:b.proxy(this._onOpen,this)};b.extend(c,d);return c},_buildContents:function(){},_updatePreview:function(d){var c=this;this.$dialog.find(".form-format-preview-in").empty().html(d||"<BR>");c.$dialog.dialog("option","height","auto");setTimeout(function(){var e=c.$dialog.dialog("widget").height();c.$dialog.dialog("option","height",e)},0)},_onClickCancel:function(c){if(this.options.onCancel){this.options.onCancel(c)}this._htmlPreview=null;this._updatePreview(null);this.$dialog.dialog("close")},_onOpen:function(c){this._updatePreview(this._htmlPreview)},"":{}})})(jQuery);desknets.page(desknets.flowset,"setRouteEntryBase",desknets.PageInputBase,{route:desknets.flow.RouteEditor.prototype,getMultiRequest:function(){var c={};var b=desknets.paramanalyzer.getHashParams();c["0"]=b;c["1"]={cmd:this.getNodeListCmd(),tmpno:this.getTempName(),id:!!b.id?b.id:[],type:this.getCmdType()};return c},_initHtml:function(c){var b=this;if(c[1]["status"]!=desknets.RES_STATUS_SUCCESS){b.onError(c[1]["errorno"],c[1]["errormessage"]);return}b.callBase("_initHtml",c)},_initSet:function(c){var b=[];if(!!c&&c["1"]){b=desknets.flow.route.getRouteFromJson(c["1"])}this._setUpRouteEditor(b);this._setTmpNm();this.callBase("_initSet")},_setTmpNm:function(){var b=this;b.$mjPage.find('input[name="tmpno"]').val(b.getTempName())},_inputAjaxFormOption:function(){var b=this;var c=b.callBase("_inputAjaxFormOption");c.beforeSerialize=function(e,f){var d=b.route.getRoute();var g={values:desknets.flow.route.getRequestParamFromRoute(d)};f.data=a.extend(g,f.data)};return c},_getRestModule:function(){return desknets.flowset.MODULE_API_FLOW},getNodeListCmd:function(){return""},getTempName:function(){return""},getRouteOptionsForParams:function(){var b=this.getTempName();return{paramsForAdd:{cmd:desknets.flow.CMD_ROUTENODE_ADD,tmpno:b},paramsForRemove:{cmd:desknets.flow.CMD_ROUTENODE_REMOVE,tmpno:b},paramsForTitle:{cmd:desknets.flow.CMD_ROUTENODE_MODTITLE,tmpno:b},paramsForCondition:{cmd:desknets.flow.CMD_ROUTENODE_MODCOND,tmpno:b},paramsForUser:{cmd:desknets.flow.CMD_ROUTENODE_MODUSER,tmpno:b},paramsForGroup:{cmd:desknets.flow.CMD_ROUTENODE_MODGROUP,tmpno:b},paramsForRole:{cmd:desknets.flow.CMD_ROUTENODE_MODROLE,tmpno:b},paramsForApprovalName:{cmd:desknets.flow.CMD_ROUTENODE_ANAME,tmpno:b},paramsForApprovalUsers:{cmd:desknets.flow.CMD_ROUTENODE_MODAUSERS,tmpno:b},paramsForRemoveApprovalUser:{cmd:desknets.flow.CMD_ROUTENODE_REMOVEAUSERS,tmpno:b},paramsForBranch:{cmd:desknets.flow.CMD_ROUTENODE_MODBRANCH,tmpno:b},paramsForHierarchy:{cmd:desknets.flow.CMD_ROUTENODE_MODHIERARCHY,tmpno:b},paramsForExceptApplicant:{tmpno:b,cmd:desknets.flow.CMD_ROUTENODE_MODEXCEPTAPPLICANT}}},getCmdType:function(){return""},_setUpRouteEditor:function(d){var c=this,b;var e=desknets.getUrl(this._getRestModule());var f={restUrl:e,route:d,branch:false};var g=this.$mjPage.find(".jflow-editor-route");a.extend(f,this.getRouteOptionsForParams());this.route=new desknets.flow.RouteEditor(g,f)}});desknets.page(desknets.flowset,"setApplicateListBase",desknets.PageInputList,{_listLine:function(c,d){var b=desknets.Resource.flow.applicate_unset;d.formcnt=d.formcnt==""?b:"";d.routecnt=d.routecnt==""?b:"";return this.callBase("_listLine",c,d)},_initListStartModLink:function(){var b=this;b.$mjTableList.dnclick(".jco-modlink",function(d){var c=a(this).parent().parent().parent().find(".jco-id").val();b.inputDispPage(c)},function(d){var c=a(this).parent().parent().parent().find(".jco-id").val();b.inputModPage(c)},{ignoreOnModifierKey:true})},_getRestModule:function(){return desknets.flowset.MODULE_API_FLOW},_getListModCmd:function(){return this._getListAddCmd()},_getListModClass:function(){return this._getListEntryClass()}});(function(b){desknets.page(desknets.flowset,"flowpsetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.flow.PAGE_FLOWLIST},_getAjaxFormOption:function(){var c=this;var d={};d=c.callBase("_getAjaxFormOption");d.validation=function(e){var f=c.checkInput(e);if(neo.isSet(f,{blank:false})){desknets.dialog.alert(f);return false}return true};return d},checkInput:function(d){var c=this;var e=null;d.find(".jco-validation-number").each(function(){if(!desknets.validation.isNumber(b(this).val())){var f={};f.msg=desknets.Resource.Message.com_invalid_number;f.fieldid=b(this).attr("name");f.fieldname=c._getErrorPlace(f.fieldid);e=desknets.getErrConvMsg(f);return false}});return e}})})(jQuery);desknets.page(desknets.flowset,"flowpsetformat",desknets.flowset.setApplicateListBase,{_listLine:function(b,c){c.iconClass="";c.iconName="";c.linkClass="";c.linkName="";return this.callBase("_listLine",b,c)},_getListCmd:function(){var b=this;return b._getListExecCmd()},_getListExecCmd:function(){return desknets.flowset.CMD_FLOWPSETFORMAT},_getListAddCmd:function(){return desknets.flowset.PAGE_FLOWPSETFORMATENTRY},_getDelExecCmd:function(){return desknets.flowset.CMD_FLOWPSETDELFORMAT},_getMoveExecCmd:function(){return desknets.flowset.CMD_FLOWPSETMVFORMAT},_getListEntryClass:function(){return desknets.flowset.flowpsetformatentry}});desknets.page(desknets.flowset,"flowpsetformatentry",desknets.flow.FlowInputBase,{_inputButton:function(){var b=this;b.callBase("_inputButton");this._initCopyButton();b.$mjPage.find("#jflow-form-entry").hide()},_getDelExecCmd:function(){return desknets.flowset.CMD_FLOWPSETDELFORMAT},getFormPartListCmd:function(){return desknets.flowset.CMD_FLOWPSETEDITFORMAT},getRouteNodeListCmd:function(){return desknets.flowset.CMD_FLOWPSETFORMROUTEEDIT},getCopyRouteNodeCmd:function(){return desknets.flow.CMD_FLOWEDITROUTECOPY},getTempName:function(){return"flowpsetformatentry"},getCmdType:function(){return"usr"},_initCopyButton:function(){var b=this;this.$mjPage.find(".jco-input-copy").click(function(){var c=desknets.paramanalyzer.getHashParams();desknets.paramanalyzer.setLocationHash({cmd:c.cmd,copyid:c.id})})}});desknets.page(desknets.flowset,"flowpsetroute",desknets.PageInputList,{_listLine:function(b,c){if(c.draft=="1"){c.iconClass="flowad-imperfect-icon";c.iconName=desknets.Resource.flow.route_incomplete}else{c.iconClass="";c.iconName=""}return this.callBase("_listLine",b,c)},_getRestModule:function(){return desknets.flowset.MODULE_API_FLOW},_getListCmd:function(){var b=this;return b._getListExecCmd()},_getListExecCmd:function(){return desknets.flowset.CMD_FLOWPSETROUTE},_getListAddCmd:function(){return desknets.flowset.PAGE_FLOWPSETROUTEENTRY},_getListModCmd:function(){return this._getListAddCmd()},_getDelExecCmd:function(){return desknets.flowset.CMD_FLOWPSETDELROUTE},_getMoveExecCmd:function(){return desknets.flowset.CMD_FLOWPSETMVROUTE},_getListEntryClass:function(){return desknets.flowset.flowpsetrouteentry},_getListModClass:function(){return this._getListEntryClass()}});desknets.page(desknets.flowset,"flowpsetrouteentry",desknets.flowset.setRouteEntryBase,{_getDelExecCmd:function(){return desknets.flowset.CMD_FLOWPSETDELROUTE},getNodeListCmd:function(){return desknets.flowset.CMD_FLOWPSETEDITROUTE},getTempName:function(){return"flowpsetroute"},getCmdType:function(){return"usr"}});desknets.page(desknets.flowset,"flowpsetabsence",desknets.PageSet,{init:function(){var b=this;b.callBase("init");b.$mjPage=a(".co-m-content");b._setUpAbsence();b._initAbsenceUser();desknets.htmlparts.setUpForm(b.$mjPage.find("form"));b._initFormErrorEvent()},_setUpAbsence:function(){var b=this;$table=a(".co-table-set");$sel=a("#jflow-absence-sel");var c=function(d){if(d=="1"){$table.addClass("flow-absence-no").removeClass("flow-absence-auto")}else{if(d=="2"){$table.removeClass("flow-absence-no").removeClass("flow-absence-auto")}else{if(d=="3"){$table.removeClass("flow-absence-no").addClass("flow-absence-auto")}}}};c($sel.val());$sel.change(function(){c(a(this).val())})},_initAbsenceUser:function(){var b=this;desknets.flowset.absence.user.init(b)},_getNextCmd:function(){return desknets.flow.PAGE_FLOWLIST},_initFormErrorEvent:function(){var c=this;var b=a(c._mIdPageForm);b.bind("invalid",function(e){var f=a(e.target);var d=f.attr("name")||f.data("name");desknets.validation.showError(f,c._getErrorPlace(d));c.onErrorForm(a(this));c._onCompleteForm()})},});(function(b){desknets.page(desknets.flowset,"flowpsetnotice",desknets.PageSet,{init:function(){var c=this;c.callBase("init");c._initAlertMessage()},_initAlertMessage:function(){var c="alert";var d=b("#jflow-topmsg").html();if(d.length!=0){desknets.pageframe.viewTopMsg(d,c)}},_getNextCmd:function(){return desknets.flow.PAGE_FLOWLIST},"":{}})})(jQuery);(function(b){desknets.page(desknets.flowset,"flowpsetformatimport",desknets.PageImport,{init:function(){var c=this;c.callBase("init");c._initHelpLink()},_initHelpLink:function(){var c=this;b("#jform-imp-help-contents").delegate("a.jform-imp-help","click",function(d){d.preventDefault();c._onClickHelpLink(d)})},_onClickHelpLink:function(e){var d=this;var f=b(e.target);var c=f.attr("data-id");desknets.form.ImpHelpDialog.open(c)},_getRestModule:function(){return desknets.flow.MODULE_API_FLOW},_getAjaxFormOption:function(){var c=this;var d={};d=this.callBase("_getAjaxFormOption");d.errorconvmsg=function(e,f){var g=desknets.getErrField(e,f);g.fieldname=c._getErrorPlace(g.fieldid);return desknets.getErrConvMsg(g)};return d},makeFileInput:function(){var c=this;c.callBase("makeFileInput");b('#frm input[name="Name"]').val("")}})})(jQuery);(function(b){desknets.page(desknets.flowset,"flowpsetformatexport",desknets.PageInputList,{_initSet:function(){var d=this;var c,e={};this.callBase("_initSet");c=this.$mjListPage.find("form");c.find(":hidden[name=cmd]").val(d._getExportExecCmd());e={};e["$control"]=this.$mjListPage.find(".jco-export-config-control");e.useCharSep=true;desknets.exportConfigControl.init(e);this.$mjListPage.find("form").submit(b.proxy(this._onSubmitForm,this));this.$mjListPage.find("form").delegate("a.jflow-format-name","click",b.proxy(this._onClickFormatName,this))},_onSubmitForm:function(c){if(this.$mjListPage.find(":radio[name=id]:checked").length<=0){desknets.dialog.alert(desknets.Resource.Message.flow_formatnoselect,{type:"warn"});return false}},_onClickFormatName:function(c){c.preventDefault();var d=b(c.target).closest("tr").find(".jco-id").val();desknets.flow.ajaxUserFormatGet(d,function(e){desknets.flow.input.format.preview.init();desknets.flow.input.format.preview.open(e.html)})},_replaceListLine:function(d,f,e){var c=this;if(f=="id"){d=d.replace("{{draft}}","")}d=c.callBase("_replaceListLine",d,f,e);return d},_getRestModule:function(){return desknets.flow.MODULE_API_FLOW},_getListCmd:function(){return desknets.flowset.CMD_FLOWPSETFORMAT},_getListExecCmd:function(){return desknets.flowset.CMD_FLOWPSETFORMAT},_getExportExecCmd:function(){return desknets.flowset.CMD_FLOWPSETFORMATEXPORT},_getListEntryClass:function(){return null},_getListModClass:function(){return null}})})(jQuery);desknets.page(desknets.flowset,"flowmsetindex",desknets.PageListBase,{_mDelFlg:"",$mForcedEndDialog:null,_mboOverErrView:true,_mboOverErr:false,_hashUpdatePageView:function(c){var b=this;if(c==desknets.flowset.PAGE_FLOWMSETSEARCH){desknets.flowset.flowmsetsearch.initPage(desknets.flowset.PAGE_FLOWMSETLIST,"jco-m-list-container");b.mhashBackErrCmd=b.mhashBackCmd;b.mhashIdErrBack=b.mhashIdBack;b.mhashBackCmd=desknets.flowset.PAGE_FLOWMSETSEARCH;b.mhashIdBack="jco-m-search-container"}},_hashUpdateDispPage:function(){var d=this;var b;var c=desknets.paramanalyzer.getHashParams();var f=d.mhashBackCmd;var e=d.mhashIdBack;if(c.mode=="history"){f=desknets.flowset.PAGE_FLOWMSETDISP;e="jco-m-disp-page"}b=d._getListDispClass();b.initPage(f,e)},_replaceListLine:function(c,f,d){var b=this;if(f=="elapsed_warn_flg"){c=b.replaceFlowListLineElapsedWarnFlg(c,f,d)}var e=desknets.flow.flowindex.replaceFlowListLine(c,f,d);if(e!=null){return e}return b.callBase("_replaceListLine",c,f,d)},replaceFlowListLineElapsedWarnFlg:function(d,f,e){var c=this;var b="";if(e[f]=="1"&&(e.status=="2"||e.status=="3")){b="flow-tr-detention"}return desknets.tmpl.replaceWord(d,f,b)},_initListStartModLink:function(){var b=this},_getListAjaxSuccessOtherSet:function(c){var b=this;b.callBase("_getListAjaxSuccessOtherSet",c);b._mboOverErr=false;if(neo.isSet(c[desknets.RES_TAG_MSGGETLIMIT])){b._mboOverErr=true;if(this._mboOverErrView){this._mboOverErrView=false;desknets.pageframe.viewTopMsg(c[desknets.RES_TAG_MSGGETLIMIT],"info")}}},_getListAjaxSuccessEnd:function(){var c=this;c.callBase("_getListAjaxSuccessEnd");var b=this.$mjListPage.find(".jco-back-page-data").find("input[name=status]").val();c.$mjListPage.find("#co-status-list").val(b)},_initListStart:function(){var b=this;b.callBase("_initListStart");desknets.flow.ForcedEndDialog.init()},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b._bindStatusList();b.$mjListPage.find(".jflow-list-dl-submit").click(function(c){c.preventDefault();b._mDelFlg="3";b.onClickDownlaodButton(c)});b.$mjListPage.find(".jflow-list-back-submit").click(function(c){c.preventDefault();b._mDelFlg="1";b._listDelSubmit(c)});b.$mjListPage.find(".jflow-list-cancel-submit").click(function(c){c.preventDefault();b._mDelFlg="2";b._listDelSubmit(c)});b.$mjListPage.find(".jflow-list-del-submit").click(function(c){c.preventDefault();b._mDelFlg="0";b._listDelSubmit(c)});b.$mjListPage.find(".jflow-list-forcedend-submit").click(function(c){c.preventDefault();b._mDelFlg="4";b._listDelSubmit(c)})},onClickDownlaodButton:function(d){var b=this;var c;var e=this._getDelAddPrm();e.cmd=desknets.flowset.CMD_FLOWDOWNLOAD;e.id=[];if(b.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){e.id.push(desknets.PRM_VAL_ALLDEL)}else{b.$mjListPage.find('input[name="'+b._getIDName()+'"]:checked').each(function(){e.id.push(a(this).val())})}if(e.id.length<=0){var f=b._delNoChkMessage();desknets.dialog.alert(f,{type:"warn"});return 0}c=desknets.getUrl(desknets.flow.MODULE_MAIN_FLOW)+"?"+desknets.getNeoParam(e);desknets.execLocation(c,"_blank")},_bindStatusList:function(){var b=this;var c=b.$mjListPage.find("#co-status-list");var d=b.$mjListPage.find(".jco-back-page-data").find('input[name="status"]').val();c.val(d);c.change(function(g){var f=a(this).find("option:selected");var e=f.val();var h=desknets.getInputDataToObj(b.$mjListPage.find(".jco-back-page-data"));h.status=e;h.row="0";b._mboOverErrView=true;desknets.pageframe.closeTopMsg();b._setLocationHash(h);return false})},_updateListCheckState:function(b){var c=this;c.callBase("_updateListCheckState",b);var d=this.$mjListPage.find(".co-chk-cnt-some");if(c._mboOverErr){d.find("a").hide()}else{d.find("a").show()}},_delNoChkMessage:function(){var b=this;if(b._mDelFlg=="1"){return desknets.Resource.Message.flow_remand_nochecked}else{if(b._mDelFlg=="2"){return desknets.Resource.Message.flow_cancel_nochecked}else{if(b._mDelFlg=="3"){return desknets.Resource.Message.flow_download_nochecked}else{if(b._mDelFlg=="4"){return desknets.Resource.Message.flow_forcedend_nochecked}else{return this.callBase("_delNoChkMessage")}}}}},_delConfMessage:function(){var c=this;var b="";if(c._mDelFlg=="2"){if(c.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message.flow_cancel_all}else{if(c.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){b=desknets.Resource.Message.flow_cancel_some}else{b=desknets.Resource.Message.flow_cancel_list}}return desknets.tmpl.replaceWordHtml(b,"count",c._getListCheckCount())}else{if(c._mDelFlg=="1"){if(c.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message.flow_remand_all}else{if(c.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){b=desknets.Resource.Message.flow_remand_some}else{b=desknets.Resource.Message.flow_remand_list}}return desknets.tmpl.replaceWordHtml(b,"count",c._getListCheckCount())}else{if(c._mDelFlg=="3"){return""}}}return this.callBase("_delConfMessage")},_setDelConfirm:function(c){var b=this;if(b._mDelFlg=="2"||b._mDelFlg=="4"){b._openForcedEndDialog(c)}else{b.callBase("_setDelConfirm",c)}},_openForcedEndDialog:function(c){var b=this;desknets.flow.ForcedEndDialog.setDlgTtile(b._getForcedEndDlgTitle());desknets.flow.ForcedEndDialog.setDlgMessage(c);desknets.flow.ForcedEndDialog.setDlgCallback(a.proxy(b.execForcedEnd,b));desknets.flow.ForcedEndDialog.open()},_getForcedEndDlgTitle:function(){var b=this;if(b._mDelFlg=="2"){return desknets.Resource.flow.revocation}else{if(b._mDelFlg=="4"){return desknets.Resource.flow.forcedend}}return""},execForcedEnd:function(c){var b=this;b.$mForcedEndDialog=c;b._listDel(true,c)},_boDelSingle:function(){return true},_getDelAddPrm:function(){var b=this;var c={};c.lcmd=desknets.flowset.CMD_FLOWMSETLIST;c.fid=b.$mjListPage.find(".jco-back-page-data").find('input[name="fid"]').val();c.subject=b.$mjListPage.find(".jco-back-page-data").find('input[name="subject"]').val();c.stsid=b.$mjListPage.find(".jco-back-page-data").find('input[name="stsid"]').val();c.status=b.$mjListPage.find(".jco-back-page-data").find('input[name="status"]').val();c.fldsort=b.$mjListPage.find(".jco-back-page-data").find('input[name="fldsort"]').val();c.order=b.$mjListPage.find(".jco-back-page-data").find('input[name="order"]').val();if(b._mDelFlg=="2"||b._mDelFlg=="4"){if(b.$mForcedEndDialog){c.memo=b.$mForcedEndDialog.find("textarea").val()}}return c},_getRestModule:function(){return desknets.flow.MODULE_API_FLOW},_getListCmd:function(){return desknets.flowset.PAGE_FLOWMSETLIST},_getListExecCmd:function(){return desknets.flowset.CMD_FLOWMSETLIST},_getListDispCmd:function(){return desknets.flowset.PAGE_FLOWMSETDISP},_getDelCmd:function(){var c=this;var b=desknets.paramanalyzer.getHashParams();if(c._mDelFlg=="0"){return desknets.flowset.CMD_FLOWMSETCMDDELCONF}else{if(c._mDelFlg=="1"){return desknets.flowset.CMD_FLOWMSETREMANDCONF}else{if(c._mDelFlg=="2"){return desknets.flowset.CMD_FLOWMSETCANCELCONF}else{if(c._mDelFlg=="4"){return desknets.flowset.CMD_FLOWMSETFORCEDENDCONF}}}}return""},_getDelExecCmd:function(){var b=this;if(b._mDelFlg=="0"){return desknets.flowset.CMD_FLOWMSETCMDDEL}else{if(b._mDelFlg=="1"){return desknets.flowset.CMD_FLOWMSETREMAND}else{if(b._mDelFlg=="2"){return desknets.flowset.CMD_FLOWMSETCANCEL}else{if(b._mDelFlg=="4"){return desknets.flowset.CMD_FLOWMSETFORCEDEND}}}}return""},_getListDispClass:function(){return desknets.flowset.flowmsetdisp},});desknets.page(desknets.flowset,"flowmsetdisp",desknets.flow.flowdisp,{_initHtmlTmplSet:function(c){var b=this;if(neo.isSet(c[0]["cabuse"])){delete c[0]["cabuse"]}b.callBase("_initHtmlTmplSet",c)},chkApproval:function(b){return false},_initSetCab:function(b){},isManageMode:function(){return true},_inputButton:function(){var b=this;b.callBase("_inputButton");b.$mjPage.find(".jflow-input-back").click(function(c){c.preventDefault();b._mDelFlg="2";b._inputDelConfSubmit()});b.$mjPage.find(".jflow-input-forcedend").click(function(c){c.preventDefault();b._mDelFlg="4";b._openForcedEndDialog()})},_delConfMessage:function(){var b=this;if(b._mDelFlg=="2"){return desknets.Resource.Message.flow_remand_confirm}if(b._mDelFlg=="4"){return desknets.Resource.Message.flow_forcedend_confirm}return b.callBase("_delConfMessage")},_getDelPrm:function(){var b=this;var c=b.callBase("_getDelPrm");if(b._mDelFlg=="4"){c.memo=b.$mForcedEndDialog.find("textarea").val()}return c},_getForcedEndDlgTitle:function(){var b=this;if(b._mDelFlg=="4"){return desknets.Resource.flow.forcedend}return b.callBase("_getForcedEndDlgTitle")},_getDispExecCmd:function(){return desknets.flowset.CMD_FLOWMSETDISP},_getDelExecCmd:function(){var b=this;if(b._mDelFlg=="1"){return desknets.flowset.CMD_FLOWMSETCANCEL}else{if(b._mDelFlg=="2"){return desknets.flowset.CMD_FLOWMSETREMAND}else{if(b._mDelFlg=="4"){return desknets.flowset.CMD_FLOWMSETFORCEDEND}}}return desknets.flowset.CMD_FLOWMSETCMDDEL},_noticeUpdateData:function(){desknets.flowset.flowmsetsearch._onSrchExec=true}});desknets.page(desknets.flowset,"flowmsetsearch",desknets.flow.flowsearch,{_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".jflow-list-download-submit").click(function(c){c.preventDefault();b._mDelFlg="3";b.onClickDownlaodButton(c)});b.$mjListPage.find(".jflow-list-back-submit").click(function(c){c.preventDefault();b._mDelFlg="2";b._listDelSubmit(c)});b.$mjListPage.find(".jflow-list-forcedend-submit").click(function(c){c.preventDefault();b._mDelFlg="4";b._listDelSubmit(c)})},_initFlowViewButton:function(){var b=this},onClickDownlaodButton:function(d){var b=this;var c;var e=this._getDelAddPrm();e.cmd=desknets.flowset.CMD_FLOWDOWNLOAD;e.id=[];if(b.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){e.id.push(desknets.PRM_VAL_ALLDEL)}else{b.$mjListPage.find('input[name="'+b._getIDName()+'"]:checked').each(function(){e.id.push(a(this).val())})}if(e.id.length<=0){var f=b._delNoChkMessage();desknets.dialog.alert(f,{type:"warn"});return 0}c=desknets.getUrl(desknets.flow.MODULE_MAIN_FLOW)+"?"+desknets.getNeoParam(e);desknets.execLocation(c,"_blank")},_delNoChkMessage:function(){var b=this;if(b._mDelFlg=="2"){return desknets.Resource.Message.flow_remand_nochecked}if(b._mDelFlg=="3"){return desknets.Resource.Message.flow_download_nochecked}else{if(b._mDelFlg=="4"){return desknets.Resource.Message.flow_forcedend_nochecked}else{return this.callBase("_delNoChkMessage")}}},_delConfMessage:function(){var c=this;var b="";if(c._mDelFlg=="2"){if(c.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message.flow_remand_all}else{if(c.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){b=desknets.Resource.Message.flow_remand_some}else{b=desknets.Resource.Message.flow_remand_list}}return desknets.tmpl.replaceWordHtml(b,"count",c._getListCheckCount())}if(c._mDelFlg=="3"){return""}return this.callBase("_delConfMessage")},_setDelConfirm:function(c){var b=this;if(b._mDelFlg=="4"){b._openForcedEndDialog(c)}else{b.callBase("_setDelConfirm",c)}},_getForcedEndDlgTitle:function(){var b=this;if(b._mDelFlg=="4"){return desknets.Resource.flow.forcedend}return b.callBase("_getForcedEndDlgTitle")},_replaceListLine:function(c,f,d){var b=this;if(f=="elapsed_warn_flg"){c=desknets.flowset.flowmsetindex.replaceFlowListLineElapsedWarnFlg(c,f,d)}var e=desknets.flow.flowindex.replaceFlowListLine(c,f,d);if(e!=null){return e}return b.callBase("_replaceListLine",c,f,d)},_getDelAddPrm:function(){var b=this;var c=b.callBase("_getDelAddPrm");if(b._mDelFlg=="4"){if(b.$mForcedEndDialog){c.memo=b.$mForcedEndDialog.find("textarea").val()}}return c},_getListCmd:function(){return desknets.flowset.PAGE_FLOWMSETSEARCH},_getListExecCmd:function(){return desknets.flowset.CMD_FLOWMSETSEARCHINDEX},_getStopBatSearchCmd:function(){return desknets.flowset.CMD_FLOWMSETSTOPSEARCH},_getListDispCmd:function(){return desknets.flowset.PAGE_FLOWMSETDISP},_getDelCmd:function(){var b=this;if(b._mDelFlg=="0"){return desknets.flowset.CMD_FLOWMSETCMDDELCONF}else{if(b._mDelFlg=="1"){return desknets.flowset.CMD_FLOWMSETCANCELCONF}else{if(b._mDelFlg=="2"){return desknets.flowset.CMD_FLOWMSETREMANDCONF}else{if(b._mDelFlg=="4"){return desknets.flowset.CMD_FLOWMSETFORCEDENDCONF}}}}return""},_getDelExecCmd:function(){var b=this;if(b._mDelFlg=="0"){return desknets.flowset.CMD_FLOWMSETCMDDEL}else{if(b._mDelFlg=="1"){return desknets.flowset.CMD_FLOWMSETCANCEL}else{if(b._mDelFlg=="2"){return desknets.flowset.CMD_FLOWMSETREMAND}else{if(b._mDelFlg=="4"){return desknets.flowset.CMD_FLOWMSETFORCEDEND}}}}return""}});(function(b){desknets.page(desknets.flowset,"flowmsetformatroutemanager",desknets.PageAdmin,{_getNextCmd:function(){return desknets.flow.PAGE_FLOWLIST}})})(jQuery);(function(b){desknets.page(desknets.flowset,"flowasetformatimport",desknets.flowset.flowpsetformatimport,{_getRestModule:function(){return desknets.flow.MODULE_API_FLOW},_getTitle:function(){return b(".jflow-title").val()}})})(jQuery);(function(b){desknets.page(desknets.flowset,"flowasetformatexport",desknets.PageInputList,{_initSet:function(){var d=this;var c,e={};this.callBase("_initSet");c=this.$mjListPage.find("form");c.find(":hidden[name=cmd]").val(d._getExportExecCmd());e={};e["$control"]=this.$mjListPage.find(".jco-export-config-control");e.useCharSep=true;desknets.exportConfigControl.init(e);this.$mjListPage.find("form").submit(b.proxy(this._onSubmitForm,this));this.$mjListPage.find("form").delegate("a.jflow-format-name","click",b.proxy(this._onClickFormatName,this));this.$mjListPage.find("#jflow-form-legend").show()},_onSubmitForm:function(c){if(this.$mjListPage.find(":radio[name=id]:checked").length<=0){desknets.dialog.alert(desknets.Resource.Message.flow_formatnoselect,{type:"warn"});return false}},_onClickFormatName:function(c){c.preventDefault();var d=b(c.target).closest("tr").find(".jco-id").val();desknets.flow.ajaxFormatGet(d,function(e){desknets.flow.input.format.preview.init();desknets.flow.input.format.preview.open(e.html)})},_replaceListLine:function(e,g,f){var d=this;if(g=="draft"){var c="";if(f[g]=="1"){c="flowad-imperfect-icon"}e=e.replace("{{"+g+"}}",c)}else{e=d.callBase("_replaceListLine",e,g,f)}return e},_getRestModule:function(){return desknets.flow.MODULE_API_FLOW},_getListCmd:function(){return desknets.flowset.CMD_ASETAPPLICATE_LIST},_getListExecCmd:function(){return desknets.flowset.CMD_ASETAPPLICATE_LIST},_getExportExecCmd:function(){return desknets.flowset.CMD_FLOWASETFORMATEXPORT},_getListEntryClass:function(){return null},_getListModClass:function(){return null},_getAreaTitle:function(c){return c.find(".jflow-title").val()}})})(jQuery);desknets.page(desknets.flowset,"flowmsetserno",desknets.PageInputList,{_getRestModule:function(){return desknets.flowset.MODULE_API_FLOW},_getListCmd:function(){return desknets.flowset.PAGE_FLOWMSETSERNO},_getListExecCmd:function(){return desknets.flowset.PAGE_FLOWMSETSERNO},_getListAddCmd:function(){return desknets.flowset.PAGE_FLOWMSETSERNOENTRY},_getListModCmd:function(){return desknets.flowset.PAGE_FLOWMSETSERNOENTRY},_getDelExecCmd:function(){return desknets.flowset.CMD_FLOWMSETSERNODEL},_getDelCmd:function(){return desknets.flowset.CMD_FLOWMSETSERNODELCONF},_getMoveExecCmd:function(){return desknets.flowset.CMD_FLOWMSETMVSERNO},_getListEntryClass:function(){return desknets.flowset.flowmsetsernoentry},_getListModClass:function(){return desknets.flowset.flowmsetsernoentry}});desknets.page(desknets.flowset,"flowmsetsernoentry",desknets.PageInputBase,{mprxtxt:null,mdefno:null,mkeywordflg:false,_initSet:function(){var b=this;b.callBase("_initSet");b._hashIdCheck();b._updateKeyWordSample();b._inputFormSaveToObserver();b._setupItemsDrag();b._initDialogNumSet();b._initDialogKeySet();b._setUpCansel()},_hashIdCheck:function(){var b=this;var d=desknets.paramanalyzer.getHashParams();if(!neo.isSet(d.id)){var c="$YYYY$$MM$$DD$$9$";b.$mjPage.find(".jflowad-input-prx").val(c);b.$mjPage.find(".jflowad-input-defno").val("0")}b.mprxtxt=b.$mjPage.find(".jflowad-input-prx").val();b.mdefno=b.$mjPage.find(".jflowad-input-defno").val();b.mdefno=parseInt(b.mdefno,10);a("#jflowad-dialog-num-area").find(".jflowad-input-defno").val(b.mdefno)},_initDialogNumSet:function(){var c=this;c.mkeywordflg=false;var b=a("#jflowad-dialog-num-area");var d=desknets.dialog.getDialogOption();d.width=400;d.autoOpen=false;d.title=desknets.Resource.flow.num_title;d.buttons={};d.buttons[desknets.Resource.OKButtonLabel]=function(){var e=a(this).find(".jflowad-input-defno").val();var f=parseInt(e,10);if(e!=f||f<0){desknets.dialog.alert(desknets.Resource.Message.com_invalid_number);return false}c.mdefno=f;c._itemUpdata();a(this).dialog("close")};d.buttons[desknets.Resource.CancelButtonLabel]=function(){a(this).dialog("close")};b=desknets.dialog.setUp(b,d);a(".flowad-seq-format-setarea").delegate(".jflowad-dialog-num","click",function(e){e.preventDefault();b.dialog("open")})},_initDialogKeySet:function(){var b=this;var c="";var e="";$mtarget="";$mdialogkey=a("#jflowad-dialog-keyword-area");var d=desknets.dialog.getDialogOption();d.width=400;d.autoOpen=false;d.title=desknets.Resource.com_srch_keyword;d.close=function(){if(b.mkeywordflg){b._setNewKeyWord(e);b.mkeywordflg=false;b._itemUpdata()}else{if(c!==e){b._itemUpdata()}}e=""};d.buttons={};d.buttons[desknets.Resource.OKButtonLabel]=function(){var g=a(this).find(".jflowad-keyword-input").val();if(g.match(/\//i)||g.match(/\\/i)||g.match(/:/i)||g.match(/\?/i)||g.match(/"/i)||g.match(/</i)||g.match(/>/i)||g.match(/\|/i)||g.match(/;/i)||g.match(/,/i)||g.match(/\*/i)){var f={extraMessage:desknets.Resource.Message.flow_keyword_err_message_ex};desknets.dialog.alert(desknets.Resource.Message.flow_keyword_err_message,f);return false}e=g;if(!b.mkeywordflg&&c!==e){$mtarget.data("key",e)}$mdialogkey.find(".jflowad-keyword-input").val("");a(this).dialog("close")};d.buttons[desknets.Resource.CancelButtonLabel]=function(){$mdialogkey.find(".jflowad-keyword-input").val("");a(this).dialog("close")};$mdialogkey=desknets.dialog.setUp($mdialogkey,d);a(".flowad-seq-format-setarea").delegate(".jflowad-dialog-keyword","click",function(f){f.preventDefault();$mtarget=a(this);$mdialogkey.find(".jflowad-keyword-input").val($mtarget.data("key"));c=a(this).data("key");$mdialogkey.dialog("open")})},_setNewKeyWord:function(d){var c=this;var b='<a class="jflowad-dialog-keyword" href="#" data-key="{{data}}">{{title}}</a>';var e=desknets.Resource.com_srch_keyword;e+="("+d+")";b=desknets.tmpl.replaceWordHtml(b,"data",d);b=desknets.tmpl.replaceWordHtml(b,"title",e);$newKeyWord=c.$mjPage.find(".flowad-seq-format-setarea").find(".jflowad-newkey");$newKeyWord.find(".title").remove();$newKeyWord.append(b);$newKeyWord.removeClass("ui-draggable");$newKeyWord.removeClass("jflowad-newkey")},_setupItemsDrag:function(){var c=this;var f=false;var b=a(".flowad-seq-format-setarea>ul");$dragWrap=a(".flowad-seq-format-items>ul"),$dragItem=$dragWrap.find("li"),$sortArea=a(".flowad-seq-format-setarea>ul");var e={handle:".handle",cancel:".used",helper:"clone",appendTo:b,connectToSortable:$sortArea,start:function(g,i){c.$mjPage.find(".flowad-seq-format-setarea-wrap").addClass("acceptarea");var h=0;a.each($sortArea.find("li"),function(){h+=a(this).outerWidth()});$sortArea.outerWidth(h+100)},stop:function(g,i){if(f&&a(this).data("type")=="keyword"){c.mkeywordflg=true;$mdialogkey.dialog("open")}c.$mjPage.find(".flowad-seq-format-setarea-wrap").removeClass("acceptarea");var h=0;a.each($sortArea.find("li"),function(){h+=a(this).outerWidth()});$sortArea.outerWidth(h+10);f=false},zIndex:1};var d={items:">*",handle:".handle",placeholder:"placeholder",scroll:true,sort:function(h,i){var g=i.item;if(g.hasClass("short")){i.placeholder.addClass("short")}},update:function(g,h){c._itemUpdata();f=true}};$dragItem.draggable(e);$sortArea.sortable(d)},_setUpCansel:function(){var b=this;b.$mjPage.find(".flowad-seq-format-setarea").delegate(".cancel","click",function(c){c.preventDefault();var e=a(this).closest("li");var d=desknets.Resource.Message.flow_route_remove_confirm;desknets.dialog.confirm(d,function(){var f=e.data("type");var g=b.$mjPage.find(".flowad-seq-format-items").find('[data-type="'+f+'"]');if(f!="keyword"){g.removeClass("jflowad-display");g.show()}e.remove();b._itemUpdata()})})},_updateKeyWordSample:function(){var b=this;var c=b.mprxtxt;b._formatItemsMake(c);c=b._getConvertFormatTextByText(c);b.$mjPage.find(".flow-number-keyword-preview").text(c)},_itemUpdata:function(){var b=this;var d="";var c="";d=b._itemEach();b.$mjPage.find(".jflowad-input-prx").val(d);b.$mjPage.find(".jflowad-input-defno").val(b.mdefno);c=b._getConvertFormatTextByText(d);b.$mjPage.find(".flow-number-keyword-preview").text(c)},_itemEach:function(){var b=this;var d;var c="";var f=0;var e=b.$mjPage.find(".flowad-seq-format-items");b.$mjPage.find(".flowad-seq-format-setarea>ul").find("li").each(function(g,k){d="";var l;var h=a(this).data("type");var m=b.$mjPage.find(".flowad-seq-format-items").find('[data-type="'+h+'"]');if(h!="9"&&h!="keyword"){m.addClass("jflowad-display")}if(h=="keyword"){d+=a(this).find(".jflowad-dialog-keyword").data("key");l=desknets.Resource.com_srch_keyword;l+="("+d+")";a(this).find(".jflowad-dialog-keyword").text(l);var j=l.length*30;a(this).closest("li").css("width",j).css("width","auto")}else{if(h=="9"){d+="$9$";l=desknets.Resource.flow.num_title;l+="("+b.mdefno+")";a(this).find(".jflowad-dialog-num").text(l)}else{if(h=="YY"){d+="$YY$"}else{d+=h;d=d.replace(/YYYY/g,"$YYYY$").replace(/MM/g,"$MM$").replace(/DD/g,"$DD$").replace(/HH/g,"$HH$").replace(/MI/g,"$MI$").replace(/SS/g,"$SS$")}}}c+=d;f=f+a(this).outerWidth()+50});b.$mjPage.find(".jflowad-display").hide();b.$mjPage.find(".flowad-seq-format-setarea>ul").width(f);return c},_formatItemsMake:function(i){var d=this;var f;var h="";var g="";var e;var c=d.$mjPage.find(".flowad-seq-format-items");var b=d.$mjPage.find(".flowad-seq-format-setarea");f=i.replace(/\$YYYY\$/g,"*YYYY*").replace(/\$YY\$/g,"*YY*").replace(/\$MM\$/g,"*MM*").replace(/\$DD\$/g,"*DD*").replace(/\$HH\$/g,"*HH*").replace(/\$MI\$/g,"*MI*").replace(/\$SS\$/g,"*SS*").replace(/\$9\$/g,"*9*");e=f.split("*");a.each(e,function(j,k){if(k.length<=0){return true}g+=d._itemFormatHtml(k)});b.find("ul>li").remove();b.find("ul").append(g);d._itemEach()},_itemFormatHtml:function(e){var c=this;var h;var g="";var f='<li class="flowad-seq-format-item" data-type="9"><div title="{{move}}" class="handle"></div><a class="jflowad-dialog-num" href="#"  data-for="{{for}}">{{title}}</a></li>';f=desknets.tmpl.replaceWordHtml(f,"move",desknets.Resource.flow.num_move);var b='<li class="flowad-seq-format-item" data-type="keyword"><div title="{{move}}" class="handle"></div><div title="{{close}}" class="cancel"></div><a class="jflowad-dialog-keyword" href="#" data-key="{{data}}">{{title}}</a>';b=desknets.tmpl.replaceWordHtml(b,"move",desknets.Resource.flow.num_move);b=desknets.tmpl.replaceWordHtml(b,"close",desknets.Resource.flow.num_close);var d='<li class="flowad-seq-format-item" data-type="{{data}}"><div title="{{move}}" class="handle"></div><div title="{{close}}" class="cancel"></div><span class="title">{{title}}</span>';d=desknets.tmpl.replaceWordHtml(d,"move",desknets.Resource.flow.num_move);d=desknets.tmpl.replaceWordHtml(d,"close",desknets.Resource.flow.num_close);var i='<li class="flowad-seq-format-item short" data-type="{{data}}"><div title="{{move}}" class="handle"></div><div title="{{close}}" class="cancel"></div><span class="title">{{title}}</span>';i=desknets.tmpl.replaceWordHtml(i,"move",desknets.Resource.flow.num_move);i=desknets.tmpl.replaceWordHtml(i,"close",desknets.Resource.flow.num_close);switch(e){case"YYYY":case"YY":h=c.$mjPage.find(".flowad-seq-format-items").find('[data-type="'+e+'"]').find(".title").text();g=desknets.tmpl.replaceWordHtml(d,"data",e);g=desknets.tmpl.replaceWordHtml(g,"title",h);break;case"MM":case"DD":case"HH":case"MI":case"SS":h=c.$mjPage.find(".flowad-seq-format-items").find('[data-type="'+e+'"]').find(".title").text();g=desknets.tmpl.replaceWordHtml(i,"data",e);g=desknets.tmpl.replaceWordHtml(g,"title",h);break;case"9":g=desknets.tmpl.replaceWordHtml(f,"data","9");g=desknets.tmpl.replaceWordHtml(g,"for",c.mdefno);h=desknets.Resource.flow.num_title;h+="("+c.mdefno+")";g=desknets.tmpl.replaceWordHtml(g,"title",h);break;default:h=desknets.Resource.com_srch_keyword;h+="("+e+")";g=desknets.tmpl.replaceWordHtml(b,"data",e);g=desknets.tmpl.replaceWordHtml(g,"title",h)}return g},_getConvertFormatTextByText:function(k){var l=this;var m=new Date();var b=["01","02","03","04","05","06","07","08","09","10","11","12"];var g=m.getFullYear();var f=b[m.getMonth()];var c=m.getDate();var i=m.getHours();var d=m.getMinutes();var j=m.getSeconds();var e=k.replace(/\$YYYY\$/g,g).replace(/\$YY\$/g,l.getZeroFilled(g%100,2)).replace(/\$MM\$/g,f).replace(/\$DD\$/g,l.getZeroFilled(c,2)).replace(/\$HH\$/g,l.getZeroFilled(i,2)).replace(/\$MI\$/g,l.getZeroFilled(d,2)).replace(/\$SS\$/g,l.getZeroFilled(j,2));var h=l._getSeqNumText();var e=e.replace(/\$9\$/g,h);return e},_getSeqNumText:function(){var b=this;var c="0";c=parseInt(b.mdefno,10);c=b.getZeroFilled(c+1,6);return c},getZeroFilled:function(b,d){if(!neo.isSet(b)){return""}var c=b.toString();while(c.length<d){c="0"+c}return c},_getNextCmd:function(){return desknets.flow.PAGE_FLOWLIST},_getRestModule:function(){return desknets.flowset.MODULE_API_FLOW},_getDelExecCmd:function(){return desknets.flowset.CMD_FLOWMSETSERNODEL},_getAddExecCmd:function(){return desknets.flowset.CMD_FLOWMSETSERNOENTRY},_getModExecCmd:function(){var b=this;return b._getAddExecCmd()},_getDelCmd:function(){return desknets.flowset.CMD_FLOWMSETSERNODELENTRYCONF}});desknets.page(desknets.flowset,"flowmsetgrpauth",desknets.PagePaneListBase,{_tree:null,_optTreeId:"data-id",_deltype:"on",initLeftTree:function(){var b=this;b._tree=a.extend({},desknets.flowset.flowmsetgrpauthtree);b._tree.options=b._getOptionLeftTree();b._tree.init(b.$mjListPage,b._getOptionLeftTree())},_getOptionLeftTree:function(){var b=this;var c=b.callBase("_getOptionLeftTree");c.module=desknets.flowset.MODULE_API_FLOW;c.cmdgroups=desknets.flowset.CMD_FLOWMSETGRPAUTHGRPS;c.cmdgrouptree=desknets.flowset.CMD_FLOWMSETGRPAUTHGRPTREE;c.chooseTarget=["user"];c.defaultGroupId=b.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]').val();return c},treeUpdateListWidth:function(){this._tree.resize()},treeUpdateList:function(){this._tree.updateTreeList()},getInputFieldName:function(){return"gid"},_isMoveListItems:function(){return false},changPage:function(){var b=this;if(b._tree!=null){b._tree.options.defaultGroupId=b.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]').val()}b.callBase("changPage")},_initListStartModLink:function(){var b=this},_initListEndButton:function(){var b=this;b.$mjListPage.find(".jflow-list-grpauth-on").click(function(c){b._deltype="on";b._listDelSubmit(c)});b.$mjListPage.find(".jflow-list-grpauth-off").click(function(c){b._deltype="off";b._listDelSubmit(c)})},_delNoChkMessage:function(){var b=this;if(b._deltype=="off"){return desknets.Resource.Message.flow_off_nochecked}return desknets.Resource.Message.flow_on_nochecked},_delConfMessage:function(){var c=this;var b="";if(c.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){if(c._deltype=="off"){return desknets.Resource.Message.flow_off_allconf}return desknets.Resource.Message.flow_on_allconf}else{if(c.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){if(c._deltype=="off"){b=desknets.Resource.Message.flow_off_someconf}else{b=desknets.Resource.Message.flow_on_someconf}}else{if(c._deltype=="off"){b=desknets.Resource.Message.flow_off_listconf}else{b=desknets.Resource.Message.flow_on_listconf}}}return desknets.tmpl.replaceWordHtml(b,"count",c._getListCheckCount())},_replaceListLine:function(c,f,d){var b=this;var e="";if(f=="flwgrpauth"){if(d[f]=="1"){e=desknets.Resource.flow.grpauth}else{e=" "}return desknets.tmpl.replaceWord(c,f,e)}return b.callBase("_replaceListLine",c,f,d)},_getRestModule:function(){return desknets.flow.MODULE_API_FLOW},_getListCmd:function(){return desknets.flowset.PAGE_FLOWMSETGRPAUTH},_getListExecCmd:function(){return desknets.flowset.CMD_FLOWMSETGRPAUTH},_getDelExecCmd:function(){var b=this;if(b._deltype=="off"){return desknets.flowset.CMD_FLOWMSETGRPAUTHOFF}return desknets.flowset.CMD_FLOWMSETGRPAUTHON},_getDelAddPrm:function(){var b=this;var c={gid:b.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]').val()};return c},});desknets.page(desknets.flowset,"flowmsetgrpauthtree",desknets.groupTree,{TMPL_ROOT_START:'<ul><li data-id="" class="jstree-open co-listview-item"><a class="root-group">{{name}}</a>',TMPL_ITEM_ASSIGN:'<li data-id="{{id}}" class="jstree-{{state}} co-listview-item"><a href="#" class="co-listview-item-inside {{classes}} {{subType}}" title="{{title}}">{{name}}</a>',TMPL_ITEM_ALL:'<li data-id="{{id}}" class="jstree-{{state}} co-listview-item jco-tree-nodrop"><a href="#" class="co-listview-item-inside {{classes}} {{subType}}">{{name}}</a>',_boGetRoot:false,_boUpdate:false,_isAssignManager:false,_getSideTreeList:function(c){var b=this;if((typeof jsonRestGroup)!="undefined"&&b._boUpdate==false){b._createTree(c,b._getFirstHtmlFromJson(jsonRestGroup))}else{b.loadTree(c)}c.bind("loaded.jstree",function(d,e){var f=b.options.defaultGroupId;var g=b.getItemObject_li(c,f);b._delRootFolderAct(c);b._onSelectItem(null,g.children("a:first"));setTimeout(function(){b._updateItemsWidth();b.onSelectItemNoAjax(c,f);b._updateScrollTopValue(g)},100)})},_getFirstHtmlFromJson:function(c){var b=this;b._boGetRoot=true;if(neo.isSet(c)&&neo.isSet(c.Group)){b.options.defaultGroupId=c.Group}if(neo.isSet(c)&&neo.isSet(c.flgmanagegrp)&&c.flgmanagegrp=="1"){b._isAssignManager=true}return b.callBase("_getFirstHtmlFromJson",c)},_getItemHtmlFromItemData:function(d){var c=this;var b;var e="";if(c._isAssignManager){c.TMPL_ITEM=c.TMPL_ITEM_ASSIGN}else{if(d.id=="all"){b=c.TMPL_ITEM;c.TMPL_ITEM=c.TMPL_ITEM_ALL}}e=c.callBase("_getItemHtmlFromItemData",d);if(c._isAssignManager){e=desknets.tmpl.replaceWord(e,"title",d.title)}else{if(d.id=="all"){c.TMPL_ITEM=b}}return e},_delRootFolderAct:function(c){var b=c.find(".co-listview-tree-rootli-nosel");if(b.length==0){return}b.removeClass("jstree-last");b.removeClass("jstree-open");b.removeClass("jstree-closed")},getHtmlFromJson:function(d){var c=this;var b=desknets.ajax.getJsonItems(d);if(c._boGetRoot==true&&c._isAssignManager==false){}c._boGetRoot=false;c._boUpdate=false;return c.callBase("getHtmlFromJson",d)},_selectOnLoaded:function(b){},updateTreeList:function(){var b=this;var d=b.$_tree;var c=a.jstree._reference(b.$_tree);if(a.isEmptyObject(c)){return}d.closest(".co-listview-tree").hide();b._boGetRoot=true;b._boUpdate=true;c.destroy();b._getSideTreeList(d)}});(function(b){desknets.page(desknets.flowset,"flowsetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.flowset.PAGE_FLOWSETADMIN},_getAjaxFormOption:function(){var c=this;var d={};d=c.callBase("_getAjaxFormOption");d.validation=function(e){var f=c.checkInput(e);if(neo.isSet(f,{blank:false})){desknets.dialog.alert(f);return false}return true};return d},checkInput:function(d){var c=this;var e=null;d.find(".jco-validation-number").each(function(){if(!desknets.validation.isNumber(b(this).val())){var f={};f.msg=desknets.Resource.Message.com_invalid_number;f.fieldid=b(this).attr("name");f.fieldname=c._getErrorPlace(f.fieldid);e=desknets.getErrConvMsg(f);return false}});return e}})})(jQuery);(function(b){desknets.page(desknets.flowset,"flowsetmanager",desknets.PageAdmin,{_getSetCondition:function(){return true},_getNextCmd:function(){return desknets.flowset.PAGE_FLOWSETADMIN}})})(jQuery);desknets.page(desknets.flowset,"flowasetroute",desknets.PageInputList,{_initSet:function(){var b=this;b.callBase("_initSet");b.$mjListPage.find("#jflow-route-legend").show()},_listLine:function(b,c){if(c.draft=="1"){c.iconClass="flowad-imperfect-icon";c.iconName=desknets.Resource.flow.route_incomplete}else{c.iconClass="";c.iconName=""}return this.callBase("_listLine",b,c)},_getRestModule:function(){return desknets.flowset.MODULE_API_FLOW},_getListCmd:function(){return desknets.flowset.PAGE_ASETROUTE_LIST},_getListExecCmd:function(){return desknets.flowset.CMD_ASETROUTE_LIST},_getListAddCmd:function(){return desknets.flowset.PAGE_ASETROUTE_ENTRY},_getListModCmd:function(){return this._getListAddCmd()},_getDelExecCmd:function(){return desknets.flowset.CMD_ASETROUTE_DEL},_getMoveExecCmd:function(){return desknets.flowset.CMD_ASETROUTE_MOVE},_getListEntryClass:function(){return desknets.flowset.flowasetrouteentry},_getListModClass:function(){return this._getListEntryClass()},_getAreaTitle:function(b){return b.find(".jflow-title").val()}});desknets.page(desknets.flowset,"flowasetrouteentry",desknets.flowset.setRouteEntryBase,{_initSet:function(d){var c=this;c.callBase("_initSet",d);var b=c.$mjPage.find("form[name=inputfrm]");if(b.find('[name="id"]').val()!=""&&b.find('[name="draft"]').val()=="1"){c.$mjPage.find(".flow-warning-area").show()}},_inputButton:function(){this.callBase("_inputButton");desknets.flowset.DialogAccess.setUp({area:this.$mjPage.find(".jflow-access"),idFldName:"aid",module:this._getRestModule(),param:{cmd:desknets.flowset.PAGE_ASETROUTE_ACCESS,id:this.$mjPage.find("[name=id]").val()},dialoghtml:a("#flow-aset-route-access-dialog")})},_getDelExecCmd:function(){return desknets.flowset.CMD_ASETROUTE_DEL},getNodeListCmd:function(){return desknets.flowset.CMD_ASETROUTE_REFEDIT},getTempName:function(){return"flowasetroute"},_getAreaTitle:function(b){return b.find(".jflow-title").val()}});desknets.page(desknets.flowset,"flowasetapplicate",desknets.flowset.setApplicateListBase,{initParamsFromHash:function(c){var b=this;b.callBase("initParamsFromHash",c);if(!!c.cmd){desknets.pageframe.closeTopMsg()}},_listLine:function(b,c){if(c.draft=="1"){c.iconClass="flowad-imperfect-icon";c.iconName=desknets.Resource.flow.route_incomplete;c.linkClass="";c.linkName=""}else{c.iconClass="";c.iconName="";c.linkClass="flowad-link-icon";c.linkName=desknets.Resource.flow.applicate_pop_title}return this.callBase("_listLine",b,c)},_initSet:function(){var b=this;b.callBase("_initSet");b.$mjListPage.find("#jflow-form-legend").show()},_initListStart:function(){var b=this;b.callBase("_initListStart");b._initListStartUrlLink()},_initListStartUrlLink:function(){var c=this;var f="";var b='<div id="flow-pop">  <div id="flow-pop-title">'+desknets.Resource.flow.applicate_pop_title+'</div>  <div id="flow-pop-main">    <div>      <input type="text" class="apply-url" name="applyurl" value="" {{readonly}} />    </div>    <span class="co-msg">'+desknets.Resource.Message.share_popmsg_copy+"</span>  </div></div>";if(desknets.browser.tablet){f=""}else{f='readonly="readonly"'}b=desknets.tmpl.replaceWordHtml(b,"readonly",f);var d=a(b);d.appendTo("body");var e=d.find("#flow-pop-main");c.$mjTableList.delegate(".flowad-from-apply","click",function(k){k.preventDefault();var g=a(this);var l=a(this).parent().parent().parent().find(".jco-id").val();var j=desknets.getUrl(desknets.flow.MODULE_MAIN_FLOW)+"?cmd="+desknets.flow.PAGE_FLOWENTRY+"&fid="+l;var h=d.find("input.apply-url");h.val(j);d.delegate("input.apply-url","focus",function(m){if(desknets.browser.tablet){this.setSelectionRange(0,9999)}else{a(this).select()}});d.delegate("input.apply-url","mouseup",function(m){m.preventDefault();a(this).focus()});var i={target:g};desknets.popUp.open(d,i);h.trigger("focus")})},_getListCmd:function(){return desknets.flowset.PAGE_ASETAPPLICATE_LIST},_getListExecCmd:function(){return desknets.flowset.CMD_ASETAPPLICATE_LIST},_getListAddCmd:function(){return desknets.flowset.PAGE_ASETAPPLICATE_ENTRY},_getDelExecCmd:function(){return desknets.flowset.CMD_ASETAPPLICATE_DEL},_getMoveExecCmd:function(){return desknets.flowset.CMD_ASETAPPLICATE_MOVE},_getListEntryClass:function(){return desknets.flowset.flowasetapplicateentry},_getAreaTitle:function(b){return b.find(".jflow-title").val()}});desknets.page(desknets.flowset,"flowasetapplicateentry",desknets.flow.FlowInputBase,{cmdRouteList:"flowcmdroutelist",cmdRouteDetail:"flowmsetcmdeditroute",_initSet:function(d){var c=this;c.callBase("_initSet",d);if(a("#jflow-topmsg").val().length>0){desknets.pageframe.viewTopMsg(a("#jflow-topmsg").val(),"alert")}var b=c.$mjPage.find("form[name=inputfrm]");if(b.find('[name="id"]').val()!=""&&b.find('[name="draft"]').val()=="1"){c.$mjPage.find(".flow-warning-area").show()}if(b.find('[name="id"]').val()==""){c.$mjPage.find("#jflow-form-entry").hide()}},_inputButton:function(){var b=this;b.callBase("_inputButton");this._initCopyButton();this._initSequence();this._initDocFolderDialog();this._initAccessDialog();b._inputFormSaveToObserver()},getRouteOptionsForParams:function(){var b=this;var c=b.callBase("getRouteOptionsForParams");c.branch=true;return c},_getDelExecCmd:function(){return desknets.flowset.CMD_ASETAPPLICATE_DEL},getFormPartListCmd:function(){return desknets.flowset.CMD_ASETFORMAT_REFEDIT},getRouteNodeListCmd:function(){return desknets.flowset.CMD_ASETFORM_ROUTEEDIT},getCopyRouteNodeCmd:function(){return desknets.flowset.CMD_ASETROUTE_REFEDIT},getCopyRouteListCmd:function(){return"flowasetcmdformroutelist"},getTempName:function(){return"flowasetapplicate"},_initCopyButton:function(){var b=this;this.$mjPage.find(".jco-input-copy").click(function(){var c=desknets.paramanalyzer.getHashParams();desknets.paramanalyzer.setLocationHash({cmd:c.cmd,copyid:c.id})})},_initSequence:function(){var d=this.$mjPage.find("select.jflow-use-seq");var c=this.$mjPage.find("select.jflow-seq-id");function b(){var e=d.val()=="1"?"show":"hide";c[e]()}d.change(function(){b()});b();if(this.$mjPage.find("select.jflow-seq-id").find("option").length<=0){this.$mjPage.find(".jflow-serno").hide()}},_initDocFolderDialog:function(){var b={module:desknets.flowset.MODULE_API_DOC,cmddef:desknets.flowset.CMD_DOCFOLDERLIST,cmdchild:desknets.flowset.CMD_DOCFOLDERLISTCHILD};desknets.chooserSingleSelFolder.init(this.$mjPage.find(".jflow-doc-folder"),b)},_initAccessDialog:function(){var c=this.$mjPage.find("[name=id]").val();var b=desknets.paramanalyzer.getHashParams();if(neo.isSet(b.copyid)&&isNaN(b.copyid)!=true){c=b.copyid}desknets.flowset.DialogAccess.setUp({area:this.$mjPage.find(".jflow-access"),idFldName:"aid",module:this._getRestModule(),param:{cmd:desknets.flowset.PAGE_ASETAPPLICATE_ACCESS,id:c},dialoghtml:a("#flow-aset-applicate-access-dialog")})},_getAreaTitle:function(b){return b.find(".jflow-title").val()}});app.addInitialAction(function(){desknets.flowset.init()})})(jQuery);