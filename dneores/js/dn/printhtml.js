/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.printhtml={init:function(){this.setUpCss();this.setUpHtml()},chkWindow:function(){var b="";if(!window.opener||window.opener.closed){b=desknets.Resource.Message.print_mainwindow_no}else{try{if(!neo.isSet(window.opener.desknets)){b=desknets.Resource.Message.print_mainwindow_no}}catch(c){b=desknets.Resource.Message.print_mainwindow_no}}return b},setUpCss:function(){var c=this;if(c.chkWindow()==""){var b=a("head");window.opener.$("link").each(function(){var d=a(this);if(d.attr("rel")=="stylesheet"){var g=d.attr("href");var e=g.indexOf("?");if(e>0){g=g.substring(0,e)}if(g!="/"+desknets.DIR_RESHOME+"/themes/common.css"&&g!="/"+desknets.DIR_RESHOME+"/themes/commonset.css"&&g!="/"+desknets.DIR_RESHOME+"/lang/"+desknets.Resource.code+"/themes/common.css"){b.append("<link />");var f=b.children(":last");f.attr({rel:"stylesheet",type:"text/css",href:d.attr("href")})}}})}},setUpHtml:function(){var l=this;var f=l.chkWindow();if(f!=""){a("#jco-print-body").html(f)}else{var g=window.opener.desknets.paramanalyzer.getHashParams();var c=document.URL;var e=0;var m="";var h=0;e=c.indexOf("#");if(e>0){c=c.substring(0,e)}e=c.indexOf("?");if(e>=0){m=c.substring(e+1,c.length)}var i=m.split("&");var k={};for(h=0;h<i.length;h++){if(i[h]==""){continue}i[h]=i[h].split("=");var d=i[h][0];var j=desknets.decodeURIComponentNeo(i[h][1]);if(d!="cmd"&&d!="fldlang"&&d!="ns"){if(d=="execcmd"){k.cmd=j}else{k[d]=j}}}if(String(k.cmd).indexOf("sch")==0){var g=window.opener.desknets.paramanalyzer.getHashParams();if(k.cmd==g.cmd){if(this.setUpHtmlFunc()){window.print()}}else{a("#jco-print-body").html(desknets.Resource.Message.print_mainwindow_chg)}}else{if(k.cmd=="koubaimgrefer"||k.cmd=="koubaimsetrefer"){var g=window.opener.desknets.paramanalyzer.getHashParams();if(k.id==g.id&&k.date==g.date){if(this.setUpHtmlFunc()){window.print()}}else{a("#jco-print-body").html(desknets.Resource.Message.print_mainwindow_chg)}}else{if(k.cmd=="prjprint"){var b=window.opener.$("#jco-pv-funcid").val();if(b=="prjindex"||b=="prjmsetlist"){if(this.setUpHtmlFunc()){window.print()}}else{a("#jco-print-body").html(desknets.Resource.Message.print_mainwindow_chg)}}else{if(k.cmd=="tcardprint"){var b=window.opener.$("#jco-pv-funcid").val();if(b=="tcardindex"||b=="tcardmsetmonthlyreport"){if(this.setUpHtmlFunc()){window.print()}}else{a("#jco-print-body").html(desknets.Resource.Message.print_mainwindow_chg)}}else{if(k.cmd=="cost"){if(this.setUpHtmlCostFunc()){window.print()}}else{if(this.chkOpenWindowPrm(g,k)){if(this.setUpHtmlFunc()){window.print()}}else{a("#jco-print-body").html(desknets.Resource.Message.print_mainwindow_chg)}}}}}}}},chkOpenWindowPrm:function(e,d){var b=true;var f=0;var c=0;a.each(d,function(h,g){c++});a.each(e,function(h,g){f++;if(g!=d[h]){b=false;return false}});if(c!=f){return false}return b},setUpHtmlCostFunc:function(){var b=this;var d=a("body").data("print-ns");if(neo.isSet(window.opener)&&neo.isSet(window.opener.desknets)&&neo.isSet(window.opener.desknets[d])){var c=window.opener.desknets[d].setPrintCostHtml(window);return c}else{return false}},setUpHtmlFunc:function(){var b=this;var d=a("body").data("print-ns");if(neo.isSet(window.opener)&&neo.isSet(window.opener.desknets)&&neo.isSet(window.opener.desknets[d])){var c=window.opener.desknets[d].setPrintHtml(window);return c}else{return false}}};app.addInitialAction(function(){desknets.printhtml.init()})})(jQuery);