/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){desknets.info={newIcon:"New",MODULE_API_INFO:"zrinfo",CMD_INFOINDEX:"infocmdindex",CMD_INFOCATELISTC:"infocatelistchild",CMD_INFOUNREAD:"infocmdunread",CMD_INFOREFER:"infocmdrefer",CMD_INFOREFATTACH:"infodispattach",CMD_INFOSEARCHINDEX:"infocmdsrchindex",CMD_INFOSEARCHSTOP:"infocmdsrchstop",CMD_INFOREFSETTAG:"infocmdsettag",CMD_INFOIMAGE:"infoimage"};a.extend(desknets.info,{MODULE_INFO:"zinfo",ERRORNO_INFO_NOACCESS:-2906,PAGE_INFOINDEX:"infoindex",PAGE_INFOEDITINDEX:"infoeditindex",CMD_INFOEDITINDEX:"infocmdeditindex",CMD_INFOCATELIST:"infocatelist",CMD_INFODELCONF:"infocmddelconf",CMD_INFODEL:"infocmddel",CMD_INFOREAD:"infocmdread",CMD_INFOEDITREFER:"infocmdeditrefer",PAGE_INFOENTRY:"infoentry",CMD_INFOENTRY:"infocmdentry",CMD_INFOENTRYDEL:"infocmdentrydel",CMD_INFOCATEACCSLIST:"infocateaccslist",PAGE_INFOREFER:"inforefer",CMD_INFOADDATTACH:"infocmdaddattach",CMD_INFODELATTACH:"infocmddelattach",PAGE_INFOSEARCHINDEX:"infosrchindex",PAGE_INFOEDITSEARCHINDEX:"infoeditsrchindex",CMD_INFOSEARCHDELCONF:"infocmdsrchdelconf",CMD_INFOSEARCHDEL:"infocmdsrchdel",CMD_INFOSEARCHREAD:"infocmdsrchread",CMD_INFOSEARCHUNREAD:"infocmdsrchunread",CMD_INFOCOPYATTACH:"infocmdcopyattach",CMD_INFOAPPROVALREQINDEX:"infocmdappvalreqindex",CMD_INFOAPPROVALNGINDEX:"infocmdappvalngindex",CMD_INFOAPPROVALREFER:"infocmdapprovalrefer",CMD_INFOAPPROVALOK:"infocmdapprovalok",CMD_INFOAPPROVALNG:"infocmdapprovalng",CMD_INFOCONNECTAPP:"infocmdconnectapp",CMD_INFORTEDISPATTACH:"infortedispattach",CATEGORYID_ALL:"0",CATEGORYID_NOC:"-1",funcID:null,init:function(){var c=this;var b=a("#jco-pv-funcid").val();this.setFuncID(b);desknets.pageframe.setFuncSel(b);if(b==desknets.info.PAGE_INFOINDEX){desknets.hashobserver.init(desknets.info);desknets.info.subwin.init();desknets.info.infoindex.init();desknets.tags.item.setUpFuncAfterAjax(c.changeMainContent)}else{if(b==desknets.info.PAGE_INFOEDITINDEX){desknets.hashobserver.init(desknets.info);desknets.info.editsubwin.init();desknets.info.infoeditindex.init();desknets.tags.item.setUpFuncAfterAjax(c.changeMainContent)}}},setFuncID:function(b){this.funcID=b},getFuncID:function(b){return this.funcID},getFolderCmd:function(){var b=this;return{restAPI:b.MODULE_API_INFO,listCMD:b.CMD_INFOCATELIST,listchildCMD:b.CMD_INFOCATELISTC}},changeMainContent:function(c,d){if(c.data("module")!="info"){return true}var b=desknets.paramanalyzer.getHashParams();if(!neo.isSet(b.cmd)){b.cmd=""}if(b.cmd==desknets.info.PAGE_INFOREFER){if(b.id==a.trim(c.data("did"))){a(".co-select-menu-text").html(a(".tag-disp-options:first").find("a:first").html());a('input[name="tagcolor"]').val("0")}}return true}});desknets.page(desknets.info,"subwin",desknets.PageSubwinSearch,{init:function(){var c=this;var d=c.getInputArea();var f=desknets.paramanalyzer.getHashParams();var e=f.cmd;if(e&&e!=c._getMainCmd()&&e!=c._getSearchCmd()){c.setSubWinSelectFolder(false)}d.find('input[name="srch_key"]').val(f.srch_key);if(f.srch_catekind){var g=d.find('select[name="srch_catekind"]');if(!g.attr("disabled")){g.val(f.srch_catekind)}}if(f.srch_attach=="1"){d.find('input[name="srch_attach"]').attr("checked","checked")}if(f.srch_important){d.find('select[name="srch_important"]').val(f.srch_important)}if(f.srch_filecontents=="1"){d.find('select[name="srch_filecontents"]').val(f.srch_filecontents)}else{d.find('select[name="srch_filecontents"]').val("0")}d.find('input[name="sdate"]').val(f.sdate);d.find('input[name="edate"]').val(f.edate);c.callBase("_initSearch");desknets.htmlparts.setUpForm(c.$_inputArea);if(c._getSearchCmd()===desknets.info.PAGE_INFOSEARCHINDEX){var b=a("#dn-s-guide");b.find(".info-edit-subwindow").attr("disabled","disabled")}},_getSearchPrm:function(e){var c=this;var d=c.$_inputArea;var g="";var b=c._getCatekindClass();e.fldsort="sdate";e.order="-1";e.row="0";e.srch_key=d.find('input[name="srch_key"]').val();e.srch_catekind=d.find(b,'select[name="srch_catekind"]').val();if(d.find('input[name="srch_attach"]').attr("checked")){e.srch_attach="1"}else{e.srch_attach=""}e.srch_important=d.find('select[name="srch_important"]').val();e.sdate=d.find('input[name="sdate"]').val();e.edate=d.find('input[name="edate"]').val();e.srch_filecontents=d.find('select[name="srch_filecontents"]').val();if(neo.isSet(e.srch_catekind)&&e.srch_catekind!="0"){var f=desknets.paramanalyzer.getHashParams();if(f.fid){g=f.fid}else{g=a(".jco-back-page-data").find('input[name="fid"]').val()}if(g!="0"){e.fid=g}else{e.srch_catekind="0"}}return e},_getCatekindClass:function(){return".jinfo-disp-subwindow"},_getMainCmd:function(){return desknets.info.PAGE_INFOINDEX},_getSearchCmd:function(){return desknets.info.PAGE_INFOSEARCHINDEX},_execClear:function(){var b=this;b.callBase("_execClear");var c=a(".jco-subwindow-search");c.find('input[name="srch_attach"]').attr("checked",false);c.find('select[name="srch_important"]').val("0");var d=c.find('select[name="srch_catekind"]');if(!d.attr("disabled")){d.val("0")}c.find('select[name="srch_filecontents"]').val("0")},_chkInputSearchRequired:function(){var j=this;var g=j.$_inputArea;var i="";var b=true;var d=0;var f=desknets.paramanalyzer.getHashParams();if(f.fid){d=f.fid}else{d=a(".jco-back-page-data").find('input[name="fid"]').val()}var e=g.find('input[name="srch_attach"]').attr("checked");var h=g.find('select[name="srch_catekind"]').val();if(h=="0"||d=="0"||d==""){if(g.find('input[name="srch_key"]').val()==""&&!e&&g.find('select[name="srch_important"]').val()=="0"&&g.find('input[name="sdate"]').val()==""&&g.find('input[name="edate"]').val()==""){b=false}}if(!b){var c=desknets.Resource.searchcond;i=desknets.tmpl.replaceWordHtml(desknets.Resource.Message.com_search_required,"item",c);desknets.dialog.alert(i,{type:"warn"});return false}return j.callBase("_chkInputSearchRequired")},setSubWinSelectFolder:function(b){var c=this;var d=c.getInputArea();var h=d.find('select[name="srch_catekind"]');var e="";var g={};if(b){if(!h.attr("disabled")){return}g=desknets.paramanalyzer.getHashParams();var f=g.cmd;if(!f||f==c._getMainCmd()){if(!f||!neo.isSet(g.fid)||g.fid==""||g.fid=="0"){e="0"}else{e="1"}}}if(f==c._getSearchCmd()){g=desknets.paramanalyzer.getHashParams();e=g.srch_catekind;if(!neo.isSet(e)){e=c.getViewArea().find(".jco-back-page-data").find('input[name="srch_catekind"]').val()}if(e=="0"){b=false}}if(e==""){e="0"}h.val(e);h.attr("disabled",!b)}});desknets.page(desknets.info,"editsubwin",desknets.info.subwin,{init:function(){var c=this;var b=a("#dn-s-guide");c.callBase("init");b.find(".jinfo-disp-subwindow").hide();b.find(".jinfo-disp-subwindow").attr("disabled","disabled");b.find(".info-edit-subwindow").show()},_getSearchPrm:function(c){var b=this;var d="";b.callBase("_getSearchPrm",c);if(!neo.isSet(c.fid,{blank:false})||c.fid=="0"){c.srch_catekind="2"}c.srch_editmode="1";return c},_getCatekindClass:function(){return".info-edit-subwindow"},_getSearchCmd:function(){return desknets.info.PAGE_INFOEDITSEARCHINDEX}});desknets.page(desknets.info,"attach",desknets.attachSetUp,{funcToggleTarget:null,_getToggleTarget:function(){return this.funcToggleTarget},_initSetDefPrm:function(){this._objDefPrm={};var b=this._$pageEntry.find('input[name="infoid"]');if(b.length>0&&b.val()!==""){this._objDefPrm[this._sDefIdName]=b.val()}},_getUploadURL:function(){return desknets.info.MODULE_API_INFO},_getUploadCmd:function(){return desknets.info.CMD_INFOADDATTACH},_getDelCmd:function(){return desknets.info.CMD_INFODELATTACH},_getDownLoadURL:function(){return desknets.info.MODULE_INFO},_getDownLoadCmd:function(){return desknets.info.CMD_INFOREFATTACH},_getHideArea:function(){return".jinfo-row-attaches"}});(function(b){desknets.page(desknets.info,"infofolderlist",desknets.folderlist_access,{_initfid:"0"})})(jQuery);desknets.page(desknets.info,"infoeditfolderlist",desknets.info.infofolderlist,{_openNodeFirstTime:function(c){var b=this;b.callBase("_openNodeFirstTime",c);b._setSelectAccsCtrl()},_onOpenItem:function(c){var b=this;b.callBase("_onOpenItem",c);b._setSelectAccsCtrl()},_setSelectAccsCtrl:function(){var b=this;var c=a("#jco-m-list-container").find(".co-listview-tree-in").find("a.co-listview-item-inside");c.each(function(f,g){var e=a(this);var d=e.data("access");if(f!=0&&!b._isHasAccess(d,2)&&!b._isHasAccess(d,4)&&!b._isHasAccess(d,8)){e.addClass("co-tree-noselect")}})}});(function(b){desknets.page(desknets.info,"infofolderinput",desknets.folderinput_access,{_setSelectAccsCtrl:function(){var c=this;var e=c._getListParent().find("a.co-listview-item-inside");var d=desknets.paramanalyzer.getHashParams();if(neo.isSet(d.id)){e.each(function(h,j){var g=b(this);var f=g.data("access");if(!c._isHasAccess(f,2)&&!c._isHasAccess(f,4)){g.addClass("co-tree-noselect")}})}else{e.each(function(h,j){var g=b(this);var f=g.data("access");if(!c._isHasAccess(f,2)){g.addClass("co-tree-noselect")}})}}})})(jQuery);(function(b){desknets.page(desknets.info,"infofolderdisp",desknets.folderdisp,{})})(jQuery);desknets.page(desknets.info,"infofoldereditdisp",desknets.folderinput_access,{addOptions:{isOnAlready:true},init:function(e,d,b){var c=this;d=a.extend({},d,c.addOptions);c.callBase("init",e,d,b)},_isCtrlAccess:function(){return true},_setSelectAccsCtrl:function(){var b=this;var c=a("#jco-m-disp-page").find(".co-listview-tree-in").find("a.co-listview-item-inside");c.each(function(f,g){var e=a(this);var d=e.data("access");if(f!=0&&!b._isHasAccess(d,2)&&!b._isHasAccess(d,4)&&!b._isHasAccess(d,8)){e.addClass("co-tree-noselect")}})},_getFirstTreeData:function(c){var b=this;b._getFirstTreeDataListCopy()},_isGetFirstTreeAjax:function(){return false},_onSelectItem:function(d,b){var c=this;c.copyTree(c.$_root,c._options.listAreaObj,true);c.callBase("_onSelectItem",d,b)},getDispTreeAjax:function(b){var c=this;if(neo.isSet(b)&&a.isFunction(b)){c._loadFunc=b}var e=desknets.paramanalyzer.getHashParams();var d=c.getInputFieldName();if(neo.isSet(e)&&e[d]){c._initfid=e[d]}c._getFirstTreeAjax();c.boGet=true},_setFolderOpen:function(){var b=this;var c=b.$_root.find(".co-listview-item-inside.on");if(c.length>0){c.removeClass("on")}b.callBase("_setFolderOpen")}});(function(b){desknets.page(desknets.info,"infoindex",desknets.PagePaneListBase,{_sDelFlg:"0",_mboOverErrView:true,_mboOverErr:false,init:function(){var c=this;c.mboHasMceEditor=true;c.callBase("init")},initLeftTree:function(){var c=this;desknets.info.infofolderlist.init(c.$mjListPage,c._getOptionLeftTree(),c._optTreeGetCmd())},treeUpdateListWidth:function(){desknets.info.infofolderlist._updateItemsWidth()},treeUpdateList:function(){desknets.info.infofolderlist.updateTreeList()},_optTreeGetCmd:function(){return desknets.info.getFolderCmd()},_optTreeIsEdit:function(){return false},_optTreeSelectFunc:function(d){var c=this;c._setInfoSubWinCate(d);c.callBase("_optTreeSelectFunc",d)},_optTreeSelectFunc:function(d){var c=this;if(!neo.isSet(c._firstFolder)||c._firstFolder.length==0){}else{if(c._boupdate==false){c._mboOverErrView=true}}c.callBase("_optTreeSelectFunc",d)},getInputFieldName:function(){return"fid"},_setInfoSubWinCate:function(f){var d=this;var e=b(".jco-subwindow-search").find('select[name="srch_catekind"]');if(!e.attr("disabled")){var c=f.attr(d._optTreeId);if(!neo.isSet(c)||c==""||c=="0"){b(".jco-subwindow-search").find(".jinfo-srch_catekind").val("0")}else{b(".jco-subwindow-search").find(".jinfo-srch_catekind").val("1")}}},_isMoveListItems:function(){return false},initParamsFromHash:function(d){var c=this;var e="";e=d.cmd;if(!neo.isSet(e)||e==c._getListCmd()||(e==c._getSubWinSearchCmd()&&(neo.isSet(d.fid)&&d.fid!="0"))){c._getSubwinClass().setSubWinSelectFolder(true)}else{c._getSubwinClass().setSubWinSelectFolder(false)}c.callBase("initParamsFromHash",d)},_listPage:function(d){var c=this;if(d=="0"){desknets.pageframe.closeTopMsg()}c.callBase("_listPage",d)},_updateListCheckState:function(c){var d=this;d.callBase("_updateListCheckState",c);var e=this.$mjListPage.find(".co-chk-cnt-some");if(d._mboOverErr){e.find("a").hide()}else{e.find("a").show()}},_initListEnd:function(){var c=this;c.callBase("_initListEnd");c.$mjListPage.find(".jinfo-range-sel").change(function(d){b(d.target).blur();c.$mjListPage.find(".jco-back-page-data").find('input[name="range"]').val(b(this).val());c._mboOverErrView=true;c._listPage("0")});c.$mjListPage.find(".jinfo-status-sel").change(function(d){b(d.target).blur();c.$mjListPage.find(".jco-back-page-data").find('input[name="status"]').val(b(this).val());c._mboOverErrView=true;c._listPage("0")});c.$mjListPage.find(".jinfo-list-approval-request").click(function(d){d.preventDefault();c.$mjListPage.find(".jco-back-page-data").find('input[name="approval"]').val("1");c.$mjListPage.find(".jco-back-page-data").find('input[name="range"]').val("4");c.$mjListPage.find(".jco-back-page-data").find('input[name="status"]').val("");c.$mjListPage.find(".jco-back-page-data").find('input[name="fldsort"]').val("sdate");c.$mjListPage.find(".jco-back-page-data").find('input[name="order"]').val("-1");c._mboOverErrView=true;c._listPage("0")});c.$mjListPage.find(".jinfo-list-approval-denial").click(function(d){d.preventDefault();c.$mjListPage.find(".jco-back-page-data").find('input[name="approval"]').val("0");c.$mjListPage.find(".jco-back-page-data").find('input[name="range"]').val("4");c.$mjListPage.find(".jco-back-page-data").find('input[name="status"]').val("");c.$mjListPage.find(".jco-back-page-data").find('input[name="fldsort"]').val("sdate");c.$mjListPage.find(".jco-back-page-data").find('input[name="order"]').val("-1");c._mboOverErrView=true;c._listPage("0")});c.$mjListPage.find(".jinfo-list-approval-back").click(function(d){d.preventDefault();c.$mjListPage.find(".jco-back-page-data").find('input[name="approval"]').val("");c.$mjListPage.find(".jco-back-page-data").find('input[name="range"]').val("2");c.$mjListPage.find(".jco-back-page-data").find('input[name="fldsort"]').val("sdate");c.$mjListPage.find(".jco-back-page-data").find('input[name="order"]').val("-1");c._mboOverErrView=true;c._listPage("0")})},_initListEndButton:function(){var c=this;c.callBase("_initListEndButton");c.$mjListPage.find(".jinfo-list-read-submit").click(function(d){if(c._getListCheckCount()>0){c._sDelFlg="1";c._listDel(true,null)}});c.$mjListPage.find(".jinfo-list-unread-submit").click(function(d){if(c._getListCheckCount()>0){c._sDelFlg="2";c._listDel(true,null)}})},_getListAjaxSuccessEnd:function(){var c=this;var d={};var e="";c.callBase("_getListAjaxSuccessEnd");d=desknets.paramanalyzer.getHashParams();e=d.range;if(e!="1"&&e!="3"&&e!="4"){e="2"}c.$mjListPage.find(".jinfo-range-sel").val(e);e=d.status;if(e!="1"&&e!="2"){e="3"}c.$mjListPage.find(".jinfo-status-sel").val(e);if(!!d.approval&&(d.approval=="0"||d.approval=="1")){c.$mjListPage.find("input[type=checkbox]").attr("disabled","disabled");c.$mjListPage.find(".jinfo-list-approval-back").show();c.$mjListPage.find(".jinfo-list-read-submit").hide();c.$mjListPage.find(".jinfo-list-unread-submit").hide();c.$mjListPage.find(".jinfo-list-sel").hide()}else{c.$mjListPage.find("input[type=checkbox]").removeAttr("disabled");c.$mjListPage.find(".jinfo-list-approval-back").hide();c.$mjListPage.find(".jinfo-list-read-submit").show();c.$mjListPage.find(".jinfo-list-unread-submit").show();c.$mjListPage.find(".jinfo-list-sel").show()}},_getListAjaxSuccessOtherSet:function(e){var c=this;c.callBase("_getListAjaxSuccessOtherSet",e);c._mboOverErr=false;if(neo.isSet(e[desknets.RES_TAG_MSGGETLIMIT])){c._mboOverErr=true;if(this._mboOverErrView){this._mboOverErrView=false;desknets.pageframe.viewTopMsg(e[desknets.RES_TAG_MSGGETLIMIT],"info")}}var d=desknets.Resource.info.approvalcnt;c.$mjListPage.find(".jinfo-list-approval-request-cnt").html(desknets.tmpl.replaceWordHtml(d,"cnt",e.approvalreqcnt));if(Number(e.approvalreqcnt)>0){c.$mjListPage.find(".jinfo-list-approval-request").addClass("info-list-approval")}else{c.$mjListPage.find(".jinfo-list-approval-request").removeClass("info-list-approval")}c.$mjListPage.find(".jinfo-list-approval-denial-cnt").html(desknets.tmpl.replaceWordHtml(d,"cnt",e.approvalngcnt));if(Number(e.approvalngcnt)>0){c.$mjListPage.find(".jinfo-list-approval-denial").addClass("info-list-approval")}else{c.$mjListPage.find(".jinfo-list-approval-denial").removeClass("info-list-approval")}},_listLine:function(d,e){var c=this;d=c.callBase("_listLine",d,e);var f=desknets.paramanalyzer.getHashParams();if(f.approval=="0"||f.approval=="1"){d=desknets.tmpl.replaceWordHtml(d,"approval","&approval="+f.approval)}else{d=desknets.tmpl.replaceWordHtml(d,"approval","")}if(!e.approvalicon){d=desknets.tmpl.replaceWordHtml(d,"approvalicon","")}return d},_replaceListLine:function(c,e,f){var j=this;var g;var k=false;var h="";var i="";var d=desknets.paramanalyzer.getHashParams();if(!neo.isSet(d.fid,{blank:false})){i="0"}else{i=d.fid}c=desknets.tmpl.replaceWordHtml(c,"fid",i);if(e==="read"){if(f.read==="1"){i="info-tr-unread"}else{i=""}c=desknets.tmpl.replaceWordHtml(c,"read",i)}else{if(e==="priority"){if(f.priority==="1"){h=desknets.Resource.importance_highest;i="haste"}else{if(f.priority==="2"){h=desknets.Resource.importance_high;i="high"}else{if(f.priority==="4"){h=desknets.Resource.importance_low;i="low"}else{h="";i=""}}}c=desknets.tmpl.replaceWordHtml(c,"implevel",i);c=desknets.tmpl.replaceWordHtml(c,e,h)}else{if(e==="attachcnt"){h=desknets.escapeSpace(desknets.escapeValue(desknets.escape(f.attachcnt)));if(h!==""&&parseInt(h,10)>0){k=true}else{k=false}if(k){i="on"}else{i=" "}c=desknets.tmpl.replaceWordHtml(c,"attachcnt",i);if(k){h=desknets.Resource.attachLabel}else{h=" "}c=desknets.tmpl.replaceWordHtml(c,"attachcnton",h)}else{if(e==="newicon"){if(f.newicon==="1"){h='<span class="info-new-icon"></span>&nbsp;'}else{h=""}c=desknets.tmpl.replaceWordHtml(c,"newicon",h)}else{if(e==="startdate"){h=desknets.dateTime.dispDateTime(f.startdate,{type:"list"});c=desknets.tmpl.replaceWordHtml(c,e,h)}else{if(e==="enddate"){h=desknets.dateTime.dispDateTime(f.enddate,{type:"list"});c=desknets.tmpl.replaceWordHtml(c,e,h)}else{if(e==="approvalicon"){if(!f[e]||d.approval=="1"||d.approval=="0"){c=desknets.tmpl.replaceWordHtml(c,e,"")}else{if(f[e]=="1"){c=desknets.tmpl.replaceWordHtml(c,e,'<span title="'+desknets.Resource.info.approvalreq+'" class="info-ictype1-appvalreq">'+desknets.Resource.info.approvalreq+"</span>")}else{if(f[e]=="2"){c=desknets.tmpl.replaceWordHtml(c,e,'<span title="'+desknets.Resource.info.approvalrem+'" class="info-ictype1-appvalng">'+desknets.Resource.info.approvalrem+"</span>")}else{c=desknets.tmpl.replaceWordHtml(c,e,"")}}}}else{return j.callBase("_replaceListLine",c,e,f)}}}}}}}return c},_getAddPageParam:function(){var c=this;var d={};d.fid=c.$mjListPage.find('input[name="fid"]').val();return d},_getDispPageParam:function(){return this._getAddPageParam()},_hashUpdatePageView:function(d){var c=this;if(d==desknets.info.PAGE_INFOSEARCHINDEX){desknets.info.infosearchindex.initPage(desknets.info.PAGE_INFOINDEX,"jco-m-list-container");c.mhashBackErrCmd=c.mhashBackCmd;c.mhashIdErrBack=c.mhashIdBack;c.mhashBackCmd=d;c.mhashIdBack="jco-m-search-container"}},_getSizeHideWidth:function(){return"690"},_getRestModule:function(){return desknets.info.MODULE_API_INFO},_getListCmd:function(){return desknets.info.PAGE_INFOINDEX},_getListExecCmd:function(){var c=desknets.paramanalyzer.getHashParams();if(c.approval=="0"){return desknets.info.CMD_INFOAPPROVALNGINDEX}if(c.approval=="1"){return desknets.info.CMD_INFOAPPROVALREQINDEX}return desknets.info.CMD_INFOINDEX},_getListModCmd:function(){return desknets.info.PAGE_INFOREFER},_getListModClass:function(){return desknets.info.infodisp},_getModPageParam:function(){var c={};c.list="1";return c},_getDelAddPrm:function(){var c=this;var d={};d.fid=c.$mjListPage.find('input[name="fid"]').val();d.range=c.$mjListPage.find('input[name="range"]').val();d.status=c.$mjListPage.find('input[name="status"]').val();return d},_getDelExecCmd:function(){var c=this;if(c._sDelFlg=="1"){return desknets.info.CMD_INFOREAD}else{if(c._sDelFlg=="2"){return desknets.info.CMD_INFOUNREAD}}return""},inputDispPage:function(f){var c=this;var e="";var d={};var g=desknets.paramanalyzer.getHashParams();e=c._getListDispCmd();d=c._getDispPageParam();d.cmd=e;d[c._getIDName()]=f;if(g.approval=="0"||g.approval=="1"){d.approval=g.approval}c._inputPage(d)},inputModPage:function(c){var d=desknets.paramanalyzer.getHashParams();if(!d.cmd||d.cmd==desknets.info.PAGE_INFOINDEX){this.inputDispPage(c)}else{this.callBase("inputModPage",c)}},_getAreaTitle:function(c){var e=this;var d=e._tmplFolderTitle;var g=desknets.paramanalyzer.getHashParams();d=desknets.tmpl.replaceWordChk(d,"foldername",e._selName);if(neo.isSet(e._selName,{blank:false})){d=" > "+d}var f="";if(g.approval=="1"){f=c.find(".jinfo-title-approval-request").val()}else{if(g.approval=="0"){f=c.find(".jinfo-title-approval-denial").val()}else{f=""}}return f+d},_getListDispCmd:function(){return desknets.info.PAGE_INFOREFER},_getDispExecCmd:function(){return desknets.info.CMD_INFOREFER},_getListDispClass:function(){return desknets.info.infodisp},_getSubWinSearchCmd:function(){return desknets.info.PAGE_INFOSEARCHINDEX},_getListAddCmd:function(){return desknets.info.PAGE_INFOENTRY},_getListModCmd:function(){return desknets.info.PAGE_INFOENTRY},_getListEntryClass:function(){return desknets.info.infoentry},_getListModClass:function(){return desknets.info.infoentry},_getSubwinClass:function(){return desknets.info.subwin}})})(jQuery);(function(b){desknets.page(desknets.info,"infoentry",desknets.PagePaneInputBase,{_initGetHtml:function(){var c=this;var d={};desknets.rte.loadRte();d.success=function(g){if(g[0]["status"]!=desknets.RES_STATUS_SUCCESS){var e=desknets.paramanalyzer.getHashParams();if(g[0]["errorno"]==desknets.info.ERRORNO_INFO_NOACCESS&&neo.isSet(e.list)){e.cmd=desknets.info.PAGE_INFOREFER;var f=b(window).data("hashobserver");if(f){f.stopObserveHash();c.resetFuncBeforeHashChange()}history.back();if(f){setTimeout(function(){f.startObserveHash();c._setLocationHash(e)},100)}}else{c.onError(g[0]["errorno"],g[0]["errormessage"])}}else{c._initHtml(g)}};d.complete=function(g,e,f){c.CompleteExec()};c._sendRequestAjax(desknets.ajax.REQTYPE_MULTI,desknets.ajax.RESTYPE_JSON,null,d)},_inputButton:function(){var c=this;c.callBase("_inputButton");c.$mjPage.find(".jinfo-input-preview").click(function(e){var f=c.$mjPage.find("form");desknets.submitform.setDisabled(f);desknets.rte.setEditorSourceOff(f);var d=function(){c._inputPreview();desknets.submitform.clearDisabled(f)};desknets.rte.execFuncEditorSourceEnd(f,d)});c.$mjPage.find(".jinfo-input-entry-page").click(function(d){d.preventDefault();c.dispBackEntryPage()})},dispBackEntryPage:function(){var c=this;c._setTitle(this._getAreaTitle(this.$mjPage));c.$mjPage.find(".info-preview").hide();c.$mjPage.find(".jinfo-entry").show()},_inputPreview:function(){var o=this;var h="";var d="";var k="";var e="";var j=o.$mjPage.find(".jinfo-entry").find(".jco-input-subject").val();j=j.replace(/ +$/g,"");var m=desknets.tmpl.escapeWord(j);var c=o.$mjPage.find(".jinfo-entry").find(".jco-input-makename").val();if(!neo.isSet(c,{blank:false})){c=o.$mjPage.find(".jinfo-entry").find(".co-watermark").text()}c=c.replace(/ +$/g,"");var p=desknets.tmpl.escapeWord(c);d=o.$mjPage.find(".jinfo-cretime").find(".jco-input-chgdate").data("cretime");if(neo.isSet(d,{blank:false})){d=String(d);d=d.substring(0,8)}else{d=b("#jco-servertime").val();if(neo.isSet(d,{blank:false})){d=d.substr(0,"8")}}if(neo.isSet(d,{blank:false})){h=desknets.dateTime.dispDateTime(d)}var g=o.$mjPage.find(".jinfo-entry").find('select[name="important"]').val();if(g!="3"){var i=o.$mjPage.find(".info-preview").find(".jinfo-preview-importance");i.addClass("info-importance");i.removeClass("haste high low");if(g=="1"){i.addClass("haste");e=o.$mjPage.find(".jinfo-entry").find('select[name="important"]').find("option:selected").text()}else{if(g=="2"){i.addClass("high");e=desknets.Resource.importance_high}else{if(g=="4"){i.addClass("low");e=desknets.Resource.importance_low}}}k="[ "+e+" ]"}var n=CKEDITOR.instances.ckeditor.getData();n=desknets.rte.converAlinkHtml(n);n=desknets.rte.convertForShow(n);var f=desknets.convertToSafeHtml(n);o.$mjPage.find(".info-preview").find(".jinfo-preview-subject").html(m);o.$mjPage.find(".info-preview").find(".jinfo-preview-entrydate").text(h);o.$mjPage.find(".info-preview").find(".jinfo-preview-importance").text(k);o.$mjPage.find(".info-preview").find(".jinfo-preview-makename").html(p);o.$mjPage.find(".info-preview").find(".jinfo-preview-body").html(f);var l=b("#jco-m-sub-title").text()+" > "+desknets.Resource.preview;b("#jco-m-sub-title").text(l);desknets.rte.readyForShow(o.$mjPage.find(".info-preview .jinfo-preview-body"));o.$mjPage.find(".jinfo-entry").hide();o.$mjPage.find(".info-preview").show()},initLeftTree:function(){var c=this;desknets.info.infofolderinput.init(c.$mjPage,c._getOptionLeftTree(),c._optTreeGetCmd())},treeUpdateListWidth:function(){desknets.info.infofolderinput._updateItemsWidth()},_optTreeGetCmd:function(){return desknets.info.getFolderCmd()},_optTreeSelectFunc:function(j){var c=this;var f;var h=false;var g=b(".jinfo-selmulti-categorys").children();var e=g.length;var i=j.attr(c._optTreeId);for(f=0;f<e;f++){if(g[f]!="undefined"&&b(g[f]).find('input[name="fid"]').val()==i){h=true;break}}if(!h){var d={cmd:c._getCategoryAccsCmd(),id:i};desknets.ajax.rest({url:desknets.getUrl(c._getRestModule()),data:d,success:function(l,k,m){c._optTreeSelectFuncAjax(j,l)}})}else{c._selectInputTree()}},_optTreeSelectFuncAjax:function(k,e){var n=this;n.callBase("_optTreeSelectFunc",k);var f=desknets.ajax.getJsonItems(e);var g=[];var d=f.length;for(var l=0;l<d;l++){var m=f[l];var c=m.id.substring(1);var j=m.condition;var i="";var h="";if(m.id.substring(0,1)=="r"){i="role";h=desknets.tmpl.escapeWord(m.description)}else{if(m.id.substring(0,1)=="g"){i="group";h=desknets.tmpl.escapeWord(m.description)}else{i="user";h=m.description}}if(j.substring(j.indexOf("_")+1)=="2"){j="all"}else{j=""}g.push({id:c,type:i,name:m.Name,descendant:j,description:h})}n._onSetSelect(g,false)},_isAccessCtrl:function(){return true},getInputFieldName:function(){return"fid"},_isMultiSelect:function(){return true},getMultiRequest:function(){var c=this.callBase("getMultiRequest");var d=desknets.attach.ext.getListParam();if(!!d){d.cmd="info"+d.cmd;c["1"]=d}return c},_initSet:function(i){var d=this;if(!!i["1"]){desknets.attach.ext.saveList(i["1"])}desknets.timePicker.create(d.$mjPage.find('input[name="starttime"]'));desknets.timePicker.create(d.$mjPage.find('input[name="endtime"]'));d.callBase("_initSet");desknets.htmlparts.setUpForm(b(d._mIdPageForm));var f=function(){desknets.autosave.attachrtesave()};var g={pagurl:desknets.info.MODULE_INFO,resturl:desknets.info.MODULE_API_INFO,dl:desknets.info.CMD_INFORTEDISPATTACH,add:"infocmdaddrteattach",mod:"infocmdmodrteattach",del:"infocmddelrteattach"};if(d.boautosave){g.attachsave=f}d._mautosavestartok=false;d.borte=true;desknets.rte.init(d.$mjPage.find(".info-textarea"),{imgeditor:true,initFunc:function(){setTimeout(function(){if(typeof CKEDITOR=="object"&&!!CKEDITOR.instances.ckeditor){d.$mjPage.find("#ckeditor").val(CKEDITOR.instances.ckeditor.getData());d._inputFormSaveToObserver()}d._mautosavestartok=true},2500)},convertToLoad:function(k){return desknets.tmpl.replaceWordHtml(k,"cmd",d._getImageCmd())},convertToSave:function(k){var l=new RegExp("cmd="+d._getImageCmd(),"i");return k.replace(l,"cmd={{cmd}}")},rtfileopt:g,});d._setUpDialog();b(".jinfo-user-button").click(function(k){k.preventDefault();d._initViewSelectDialog()});var h=d.$mjPage.find(".jinfo-selmulti-items");var j=h.find(".co-selitem");if(j.length>0){var e=b.extend({},j);h.empty();h.append(e)}desknets.chooser.setUpEntry(b("#jinfo-entry-approval"),[],{dialogID:"jinfo-entry-approval-dialog",dialogOptions:{mode:"single",choosePrivateGroup:"readonly",unassignGroup:"readonly",},extraVars:{user:{keyName:"sid_approvalusr"},},change:function(){d.$mjPage.find("#jinfo-entry-approval-area").show();d._setListviewHeight(d.$mjPage)},});b("#jinfo-entry-approval").on("click",".co-btn-close",function(k){d.$mjPage.find("#jinfo-entry-approval-area").hide();d._setListviewHeight(d.$mjPage)});if(d.$mjPage.find('input[name="sid_approvalusr"]').length>0){d.$mjPage.find("#jinfo-entry-approval-area").show()}else{d.$mjPage.find("#jinfo-entry-approval-area").hide()}d._setListviewHeight(d.$mjPage);var c=false;if(desknets.pageframe.getMailUse()!="1"){c=true;d.$mjPage.find(".jco-notice-mail").remove()}if(!desknets.pageframe.isShownMenu("memo")){d.$mjPage.find(".jco-notice-memo").remove();if(c){d.$mjPage.find(".info-notice-msg").remove()}}d.$mjPage.find(".jinfo-approval-button").click(function(k){k.preventDefault();d.$mjPage.find("#jinfo-entry-approval").find(".jco-sel-btn").click()})},_createEventInputPane:function(d){var c=this;c.callBase("_createEventInputPane",d);d.find(".co-listview").delegate(".co-selitem-close","click",function(e){c._setListviewHeight(c.$mjPage)})},_initViewSelectDialog:function(){var c=this;desknets.chooser.open("jinfo-view-sel-dialog",c._getSelDialogOptions())},_getSelDialogOptions:function(){var d=this;var e={};var c=[];var f=desknets.chooser.getItemsFromElement(d.$mjPage.find(".jinfo-selmulti-items"),{itemFilter:function(i,g){var h=g.closest(".co-selitem").find('input[name="condition"]').val();if(h.substring(h.indexOf("_")+1)=="2"){h="all"}else{h=""}i.descendant=h;return i}});e={allGroup:"readonly",chooseTarget:["user","group","role"],editDescendant:true,unassignGroup:"readonly",choose:function(g){d._onSetSelect(g,true)},items:f};if(d._isMSetCmd()){e.cmdusers=desknets.CMD_CHOOSERMSETUSERSEL}else{e.choosePrivateGroup="readonly"}return e},_onSetSelect:function(i,l){var o,h;var q=this;var g=b(".jinfo-selmulti-items").children();var d="";var f="";var m;var k=null;var e=i.length;var p=g.length;for(o=0;o<e;o++){m=false;f=i[o].id;d=i[o].type.substring(0,1);for(h=0;h<p;h++){if(g[h]!="undefined"&&b(g[h]).find('input[name="id"]').val()==d+f){m=true;break}}if(!m){var j=q._createRow(i[o],l)}else{var n=null;var c="";if(d=="g"){if(i[o].descendant=="all"){n=b(g[h]);c=d+f+"_2";n.find('input[name="condition"]').val(c)}else{n=b(g[h]);c=d+f+"_1";n.find('input[name="condition"]').val(c)}}delete g[h]}}if(l){for(h=0;h<p;h++){if(g[h]!="undefined"){b(g[h]).remove()}}}q._setListviewHeight(q.$mjPage)},_getAreaTitle:function(c){var d=this;var e=desknets.paramanalyzer.getHashParams();if(e.approval=="0"){return c.find(".jinfo-title-approval-denial").val()}return c.find(".jinfo-title-edit").val()},_createRow:function(l,k){var g="";var d="";var e="";var j="";var h=b(".jinfo-selmulti-items");d=l.type.substring(0,1);g=l.id;if(d=="g"&&l.descendant=="all"){e=d+g+"_2"}else{e=d+g+"_1"}var i='<span class="co-selitem"><span title="{{titlename}}">{{Name}}</span><input type="hidden" value="{{id}}" name="id"><input type="hidden" value="{{id}}_1" name="accesskind"><input type="hidden" value="{{condition}}" name="condition">';if(!k&&d=="u"){i+='<input type="hidden" class="jco-sel-item" data-id="{{id}}" data-name="{{Name}}" {{description}} /></span>';j=l.description}else{i+='<input type="hidden" class="jco-sel-item" data-id="{{id}}" data-name="{{Name}}" data-description="{{description}}" /></span>';if(d=="u"){j=desknets.escapeValue(desknets.escape(l.description))}else{j=l.description}}var f=desknets.escapeValue(desknets.escape(l.name));var c="";if(d=="r"||d=="u"){c=f}else{if(neo.isSet(l.description,{blank:false})){c=l.description+"-"}c=c+f}i=desknets.tmpl.replaceWordHtml(i,"Name",f);i=desknets.tmpl.replaceWordHtml(i,"titlename",c);i=desknets.tmpl.replaceWordHtml(i,"id",d+g);i=desknets.tmpl.replaceWordHtml(i,"condition",e);i=desknets.tmpl.replaceWordHtml(i,"description",j);h.append(i)},_setUpDialog:function(){var c=this;desknets.info.attach.funcToggleTarget=function(){c._setListviewHeight(c.$mjPage);if(c.boautosave){desknets.autosave.attachsave()}};desknets.info.attach.init(c.$mjPage,true);c.$mjPage.find(".co-ebtnarea").delegate(".jinfo-attach-button","click",function(d){d.preventDefault();desknets.info.attach.open();if(c.boautosave){desknets.autosave.save();desknets.autosave.restart()}});if(c.boautosave){c.$mjPage.find(".jco-setup-attach-list").on("click",".jco-selfile-button",function(d){desknets.autosave.save();desknets.autosave.restart()})}c.grpselset()},_updatePageListId:function(e){var c=this;var g=b("#jco-m-list-container").find(".jco-back-page-data");var d=c.getInputFieldName();var f=g.find('input[name="range"]');if(f.val()!="4"){f.val(e.range)}g.find('input[name="status"]').val("3");if(g.find('input[name="'+d+'"]').val()=="0"){return}else{c.callBase("_updatePageListId")}},_getErrorPlace:function(c){var e=this;if(c=="edithtml"){var d=desknets.Resource.info.edithtml+desknets.merrMsgConnect;return d}else{return e.callBase("_getErrorPlace",c)}},grpselset:function(){var c=this;var d=0;var e={mode:"single",selectable:false,chooseTarget:["group"]};desknets.chooser.setUpEntry(b("#jinfo-selgrp-area"),[],{dialogID:"jinfo-group-sel",initCreate:true,template:"<span>{{Name}}</span>",dialogOptions:e,change:function(){c.$mjPage.find('input[name="makename"]').val(c.$mjPage.find(".info-entry-makename").text()).blur()},filter:function(f){if(d===f[0]["id"]){delete f[0]["id"]}d=f[0]["id"]}})},changPage:function(){var c=this;c.callBase("changPage");var d=c.$mjPage.find(".jco-input-makename");desknets.watermark.set(d);d.attr("title","")},_inputAjaxFormOption:function(){var c=this;var d=c.callBase("_inputAjaxFormOption");d.success=function(g,e,h){c._updatePageListId(g);if(!!g.noticeerror){var f=desknets.dialog.alert(g.noticeerror,{extraMessage:g.msgadd,extraClass:"co-msg-r",type:"warn"});f.bind("dialogclose",function(i){desknets.dialog.deleteById("warn");c._setLocationHashForm()});return}c._setLocationHashForm()};d.beforeSerialize=function(f,g){var h={};if(c.$mjPage.find("[name=makename]").val()==""){c.$mjPage.find("[name=makename]").attr("disabled","disabled");h.makename=c.$mjPage.find(".co-watermark").text()}if(c.$mjPage.find("#jinfo-entry-approval-area").css("display")=="table-row"){var e=0;c.$mjPage.find(".info-notice-msg").find("input[type=checkbox]:checked").each(function(){e+=Number(b(this).val())});if(e===0){h.sendhowto=""}else{h.sendhowto=e.toString()}}g.data=b.extend(h,g.data)};return d},_onCompleteForm:function(){var c=this;c.$mjPage.find("[name=makename]").removeAttr("disabled");c.callBase("_onCompleteForm")},_getRestModule:function(){return desknets.info.MODULE_API_INFO},_getAddExecCmd:function(){return desknets.info.CMD_INFOENTRY},_getModExecCmd:function(){var c=this;return c._getAddExecCmd()},_getDelExecCmd:function(){return desknets.info.CMD_INFOENTRYDEL},_getCategoryAccsCmd:function(){return desknets.info.CMD_INFOCATEACCSLIST},_isMSetCmd:function(){return false},_getImageCmd:function(){return desknets.info.CMD_INFOIMAGE},AutoSaveOpt:function(d){var c=this;var e=c.callBase("AutoSaveOpt",d);e.fieldid="infoid";e.module="info";e.attachname="infoatt";e.rtename="inforteatt";return e},AutoSaveChkConfirm:function(g,d){var c=this;var f=desknets.paramanalyzer.getHashParams();if(!!f.copyid||!!f.link){desknets.autosave.del();desknets.autosave.start()}else{var e=c.callBase("AutoSaveChkConfirm",g,d);c.AutoSaveDialogLock(e)}},AutoSaveEntry:function(g){var f=this;g=f.callBase("AutoSaveEntry",g);var d=[];f.$mjPage.find(".jinfo-selmulti-categorys .co-selitem").each(function(){d[d.length]=b(this).find("span").attr("title")});g.categoryname=d;var c=[];var h=[];f.$mjPage.find(".jinfo-selmulti-items .co-selitem").each(function(){var i=b("<div>"+b(this).html()+"</div>");i.children().not(".jco-sel-item").remove();c[c.length]=b(this).find("span").attr("title");h[h.length]=jQuery.trim(i.html())});g.idname=c;g.iddes=h;g.sid_approvalusrname=f.$mjPage.find("#jinfo-entry-approval .co-selitem-text").attr("title");if(f.$mjPage.find("#jinfo-entry-approval-area").css("display")=="table-row"){var e=0;f.$mjPage.find(".info-notice-msg").find("input[type=checkbox]:checked").each(function(){e+=Number(b(this).val())});if(e===0){g.sendhowto=""}else{g.sendhowto=e.toString()}}if(typeof CKEDITOR=="object"&&!!CKEDITOR.instances.ckeditor){g.edithtml=CKEDITOR.instances.ckeditor.getData()}return g},AutoSaveGetData:function(g){var c=this;var f="";c.$mjPage.find('input[name="subject"]').val(g.subject);g.fid=c.arrayToData(g.fid);g.categoryname=c.arrayToData(g.categoryname);f="";b.each(g.fid,function(h,i){f=f+c.getSelTmplData("fid",i,g.categoryname[h])});c.$mjPage.find(".jinfo-selmulti-categorys>.co-selitem").remove();c.$mjPage.find(".jinfo-selmulti-categorys .co-selitem-msg").before(f);c._selectInputTree();g.id=c.arrayToData(g.id);g.condition=c.arrayToData(g.condition);g.idname=c.arrayToData(g.idname);g.iddes=c.arrayToData(g.iddes);f="";b.each(g.id,function(i,j){var h='<span class="co-selitem"><span title="{{titlename}}">{{Name}}</span><input type="hidden" value="{{id}}" name="id"><input type="hidden" value="{{id}}_1" name="accesskind"><input type="hidden" value="{{condition}}" name="condition">{{description}}</span>';h=desknets.tmpl.replaceWordHtml(h,"id",j);h=desknets.tmpl.replaceWordHtml(h,"Name",desknets.tmpl.dispStr(g.idname[i]));h=desknets.tmpl.replaceWordHtml(h,"titlename",desknets.escapeValue(g.idname[i]));h=desknets.tmpl.replaceWordHtml(h,"condition",desknets.escapeValue(g.condition[i]));h=desknets.tmpl.replaceWordHtml(h,"description",g.iddes[i]);f=f+h});c.$mjPage.find(".jinfo-selmulti-items").html(f);c.$mjPage.find('input[name="makename"]').val(g.makename).blur();c.$mjPage.find(".jco-input-sdate").datepicker("setDate",neo.dateTime.parse(g.sdate.replace(/\u002D/g,"")));c.$mjPage.find('input[name="starttime"]').val(g.starttime);desknets.timePicker._setFromInput(c.$mjPage.find('input[name="starttime"]').closest(".co-timepicker"));c.$mjPage.find(".jco-input-edate").datepicker("setDate",neo.dateTime.parse(g.edate.replace(/\u002D/g,"")));c.$mjPage.find('input[name="endtime"]').val(g.endtime);desknets.timePicker._setFromInput(c.$mjPage.find('input[name="endtime"]').closest(".co-timepicker"));c.$mjPage.find('select[name="important"]').val(g.important);if(!!g.sid_approvalusr&&!!g.sid_approvalusrname){f="";var d='<span class="co-selitem"><span title="{{nametitle}}" class="co-selitem-text">{{name}}</span><a class="co-btn co-btn-close co-selitem-close" href="#" title="'+desknets.Resource.deselectLabel+'">x</a><input type="hidden" name="sid_approvalusr" value="{{id}}"></span>';d=desknets.tmpl.replaceWordHtml(d,"name",desknets.tmpl.dispStr(g.sid_approvalusrname));d=desknets.tmpl.replaceWordHtml(d,"nametitle",desknets.escapeValue(g.sid_approvalusrname));d=desknets.tmpl.replaceWordHtml(d,"id",g.sid_approvalusr);f=f+d;c.$mjPage.find("#jinfo-entry-approval .jco-sel-items").html(f);c.$mjPage.find("#jinfo-entry-approval-area").show()}else{c.$mjPage.find("#jinfo-entry-approval-area").hide()}if(!!g.sendhowto){if(g.sendhowto=="1"||g.sendhowto=="3"){c.$mjPage.find("#co-notice-mail").attr("checked","checked")}else{c.$mjPage.find("#co-notice-mail").attr("checked",false)}if(g.sendhowto=="2"||g.sendhowto=="3"){c.$mjPage.find("#co-notice-memo").attr("checked","checked")}else{c.$mjPage.find("#co-notice-memo").attr("checked",false)}}var e=setInterval(function(){if(b(".cke_button.cke_button__table.cke_button_disabled").length==0){desknets.rte.setEditorData(CKEDITOR.instances.ckeditor,g.edithtml);clearInterval(e);c._setListviewHeight(c.$mjPage)}},200)},AutoSaveGetAttData:function(d){var c=this;desknets.info.attach.update(d)},_getConnectToModuleName:function(){return"info"},_setConnectData:function(c){var f=this;var d=[];var h={};var e={};f.$mjPage.find('input[name="subject"]').val(c.title);var g=c.content||"";if(!!c.rteatt&&!!c.rteatt.attach&&!!c.rteatt.attach.item){d=c.rteatt.attach.item;if(!b.isArray(d)){d=[d]}e.content=g;e.module=desknets.info.MODULE_INFO;e.cmd=desknets.info.CMD_INFORTEDISPATTACH;e.arAttach=c.rteatt.attach.item;g=desknets.rtfile.replaceDownloadUrlforConnectApp(e)}h.content=g;var i=function(){f.AutoSaveGetRteData(d)};h.funcSetAtt=i;desknets.rte.setDataForConnectApp(h)},_inputAddSubmit:function(d){var c=this;c.callBase("_inputAddSubmit",d);desknets.rte.inputSubmitRte(d,c.$mjPage.find("form"))},_inputModSubmit:function(d){var c=this;c.callBase("_inputModSubmit",d);desknets.rte.inputSubmitRte(d,c.$mjPage.find("form"))},})})(jQuery);(function(b){desknets.page(desknets.info,"infodisp",desknets.PagePaneDispBase,{marUser:"",msapprovaltype:"",$mdenialdialog:null,initLeftTree:function(){var c=this;desknets.info.infofolderdisp.init(c.$mjPage,c._getOptionLeftTree(),c._optTreeGetCmd());c._treeClass=desknets.info.infofolderdisp},treeUpdateListWidth:function(){desknets.info.infofolderdisp._updateItemsWidth()},_optTreeGetCmd:function(){return desknets.info.getFolderCmd()},_optTreeSelItemParams:function(){var c=this;if(c.mIdBack=="jco-m-list-container"){return c.callBase("_optTreeSelItemParams")}return{}},_isAccessCtrl:function(){return true},getInputFieldName:function(){return"fid"},_initHtmlTmplSet:function(d){var c=this;var f;var e=desknets.paramanalyzer.getHashParams();if(neo.isSet(d[0])&&neo.isSet(d[0]["cretime"])){d[0]["registdate"]=d[0]["cretime"].substr(0,"8")}if(neo.isSet(d[0],{blank:false})&&neo.isSet(d[0]["edithtml"])){f=desknets.tmpl.replaceWordHtml(d[0]["edithtml"],"cmd",c._getImageCmd());d[0]["edithtml"]=desknets.rte.convertForShow(f)}if(e.approval=="0"){d[0]["approval"]="0"}else{d[0]["approval"]=""}c.callBase("_initHtmlTmplSet",d)},_initSet:function(h){var k=this;desknets.tagDisp.initTagEvent(desknets.info.MODULE_API_INFO,this._getInfoRefTagParam());desknets.rte.readyForShow(b("#info-detail-body"));this.callBase("_initSet",h);desknets.cabinetregist.geTemplate(e,"info.html");var d=function(o,n){var p=k.$mjPage.find(".jco-cab-template").html();var m=b("<div>"+p+"</div>");var l=m.find(".jinfo-viewer");desknets.attachDisp.removeAttachAlink(m);if(l.length>0){l.text(k.marUser.join(","))}m.find(".info-view-route-wrap").css({"margin-top":"-1px",padding:"10px"});m.find(".info-width-approval").css({"padding-right":"0","padding-left":"0",width:"4em","text-indent":"5px"});m.find(".info-width-approver-name").css({"padding-right":"0","padding-left":"0",width:"207px","text-indent":"5px"});m.find(".info-notice-comment>pre").css({"white-space":"pre-wrap","word-wrap":"break-word"});m.find("#info-detail-wrap").css({"margin-top":"-1px",padding:"10px"});m.find("#info-detail").css({border:"1px solid #B9B9B9","line-height":"1.8",padding:"10px 30px 20px"});m.find("#info-detail-meta").css({margin:"0 0 1em","text-align":"right"});m.find("#info-detail-title").css({"font-size":"16px","font-weight":"bold",margin:"0 0 1.5em","text-align":"center"});m.find(".info-importance.haste").css({color:"#CC3333"});m.find(".info-importance.high").css({color:"#CC3333"});m.find(".info-importance.low").css({color:"#333333"});m.find(".co-mceview").css({"line-height":"1.5","overflow-x":"auto","overflow-y":"hidden","word-break":"normal","word-wrap":"normal"});return desknets.tmpl.replaceWordHtml(n,"body",m.html())};var e=function(m,l){return""};var j=function(){var l={};l=desknets.paramanalyzer.getHashParams();l.cmd=desknets.info.CMD_INFOCOPYATTACH;l.viewdata=d({},desknets.cabinetregist.loadFiles["info.html"]);return l};var f={copymodule:desknets.info.MODULE_API_INFO,copycmd:desknets.info.CMD_INFOCOPYATTACH,cabmaketemplate:e,copyprm:j};desknets.cabinetregist.init(this.$mjPage,f,false);var i=function(l,n){var m=desknets.print.setPrintHtmlFuncDef(l,n);if(!m){return false}n.$(".jinfo-viewer").text(k.marUser.join(","));return true};desknets.print.init(this.$mjPage,i);if(k.$mdenialdialog!=null){k.$mdenialdialog.dialog("destroy").remove()}k.$mdenialdialog=b("#jinfo-approval-denial-dialog");var c=false;if(desknets.pageframe.getMailUse()!="1"){c=true;k.$mdenialdialog.find(".jinfo-edit-approval-notice-mail").hide()}else{c=false;k.$mdenialdialog.find(".jinfo-edit-approval-notice-mail").show()}if(!desknets.pageframe.isShownMenu("memo")){k.$mdenialdialog.find(".jinfo-edit-approval-notice-memo").hide();if(c){k.$mdenialdialog.find(".info-edit-approval-notice").hide()}}else{k.$mdenialdialog.find(".jinfo-edit-approval-notice-memo").show()}k.$mdenialdialog;var g=desknets.dialog.getDialogOption();g.width=700;g.autoOpen=false;g.title=desknets.Resource.info.approvalng;g.buttons={};g.buttons[desknets.Resource.OKButtonLabel]=function(){k.msapprovaltype="0";k._inputDelSubmit(null)};g.buttons[desknets.Resource.CancelButtonLabel]=function(){b(this).dialog("close")};k.$mdenialdialog=desknets.dialog.setUp(k.$mdenialdialog,g);desknets.rtfile.onHeightSizeChk(k.$mjPage.find("#info-detail-body"),function(){k._setListviewHeight(k.$mjPage)});this._initSetMail()},_getInfoRefTagParam:function(){var c=desknets.paramanalyzer.getHashParams();c.cmd=desknets.info.CMD_INFOREFSETTAG;return c},_initSetMail:function(){var d=this;var e={};var c=desknets.paramanalyzer.getHashParams();e.connectid=c.id;e.restmodule=d._getRestModule();e.restcmd=d._getConnectAppCmd();d.$mjPage.find(".jco-connectmail").click(function(f){f.preventDefault();desknets.connectapp.connectMail(e)})},getAttachDownloadParams:function(){var c={};var d=desknets.paramanalyzer.getHashParams();c={cmd:desknets.info.CMD_INFOREFATTACH,id:d.id};return c},changPage:function(){var k=this;var l=b(".jinfo-viewer");k.marUser=l.text().split(",");var e=desknets.paramanalyzer.getHashParams();if(e.approval!="0"&&e.approval!="1"){var h=10;var g=k.marUser;var j=0;var m="";var d=false;var c='<br /><a href="#">'+desknets.Resource.showLabel+"</a>";var i='<br /><a href="#">'+desknets.Resource.hideLabel+"</a>";var f=function(){if(d){l.empty();l.text(g.join(","));l.append(i);d=false}else{l.empty();m="";for(j=0;j<h;j++){if(j==0){m=g[j]}else{m=m+","+g[j]}}m=m+" ...";l.text(m);l.append(c);d=true}k._setListviewHeight(k.$mjPage)};if(g.length<=h){l.empty().text(g.join(","))}else{l.delegate("a","click",function(n){n.preventDefault();f()});f()}}k.callBase("changPage")},_getRestModule:function(){return desknets.info.MODULE_API_INFO},_getDispExecCmd:function(){var c=desknets.paramanalyzer.getHashParams();if(c.approval=="0"){return desknets.info.CMD_INFOEDITREFER}if(c.approval=="1"){return desknets.info.CMD_INFOAPPROVALREFER}return desknets.info.CMD_INFOREFER},_inputButton:function(){var c=this;var d=true;c.callBase("_inputButton");c.$mjPage.find(".jinfo-input-add-page").click(function(f){f.preventDefault();var e=desknets.paramanalyzer.getHashParams();e.copyid=e.id;delete e.id;e.cmd=c._getDispCopyCmd();c._setLocationHash(e)});c.$mjPage.find(".jinfo-input-appok-submit").click(function(e){c.msapprovaltype="1";$dialog=desknets.dialog.confirm(desknets.Resource.Message.info_approve_confirmok,function(){c._inputDelSubmit($dialog);return false})});c.$mjPage.find(".jinfo-input-appng-submit-conf").click(function(e){e.preventDefault();c.$mdenialdialog.dialog("open");if(d){desknets.dialog.setFirstDialogOpen(c.$mdenialdialog);d=false}})},_getDispModCmd:function(){return desknets.info.PAGE_INFOENTRY},_getAreaTitle:function(c){var d=this;var e=desknets.paramanalyzer.getHashParams();if(e.approval=="1"||e.approval=="0"){if(e.approval=="1"){return c.find(".jinfo-title-approval-request").val()}else{if(e.approval=="0"){return c.find(".jinfo-title-approval-denial").val()}}}return c.find(".jco-title").val()},_getDelPrm:function(){var d=this;var f=desknets.paramanalyzer.getHashParams();var e={};if(f.approval=="1"||f.approval=="0"){if(d.msapprovaltype=="0"){var c=0;d.$mdenialdialog.find(".info-edit-approval-notice").find("input[type=checkbox]:checked").each(function(){c+=Number(b(this).val())});if(c===0){e.sendhowto=""}else{e.sendhowto=c.toString()}e.approvaltext=d.$mdenialdialog.find("textarea").val()}}return e},_getDelExecCmd:function(){var c=this;var e=desknets.paramanalyzer.getHashParams();var d=desknets.info.CMD_INFOENTRYDEL;if(e.approval=="1"||e.approval=="0"){if(c.msapprovaltype=="1"){d=desknets.info.CMD_INFOAPPROVALOK}else{if(c.msapprovaltype=="0"){d=desknets.info.CMD_INFOAPPROVALNG}}}c.msapprovaltype="";return d},_inputDelSubmit:function(e){var c=this;var d={};var f=desknets.paramanalyzer.getHashParams();if(e!=null){desknets.submitform.setDialogDisabled(e)}d=c._getDelPrm();d.cmd=c._getDelExecCmd();d[c._getIDName()]=f[c._getIDName()];desknets.ajax.rest({url:desknets.getUrl(c._getRestModule()),data:d,success:function(i,g,j){b(window).off("beforeunload.pageBase");c.resetFuncBeforeHashChange();if(!!i.noticeerror){var h=desknets.dialog.alert(i.noticeerror,{extraMessage:i.msgadd,extraClass:"co-msg-r",type:"warn"});h.bind("dialogclose",function(k){desknets.dialog.deleteById("warn");c.dispBackListPage()});return}else{c.dispBackListPage()}},complete:function(i,g,h){if(e!=null){desknets.submitform.clearDialogDisabled(e);e.dialog("close")}}})},_getDispCopyCmd:function(){return desknets.info.PAGE_INFOENTRY},_getImageCmd:function(){return desknets.info.CMD_INFOIMAGE},_getConnectAppCmd:function(){return desknets.info.CMD_INFOCONNECTAPP},})})(jQuery);desknets.page(desknets.info,"infosearchindex",desknets.PageListBatSearchBase,{_sDelFlg:"0",_mboSearchInit:true,_getListAjaxSuccessEnd:function(){var c=this;c.callBase("_getListAjaxSuccessEnd");var b=a("#jco-m-list-container").find(".jco-back-page-data").find('input[name="approval"]').val();if(!!b&&(b=="0"||b=="1")){var d=a("#jco-m-list-container").find(".jco-back-page-data");d.find('input[name="approval"]').val("");d.find('input[name="range"]').val("2");d.find('input[name="fldsort"]').val("sdate");d.find('input[name="order"]').val("-1")}},_listLine:function(c,d){var b=this;var e=b._listLineCmd(c);return desknets.info.infoindex._listLine(e,d)},_replaceListLine:function(b,d,c){return desknets.info.infoindex._replaceListLine(b,d,c)},_initListEndButton:function(){var b=this;b.$mjListPage.find(".co-pageback").click(function(c){c.preventDefault();b.dispBackListPage()});b.$mjListPage.find(".co-btn-update").click(function(c){c.preventDefault();a(this).addClass("on");b.updateSearchList()});b.$mjListPage.find(".jinfo-list-read-submit").click(function(d){var c=0;b.$mjTableList.find("input[type=checkbox]").each(function(){if(a(this).attr("checked")){c++;return false}});if(c>0){b._sDelFlg="1";b._listDel(true,null)}});b.$mjListPage.find(".jinfo-list-unread-submit").click(function(d){var c=0;b.$mjTableList.find("input[type=checkbox]").each(function(){if(a(this).attr("checked")){c++;return false}});if(c>0){b._sDelFlg="2";b._listDel(true,null)}})},_listDelSrchFlgSet:function(c){var b=this;if(c&&b._sDelFlg=="0"){b._onSrchExec=true}},_openSearchMessageDialog:function(){if(!neo.isSet(this.$dialogexec)){this._mboSearchInit=true}this.callBase("_openSearchMessageDialog")},_getListAjaxSuccessOtherSet:function(c){var b=this;b.callBase("_getListAjaxSuccessOtherSet",c);if(this._mboSearchInit&&neo.isSet(c[desknets.RES_TAG_MSGGETLIMIT])){this._mboSearchInit=false;desknets.pageframe.viewTopMsg(c[desknets.RES_TAG_MSGGETLIMIT],"info")}},_getAddPageParam:function(){var c=desknets.paramanalyzer.getHashParams();var b="0";if(neo.isSet(c.fid,{blank:false})){b=c.fid}return{fid:b}},_getModPageParam:function(){var b=this._getAddPageParam();b.list="1";return b},_getDispPageParam:function(){return this._getAddPageParam()},_getRestModule:function(){return desknets.info.MODULE_API_INFO},_getListCmd:function(){return desknets.info.PAGE_INFOSEARCHINDEX},_getListExecCmd:function(){return desknets.info.CMD_INFOSEARCHINDEX},_getStopBatSearchCmd:function(){return desknets.info.CMD_INFOSEARCHSTOP},_getListDispCmd:function(){return desknets.info.PAGE_INFOREFER},_getListModCmd:function(){return desknets.info.PAGE_INFOREFER},_getDelExecCmd:function(){var b=this;if(b._sDelFlg=="1"){return desknets.info.CMD_INFOSEARCHREAD}else{if(b._sDelFlg=="2"){return desknets.info.CMD_INFOSEARCHUNREAD}}return""},_getListModClass:function(){return desknets.info.infodisp},_getListDispClass:function(){return desknets.info.infodisp},_getSearchConditionParams:function(){var b=[];b.push("srch_key");b.push("sdate");b.push("edate");b.push("srch_catekind");b.push("srch_attach");b.push("srch_important");b.push("srch_filecontents");return b}});desknets.page(desknets.info,"infoeditindex",desknets.info.infoindex,{initLeftTree:function(){var b=this;desknets.info.infoeditfolderlist.init(b.$mjListPage,b._getOptionLeftTree(),b._optTreeGetCmd())},treeUpdateListWidth:function(){desknets.info.infoeditfolderlist._updateItemsWidth()},treeUpdateList:function(){desknets.info.infoeditfolderlist.updateTreeList()},_isAccessCtrl:function(){return true},_setInfoEntryBtn:function(f){var c=this;var e=false;var d=2;if(!f||f.length==0){e=true}else{var b=f.children("a:first").data("access");if(neo.isSet(b)&&(Number(b)&d)!=d){e=true}}c.$mjListPage.find(".jco-list-add-page").attr("disabled",e)},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".jinfo-list-del-submit").click(function(c){b._sDelFlg="0";b._listDelSubmit(c)})},_hashUpdatePageView:function(c){var b=this;if(c==desknets.info.PAGE_INFOEDITSEARCHINDEX){desknets.info.infoeditsearchindex.initPage(desknets.info.PAGE_INFOEDITINDEX,"jco-m-list-container");b.mhashBackErrCmd=b.mhashBackCmd;b.mhashIdErrBack=b.mhashIdBack;b.mhashBackCmd=c;b.mhashIdBack="jco-m-search-container"}},_getDelCmd:function(){var b=this;if(b._sDelFlg=="0"){return desknets.info.CMD_INFODELCONF}return""},_getAreaTitle:function(b){var d=this;var c=d._tmplFolderTitle;c=desknets.tmpl.replaceWordChk(c,"foldername",d._selName);if(neo.isSet(d._selName,{blank:false})){c=" > "+c}return b.find(".jinfo-title-edit").val()+c},_getSizeHideWidth:function(){return"350"},_getDelExecCmd:function(){var b=this;return desknets.info.CMD_INFODEL},_getListCmd:function(){return desknets.info.PAGE_INFOEDITINDEX},_getListExecCmd:function(){return desknets.info.CMD_INFOEDITINDEX},_getDispExecCmd:function(){return desknets.info.CMD_INFOEDITREFER},_getListDispClass:function(){return desknets.info.infoeditdisp},_getSubWinSearchCmd:function(){return desknets.info.PAGE_INFOEDITSEARCHINDEX}});desknets.page(desknets.info,"infoeditdisp",desknets.info.infodisp,{initLeftTree:function(){var b=this;desknets.info.infofoldereditdisp.init(b.$mjPage,b._getOptionLeftTree(),b._optTreeGetCmd());b._treeClass=desknets.info.infofoldereditdisp},_initSet:function(c){var b=this;b.callBase("_initSet",c)},_initHtmlTmplSet:function(c){var b=this;c[0]["created"]="1";b.callBase("_initHtmlTmplSet",c)},_getAreaTitle:function(b){return b.find(".jinfo-title-edit").val()},_getDispExecCmd:function(){return desknets.info.CMD_INFOEDITREFER}});desknets.page(desknets.info,"infoeditsearchindex",desknets.info.infosearchindex,{_initListEndButton:function(){var b=this;this.callBase("_initListEndButton");b.$mjListPage.find(".jinfo-list-del-submit").click(function(c){b._sDelFlg="0";b._listDelSubmit(c)})},_getAreaTitle:function(b){return b.find(".jinfo-title-edit").val()},_getListCmd:function(){return desknets.info.PAGE_INFOEDITSEARCHINDEX},_getListAddCmd:function(){return desknets.info.PAGE_INFOENTRY},_getListModCmd:function(){return desknets.info.PAGE_INFOENTRY},_getDelCmd:function(){return desknets.info.CMD_INFOSEARCHDELCONF},_getDelExecCmd:function(){return desknets.info.CMD_INFOSEARCHDEL},_getListModClass:function(){return desknets.info.infoentry}});app.addInitialAction(function(){desknets.info.init()})})(jQuery);