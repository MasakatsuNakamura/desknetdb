/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){(function(b){desknets.mailimapset={MODULE_API_MAILIMAP:"zrmailimap",PAGE_MAILIMAPMSETUSERACCOUNT:"mailimapmsetuseraccount",CMD_MAILIMAPMSETUSERACCOUNT:"mailimapmsetcmduseraccount",PAGE_MAILIMAPMSETACCOUNTENTRY:"mailimapmsetaccountentry",CMD_MAILIMAPMSETACCOUNTENTRY:"mailimapmsetcmdaccountentry",CMD_MAILIMAPMSETACCOUNTDEL:"mailimapmsetcmddelaccount",CMD_MAILIMAPMSETACCOUNTMAILUSE:"mailimapmsetcmdusemail",PAGE_MAILIMAPSETADMIN:"mailimapsetadmin",PAGE_MAILIMAPSETGEN:"mailimapsetgen",CMD_MAILIMAPSETGEN:"mailimapsetcmdgen",PAGE_MAILIMAPSETMANAGER:"mailimapsetmanager",CMD_MAILIMAPSETMANAGER:"mailimapsetcmdmanager",PAGE_MAILIMAPSETSERVER:"mailimapsetserver",CMD_MAILIMAPSETSERVER:"mailimapsetcmdserver",PAGE_MAILIMAPSETEXPORT:"mailimapsetexport",CMD_MAILIMAPSETEXPORT:"mailimapsetcmdexport",PAGE_MAILIMAPSETDIRECTORY:"mailimapsetdirectory",CMD_MAILIMAPSETDIRECTORY:"mailimapsetcmddirectory",PAGE_MAILIMAPSETDIRECTORYENTRY:"mailimapsetdirectoryentry",CMD_MAILIMAPSETDIRECTORYENTRY:"mailimapsetcmddirectoryentry",CMD_MAILIMAPSETDIRECTORYDEL:"mailimapsetcmddeldirectory",PAGE_MAILIMAPSETSENDMISTAKE:"mailimapsetsendmistake",CMD_MAILIMAPSETSENDMISTAKE:"mailimapsetcmdsendmistake",PAGE_MAILIMAPSETWLISTADDR:"mailimapsetwlistaddr",CMD_MAILIMAPSETWLISTADDR:"mailimapsetcmdwlistaddr",PAGE_MAILIMAPSETWLISTADDRENTRY:"mailimapsetwlistaddrentry",CMD_MAILIMAPSETWLISTADDRENTRY:"mailimapsetcmdwlistaddrentry",CMD_MAILIMAPSETWLISTADDRDEL:"mailimapsetcmdwlistaddrdel",CMD_MAILIMAPSETWLISTADDRMV:"mailimapsetcmdwlistaddrmv",FIELD_MAILUSE:"mailuse",FIELD_ACCLIST:"acclist",FIELD_ACCMAIL:"mail",FIELD_USER:"userid",FIELD_SHOW:"show",init:function(){var c=b("#jco-pv-funcid").val();desknets.pageframe.setFuncSel(c);if(c==desknets.mailimapset.PAGE_MAILIMAPMSETUSERACCOUNT){desknets.hashobserver.init(desknets.mailimapset);desknets.mailimapset.mailimapmsetuseraccount.init()}else{if(c==desknets.mailimapset.PAGE_MAILIMAPSETGEN){desknets.mailimapset.mailimapsetgen.init()}else{if(c==desknets.mailimapset.PAGE_MAILIMAPSETMANAGER){desknets.mailimapset.mailimapsetmanager.init()}else{if(c==desknets.mailimapset.PAGE_MAILIMAPSETSERVER){desknets.mailimapset.mailimapsetserver.init()}else{if(c==desknets.mailimapset.PAGE_MAILIMAPSETEXPORT){desknets.mailimapset.mailimapsetexport.init()}else{if(c==desknets.mailimapset.PAGE_MAILIMAPSETDIRECTORY){desknets.hashobserver.init(desknets.mailimapset);desknets.mailimapset.mailimapsetdirectory.init()}else{if(c==desknets.mailimapset.PAGE_MAILIMAPSETSENDMISTAKE){desknets.mailimapset.mailimapsetsendmistake.init()}else{if(c==desknets.mailimapset.PAGE_MAILIMAPSETWLISTADDR){desknets.hashobserver.init(desknets.mailimapset);desknets.mailimapset.mailimapsetwlistaddr.init()}}}}}}}}}}})(jQuery);(function(b){desknets.page(desknets.mailimapset,"mailimapmsetacclistcom",desknets.PageListBase,{inputDispPage:function(d){var c=this;c.inputModPage(d)},_getRestModule:function(){return desknets.mailimapset.MODULE_API_MAILIMAP},_getListModCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPMSETACCOUNTENTRY},})})(jQuery);(function(b){desknets.page(desknets.mailimapset,"mailimapmsetuseraccount",desknets.mailimapset.mailimapmsetacclistcom,{_sDelFlg:"0",_muid:"",_maccid:"",_initListStart:function(){var c=this;c.callBase("_initListStart");var d={allGroup:"choosable",unassignGroup:"choosable"};desknets.page.groupSelect.init({},d)},_getListAjaxSuccess:function(d){var c=this;c.callBase("_getListAjaxSuccess",d);desknets.page.groupSelect.editSelectedGroup(c.$mjListPage.find(".jco-sel-items"),d)},init:function(){var c=this;c.callBase("init");c._initMailSetUserAccountRegistryEvent()},_initMailSetUserAccountRegistryEvent:function(){var d=this;var c=d.$mjListPage.find(d._mIdPageForm);d.$mjListPage.find(".jmail-list-enable-submit").click(function(e){d._sDelFlg="1";d._listDelSubmit(e)});d.$mjListPage.find(".jmail-list-disables-submit").click(function(e){d._sDelFlg="0";d._listDelSubmit(e)})},_delNoChkMessage:function(){var c=this;if(c._sDelFlg=="0"){return desknets.Resource.Message.mail_accuse_off_nochecked}else{return desknets.Resource.Message.mail_accuse_on_nochecked}},_delConfMessage:function(){var d=this;var c="";if(d._sDelFlg=="0"){if(d.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message.mail_accuse_off_allconf}else{if(d.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){c=desknets.Resource.Message.mail_accuse_off_someconf}else{c=desknets.Resource.Message.mail_accuse_off_listconf}}return desknets.tmpl.replaceWordHtml(c,"count",d._getListCheckCount())}else{if(d.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message.mail_accuse_on_allconf}else{if(d.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){c=desknets.Resource.Message.mail_accuse_on_someconf}else{c=desknets.Resource.Message.mail_accuse_on_listconf}}return desknets.tmpl.replaceWordHtml(c,"count",d._getListCheckCount())}},_getDelAddPrm:function(){var c=this;var d={};if(c._sDelFlg=="0"){d.mailuse="0"}else{if(c._sDelFlg=="1"){d.mailuse="1"}}var e=c.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]').val();if(neo.isSet(e)&&e!="all"){d.gid=e}return d},_initListStartModLink:function(){var c=this;c.$mjTableList.dnclick(".jco-modlink",function(f){var d=b(this).parent().parent().find(".jco-id").val();var e=b(this).prev('[name="accid"]').val();c._inputModPageAccount(d,e)},function(f){var d=b(this).parent().parent().find(".jco-id").val();var e=b(this).prev('[name="accid"]').val();c._inputModPageAccount(d,e)})},_inputModPageAccount:function(g,d){var c=this;var f="";var e={};f=c._getListModCmd();e=c._getModPageParam();e.cmd=f;e.uid=g;e.id=d;c._inputPage(e)},_replaceListLine:function(d,f,e){var c=this;if(f==desknets.mailimapset.FIELD_ACCLIST){d=c._replaceAccountLine(d,e[f])}else{if(f==desknets.mailimapset.FIELD_MAILUSE){d=c._replaceMailUseLine(d,f,e)}else{d=c.callBase("_replaceListLine",d,f,e)}}return d},_replaceMailUseLine:function(d,f,e){var c="";if(e[f]=="1"){c=desknets.Resource.mailimap.mailuseon}else{c=desknets.Resource.mailimap.mailuseoff}d=desknets.tmpl.replaceWordHtml(d,f,c);return d},_replaceAccountLine:function(f,g){var e=this;var d="";var c="";if(typeof g=="object"){f=e._replaceAccountListLine(f,g)}else{c=desknets.mailimapset.FIELD_ACCMAIL;d=desknets.Resource.Message.mail_acc_nodata;f=desknets.tmpl.replaceWordHtml(f,c,d);c=desknets.mailimapset.FIELD_USER;d="";f=desknets.tmpl.replaceWordHtml(f,c,d)}return f},_replaceAccountListLine:function(d,l){var c="";var i="";var j=0;var h="";var k="";var g="";var e=[];if(!b.isArray(l)){e=[l]}else{e=l}for(j=0;j<e.length;j++){var f=e[j];if(typeof f=="object"){for(c in f){if(c.length<=0){continue}i=desknets.escape(f[c]);i=desknets.escapeValue(i);i=desknets.escapeSpace(i);d=desknets.tmpl.replaceWordHtml(d,c,i)}}}return d},_getListCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPMSETUSERACCOUNT},_getListExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPMSETUSERACCOUNT},_getListModClass:function(){return desknets.mailimapset.mailimapmsetaccountentry},_getDelExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPMSETACCOUNTMAILUSE}})})(jQuery);(function(b){desknets.page(desknets.mailimapset,"mailimapmsetaccountentry",desknets.PageInputBase,{_initSet:function(){var c=this;c._initSetWarningArea();c.callBase("_initSet")},_initSetWarningArea:function(){var d=b("#mail-warning-area");var c=b("#mail-warning-msg");var e=b("#mail-warning-detail");if(c.text()!=""||e.text()!=""){if(e.text()!=""){b("<br />").insertBefore(e)}d.show()}},_getErrorPlace:function(d){var e=this;var f="";var c="";if(d=="pop3server"||d=="pop3"||d=="pop3secure"||d=="smtpserver"||d=="smtp"||d=="smtpsecure"||d=="smtpauthuid"||d=="smtpauthpwd"){f=b("#inputfrm").find(".jco-input-"+d).closest("td").prev().find(".co-colon").eq(0).text();c=b("#inputfrm").find(".jco-input-"+d).closest("table").closest("td").prev().find(".co-colon").eq(0).text();if(neo.isSet(f)&&f.length>0){f=c+" - "+f+desknets.merrMsgConnect}return f}else{return e.callBase("_getErrorPlace",d)}},_inputDelConfSubmit:function(){var c=this;var f=c._delConfMessage();var e=null;var d={};e=desknets.dialog.confirm(f,function(){c._inputDelSubmit(e);return false},d)},_getRestModule:function(){return desknets.mailimapset.MODULE_API_MAILIMAP},_getAddExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPMSETACCOUNTENTRY},_getModExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPMSETACCOUNTENTRY},_getDelExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPMSETACCOUNTDEL},_getDelPrm:function(){var c={};var d=desknets.paramanalyzer.getHashParams();c.uid=d.uid;return c}})})(jQuery);(function(b){desknets.page(desknets.mailimapset,"mailimapsetgen",desknets.PageSet,{_getNextCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETADMIN},})})(jQuery);(function(b){desknets.page(desknets.mailimapset,"mailimapsetmanager",desknets.PageAdmin,{_getSetCondition:function(){return false},_getNextCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETADMIN}})})(jQuery);(function(b){desknets.page(desknets.mailimapset,"mailimapsetserver",desknets.PageSet,{_getErrorPlace:function(d){var e=this;var f="";var c="";if(d=="pop3"||d=="pop3secure"||d=="smtp"||d=="smtpsecure"||d=="imap"){f=b("#frm").find(".jco-input-"+d).prev("span").text();c=b("#frm").find(".jco-input-"+d).closest("td").prev().find(".co-colon").eq(0).text();if(neo.isSet(f)&&f.length>0){f=c+" - "+f+desknets.merrMsgConnect}return f}else{return e.callBase("_getErrorPlace",d)}},_getNextCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETADMIN}})})(jQuery);(function(b){desknets.page(desknets.mailimapset,"mailimapsetexport",desknets.PageSet,{_getNextCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETADMIN}})})(jQuery);desknets.page(desknets.mailimapset,"mailimapsetdirectory",desknets.PageInputList,{_replaceListLine:function(c,e,d){var b=this;if(e==desknets.mailimapset.FIELD_SHOW){c=b._replaceListLineShow(c,e,d)}else{c=b.callBase("_replaceListLine",c,e,d)}return c},_replaceListLineShow:function(c,e,d){var b="";if(d[e]=="1"){b=desknets.Resource.mailimap.directoryDisplayOn}else{b=desknets.Resource.mailimap.directoryDisplayOff}c=desknets.tmpl.replaceWordHtml(c,e,b);return c},_getRestModule:function(){return desknets.mailimapset.MODULE_API_MAILIMAP},_getListCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETDIRECTORY},_getListExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETDIRECTORY},_getListAddCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETDIRECTORYENTRY},_getListModCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETDIRECTORYENTRY},_getDelExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETDIRECTORYDEL},_getListEntryClass:function(){return desknets.mailimapset.mailimapsetdirectoryentry},_getListModClass:function(){return desknets.mailimapset.mailimapsetdirectoryentry}});desknets.page(desknets.mailimapset,"mailimapsetdirectoryentry",desknets.PageInputBase,{_getRestModule:function(){return desknets.mailimapset.MODULE_API_MAILIMAP},_getDelExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETDIRECTORYDEL},_getAddExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETDIRECTORYENTRY},_getModExecCmd:function(){var b=this;return b._getAddExecCmd()},_initSet:function(){var b=this;a("#jmailimapset-chkconnect").click(function(c){c.preventDefault();b._checkDirectoryConnect()});a(".jmailimapset-chkconn-required").blur(function(){b._resetChkButton()});b._resetChkButton();b.callBase("_initSet")},_resetChkButton:function(){var b=this;a("#jmailimapset-chkconnect").attr("disabled",b._isEmptyForChkButton())},_isEmptyForChkButton:function(){var c=this;var b=false;a(".jmailimapset-chkconn-required").each(function(d,e){if(!neo.isSet(a(e).val(),{blank:false})){b=true;return false}});return b},_checkDirectoryConnect:function(){var b=this;var d=a("#inputfrm");var e;if(b._isEmptyForChkButton()){return}e=b.checkInput(d);if(neo.isSet(e,{blank:false})){desknets.dialog.alert(e);return}desknets.submitform.setDisabled(d);var c={cmd:"addrdirchkconnect",id:d.find("[name=id]").val(),server:d.find("[name=server]").val(),loginid:d.find("[name=loginid]").val(),word:d.find("[name=word]").val(),port:d.find("[name=port]").val(),timeout:d.find("[name=timeout]").val(),base:d.find("[name=base]").val(),search_name:d.find("[name=search_name]").val()};desknets.ajax.rest({url:desknets.getUrl("zrwimapdir"),data:c,dataType:"xml",success:function(f){var h=desknets.Resource.Message.mailimap_dir_connect;var g={type:"message"};desknets.dialog.alert(h,g)},complete:function(g,f,h){desknets.submitform.clearDisabled(d)},errorconvmsg:function(f,g){var h=desknets.getErrField(f,g);h.fieldname=b._getErrorPlace(h.fieldid);return desknets.getErrConvMsg(h)}})},onErrorForm:function(c){var b=this;b.callBase("onErrorForm",c);b._resetChkButton()}});(function(b){desknets.page(desknets.mailimapset,"mailimapsetsendmistake",desknets.PageSet,{_getNextCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETADMIN},_getErrorPlace:function(d){var e=this;var f="";var c="";if(d=="manysendcount"){f=b("#frm").find(".jco-input-"+d).closest("td").find(".jmail-manysend").eq(0).text();c=b("#frm").find(".jco-input-"+d).closest("table").closest("td").closest("table").closest("td").prev().find(".co-colon").eq(0).text();if(neo.isSet(f)&&f.length>0){f=c+" - "+f+desknets.merrMsgConnect}return f}else{if(d=="undosendtime"){f=b("#frm").find(".jco-input-"+d).closest("td").find(".jmail-undosendtype").eq(0).text();c=b("#frm").find(".jco-input-"+d).closest("table").closest("td").prev().find(".co-colon").eq(0).text();if(neo.isSet(f)&&f.length>0){f=c+" - "+f+desknets.merrMsgConnect}return f}else{return e.callBase("_getErrorPlace",d)}}}})})(jQuery);desknets.page(desknets.mailimapset,"mailimapsetwlistaddr",desknets.PageInputList,{_getRestModule:function(){return desknets.mailimapset.MODULE_API_MAILIMAP},_getListCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETWLISTADDR},_getListExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETWLISTADDR},_getListAddCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETWLISTADDRENTRY},_getListModCmd:function(){return desknets.mailimapset.PAGE_MAILIMAPSETWLISTADDRENTRY},_getDelExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETWLISTADDRDEL},_getMoveExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETWLISTADDRMV},_getListEntryClass:function(){return desknets.mailimapset.mailimapsetwlistaddrentry},_getListModClass:function(){return desknets.mailimapset.mailimapsetwlistaddrentry}});desknets.page(desknets.mailimapset,"mailimapsetwlistaddrentry",desknets.PageInputBase,{_getRestModule:function(){return desknets.mailimapset.MODULE_API_MAILIMAP},_getDelExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETWLISTADDRDEL},_getAddExecCmd:function(){return desknets.mailimapset.CMD_MAILIMAPSETWLISTADDRENTRY},_getModExecCmd:function(){var b=this;return b._getAddExecCmd()}});app.addInitialAction(function(){desknets.mailimapset.init()})})(jQuery);