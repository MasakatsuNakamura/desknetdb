/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){(function(b){desknets.coreset={init:function(){var c=this;c.setAdminFuncMove()},setAdminFuncMove:function(){b("#co-m-h-select").find("select").change(function(){var c=desknets.msUrl+b(this).val();desknets.execLocation(c)})}}})(jQuery);(function(b){desknets.page(desknets,"PageSet",desknets.PageBase,{init:function(){var c=this;c._mIdPageForm="#"+c._getIdPageForm();c._setTitle(c._getTitle());c._initSetAjaxFrom();c._initBeforeUnload();c._inputFormSaveToObserver();c._initPageEnterKeysSubmitFormCancel();if(desknets.browser.tablet){var d=function(){desknets.submitform.clearDisabled(b(c._mIdPageForm))};b(window).on("pageshow",d)}else{if(desknets.browser.safari){var d=function(){desknets.submitform.clearDisabled(b(c._mIdPageForm))};b(window).on("pageshow",d)}else{b(document).ready(function(){desknets.submitform.clearDisabled(b(c._mIdPageForm))})}}},_initSetAjaxFrom:function(){var c=this;var d={};d=c._getAjaxFormOption();c._initFormRequestAjax("#frm",d);c._initFormErrorEvent()},_getAjaxFormOption:function(){var c=this;var d={};d={success:function(f,e,g){c._onAjaxFormSuccess(f)},errorconvmsg:function(e,f){var g=desknets.getErrField(e,f);g.fieldname=c._getErrorPlace(g.fieldid);return desknets.getErrConvMsg(g)},validation:function(e){var f=c.checkInput(e);if(neo.isSet(f,{blank:false})){desknets.dialog.alert(f);return false}return true}};return d},_getErrorPlace:function(c){var d=this;if(c!==""){return desknets.getErrFieName(b("#frm"),c)}return""},_onAjaxFormSuccess:function(e){var c=this;var f={};var h=c._getModule();var g=c._getNextCmd();var i=desknets.getUrl(h);f.cmd=g;var d=desknets.getNeoParam(f);i=i+"?"+d;desknets.execLocation(i)},_inputFormSaveToObserver:function(){var c=this;var d=c._getIdPageSetForm();if(d!=""){c._defFormVals={};var e=b("#"+d);c._formObserveSave(e,c._defFormVals)}},_getNextCmd:function(){return""},_getIdPageSetForm:function(){return"frm"},_getBeforeUnloadMsg:function(){return desknets.Resource.Message.com_input_beforeentry_msg},_formObserveisChanged:function(){var c=this;var d=c._getIdPageSetForm();if(!neo.isSet(d)){return false}var e=b("#"+d);if(c._formObserve_isChanged(e)){return true}return false},_getIdPageForm:function(){return"frm"},})})(jQuery);desknets.page(desknets,"PageSetList",desknets.PageSet,{_$listArea:null,_$listTable:null,_$listNoData:null,_$listdelButton:null,init:function(){var b=this;b.callBase("init");b._setListTable();b._listSet();b._initPageView();b._initListDisp();b._initListChk();b._initListButton()},_setListTable:function(){var b=this;b._$listArea=a("#"+b._getIdListArea());b._$listTable=b._$listArea.find(".co-table-list");b._$listNoData=b._$listArea.find(".co-nodata");b._$listdelButton=b._$listArea.find("#"+b._getIdDelButton())},_listSet:function(){var c=this;var b=c._$listTable.find(".co-tbody-list");if(b.find("tr").length==0){c._listNodata()}else{c._listView()}c._allChkHide();c._$listTable.find("tr").removeClass("co-tr-selected");c._$listTable.find("input[type=checkbox]").attr("checked",false)},_initPageView:function(){a(".jco-page").show()},_listNodata:function(){var b=this;b._$listTable.hide();b._$listNoData.show()},_listView:function(){var c=this;var b=c._$listTable.find(".co-tbody-list");c._$listTable.show();c._$listNoData.hide();desknets.htmlparts.addStripeClass(b,"co-tr-even")},_initListDisp:function(){var d=this;var e=d._$listTable.find("thead").find("tr");var b=e.length;for(var c=0;c<b;c++){desknets.htmlparts.addLastClass(a(e[c]),"last-child")}},_allChkHide:function(){var b=this;var c=b._$listArea.find(".co-chk-cnt").find(".co-chk-cnt-all");if(c.css("display")=="block"){c.hide();b._$listTable.find(".jco-checkbox-all").attr("checked",false)}},_initListChk:function(){var b=this;b._$listTable.find(".co-tbody-list").delegate("input[type=checkbox]","click",function(c){b._$listTable.find(".jco-checkbox-all").attr("checked",false);b._$listArea.find(".co-chk-cnt").find(".co-chk-cnt-all").hide();if(a(this).attr("checked")){a(this).parent().parent().addClass("co-tr-selected")}else{a(this).parent().parent().removeClass("co-tr-selected")}});b._$listTable.find(".jco-checkbox-all").click(function(){var d=(a(this).attr("checked"))?true:false;var c=b._$listTable.find(".co-tbody-list");b._$listTable.find("input[type=checkbox]").attr("checked",d);if(d){c.find("tr").addClass("co-tr-selected")}else{c.find("tr").removeClass("co-tr-selected")}if(d){var f=c.find("tr").length;var e=desknets.Resource.Message.com_listchk_cnt_all_disp;e=desknets.tmpl.replaceWordLF(e,"num",f+" ");b._$listArea.find(".co-chk-cnt").find(".jco-span-chk-msg-all").html(e);b._$listArea.find(".co-chk-cnt").find(".co-chk-cnt-all").show()}else{b._$listArea.find(".co-chk-cnt").find(".co-chk-cnt-all").hide()}})},_initListButton:function(){var b=this;b._initDelButton()},_initDelButton:function(){var b=this;a("#"+b._getIdDelButton()).click(function(){if(!b._checkSelectTarget(b._delNoChkMessage())){return}b._listDel()})},_checkSelectTarget:function(d){var c=this;var b;b=c._$listTable.find("input[type=checkbox]").filter(":checked");if(b.length<=0){desknets.dialog.alert(d,{type:"warn"});return false}return true},_listDel:function(){var b=this;b._$listTable.find(".co-tbody-list").find("input[type=checkbox]").each(function(){if(a(this).attr("checked")){a(this).parent().parent().remove()}});b._listSet()},_getIdListArea:function(){return"jco-pageset-list"},_getIdDelButton:function(){return"jco-del-button"},_delNoChkMessage:function(){return desknets.Resource.Message.com_del_nochecked}});desknets.page(desknets,"PageInputList",desknets.PageListBase,{_listSortable:null,_initSet:function(){this.callBase("_initSet");this._initListSortable()},_initListStartSet:function(){this.callBase("_initListStartSet");this._initListStartSetBack()},_initListStartSetBack:function(){var b=this;b.$mjListPage.find(".co-actionarea-normal").find(".co-pageback").click(function(c){c.preventDefault();b._onClickPageBack(a(this))})},_onClickPageBack:function(b){desknets.clickAlink(b)},_listPageSort:function(b,c){this.callBase("_listPageSort",b,c);this._setMoveMode()},inputDispPage:function(b){this.inputModPage(b)},_getListAjaxSuccessEnd:function(){this.callBase("_getListAjaxSuccessEnd");if(this._listSortable!=null){this._listSortable.fixListItems()}},_initListSortable:function(){var b=this.$mjListPage.find("form");var d=this._getMoveExecCmd();if(!!d){var c=this._getListSortableOptions(d);this._listSortable=new desknets.ListSortable(b,c)}},_getListSortableOptions:function(c){var b=this;return{disabled:!this._canSort(),url:desknets.getUrl(this._getRestModule()),sortCmd:c,sortParamFilter:function(d){return a.extend(d,b._getMoveParam())},confirmMessage:b._moveMessage(),getAdditionalData:function(){return a.extend({cmd:b._getListExecCmd()},b.getListParamToObj())},start:function(){b._listToggleViewMove(true)},change:function(d){b._getListAjaxSuccess(d)},stop:function(){b._listToggleViewMove(false)}}},_listToggleViewMove:function(b){},_setMoveMode:function(){if(this._listSortable!=null){if(this._canSort()){this._listSortable.enable()}else{this._listSortable.disable()}}},_canSort:function(){var c=this._setDefSort();var d=this.$mjListPage.find('input[name="fldsort"]').val();var b=this.$mjListPage.find('input[name="order"]').val();return(c==""||c==d)&&b=="1"},_moveMessage:function(){return desknets.Resource.Message.com_move_conf},_setDefSort:function(){return""},_getMoveParam:function(){return{}},_getMoveExecCmd:function(){return""}});desknets.page(desknets,"PageImport",desknets.PageSet,{_mfuncTimer:null,_mboImportEndMsg:false,$dialogexec:null,init:function(){var b=this;b.callBase("init");b.makeFileInput();b._initTableDnD();if(b._getChkCmd()!=""){b._chkImport()}b._initSetEncodeType();b._initButton()},_getAjaxFormOption:function(){var b=this;var c={};c={dataType:"xml",success:function(e,d,f){b._onAjaxFormSuccess(e)}};return c},_initSetEncodeType:function(){var c=this;a("#jco-encodetype").find("a").click(function(e){e.preventDefault();a("#jco-encodetype").hide();a("#co-encodetype-input").show()});var d=a.cookie(desknets.COOKIENAME_IMEX_CCODE);var b=a.cookie(desknets.COOKIENAME_IMEX_CSEP);if(d){a('[name="char_code"]').val(d);a(".jco-encodetype-char").text(desknets.Resource.ImEx["charCode"+d])}if(b){a('[name="char_sep"]').val(b);a(".jco-encodetype-sep").text(desknets.Resource.ImEx["charSep"+b])}},_initButton:function(){var b=this;a("#jco-imexfld-set").click(function(){a("#jco-imexfld").html(a("#jco-imexfld-def").html());b._initTableDnD()});a(".jco-import-submit").click(function(c){c.preventDefault();if(b._importSubmitClick()){b._setCookiesImportSetting();a("#frm").submit()}})},_importSubmitClick:function(){if(a('input[name="attach"]').val().length<=0){desknets.dialog.alert(desknets.Resource.Message.com_import_nofile,{type:"warn"});return false}return true},_setCookiesImportSetting:function(){desknets.saveCookieToDisk(desknets.COOKIENAME_IMEX_CCODE,a('[name="char_code"]').val());desknets.saveCookieToDisk(desknets.COOKIENAME_IMEX_CSEP,a('[name="char_sep"]').val())},_initTableDnD:function(){a("#jco-imexfld").tableDnD({onDragClass:"co-tr-selected"})},_onAjaxFormSuccess:function(d){var b=this;var c=function(){if(b._getChkCmd()!=""){b._chkImport()}};if(b._getChkCmd()!=""){b._importExecDialog();b._mboImportEndMsg=true;setTimeout(function(){c()},2000)}else{b._mboImportEndMsg=true;b._execImportEnd(d)}},_execImportEnd:function(c){var b=this;var d="";desknets.submitform.clearDisabled(a("#frm"));if(b.$dialogexec!=null){b.$dialogexec.dialog("close");desknets.submitform.clearDialogDisabled(b.$dialogexec);b.$dialogexec=null}if(b._mboImportEndMsg){if(neo.isSet(c.mymessage)||neo.isSet(c.message)){desknets.dialog.alert(b._makeErrorMsg(c),{type:"warn"})}else{desknets.dialog.alert(b._importMessage(),{type:"message"});b.makeFileInput()}}else{b.makeFileInput()}b.delTimer();b._mboImportEndMsg=false},makeFileInput:function(){a(".jco-import-file").html('<input type="file" name="attach" size="40" />')},_chkImport:function(){var c=this;var f="";var b="";var d={};f=c._getRestModule();b=c._getChkCmd();var e=desknets.getUrl(f);d.cmd=b;desknets.ajax.rest({url:e,data:d,success:function(h,g,i){c._makeImport(h)}})},_makeImport:function(d){var c=this;var b="";if(d.execflg=="0"){if(!c._mboImportEndMsg){if(neo.isSet(d.mymessage)||neo.isSet(d.message)){var e=c._makeErrorMsg(d);desknets.pageframe.viewTopMsg(e.replace(/\r?\n/g,"<br />"),"alert")}else{desknets.pageframe.closeTopMsg()}}else{desknets.pageframe.closeTopMsg()}c._execImportEnd(d)}else{desknets.submitform.setDisabled(a("#frm"));c._importExecDialog();c._mboImportEndMsg=true;c.setTimer()}},_makeErrorMsg:function(d){var c=this;var b="";if(neo.isSet(d.mymessage)&&d.mymessage.length>0){b=d.mymessage}if(neo.isSet(d.message)&&d.message.length>0){if(neo.isSet(b)&&b.length>0){b=b+"\n"}b=b+d.message}return b},setTimer:function(){var b=this;var c=5000;if(b._mfuncTimer==null){b._mfuncTimer=setInterval(function(){b._chkImport()},c)}},delTimer:function(){var b=this;if(b._mfuncTimer!==null){clearInterval(b._mfuncTimer);b._mfuncTimer=null}},_importExecDialog:function(){var b=this;var c={type:"message",extraMessage:desknets.Resource.Message.com_dialog_execaddmsg,extraClass:"co-loading-dialog"};b.$dialogexec=desknets.dialog.alert(b._importExecMessage(),c);desknets.submitform.setDialogDisabled(b.$dialogexec)},_importExecMessage:function(){var b=desknets.Resource.Message.com_dialog_execmsg;b=desknets.tmpl.replaceWordHtml(b,"msg",desknets.Resource.Message.com_import_nowexec);return b},_importMessage:function(){return desknets.Resource.Message.com_import_end},_getRestModule:function(){return""},_getChkCmd:function(){return""},_getBeforeUnloadExec:function(){return false}});desknets.page(desknets,"PageExport",desknets.PageSet,{init:function(){var b=this;b.callBase("init");b._initTableDnD();b._initSetEncodeType();b._initButton();b._initFormErrorEvent()},_initSetAjaxFrom:function(){},_initSetEncodeType:function(){var c=this;a("#jco-encodetype").find("a").click(function(e){e.preventDefault();a("#jco-encodetype").hide();a("#co-encodetype-input").show()});var d=a.cookie(desknets.COOKIENAME_IMEX_CCODE);var b=a.cookie(desknets.COOKIENAME_IMEX_CSEP);if(d){a('[name="char_code"]').val(d);a(".jco-encodetype-char").text(desknets.Resource.ImEx["charCode"+d])}if(b){a('[name="char_sep"]').val(b);a(".jco-encodetype-sep").text(desknets.Resource.ImEx["charSep"+b])}},_initButton:function(){var b=this;a("#jco-imexfld-set").click(function(){a("#jco-imexfld").html(a("#jco-imexfld-def").html());b._initTableDnD()});a(".jco-export-submit").click(function(c){c.preventDefault();var d=b.checkExport();if(neo.isSet(d,{blank:false})){desknets.dialog.alert(d);return}b._setCookiesExportSetting();a("#frm").submit()})},checkExport:function(){return null},_initFormErrorEvent:function(){var c=this;var b=a("#frm");b.bind("invalid",function(e){var f=a(e.target);var d=f.attr("name")||f.data("name");desknets.validation.showError(f,c._getErrorPlace(d))})},_setCookiesExportSetting:function(){desknets.saveCookieToDisk(desknets.COOKIENAME_IMEX_CCODE,a('[name="char_code"]').val());desknets.saveCookieToDisk(desknets.COOKIENAME_IMEX_CSEP,a('[name="char_sep"]').val())},_initTableDnD:function(){a("#jco-imexfld").tableDnD({onDragClass:"co-tr-selected"})},_getBeforeUnloadExec:function(){return false}});desknets.page(desknets,"PageAccess",desknets.PageSetList,{_dialogId:"setaccess",_ID_ACCESS_OPEN:"jco-access-open",_ID_ACCESS_ADD:"jco-access-add",_ID_ACCESS_MOD:"jco-access-mod",_ID_ACCESS_DEL:"jco-access-del",_BIT_ACCESS_OPEN:1,_BIT_ACCESS_ADD:2,_BIT_ACCESS_MOD:4,_BIT_ACCESS_DEL:8,_TYPE_GROUPDATA:"g",_TYPE_USERDATA:"u",_TYPE_ROLEDATA:"r",_CSS_ICON_ROLE:"co-gicon-role",_CSS_ICON_ROLELOCK:"co-gicon-lock",_CSS_ICON_GROUP:"co-gicon-group",_CSS_ICON_MYGROUP:"co-gicon-mygroup",_CSS_ICON_USER:"co-gicon-user",_TMPL_ACCSEL:"com/setaccess.html",_TMPL_ACCSEL_ADDONLY:"com/setaccess_addonly.html",_boAddOnly:false,_initListButton:function(){var b=this;b.callBase("_initListButton");b._initAccessAssignSelButton();b._initAccessSetButton()},_initAccessAssignSelButton:function(){var b=this;a("#jco-acc-usel").click(function(c){b._openAccessAssignSelDialog()})},_openAccessAssignSelDialog:function(e){var c=this;var f;var b=c._getSelDialogID();var d=c._getSelDialogOptions();f=desknets.chooser.open(b,d)},_initAccessSetButton:function(){var b=this;a("#jco-acc-setaccess").click(function(c){c.preventDefault();if(!b._checkSelectTarget(desknets.Resource.Message.com_set_nochecked)){return}b._openAccessSetDialog()})},_openAccessSetDialog:function(){var b=this;var c=a("#"+b._dialogId);if(c.length>0){c.find("input[type=checkbox]").attr("checked",false);b._setItemsAccessKind();return c.dialog("open").find("input").get(0).blur()}c=a("<div />").attr("id",b._dialogId).addClass("co-editarea").appendTo(document.body);b._initAccessSetDialog(c);return c},_initAccessSetDialog:function(d){var c=this;var e=function(){desknets.dialog.setUp(d,c._getDialogOptions());d.dialog("open").find("input").get(0).blur();desknets.dialog.setFirstDialogOpen(d);d.delegate("input[type=checkbox]","click",function(f){if(a(this).attr("checked")){d.find("#"+c._ID_ACCESS_OPEN).attr("checked",true)}else{if(a(this).attr("id")==c._ID_ACCESS_OPEN){d.find("input[type=checkbox]").attr("checked",false)}}});c._setItemsAccessKind()};var b=c._TMPL_ACCSEL;if(c._boAddOnly){b=c._TMPL_ACCSEL_ADDONLY}desknets.tmpl.load(d,b,e,true)},_getDialogOptions:function(){var b=this,e={};e[desknets.Resource.OKButtonLabel]=function(){b._onSetAccess(a(this))};e[desknets.Resource.CancelButtonLabel]=function(){a(this).dialog("close")};var d=desknets.dialog.getDialogOption();var c=b._getDialogSelfOptions(e);a.extend(d,c);return d},_getDialogSelfOptions:function(b){return{buttons:b,title:desknets.Resource.modRight,width:400}},_onSetAccess:function(){var i=this;var c=a("#"+i._dialogId);var j=0;var k=0;var f=0;var h=0;var b,e;var d=c.find("input[type=checkbox]").filter(":checked");for(var g=0;g<d.length;g++){if(a(d[g]).attr("id")==i._ID_ACCESS_OPEN){j=1}if(a(d[g]).attr("id")==i._ID_ACCESS_ADD){k=2}if(!i._boAddOnly){if(a(d[g]).attr("id")==i._ID_ACCESS_MOD){f=4}if(a(d[g]).attr("id")==i._ID_ACCESS_DEL){h=8}}}i._$listTable.find(".co-tbody-list").find("input[type=checkbox]").each(function(){if(a(this).attr("checked")){var n=a(this).parent().parent();if(j==0){n.remove()}else{var m=n.find(".comad-td-access");a(m).html("&nbsp");var l={accsOpen:j,accsAdd:k,accsMod:f,accsDel:h};i._setAccessTdText(m,l)}a(this).attr("checked",false);a(this).parent().parent().removeClass("co-tr-selected");b=a(this).parent().parent().find('input[name="id"]').val();e=b+"_"+(j+k+f+h);a(this).parent().parent().find('input[name="accesskind"]').val(e)}});i._listSet();c.dialog("close")},_setAccessTdText:function(d,b){var c=this;if(b.accsOpen&c._BIT_ACCESS_OPEN){a(d[0]).text(desknets.Resource.acceccOpen)}if(b.accsAdd&c._BIT_ACCESS_ADD){a(d[1]).text(desknets.Resource.acceccAdd)}if(!c._boAddOnly){if(b.accsMod&c._BIT_ACCESS_MOD){a(d[2]).text(desknets.Resource.acceccMod)}if(b.accsDel&c._BIT_ACCESS_DEL){a(d[3]).text(desknets.Resource.acceccDel)}}},_setItemsAccessKind:function(){var c=this;var h=a("#"+c._dialogId);var b=1;var i=1;var g=1;var d=1;c._$listTable.find(".co-tbody-list").find("input[type=checkbox]").filter(":checked").each(function(){var j=a(this);var k=j.parent().parent().find(".comad-td-access");k.each(function(l){if(a(this).html()=="&nbsp;"){if(l+1==1){b=0}if(l+1==2){i=0}if(l+1==3){g=0}if(l+1==4){d=0}}})});var f=h.find("input[type=checkbox]");for(var e=0;e<f.length;e++){if((a(f[e]).attr("id")==c._ID_ACCESS_OPEN&&b==1)||(a(f[e]).attr("id")==c._ID_ACCESS_ADD&&i==1)||(a(f[e]).attr("id")==c._ID_ACCESS_MOD&&g==1)||(a(f[e]).attr("id")==c._ID_ACCESS_DEL&&d==1)){a(f[e]).attr("checked","checked")}}},_createAccessRow:function(k,p,m,g,d,o){var n=this;var j="";var e="";var b=n._getDefAccess();var c=1;var l="";if(g==n._TYPE_ROLEDATA){if(Number(k)<=desknets.DBVAL_ROLE_LOCK_MAX){e=n._CSS_ICON_ROLELOCK}else{e=n._CSS_ICON_ROLE}}else{if(g==n._TYPE_USERDATA){e=n._CSS_ICON_USER}else{if(g==n._TYPE_GROUPDATA){if(k<0){e=n._CSS_ICON_MYGROUP}else{e=n._CSS_ICON_GROUP}}}}if(neo.isSet(d)&&d=="all"){c=2;l=desknets.Resource.chooser.allDescendantsLabel}else{if(g==n._TYPE_GROUPDATA&&neo.isSet(d)&&d!="all"){l=desknets.Resource.chooser.offDescendantsLabel}}var i=desknets.escape(p);i=desknets.escapeValue(i);i=desknets.escapeSpace(i);var f;if(neo.isSet(m,{blank:false})){f='<span title="'+desknets.tmpl.escapeWord(a("<div />").append(m).text())+'">'+m+"</span>"}else{f="&nbsp;"}if(g==n._TYPE_USERDATA){o=desknets.escape(o);o=desknets.escapeValue(o)}j=j+'<td class="co-chk"><input type="checkbox" name="_id" value="'+g+k+'">';j=j+'<input type="hidden" name="id" value="'+g+k+'" />';j=j+'<input type="hidden" name="accesskind" value="'+g+k+"_"+b+'" />';j=j+'<input type="hidden" name="condition" value="'+g+k+"_"+c+'" />';j=j+"</td>";var h;if(g!=n._TYPE_USERDATA){h='<span class="jco-sel-item" data-id="'+g+k+'" data-name="'+i+'" data-description="'+o+'" title="'+i+'">'+i+"</span>"}else{h='<a class="jco-ref-dialog-link jco-sel-item" data-id="'+g+k+'" data-name="'+i+'" data-description="'+o+'" data-refid="user'+k+'" title="'+i+'" href="#">'+i+"</a>"}j=j+'<td><span class="'+e+'">&nbsp;</span>'+h+"</td>";j=j+'<td class="co-busyo">'+f+"</td>";j=j+'<td class="jco-td-access-descendant">'+l+"</td>";j=j+n._getAccessListDefRow();return j},_getDefAccess:function(){return 3},_createAccessRowAdd:function(b){return""},_getAccessListDefRow:function(){var e;var c=this;var h=c._getDefAccess();var g="&nbsp;";var b="&nbsp;";var f="&nbsp;";var d="&nbsp;";if(h>=8){h=h-8;d=desknets.Resource.acceccDel}if(h>=4){h=h-4;f=desknets.Resource.acceccMod}if(h>=2){h=h-2;b=desknets.Resource.acceccAdd}if(h>=1){h=h-1;g=desknets.Resource.acceccOpen}e='<td class="comad-td-access">'+g+"</td>";e=e+'<td class="comad-td-access">'+b+"</td>";if(!c._boAddOnly){e=e+'<td class="comad-td-access">'+f+"</td>";e=e+'<td class="comad-td-access">'+d+"</td>"}return e},_getSelDialogOptions:function(){var c=this;var d={};var b=[];var e="";e=c._getChoosePrivateGroup();b=desknets.chooser.getItemsFromElement(a(".co-tbody-list"),{itemFilter:function(i,f){var h=f.closest("tr").find('input[name="condition"]').val();if(h.substring(h.indexOf("_")+1)=="2"){h="all"}else{h=""}i.descendant=h;var g=f.closest("tr").find(".co-busyo").html();i.summary=g;return i}});d={chooseTarget:["user","group","role"],title:desknets.Resource.selItemDlgTitle,unassignGroup:"readonly",choosePrivateGroup:e,editDescendant:true,choose:function(f){c._onSelectAccessAssignItems(f)},items:b};if(c._isMSetCmd()){d.cmdusers=desknets.CMD_CHOOSERMSETUSERSEL}return d},_onSelectAccessAssignItems:function(h){var m,g;var o=this;var e=o._$listTable.find(".co-tbody-list").find("tr");var c="";var f="";var k;var j=null;var d=h.length;var n=e.length;for(m=0;m<d;m++){k=false;f=h[m].id;c=h[m].type.substring(0,1);for(g=0;g<n;g++){if(e[g]!="undefined"&&a(e[g]).find('input[name="id"]').val()==c+f){k=true;break}}if(k){if(c=="g"){if(h[m].descendant=="all"){var l=a(e[g]);var b=c+f+"_2";l.find(".jco-td-access-descendant").text(desknets.Resource.chooser.allDescendantsLabel);l.find('input[name="condition"]').val(b)}else{var l=a(e[g]);var b=c+f+"_1";l.find(".jco-td-access-descendant").text(desknets.Resource.chooser.offDescendantsLabel);l.find('input[name="condition"]').val(b)}}delete e[g];continue}var i=o._createAccessRow(h[m].id,h[m].name,h[m].summary,h[m].type.substring(0,1),h[m].descendant,h[m].description);var p="<tr>";p=p+i;p=p+o._createAccessRowAdd(h[m]);p=p+"</tr>";o._$listTable.find(".co-tbody-list").append(p)}for(g=0;g<n;g++){if(e[g]!="undefined"){a(e[g]).remove()}}o._listSet()},_getChoosePrivateGroup:function(){return""},_getIdDelButton:function(){return"jco-acc-delaccess"},_getIdListArea:function(){return"jco-acc-list-container"},_getSelDialogID:function(){return"jco-sel-access-items"},_isMSetCmd:function(){return false},_formObserve_getTargetNames:function(){return["condition","accesskind"]},_delNoChkMessage:function(){return desknets.Resource.Message.com_sel_nochecked}});desknets.page(desknets,"PageAccessInput",desknets.PageAccess,{mBackCmd:"",mIdBack:"jco-m-list-container",$mjPage:null,initPage:function(d,c){var b=this;if(neo.isSet(d)){b.mBackCmd=d}if(neo.isSet(c)){b.mIdBack=c}b.initGetPageId();b._initGetHtml()},initGetPageId:function(){var b=this;b.$mjPage=a("#"+b._getIdPage())},_initGetHtml:function(){var b=this;var c={};var d=desknets.paramanalyzer.getHashParams();c.success=function(h){var f=desknets.ajax.chkAjaxHtmlError(h);if(f.status=="ok"){b._initHtml(h)}else{var g=desknets.dialog.alert(f.message,{errorNo:f.no});var i=desknets.parseErrorInfo(f.message,f.no);var e={close:function(j){desknets.dialog.deleteById(i.level);b.dispBackListPage()}};g.dialog(e)}};b._sendRequestAjax(desknets.ajax.REQTYPE_SINGLE,desknets.ajax.RESTYPE_HTML,d,c)},_initHtml:function(c){var b=this;b.$mjPage.empty();b.$mjPage.html(c);b._initSet(c)},_initSet:function(c){var b=this;b._initBeforeUnload();b._initSetAjaxFrom();b._inputFormSaveToObserver();b._initPageEnterKeysSubmitFormCancel();b._setListTable();b._listSet();b._initListDisp();b._initListChk();b._initListButton();b._setTitle(b._getAreaTitle(b.$mjPage));a(".jco-page").hide();b.$mjPage.show();desknets.moveScroll()},_initListButton:function(){var b=this;b.callBase("_initListButton");b.$mjPage.find(".jco-input-list-page").click(function(c){b.dispBackListPage()})},dispBackListPage:function(){var b=this;var c=b.getLocationFormParam();if(neo.isSet(c)){b._setLocationHash(c)}},getLocationFormParam:function(){var b=this;var c={};if(!neo.isSet(b.mBackCmd)||!neo.isSet(b.mIdBack)){return null}c=desknets.getInputDataToObj(a("#"+b.mIdBack).find(".jco-back-page-data"));c.cmd=b.mBackCmd;return c},_onAjaxFormSuccess:function(c){var b=this;b._setLocationHashForm()},_getIdPage:function(){return"jco-m-input-page"},_formObserve_getTargetNames:function(){return["condition","accesskind","uid"]}});desknets.page(desknets,"PageAdmin",desknets.PageSetList,{_TYPE_USERDATA:"u",_TYPE_ROLEDATA:"r",_CSS_ICON_ROLE:"co-gicon-role",_CSS_ICON_ROLELOCK:"co-gicon-lock",_CSS_ICON_USER:"co-gicon-user",ZERR_NOGROUPASSIGNMANAGER:"-6100201",ZERR_NOGROUPASSIGNSELMANAGER:"-6100202",_tmpl_item:'<div><span class="co-selitem"><span title="{{description}}{{descriptionline}}{{name}} {{condition}}" class="jco-sel-item co-sel-item-exclude co-selitem-text" data-id="g{{id}}" data-name="{{name}}" data-descendant="{{descendant}}" data-description="{{description}}">{{name}} {{condition}}</span><a class="co-btn co-btn-close"  title="{{L_Delete}}" href="#">x</a><input type="hidden" name="adminselgrp" value="{{adminselgrp}}"></span></div>',$mGrpSelArea:null,msid:"",msAllManager:desknets.Resource.setAdminAllUser,_initListButton:function(){var b=this;b.callBase("_initListButton");b._initAdminAssignSelButton();b._initAdminSetButton();b._initAdminSelTargetLink()},_initAdminAssignSelButton:function(){var b=this;a("#jco-admin-usel").click(function(){b._openAdminAssignSelDialog()})},_openAdminAssignSelDialog:function(){var c=this;var e;var b=c._getSelDialogID();var d=c._getSelDialogOptions();e=desknets.chooser.open(b,d)},_initAdminSetButton:function(){var b=this;a("#jco-admin-settarget").click(function(c){if(!b._checkSelectTarget(desknets.Resource.Message.com_set_nochecked)){return false}b._openAadminSetDialog()})},_openAadminSetDialog:function(){var b=this;var c=a("#settarget");if(c.length>0){c.find("input").eq(0).attr("checked",true);c.find(".co-admin-selgrp").empty();c.find(".co-admin-selgrp-area").hide();return c.dialog("open").find("input").get(0).blur()}c=a("<div />").attr("id","settarget").appendTo(document.body);c.addClass("co-editarea");b._initAdminSetDialog(c);return c},_initAdminSetDialog:function(c){var b=this;var d=function(){c.dialog(b._getDialogOptions());c.dialog("open").find("input").get(0).blur();c.find(".co-admin-selgrp-area").hide();c.find("input").change(function(){if(a(this).val()=="3"){c.find(".co-admin-selgrp-area").show()}else{c.find(".co-admin-selgrp-area").hide()}});c.find(".co-admin-selgrp-btn").click(function(){b._initSetAdminGrpDialogSel(c.find(".co-admin-selgrp-area"))});c.find(".co-admin-selgrp").on("click",".co-btn-close",function(e){a(this).parent().parent().remove();e.preventDefault()})};desknets.tmpl.load(c,"com/setadmin.html",d,{cache:true})},_getDialogOptions:function(){var b=this,e={};e[desknets.Resource.OKButtonLabel]=function(){b._onSetTarget(a(this))};e[desknets.Resource.CancelButtonLabel]=function(){a(this).dialog("close")};var d=desknets.dialog.getDialogOption();var c={buttons:e,title:desknets.Resource.setAdminTarget,width:450};a.extend(d,c);return d},_onSetTarget:function(){var c=this;var e=a("#settarget");var d,b,f;var d=e.find('input[name="setadmin"]').filter(":checked").val();a(".co-tbody-list").find("input[type=checkbox]").each(function(){if(a(this).attr("checked")){var i=a(this).parent().parent();var h=i.find("ul");if(d=="1"){b=c.msAllManager}else{if(d=="3"){b=desknets.Resource.setAdminSelectGroup}else{b=desknets.Resource.setAdminAssignOnly}}i.find(".co-multiple-sel-text").text(b);a(this).attr("checked",false);i.removeClass("co-tr-selected");sid=i.find('input[name="id"]').val();f=sid+"_"+d;i.find('input[name="condition"]').val(f);if(d=="3"){var g=e.find(".co-admin-selgrp").html();g=desknets.tmpl.replaceWord(g,"admintarget",sid);i.find(".co-admin-selgrp").html(g).show()}else{i.find(".co-admin-selgrp").empty()}}});c._allChkHide();e.dialog("close")},_initAdminSelTargetLink:function(){var c=this;var d=null;var b=null;a(".co-tbody-list").delegate(".co-multiple-sel-text","click",function(g){$targetTr=a(this).parent().parent();b=a(this).parent();var f=$targetTr.find('input[name="condition"]').val();var e=f.split("_");a(".co-multiple-sel-list").find(".co-multiple-sel-item").removeClass("on");a(".co-multiple-sel-list").find("#"+e[1]).parent().addClass("on");g.preventDefault()});a(".co-multiple-sel-list").find("a").click(function(f){f.preventDefault();$targetTr.find(".co-multiple-sel-text").text(a(this).text());var e=$targetTr.find('input[name="id"]').val()+"_"+a(this).attr("id");$targetTr.find('input[name="condition"]').val(e);a("#jco-multiple-sel-list").removeClass("show");if(a(this).attr("id")=="3"){c._initSetAdminGrpDialog(b);$targetTr.find(".co-admin-selgrp").show()}else{$targetTr.find(".co-admin-selgrp").html("");$targetTr.find(".co-admin-selgrp").hide()}});c._initSetAdminGrp()},_initSetAdminGrp:function(){var b=this;b._tmpl_item=desknets.tmpl.replaceWordHtml(b._tmpl_item,"L_Delete",desknets.Resource.deselectLabel);a(".co-tbody-list").on("click",".co-btn-close",function(c){a(this).parent().parent().remove();c.preventDefault()})},_initSetAdminGrpDialog:function(c){var b=this;b.msid=c.parent().find("td").find('input[name="id"]').val();b.$mGrpSelArea=c;desknets.chooser.open("admin-group-chooser",b._initSetAdminGrpDialogOpt(c))},_initSetAdminGrpDialogSel:function(c){var b=this;b.msid="{{admintarget}}";b.$mGrpSelArea=c;desknets.chooser.open("admin-group-chooser",b._initSetAdminGrpDialogOpt(c))},_initSetAdminGrpDialogOpt:function(e,b){var c=this;var d;d={chooseTarget:["group"],title:desknets.Resource.setAdminSelectGroupDialog,editDescendant:true,dialogID:"admin-group-chooser",chooseAssignedGroup:false,choose:function(f){c._onSelectAssignItems(f)},items:c._getTargetGroups(e)};return d},_onSelectAssignItems:function(h){var j=this;var i;var f;var c="";var g="";var d="";f="";var b=h.length;for(i=0;i<b;i++){if(h[i]["descendant"]=="all"){g="1";d="("+desknets.Resource.chooser.allDescendantsLabel+")"}else{g="2";d="("+desknets.Resource.chooser.offDescendantsLabel+")"}c=j.msid+"_"+h[i]["id"]+"_"+g;srow=j._tmpl_item;srow=desknets.tmpl.replaceWord(srow,"id",h[i]["id"]);srow=desknets.tmpl.replaceWord(srow,"name",h[i]["name"]);srow=desknets.tmpl.replaceWord(srow,"description",h[i]["description"]);var e="";if(!!h[i]["description"]){e="-"}srow=desknets.tmpl.replaceWord(srow,"descriptionline",e);srow=desknets.tmpl.replaceWord(srow,"descendant",h[i]["descendant"]);srow=desknets.tmpl.replaceWord(srow,"condition",d);srow=desknets.tmpl.replaceWord(srow,"adminselgrp",c);f=f+srow}j.$mGrpSelArea.find(".co-admin-selgrp").html(f)},_getTargetGroups:function(d){var c=this;var b=desknets.chooser.getItemsFromElement(d,{itemFilter:function(g,e){var f=a.extend({},g);if(e.data("descendant")=="all"){f.descendant="all"}return f}});return b},_createAdminRow:function(h,l,i,e,k){var j=this;var g="";var b="";var c=1;if(e==j._TYPE_ROLEDATA){if(parseInt(h,10)<=desknets.DBVAL_ROLE_LOCK_MAX){b=j._CSS_ICON_ROLELOCK}else{b=j._CSS_ICON_ROLE}}else{b=j._CSS_ICON_USER}var f=desknets.escape(l);f=desknets.escapeValue(f);f=desknets.escapeSpace(f);var d=desknets.tmpl.escapeWord(a("<div />").append(i).text());if(e==j._TYPE_USERDATA){k=desknets.escape(k);k=desknets.escapeValue(k)}g="<tr>";g=g+'<td class="co-chk"><input type="checkbox" name="_id" value="'+e+h+'" />';g=g+'<input type="hidden" name="id" value="'+e+h+'" />';g=g+'<input type="hidden" name="condition" value="'+e+h+"_"+c+'" />';g=g+"</td>";if(e==j._TYPE_ROLEDATA){g=g+'<td><span class="'+b+'">&nbsp;</span><span data-name="'+f+'" data-id="'+e+h+'" data-description="'+k+'" class="jco-adminset-name jco-sel-item" title="'+f+'">'+f+"</span></td>"}else{g=g+'<td><span class="'+b+'">&nbsp;</span><a href="#" data-name="'+f+'" data-id="'+e+h+'" data-description="'+k+'" class="jco-adminset-name jco-ref-dialog-link jco-sel-item" data-refid="user'+h+'" "title="'+f+'">'+f+"</a></td>"}g=g+'<td class="co-busyo"><span class="jco-adminset-description" title="'+d+'">'+i+"</span></td>";if(j._getSetCondition()){g=g+'<td class="co-normal">';g=g+'  <a href="#" class="co-multiple-sel-text co-drop-down-button" data-align="left" data-for="jco-multiple-sel-list">'+j.msAllManager+"</a>";g=g+'  <div class="co-admin-selgrp"></div>';g=g+"</td>"}g=g+"</tr>";a(".co-tbody-list").append(g)},_getSelDialogOptions:function(){var c=this;var d={};var b=[];b=desknets.chooser.getItemsFromElement(a(".co-tbody-list"),{itemFilter:function(g,e){var f=e.closest("tr").find(".jco-adminset-description").html();g.summary=f;return g},excludeClass:"co-sel-item-exclude"});d={chooseTarget:["user","role"],title:desknets.Resource.UserSelDlgTitle_UserRole,choose:function(e){c._onSelectAdminAssignItems(e)},items:b,unassignGroup:"choosable",noAdministrators:true,cmdusers:desknets.CMD_CHOOSERMSETUSERSEL};return d},_onSelectAdminAssignItems:function(g){var i,f;var k=this;var d=k._$listTable.find(".co-tbody-list").find("tr");var b="";var e="";var h;var c=g.length;var j=d.length;for(i=0;i<c;i++){h=false;e=g[i].id;b=g[i].type.substring(0,1);for(f=0;f<j;f++){if(d[f]!="undefined"&&a(d[f]).find('input[name="id"]').val()==b+e){h=true;delete d[f];break}}if(h){continue}k._createAdminRow(g[i].id,g[i].name,g[i].summary,g[i].type.substring(0,1),g[i].description)}for(f=0;f<j;f++){if(d[f]!="undefined"){a(d[f]).remove()}}k._listSet()},_getAjaxFormOption:function(){var b=this;var c={};c=b.callBase("_getAjaxFormOption");c.errorconvmsg=function(d,e){if(e.errorno==b.ZERR_NOGROUPASSIGNMANAGER||e.errorno==b.ZERR_NOGROUPASSIGNSELMANAGER){return b.getErrMsg(e.errmsgadd,e.errormessage)}else{var f=desknets.getErrField(d,e);f.fieldname=b._getErrorPlace(f.fieldid);return desknets.getErrConvMsg(f)}};return c},getErrMsg:function(e,d){var b="";var c="";a("#frm").find('input[name="id"]').each(function(){var f=a(this);if(f.val()==e){c=f.closest("tr").find(".jco-adminset-name").html();if(!!c){c=c+'<span class="co-colon-span">:</span>'}return false}});if(neo.isSet(c)){if(neo.isSet(c)&&c.length>0){if(d.charAt(1)==":"){b=d.substring(0,2);d=d.substring(2)}return b+c+d}}return d},_getSelDialogID:function(){return"jco-sel-admin-items"},_getSetCondition:function(){return false},_getBeforeUnloadMsg:function(){return desknets.Resource.Message.com_setting_beforeentry_msg},_formObserve_getTargetNames:function(){return["condition","adminselgrp"]},_delNoChkMessage:function(){return desknets.Resource.Message.com_sel_nochecked}});desknets.page(desknets,"PageCapacityList",desknets.PageInputList,{mboEnable:true,_initListStart:function(){var b=this;b.callBase("_initListStart");desknets.page.groupSelect.init({},{allGroup:"choosable",unassignGroup:"choosable"});b.$mjListPage.find(".co-chk-cnt-some").find("a").hide()},_getListAjaxSuccess:function(c){var b=this;b.callBase("_getListAjaxSuccess",c);desknets.page.groupSelect.editSelectedGroup(a(".jco-sel-items"),c);b.$mjListPage.find(".jco-capa-noset").find("input[type=checkbox]").attr("disabled",true);b.$mjListPage.find(".jco-capa-set").find("input[type=checkbox]").attr("disabled",false);var e=b.$mjListPage.find(".jco-capa-set").length;if(e>0){b.$mjListPage.find(".co-table-list").find("thead").find(".jco-checkbox-all").attr("disabled",false)}else{b.$mjListPage.find(".co-table-list").find("thead").find(".jco-checkbox-all").attr("disabled",true)}var d=desknets.Resource.Message.com_listchk_cnt_some_disp;d=desknets.tmpl.replaceWordLF(d,"num"," "+e+" ");b.$mjListPage.find(".jco-span-chk-msg-page").html(d)},_initListEndChk:function(){var b=this;b.$mjListPage.find(".co-table-list").find("thead").delegate(".jco-checkbox-all","click",function(e){var c=(a(this).attr("checked"))?true:false;var d=0;b.$mjTableList.find("input[type=checkbox]").each(function(){var f=a(this);if(!f.attr("disabled")){f.attr("checked",c);if(c){f.closest("tr").addClass("co-tr-selected")}else{f.closest("tr").removeClass("co-tr-selected")}}});if(b.$mjListPage.find(".jco-sort-change").css("display")!="block"){if(c){b.$mjListPage.find(".co-chk-cnt-some").show();b.$mjListPage.find(".co-chk-cnt-all").hide()}else{b.$mjListPage.find(".co-chk-cnt-some").hide();b.$mjListPage.find(".co-chk-cnt-all").hide()}}});b.$mjListPage.find(".co-chk-cnt-some").find("a").click(function(c){c.preventDefault();b.$mjListPage.find(".co-chk-cnt-some").hide();b.$mjListPage.find(".co-chk-cnt-all").show()});b.$mjListPage.find(".co-chk-cnt-all").find("a").click(function(c){c.preventDefault();b.$mjListPage.find(".co-chk-cnt-all").hide();b.$mjListPage.find(".jco-checkbox-all").attr("checked",false);b.$mjTableList.find("input[type=checkbox]").attr("checked",false).end().find("tr").removeClass("co-tr-selected")})},_initListEndButton:function(){var b=this;b.callBase("_initListEndButton");b.$mjListPage.find(".jco-capacity-back-setadmin").click(function(e){e.preventDefault();var d={};var g=b._getModule();var f=b._getBackCmd();var h=desknets.getUrl(g);d.cmd=f;var c=desknets.getNeoParam(d);h=h+"?"+c;desknets.execLocation(h)});b.$mjListPage.find(".jco-list-enable-submit").click(function(c){b.mboEnable=true;b._listDelSubmit(c)});b.$mjListPage.find(".jco-list-disables-submit").click(function(c){b.mboEnable=false;b._listDelSubmit(c)})},_replaceListLine:function(c,e,d){var b=this;if(e=="assigngrp"){c=b._replaceGrpLine(c,e,d)}else{if(e=="size"){c=b._replaceSizeLine(c,e,d)}else{if(e=="capa"){c=b._replaceCapaLine(c,e,d)}else{c=b.callBase("_replaceListLine",c,e,d)}}}return c},_replaceGrpLine:function(c,f,e){var d=[];d=desknets.user.getListAssignGroups(e[f].Name);var b="";if(d.assigntitle!==""){b='<span title="'+d.assigntitle+'">'+d.assign+"</span>"}return desknets.tmpl.replaceWordHtml(c,f,b)},_replaceSizeLine:function(c,g,f){var b="";var d="jco-capa-noset";if(f[g]===""){b=desknets.Resource.setnot}else{var e=parseInt(f[g],10);b=desknets.numberFormat(e)+" MB";if(e>0){d="jco-capa-set"}}c=desknets.tmpl.replaceWordHtml(c,g,b);return desknets.tmpl.replaceWordHtml(c,"jco-capa-noset",d)},_replaceCapaLine:function(c,e,d){var b="";if(d[e]=="1"){b=desknets.Resource.capaenable}else{b=desknets.Resource.capadisables}return desknets.tmpl.replaceWordHtml(c,e,b)},_delNoChkMessage:function(){var b=this;if(b.mboEnable){return desknets.Resource.Message.com_capaenable_nochecked}return desknets.Resource.Message.com_capadisenable_nochecked},_delConfMessage:function(){var c=this;var b="";if(c.mboEnable){if(c.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message.com_capaenable_allconf}else{if(c.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){b=desknets.Resource.Message.com_capaenable_someconf}else{b=desknets.Resource.Message.com_capaenable_listconf}}return desknets.tmpl.replaceWordHtml(b,"count",c._getListCheckCount())}if(c.$mjListPage.find(".co-chk-cnt-all").css("display")=="block"){return desknets.Resource.Message.com_capadisenable_allconf}else{if(c.$mjListPage.find(".co-chk-cnt-some").css("display")=="block"){b=desknets.Resource.Message.com_capadisenable_someconf}else{b=desknets.Resource.Message.com_capadisenable_listconf}}return desknets.tmpl.replaceWordHtml(b,"count",c._getListCheckCount())},_getDelAddPrm:function(){var b=this;var c={};if(b.mboEnable){c.capa="1"}else{c.capa="0"}c.gid=b.$mjListPage.find(".jco-back-page-data").find('input[name="gid"]').val();return c},_getBackCmd:function(){return""}});(function(b){desknets.page(desknets,"PageCapacityInput",desknets.PageInputBase,{_initSet:function(){var c=this;c._initUserSelectDialog();c.callBase("_initSet")},_initUserSelectDialog:function(){var d=this;var g=b("#jco-capacity-sel-items-area");var c=g.find("table").find("thead").remove().html();var f={chooseTarget:["user"],allGroup:"choosable",unassignGroup:"choosable",cmdusers:desknets.CMD_CHOOSERMSETUSERSEL};var h=g.find(".co-table-set-list");h.hide();var e=function(){if(h.find("tr").length>0){h.show()}else{h.hide()}};desknets.chooser.setUpEntry(g,[],{dialogID:"jcapa-user-sel",initCreate:true,template:c,dialogOptions:f,change:e,extraVars:{user:{keyName:"id"}}})}})})(jQuery);desknets.page(desknets,"msetaccess",desknets.PageInputList,{_initListStart:function(){var b=this;b.callBase("_initListStart");var c={assign:true,onSelectGroupHide:true};var d={};var e=b.$mjListPage.find(".jco-sel-btn");if(e.data("type")=="assign"){d={cmdgroups:"constructmsetugroups",cmdgrouptree:"constructmsetcmdgrouptree",moduletype:e.data("module")}}else{d={allGroup:"choosable",unassignGroup:"choosable"}}desknets.page.groupSelect.init(c,d)},_replaceListLine:function(c,f,e){var b=this;if(f==desknets.user.KEY_ASSIGNGROUP){var d=[];d=desknets.user.getListAssignGroups(e[f].Name);c=desknets.tmpl.replaceWordHtml(c,f,d.assign);c=desknets.tmpl.replaceWordHtml(c,"assigngrptitle",d.assigntitle);return c}return b.callBase("_replaceListLine",c,f,e)},_listLine:function(c,d){var b=this;c=b.callBase("_listLine",c,d);if(!neo.isSet(d[desknets.user.KEY_ASSIGNGROUP])){var e=new RegExp("{{"+desknets.user.KEY_ASSIGNGROUP+"}}","ig");c=c.replace(e,"&nbsp;");e=new RegExp("{{assigngrptitle}}","ig");c=c.replace(e,"&nbsp;")}return c},_getListAjaxSuccess:function(c){var b=this;b.callBase("_getListAjaxSuccess",c);desknets.page.groupSelect.editSelectedGroup(a(".jco-sel-items"),c)}});desknets.page(desknets,"msetaccessentry",desknets.PageAccessInput,{_$uroot:null,_$userRoot:null,_$user:null,_initSet:function(c){var b=this;b.callBase("_initSet",c);b._initUserSelectDialog();b._switchDispAccTargetAdd(false);b._switchDispUserBox()},_initListButton:function(){var b=this;b.callBase("_initListButton");b.$mjPage.find(".jco-input-list-acc-entry").click(function(c){b._entryButtonAccData(c)});a("#"+b._getIdListArea()).find(".jco-input-list-acc-copy").click(function(c){b.dispUserSelButtonCPTarget(c)})},_switchDispAccTargetAdd:function(d){var c=this;var e=desknets.paramanalyzer.getHashParams();var b=a("#"+c._getIdListArea()).find(".jco-sel-btn");if(!neo.isSet(e.id)||d){c.$mjPage.find(".co-actionarea").find(".jco-input-list-add-hide").hide();b.show()}else{b.hide()}},_switchDispUserBox:function(){var c=this;var d=c.$mjPage.find(".co-setarea.co-editarea").find(".co-selmulti-btn._alluser");var b=c.$mjPage.find(".co-setarea.co-editarea").find(".co-selmulti-items-scroll");c._switchDispUserInfoBox(d,b);c._switchDispUsersArea(b,c._checkUserIdExist(b))},_checkUserIdExist:function(b){var d=false;if(!neo.isSet(b)){return false}var c=b.find('input[name="uid"]');c.each(function(){if(a(this).val().length>0){d=true;return false}});return d},_switchDispUsersArea:function(c,b){if(b){c.show()}else{c.hide()}c.find(".jco-userinfo-hide").hide()},_switchDispUserInfoBox:function(b,c){if(b.find(".jco-sel-btn").css("display")!="none"){c.find(".jco-user-box.box").addClass("co-selitem");c.find(".jco-user-box.close").addClass("co-btn-close")}else{c.find(".jco-user-box").removeClass("co-selitem co-btn-close")}},_entryButtonAccData:function(e){var c=this;var d=false;var b=c.$mjPage.find(".co-setarea.co-editarea").find(".co-selmulti-items-scroll");var f=c.$mjPage.find(".jco-sel-items").find('input[name="uid"]');f.each(function(){if(a(this).val().length>0){d=true;return false}});if(!d){e.preventDefault();var g=desknets.Resource.Message.com_set_nochecked;desknets.dialog.alert(g,{type:"warn"})}},dispUserSelButtonCPTarget:function(c){var b=this;b._switchDispAccTargetAdd(true);b._switchDispUserBox()},_initUserSelectDialog:function(){var b=this;b._$uroot=a("#"+b._getIdListArea());b._$userRoot=b._$uroot.find(".jco-sel-items").parent().parent();b._$user=b._$userRoot.find(".jco-sel-items");a(".jco-user-sel-item-tmpl").hide();b._$uroot.find("form").formSetUp({date:false});var c=this._getAccEntrySelectedUserOptions();desknets.chooser.setUpEntry(b.$mjPage,b._getSelectedUser(),c)},_getAccEntrySelectedUserOptions:function(){var b=this;return{initCreate:true,template:a(".jco-user-sel-item-tmpl").remove().html(),dialogOptions:b._getUserSelectDialogOptions(),dialogID:"jco-selaccuser-chooser-dialog",change:function(){b._onSelectAccessTargetUsers()}}},_getSelectedUser:function(){var c=this;var b=[];b=desknets.chooser.getItemsFromElement(a(".jco-sel-items"));return b},_getUserSelectDialogOptions:function(){var b=this;var c={mode:"multi",allGroup:"readonly",unassignGroup:"readonly",chooseTarget:["user"],editDescendant:true,cmdusers:desknets.CMD_CHOOSERMSETUSERSEL};return c},_onSelectAccessTargetUsers:function(){var b=this;b._switchDispUserBox()},_isMSetCmd:function(){return true},_getSelDialogOptions:function(){var b=this;var d={allGroup:"readonly",unassignGroup:"readonly"};var c=b.callBase("_getSelDialogOptions");a.extend(c,d);return c}});desknets.page(desknets,"DialogAccess",desknets.PageAccess,{_options:{},_boUseAjaxForm:true,$dialog:null,_msTableHtml:"",mbMSetCmd:false,itemClass:"co-selitem",init:function(d,c){var b=this;if(c===false){b._boUseAjaxForm=false}else{if(neo.isSet(d)){b._options=a.extend({},d)}}b.callBase("init");b.addClassListHead();b.addClassListBody()},_initBeforeUnload:function(){},_initPageView:function(){},addClassListHead:function(){var c=this;if(c._boAddOnly){var b=c._$listTable.find("thead").find("th");b.eq(1).addClass("co-th-acc-user-2of4").removeClass("co-th-acc-user");b.eq(2).addClass("co-th-acc-busyo-2of4").removeClass("co-th-acc-busyo");b.eq(4).removeClass("co-th-acc-access-all")}},addClassListBody:function(){var c=this;var b=c._$listTable.find(".co-tbody-list");var d=b.find("tr");d.each(function(){var e=a(this).find("td");if(c._boAddOnly){e.eq(1).addClass("co-td-acc-user-2of4");e.eq(2).addClass("co-td-acc-busyo-2of4");e.eq(3).addClass("co-td-gcond")}else{e.eq(1).addClass("co-td-acc-user");e.eq(2).addClass("co-td-acc-busyo");e.eq(3).addClass("co-td-gcond")}})},_initSetAjaxFrom:function(){var b=this;var c={};if(b._boUseAjaxForm){c=b._getAjaxFormAccsOption();desknets.ajax.submitForm(a("#Accessfrm"),c)}},_getAjaxFormAccsOption:function(){var c=this;var b=a("#jco-acc-list-container");var d={};a.extend(d,c._options);return d},_listNodata:function(){var b=this;b.callBase("_listNodata");b._$listArea.find(".co-table-list-scroll").hide()},_listView:function(){var b=this;b.callBase("_listView");b._$listArea.find(".co-table-list-scroll").show()},_onSelectAccessAssignItems:function(c){var b=this;b.callBase("_onSelectAccessAssignItems",c);b.addClassListBody()},_getChoosePrivateGroup:function(){var b=this;if(b._isMSetCmd()){return""}return"readonly"},_setTitle:function(c,b){return},setUp:function(d){var c=this;if(d.msetcmd===true){c.mbMSetCmd=true}c._options=a.extend({},d);if(!c._options.idFldName){c._options.idFldName="id"}if(!neo.isSet(c._options.bosubmitcommit)){c._options.bosubmitcommit=true}if(c.$dialog!==null){c.$dialog.remove();c.$dialog.dialog("destroy");c.$dialog=null}if(neo.isSet(c._options.area)){var b=c._options.area.find(".jco-acc-dialog-set");var f;c._options.area.find('input[type="button"]').click(function(){c.openDialog()});f=b.find("."+c.itemClass);if(f.length>0){var e=a.extend({},f);b.empty();b.append(e)}}},openDialog:function(){var b=this;if(b.$dialog!==null){if(b._msTableHtml!=""){b.$dialog.find(".jco-acc-list-container").html(b._msTableHtml);b._listSet()}else{b._msTableHtml=b.$dialog.find(".jco-acc-list-container").html()}if(a.isFunction(b._options.beforeopen)){b._options.beforeopen()}else{b.$dialog.dialog("open")}}else{b.createAccessDlg()}},createAccessDlg:function(){var b=this;var e=function(f){b._options.dialoghtml.html(f);b._onAccessDlg();b._initFolderAccessDlg();b._msTableHtml=b.$dialog.find(".jco-acc-list-container").html()};var c=function(h){var f=desknets.ajax.chkAjaxHtmlError(h);if(f.status=="ok"){e(h)}else{var g=desknets.dialog.alert(f.message,{errorNo:f.no})}};var d={dataType:desknets.ajax.RESTYPE_HTML,url:desknets.getUrl(b._options.module),data:b._options.param,success:c};desknets.ajax.rest(d)},_onAccessDlg:function(){var b=this;b.$dialog=a("#jco-acc-list-container");var c={buttons:{},width:700,title:desknets.Resource.setAccess};if(b.$dialog.length==0){b.$dialog=a(".err")}c.buttons[b._getSaveBtnLabel()]=function(){b._msTableHtml="";b.onSetAccess()};c.buttons[desknets.Resource.CancelButtonLabel]=function(){a(this).dialog("close")};desknets.dialog.setUp(b.$dialog,c);b.$dialog.dialog("open");desknets.dialog.setFirstDialogOpen(b.$dialog)},_getSaveBtnLabel:function(){var b=this._options;return desknets.Resource.OKButtonLabel},onSetAccess:function(){var b=this;b._onSelectAccess(b.$dialog);b.$dialog.dialog("close")},_onSelectAccess:function(c){var d=this;var b=d._options.area.find(".jco-acc-dialog-set");var f=c.find(".jco-acc-list-container").find("tr");var e="";if(d._onSelectModChkAccess(c)){d._options.area.find('input[name="changeacc"]').val("1");b.empty();a.each(f,function(g,j){var k={};var h=a(this);k.Name=h.find(".jco-sel-item").data("name");k.id=h.find("td").eq(0).find("input[name=id]").val();k.accesskind=h.find("td").eq(0).find('input[name="accesskind"]').val();k.condition=h.find("td").eq(0).find('input[name="condition"]').val();if(k.id.charAt(0)=="g"){k.description=h.find("td").eq(2).children("span").eq(0).text()}e=e+d._changAccessToEntry(k)});b.html(e);if(a.isFunction(d._options.afteraccchg)){d._options.afteraccchg()}}},_onSelectModChkAccess:function(f){var m=this;var g=m._options.area.find("."+m.itemClass);var i=f.find(".jco-acc-list-container").find("tr");var c=g.length;var l=i.length;if(c==l){if(c==0){return false}var k;var h;var e;var d;for(k=0;k<c;k++){e=true;d=i.eq(k).find('input[name="'+m._options.idFldName+'"]').val();var b=i.eq(k).find('input[name="accesskind"]').val();var j=i.eq(k).find('input[name="condition"]').val();for(h=0;h<l;h++){if(d==g.eq(h).find('input[name="'+m._options.idFldName+'"]').val()&&b==g.eq(h).find('input[name="accesskind"]').val()&&j==g.eq(h).find('input[name="condition"]').val()){e=false}}if(e){return true}}return false}return true},_changAccessToEntry:function(e){var b=desknets.tmpl.escapeWord(e.Name);var d;if(neo.isSet(e.description,{blank:false})){d=desknets.tmpl.escapeWord(e.description)+"-"+b}else{d=b}var c='<span class="'+this.itemClass+'"><span title="'+d+'">'+b+'</span><input type="hidden" name="'+this._options.idFldName+'" value="'+e.id+'"><input type="hidden" name="accesskind" value="'+e.accesskind+'"><input type="hidden" name="condition" value="'+e.condition+'"></span>';return c},_initFolderAccessDlg:function(){this.init()},_isMSetCmd:function(){return this.mbMSetCmd}});desknets.DialogGuideList={_$dialog:{},init:function(b,d,c){this._sendDlgAjax(b,d,c)},setUp:function(b,d,c){if(this._$dialog[d]){this._$dialog[d].dialog("open")}else{this.init(b,d,c)}},_sendDlgAjax:function(e,g,f){var b=this;var c;var d;c=desknets.getUrl(desknets.MODULE_API_MAIN);d=desknets.ajax.arrayToMultiCmdData(this._getDlgAjaxReq(e,g));desknets.ajax.rest({id:this._getDlgID(g),url:c,data:d,type:"POST",success:function(i,h,j){if(i[0]["status"]!=desknets.RES_STATUS_SUCCESS){desknets.dialog.alert(i[0]["errormessage"],{errorNo:i[0]["errorno"]})}else{b._onSuccessDlg(i,g,f)}}})},_getDlgAjaxReq:function(d,f){var c;var b={};var e=0;c={};c.cmd=f;b[e]=c;e++;c={};c.cmd=d;b[e]=c;e++;return b},_onSuccessDlg:function(b,d,e){var c;c=this._setDlgHtml(b[1],d,e);if(!c){return}this._setlDlgList(b[0],d);this._$dialog[d].dialog("open")},_setDlgHtml:function(c,d,e){var b=c.html;if(!neo.isSet(b)){desknets.ajax.onError(c.errorno,c.errormessage);this._dataError=true;return false}this._$dialog[d]=desknets.dialog.make(this._getDlgID(d),this._getDialogOption(d,e));this._$dialog[d].append(b);return true},_getDlgID:function(b){return"jcomset-"+b},_setlDlgList:function(f,c){var g,k;var e,j;var h;var d=this._$dialog[c];var i;var b=[];g=desknets.ajax.getJsonItems(f);h=d.find(".co-tbody-list");i=h.html();h.empty();e=g.length;for(j=0;j<e;j++){k=g[j];b[b.length]=this._listLine(i,k)}h.html(b.join(""))},_listLine:function(c,d){var b="";for(b in d){c=desknets.tmpl.replaceWord(c,b,d[b])}return c},_getDialogOption:function(f,g){var b=this;var e={};e[desknets.Resource.CloseButtonLabel]=function(){b._$dialog[f].dialog("close")};var d=desknets.dialog.getDialogOption();var c={title:g,width:400,buttons:e};a.extend(d,c);return d}};(function(b){desknets.page(desknets.folderlist,"AccessAuth",desknets.DialogAccess,{$_uselDlg:null,_getSelDialogOptions:function(){var c=this;var e={choose:function(f){c.$_uselDlg=b(this);desknets.submitform.setDialogDisabled(c.$_uselDlg);c._onSelectAccessAssignItems(f);return false}};var d=c.callBase("_getSelDialogOptions");b.extend(d,e);return d},_onSelectAccessAssignItems:function(d){var c=this;c._onSelectAccessAuth(d)},_onSelectAccessAuth:function(d){var c=this;var e=desknets.getUrl(c._getRestModule());desknets.ajax.rest({url:e,data:c._getRequestAccsAuthParams(d),success:function(g,f,h){c._onSuccessAccessAuth(d,g)},complete:function(g,f){if(neo.isSet(c.$_uselDlg)){desknets.submitform.clearDialogDisabled(c.$_uselDlg);desknets.chooser.close(c.$_uselDlg,true)}c.$_uselDlg=null},traditional:true})},_onSuccessAccessAuth:function(d,e){var c=this;d=c._setAccessAuthId(d,e);c.callBase("_onSelectAccessAssignItems",d)},_getRestModule:function(){return""},_getRequestAccsAuthCmd:function(){return""},_getRequestAccsAuthParams:function(g){var f=this;var j={};var e=[];var d=[];var c=[];var i;var h=f._getRequestAccsAuthCmd();i=f._getTargetIDAccsAuth();j={cmd:h,folder:i};b.each(g,function(k,l){var n;var m=l.type.substring(0,1);n=l.id;if(m=="u"){e[e.length]=n}else{if(m=="g"){d[d.length]=n}else{if(m=="r"){c[c.length]=n}}}});if(e.length>0){j.uid=e}if(d.length>0){j.gid=d}if(c.length>0){j.rid=c}return j},_getTargetIDAccsAuth:function(){return b("#jco-acc-list-container").find("input[name=folder]").attr("value")},_setAccessAuthId:function(f,g){var e=this;var c=b("#jco-acc-list-container");var j="";var h=false;var d={};var i=[];if(g.limit&&g.limit=="1"){h=true;j=desknets.Resource.Message.com_folder_accsauth}c.find("div.jco-accessauth-msg").html(j);if(h==false){return f}if(g.list&&g.list.item){d=b.isArray(g.list.item)?g.list.item:[g.list.item];b.each(d,function(k,m){var l=m.type;var n=m.id;b.each(f,function(p,q){var r=q.type.substring(0,1);var o=q.id;if(l==r&&n==o){i.push(q)}})})}return i}})})(jQuery);app.addInitialAction(function(){desknets.coreset.init()})})(jQuery);