/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(c){var a={convertMail:true,convertPhone:false,convertPhoneOnly:false,convertURL:true,urlTarget:"_blank",urlSchemas:["http","https"]};c.detectHref={urlPatternAfterSchema:":\\/\\/[\\w%_!~\\-\\.\\*\\(\\);:@&=\\/\\?\\+\\$\\,#]+",mailPattern:"[\\w\\.\\-_]+@[\\w\\-\\._]+\\w",mailtoPattern:"mailto:[\\w\\.\\-_]+@[\\w\\-\\._]+\\w(\\?[^\\r\\n]*)?",phonePattern:"[\\d\\*#]+[\\d\\*#\\-]*\\-+[\\d\\*#]+",phonePatternTel:"tel:[\\d\\*#\\-]*[\\d\\*#]+",phonePatternOnly:"[\\d\\*#]+",convertTextNode:function(h,f){var e=this;var g=e._splitTextToTokens(h.data,f);c.each(g,function(i,j){e._insertWithToken(h,j,f)});h.parentNode.removeChild(h)},_splitTextToTokens:function(i,f){var g,e;var h=[{type:"text",content:i}];if(f.convertURL){e=f.urlSchemas.join("|");g=new RegExp("("+e+")"+this.urlPatternAfterSchema);h=this._getTokensFromTokens(h,"url",g)}if(f.convertMail){g=new RegExp(this.mailtoPattern);h=this._getTokensFromTokens(h,"mailto",g);g=new RegExp(this.mailPattern);h=this._getTokensFromTokens(h,"mail",g)}if(f.convertPhone){g=new RegExp(this.phonePatternTel);h=this._getTokensFromTokens(h,"phone",g);g=new RegExp(this.phonePattern);h=this._getTokensFromTokens(h,"phone",g)}if(f.convertPhoneOnly){g=new RegExp(this.phonePatternTel);h=this._getTokensFromTokens(h,"phone",g);g=new RegExp(this.phonePattern);h=this._getTokensFromTokens(h,"phone",g);g=new RegExp(this.phonePatternOnly);h=this._getTokensFromTokens(h,"phone",g)}return h},_getTokensFromTokens:function(h,f,g){var e=this,i=[];c.each(h,function(k,j){if(j.type=="text"){var l=e._getTokensFromText(j.content,f,g);c.merge(i,l)}else{i.push(j)}});return i},_getTokensFromText:function(j,e,h){var i=[];var g=j.match(h);while(!!g&&!!g[0]){var f=String(g[0]);if(g.index>0){i.push({type:"text",content:j.substring(0,g.index)})}i.push({type:e,content:f});j=j.substring(g.index+f.length);g=j.match(h)}if(j.length>0){i.push({type:"text",content:j})}return i},_insertWithToken:function(i,g,f){var h,e,j=g.content;if(g.type=="text"){h=document.createTextNode(j);i.parentNode.insertBefore(h,i)}else{if(g.type=="url"){h=this._insertWithValues(i,j,j,f.urlFilter);h.target=f.urlTarget}else{if(g.type=="mail"){e="mailto:"+j;this._insertWithValues(i,j,e,f.mailFilter)}else{if(g.type=="mailto"){e=j;this._insertWithValues(i,j,e,f.mailFilter)}else{if(g.type=="phone"){e="tel:"+g.content.replace(/[^0-9*#]/g,"");this._insertWithValues(i,j,e,f.phoneFilter)}}}}}},_insertWithValues:function(h,i,e,f){var g=document.createElement("A");g.href=e;h.parentNode.insertBefore(g,h);c(g).text(i);if(typeof f=="function"){f(g)}return g}};var b={init:function(e){this.each(function(){d.convertElement(this,e)})}};var d={convertElement:function(f,e){var g=c.merge([],f.childNodes);c.each(g,function(h,j){if(j.nodeType==1&&j.tagName!="A"){d.convertElement(j,e)}else{if(j.nodeType==3||j.nodeType==4){c.detectHref.convertTextNode(j,e)}}})}};c.fn.detectHref=function(h){var i=typeof h=="string";if(i){var f=Array.prototype.slice.call(arguments,1);return b[h].apply(this,f)}var e=(typeof(h)=="object")?h:{};var g=c.extend({},a,e);return b.init.apply(this,[g])}})(jQuery);