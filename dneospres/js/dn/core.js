/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){a.extend(desknets,{MODULE_MAIN:"dneo",MODULE_API_MAIN:"dneor",MODULE_REFER:"zrefer",MODULE_API_OPT:"zropt",MODULE_HTML_MAIN:"zhtml",DIR_RESHOME:"dneores",CMD_DOWNLOAD:"referdownload",CMD_TMPLHTML:"tmplhtml",COOKIENAME_SESSION_ID:"dnzSid",COOKIENAME_STOKEN:"dnzToken",COOKIENAME_ATTACH_IE_FLASH:"dnzAttFlash",COOKIENAME_LOGIN_INFO:"dnzInfo",ERRORNO_MAILSELTRANSMIT:-40007,PRM_VAL_ALLDEL:"all",CACHE_VERSION:"3.5.0.0",CACHE_RTE_VERSION:"3.5.0.0",msUrl:"",msSubDirectory:"",msModuleName:"",RES_STATUS_SUCCESS:"ok",merrMsgConnect:'<span class="co-colon-span">:</span>',_msExtension:"",_initSetUp:function(){var c=this;var g=document.URL;var e=0;var d="";var i="";var h="";var f="";var b="";e=g.indexOf("?");if(e>0){g=g.substring(0,e)}e=g.lastIndexOf("/");if(e>=0){d=g.substring(0,e+1);c.msUrl=d;i=g.substring(e+1,g.length);e=i.lastIndexOf(".");if(e>=0){h=i.substring(0,e);c.msModuleName=h;f=i.substring(e+1,i.length);c._msExtension=f}e=d.indexOf("//");if(e>=0){b=d.substring(e+2,d.length);e=b.indexOf("/");if(e>=0){b=b.substring(e,b.length);c.msSubDirectory=b}}}},getUrl:function(b){var c=this;var d=0;var e="";if(typeof(b)==="string"){e=b}if(e!==""&&c._msExtension){e=e+"."+c._msExtension}return c.msUrl+e},getExtension:function(){return this._msExtension},createRandomId:function(){var b=""+(new Date()).getTime()+parseInt(Math.random()*10000);return b},formatFileSize:function(d,b){var c=Number(d);if(isNaN(d)||d<0){return desknets.Resource.attachInvSize}c=Math.ceil(c/1024);return desknets.numberFormat(c)+" KB"},numberFormat:function(c){var b=[];var d="";if((c.toString()).indexOf(".")!=-1){b=(c.toString()).split(".")}else{b[0]=c;b[1]=""}d=new String(b[0]).replace(/,/g,"");while(d!=(d=d.replace(/^(-?\d+)(\d{3})/,"$1,$2"))){}if(b[1].length>0){d=d+"."+b[1]}return d},getDataAttr:function(b,c){return b.attr("data-"+c)},setDataAttr:function(b,c,d){return b.attr("data-"+c,d)},zeroPadding:function(c,b){var d=c.toString();while(d.length<b){d="0"+d}return d},escape:function(b){return b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescape:function(b){return b.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},escapeValue:function(b){return b.replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")},escapeSpace:function(d,c){var b;if(c){b="\u00A0"}else{b="&nbsp;"}d=d.replace(/^ /gm,b);return d.replace(/  /g," "+b)},encodeURIComponentNeo:function(b){if(typeof(b)==="string"){return encodeURIComponent(b).replace(/'/g,"%27")}else{return encodeURIComponent(b)}},decodeURIComponentNeo:function(b){b=b.replace(/\+/g," ");try{return decodeURIComponent(b)}catch(c){return b}},getNeoParam:function(f){var h="";var b=[];for(var d in f){var c=f[d];if(!(c instanceof Array)){c=[c]}for(var e=0;e<c.length;e++){var g=c[e];if(g!=null){var j=desknets.encodeURIComponentNeo(g);b.push(d+"="+j)}}}h=b.join("&");return h},splitParam:function(f){var g={};f=f.substr(f.indexOf("?")+1,f.length);if(f==""){return{}}var b=f.split("&");for(var d=0;d<b.length;d++){b[d]=b[d].split("=");if(!neo.isSet(b[d][0],{blank:false})||!neo.isSet(b[d][1])){continue}var c=b[d][0];var e=desknets.decodeURIComponentNeo(b[d][1]);if(neo.isSet(g[c])){if(g[c] instanceof Array){g[c].push(e)}else{g[c]=[g[c],e]}}else{g[c]=e}}return g},parseErrorInfo:function(d,c){var b={level:"error",message:d};var e={E:"error",W:"warn",M:"message"};if(d.charAt(1)==":"){b.level=e[d.charAt(0)];b.message=d.substring(2)}if(!!c&&b.level=="error"){var f="";if(typeof c==="number"&&c>=500){f="HTTP"}b.message+="\n["+f+String(c)+"]"}else{if(!!c&&c===this.ERRORNO_MAILSELTRANSMIT){b.message+=this.getErrMailTransmitMsg()}}return b},getErrMailTransmitMsg:function(){return""},getErrField:function(d,f){var e={};var b="";var c="";if(d==neo.ajax.NEOAJAX_OBJXML){c=f.find("errormessage").text();b=f.find("errmsgadd").text()}else{c=f.errormessage;b=f.errmsgadd}e.fieldid=b;e.msg=c;return e},getErrFieName:function(c,b){var d="";d=c.find(".jco-input-"+b).closest("td").prev().find(".co-colon").eq(0).text();if(neo.isSet(d)&&d.length>0){d=d+desknets.merrMsgConnect}return d},getErrConvMsg:function(f){var b=f.msg;var d=f.fieldid;var e=f.fieldname;var c="";if(neo.isSet(d)){if(neo.isSet(e)&&e.length>0){if(b.charAt(1)==":"){c=b.substring(0,2);b=b.substring(2)}return c+e+b}}return b},saveHashCmdCookie:function(c){var b=this;a.cookie(desknets.COOKIENAME_HASHCMD_FLG,c)},saveCookie:function(d,f,c){var b=this;var e={};if(typeof(c)=="object"){a.extend(e,c)}if(!e.path&&!!b.msSubDirectory){e.path=b.msSubDirectory}a.cookie(d,f,e)},saveCookieToDisk:function(c,e){var d=new Date(2050,11,31,23,59,59);var b=this;b.saveCookie(c,e,{expires:d})},convertToSafeHtml:function(c,b){var d=a.extend({allowedFrameUri:["http://www.youtube.com/","http://libura.com/","https://www.youtube.com/","https://libura.com/"],allowedSchemas:["http","https","file","mailto","ftp"]},b);return neo.html.convertToSafeHtml(c,d)}});(function(c){var b=c(document.documentElement);desknets.browser={};desknets.browser.msie=b.hasClass("co-browser-IE");desknets.browser.msie8=b.hasClass("co-browser-IE-8");desknets.browser.msie9=b.hasClass("co-browser-IE-9");desknets.browser.msie11=b.hasClass("co-browser-IE-11");desknets.browser.firefox=b.hasClass("co-browser-Firefox");desknets.browser.chrome=b.hasClass("co-browser-Chrome");desknets.browser.safari=b.hasClass("co-browser-Safari");desknets.browser.ipad=b.hasClass("co-device-iPad");desknets.browser.android=b.hasClass("co-device-Android");desknets.browser.tablet=desknets.browser.ipad||desknets.browser.android;desknets.browser.edge=b.hasClass("co-browser-Edge");desknets.support={};desknets.support.cssTransform=neo.supportStyle("transform");desknets.support.cssTransition=neo.supportStyle("transition");desknets.support.cssPositionFixed=neo.supportStyle("position","fixed")})(jQuery);desknets.ajax={RESTYPE_JSON:"json",RESTYPE_HTML:"html",REQTYPE_MULTI:"multi",REQTYPE_SINGLE:"single",_showErrorDialog:true,numberForStatus:{parsererror:1000,abort:1001},onError:function(b,c){if(this._showErrorDialog&&b!=this.numberForStatus.abort){desknets.dialog.alert(c,{errorNo:b})}},rest:function(b){if(typeof b.data=="object"&&b.processData!==false){if(b.allowCsrfTempl!==false){this._addParamForCsrf(b.data)}delete b.allowCsrfTempl;if(b.allowCacheTempl!==false){this._addParamForNoCache(b.data)}delete b.allowCacheTempl}this._setUpOptions(b);neo.ajax.rest(b)},getJsonItems:function(b){if(!b||!b.list){return[]}else{return this.getItems(b.list.item)}},getItems:function(b){if(!b){return[]}else{if(!a.isArray(b)){return[b]}else{return b}}},arrayToMultiCmdData:function(c){var b={};a.each(c,function(d,e){b[d.toString()]=e});return{multicmd:JSON.stringify(b)}},addParamForCsrf:function(b){this._addParamForCsrf(b)},addParamForNoCache:function(b){this._addParamForNoCache(b)},getErrorNumber:function(c,b){if(c.status!=0){return c.status}else{return this.numberForStatus[b]||0}},_setUpOptions:function(c){var b=this;if(typeof(c.dataType)!=="string"){c.dataType="json"}if(!a.isFunction(c.error)){c.error=function(e,d,f){b.onError(b.getErrorNumber(e,d),f)}}},_addParamForCsrf:function(c){var b=a.cookie(desknets.COOKIENAME_STOKEN);if(!!b&&!c[b]){c[b]="1"}},_addParamForNoCache:function(c){var b=desknets.createRandomId();if(!!b&&!c[b]){c[b]=""}},initSetUp:function(){var b=this;neo.ajax.defaultOptions.beforeSend=function(d,c){b.extendRequestUrl(c)}},extendRequestUrl:function(d){var c=this;if(typeof d.url=="string"&&typeof d.data=="string"){var g="",b=250,f=d.data.match(/^(.*&)?multicmd=([^&]+)/);var h=!!f?JSON.parse(neo.decodeURIComponent(f[2])):null;if(!!h){for(var e=0;!!h[e.toString()];e++){g+=e+"/"+c.getPath(h[e.toString()])}}else{g=c.getPath(neo.parseQueryString(d.data))}if(g.length>0){g=d.url+"/"+g;f=g.match(/^((\w+:\/\/[^/]+)?\/)?([^/]*\/){0,10}/);if(!!f){g=f[0]}if(g.length>b){g=g.substring(0,b).replace(/\/[^/]*$/,"/")}d.url=g}}},getPath:function(f){var b=this;var e="",d;if(!!f.cmd){e+=f.cmd+"/";for(var c in f){if(!!c.match(/^(\w+_)?id$/)){d=typeof f[c]=="object"?"%5B...%5D":f[c];if(!!d){e+=c+"/"+d+"/"}}}}return e},};desknets.dateTime={current:new Date(2000,0,1),_dtTimer:null,init:function(){var b=this;var c=neo.dateTime.parse(a("#jco-servertime").val());if(!!c){b.setDateTime(c);a(document).bind("ajaxComplete",function(e,f,d){b._updateWithServerTime(f)})}},setDateTime:function(b){var c=this.current;this.current=b;this._updateDateTimeAtNextMinute(b);if(neo.dateTime.compareOn(c,b,"minute")!=0){a(document).trigger("minuteChanged.desknets")}},moveDate:function(c,d){var b=neo.dateTime.parse(c);if(b==null){return null}b=neo.dateTime.moveDate(b,Number(d));return neo.dateTime.format("yyyyMMdd",b)},moveMonth:function(c,b){c=String(c).substr(0,6);return this.computeMonth(c,b)},computeMonth:function(d,b){var c=neo.dateTime.parse(String(d));if(c==null){return null}c=neo.dateTime.moveMonth(c,Number(b));return neo.dateTime.format("yyyyMMdd",c)},formatDate:function(d,c){var e=desknets.Resource.dateFormat;var b=desknets.dateTime.current;if(a.type(c)!="date"){c=neo.dateTime.parse(c)}if(d=="s"&&b.getFullYear()==c.getFullYear()){e=desknets.Resource.shortDateFormat}return neo.dateTime.format(e,c)},formatDateTime:function(d,c){var e=desknets.Resource.dateTimeFormat;var b=desknets.dateTime.current;if(a.type(c)!="date"){c=neo.dateTime.parse(c)}if(d=="s"&&b.getFullYear()==c.getFullYear()){e=desknets.Resource.shortDateTimeFormat}return neo.dateTime.format(e,c)},formatHour:function(e,d){var c="20120101"+d;var b=neo.dateTime.parse(c);return neo.dateTime.format(e,b)},dispDateTime:function(f,c){var e;if(!neo.isSet(f,{blank:false})){return"&nbsp;"}e=neo.dateTime.parse(f);if(jQuery.type(c)==="string"){return neo.dateTime.format(desknets.Resource[c],e)}else{var d=false;if(f.length>=12){d=true}else{if(f.length>=8){d=false}else{return"&nbsp;"}}var b={type:""};if(neo.isSet(c)){a.extend(b,c)}if(b.type=="list"){if(d){return desknets.dateTime.dispListDateTime("datetime",e)}else{return desknets.dateTime.dispListDateTime("date",e)}}else{if(d){c="longDateTimeFormat"}else{c="longDateFormat"}return neo.dateTime.format(desknets.Resource[c],e)}}},dispListDateTime:function(d,c){var e=desknets.Resource.dateFormat;var b=desknets.dateTime.current;if(a.type(c)!="date"){c=neo.dateTime.parse(c)}if(b.getFullYear()==c.getFullYear()){if(d=="datetime"){e=desknets.Resource.shortDateTimeFormat}else{e=desknets.Resource.shortDateFormat}}else{if(d=="datetime"){e=desknets.Resource.dateTimeFormat}else{e=desknets.Resource.dateFormat}}return neo.dateTime.format(e,c)},_updateDateTimeAtNextMinute:function(d){var c=this;var b=(60-d.getSeconds())*1000-d.getMilliseconds();var e=new Date(d.getTime()+b);if(!!c._dtTimer){clearTimeout(c._dtTimer)}c._dtTimer=setTimeout(function(){c._dtTimer=null;c.setDateTime(e)},Math.max(b,100))},_updateWithServerTime:function(d){var c=neo.ajax.getDataValue(d,"servertime");var b=neo.dateTime.parse(String(c));if(!!b){this.setDateTime(b)}},};desknets.tmpl={replaceWordChk:function(d,c,b){if(neo.isSet(b)){return this.replaceWord(d,c,b)}else{return this.replaceWord(d,c,"")}},replaceWordChkHtml:function(d,c,b){if(neo.isSet(b)){return this.replaceWordHtml(d,c,b)}else{return this.replaceWordHtml(d,c,"")}},replaceWordLF:function(b,c,d){d=this.escapeWordLF(d);return this.replaceWordHtml(b,c,d)},replaceWord:function(b,c,d){d=this.escapeWord(d);return this.replaceWordHtml(b,c,d)},replaceWordHtml:function(b,d,f){var c=new RegExp("{{"+d+"}}","ig");try{return b.replace(c,function(e,h,i){return f})}catch(g){alert(g)}},escapeWord:function(b){if(typeof b=="string"){b=desknets.escape(b);b=desknets.escapeValue(b);b=desknets.escapeSpace(b)}return b},escapeWordLF:function(b){b=this.escapeWord(b);b=b.replace(/\r\n/g,"<br />");b=b.replace(/(\n|\r)/g,"<br />");return b},dispStr:function(b){var c;if(neo.isSet(b,{blank:false})){c=desknets.tmpl.escapeWordLF(b)}else{c="&nbsp;"}return c},dispItems:function(j,o,e,f,d){var h="";var k=[];var i=[];if(!j||!j.item){return"&nbsp;"}k=desknets.ajax.getItems(j.item);if(k.length==0){return"&nbsp;"}if(o!=undefined){if(!(!o||!o.item)){i=desknets.ajax.getItems(o.item)}}for(var n=0;n<k.length;n++){var p="";var m="";var c=k[n];if(n!=0){if(d==undefined){p=",&#x0A;"}else{p=d}}if(c.val!=undefined){m=desknets.tmpl.escapeWord(c.val)}p=p+m;if(i.length>n){var g="";var b=i[n];if(b.val){g=desknets.tmpl.escapeWord(b.val)}if(g.length>0){if(e){var l=desknets.tmpl.replaceWordChkHtml(e,f,g);p=p+l}else{p=p+"("+g+")"}}}h=h+p}return h},dispMember:function(b){if(neo.isSet(b,{blank:false})){return desknets.tmpl.replaceWord(desknets.Resource.members,"members",b)}else{return"&nbsp;"}},CreateNameDelimValueHtml:function(b,c){if(desknets.Resource.code!="ja_JP"){return(b+": "+c)}return(b+" : "+c)},CreateNameDelimValue:function(b,c){if(desknets.Resource.code!="ja_JP"){return this.escapeWordLF(b+":&nbsp;"+c)}return this.escapeWordLF(b+"&nbsp;:&nbsp;"+c)}};desknets.rte={convertForShow:function(c,b){c=this._convertImageSrcToLoad(c,b);c=desknets.convertToSafeHtml(c);return c},_convertImageSrcToLoad:function(d,c){var b=this;var e=d.replace(/<a\s[^>]*>/ig,function(f){return f.replace(/href="([^"]+)"/i,function(g,h){var i=desknets.tmpl.replaceWordHtml(h,"ext",desknets.getExtension());if(!!c&&typeof c.convertToLoad=="function"){i=c.convertToLoad(i)}return'href="'+i+'"'})});d=e;var e=d.replace(/<video\s[^>]*>/ig,function(f){return b._convertSrcToLoad(f,c)});d=e;var e=d.replace(/<audio\s[^>]*>/ig,function(f){return b._convertSrcToLoad(f,c)});d=e;var e=d.replace(/<embed\s[^>]*>/ig,function(f){return b._convertSrcToLoad(f,c)});d=e;return d.replace(/<img\s[^>]*>/ig,function(f){return b._convertSrcToLoad(f,c)})},_convertSrcToLoad:function(c,b){return c.replace(/src="([^"]+)"/i,function(d,e){var f=desknets.tmpl.replaceWordHtml(e,"ext",desknets.getExtension());if(!!b&&typeof b.convertToLoad=="function"){f=b.convertToLoad(f)}return'src="'+f+'"'})},};desknets.attachDisp={_TMP_ATTACHAREA:'<div class="jco-attach-area co-tp-e-file"><table class="co-selfile"><tbody>{{tmpl}}</tbody></table></div>',disp:function(f,b,c){var l=this;if(!f||!f.item){return"&nbsp;"}var e="";var d,j;var h={};if(b!=null){b=desknets.getUrl(b)}var g=desknets.ajax.getItems(f.item);var i=desknets.getNeoParam(c);d=g.length;if(d==0){return"&nbsp;"}h.cgi=b;h.query=i;for(j=0;j<d;j++){var k=l.editDispItem(j,g[j],h);e=e+k}if(j>0){e=desknets.tmpl.replaceWordHtml(l._TMP_ATTACHAREA,"tmpl",e)}return e},editDispItem:function(f,g,e){var i=this;var h="",b,j="";var c=desknets.tmpl.escapeWord(g.attachdisp);var d=desknets.tmpl.escapeWord(encodeURIComponent(g.attachdisp.replace(/'/g,"%27")));if(g.size){j=desknets.attachDisp.getSize(g.size)}else{j=desknets.Resource.attachInvSize}if(e.cgi==null){h="<td>"+c+'</td><td class="co-td-num">'+j+"</td>"}else{b=e.cgi+"?"+e.query+"&fno="+g.id+"&filename="+d;h='<td><a target="attach" href="'+b+'">'+c+'</a></td><td class="co-td-num">'+j+"</td>"}h="<tr>"+h+"</tr>";return h},dispDelimited:function(){return",\n"},getSize:function(b){return desknets.formatFileSize(b,{minUnit:"KB",maxUnit:"KB"})}};(function(b){desknets.page=function(e,h,f,d){var g={callBase:function(m){var l=this;function n(p,q){for(var o in p){if(p[o]==q){return true}}return false}function k(p,q){for(var o=p;!!o;o=o._baseClass){if(n(o,q)){return o._baseClass}}return null}function j(q,p){for(var o=q;!!o;o=o._baseClass){if(b.isFunction(o[m])){return o[m].apply(l,p)}}throw"No method in base class"}return j(k(this._thisClass,arguments.callee.caller),Array.prototype.slice.call(arguments,1))}};function i(){var j=b.extend({},d);j._baseClass=!!f?f._thisClass:null;return j}function c(){var k={};var j=!!f?f:g;b.extend(k,j,d);k._thisClass=i();return k}e[h]=c()}})(jQuery);desknets.user={KEY_ASSIGNGROUP:"assigngrp",KEY_GROUP:"Group",KEY_NAME:"val",VAL_DEFGROUP:"1",_hiddenFields:null,getListAssignGroups:function(g){var l=this;var f=[];var k=[];var c;var j;var d;var h;var m="";var b="";var e={assign:"",assigntitle:""};var i;if(!neo.isSet(g)){return e}if(a.isArray(g)){f=g}else{f[0]=g}c=f.length;for(j=0;j<c;j++){k=f[j];if(typeof k!="object"){h=k;i=false}else{h=k[l.KEY_NAME];i=true}if(m.length!=0){m=m+",\n";b=b+",&#x0A;"}h=desknets.tmpl.escapeWord(h);if(i&&k[l.KEY_GROUP]==l.VAL_DEFGROUP){d='<span class="co-busyo-def">'+h+"</span>"}else{d=h}m=m+d;b=b+h}e.assign=m;e.assigntitle=b;return e},removeFieldIfHidden:function(b,c){this._loadHiddenFields();if(this._isFieldToHide(b)){b.remove();if(!!c){c.remove()}}},_isFieldToHide:function(b){var c=b.data("fields");if(!c){return false}var e=c.split(",");for(var d=0;d<e.length;d++){if(a.inArray(e[d],this._hiddenFields)<0){return false}}return true},_loadHiddenFields:function(){if(a.type(this._hiddenFields)!="array"){this._hiddenFields=String(desknets.pageframe.getUserNoDispItems()).split(",")}return this._hiddenFields}};desknets.RefDialog=function(){return this};desknets.refDialog={_option:{module:"zrconst",linkClass:"jco-ref-dialog-link",idName:"refid",dlgId:"jco-ref-dialog-",closedDel:true,uProfCmd:"constructcmduserinfo",uProfMsetCmd:"constructmsetcmduserinfo",uLdentClass:"co-userprof-dialog",uTmpl:"com/userprofile.html",uTmplObj:null,uMakeFunc:null,gProfCmd:"constructgroupinfo",gLdentClass:"co-groupprof-dialog",gTmpl:"com/groupprofile.html"},_arrMail:["Mail","mailmobile","mailprivate","mailother"],_arrOfficeTel:["TelHand","Tel1","Tel2","Naisen","TelFax"],_arrPrivateTel:["TelHome","TelOther"],$_area:null,$_uTmpl:null,$_gTmpl:null,_tmplMLink:'<a class="jco-userprof-maillink" href="mailto:{{mAddr}}">{{mAddr}}</a>',_tmplMLinkNoLink:'<span title="{{mAddr}}">{{mAddr}}</span>',init:function(){var c=this;var b;if(neo.isSet(c.$_area)){b=c.$_area}else{b=a(document.body)}c.setLinkDisabled(b);b.delegate("."+c._option.linkClass,"click",function(d){d.preventDefault();c._openWithElement(a(this))});if(neo.isSet(c._option.uTmplObj)&&c._option.uTmplObj.length){c.$_uTmpl=c._option.uTmplObj}},setLinkDisabled:function(b){var d=this;var c;if(neo.isSet(b)){c=b}else{c=a(document.body)}if(!desknets.pageframe.isUserInfoDisp()){c.find("."+d._option.linkClass).filter(function(){var e=a(this).data(d._option.idName).match(/user/);return !!e&&e.length==1}).addClass("co-page-linkdisable")}},_openWithElement:function(b){var c=this;var f=b.data(c._option.idName);if(!!f){var e=f.match(/(user|group|role)(\w+|-\w+)/i);if(e&&e.length>2){var d=a("#jco-user-dispitems").data("cmdtype");c._open(e[1],e[2],d)}}},_open:function(d,e,c){var b=this;if(neo.isSet(d)&&d=="user"){if(!!desknets.pageframe.isUserInfoDisp()){b._openUserProf(e,c)}}else{if(neo.isSet(d)&&d=="group"){b._openGroupProf(e)}}},_getProfileInfoAjax:function(e,f){var b=this;var d=desknets.getUrl(b._option.module);var c=desknets.ajax.arrayToMultiCmdData(e);desknets.ajax.rest({dataType:desknets.ajax.RESTYPE_JSON,url:d,data:c,success:function(h,g,i){if(h[0]["status"]!=desknets.RES_STATUS_SUCCESS){desknets.dialog.alert(h[0]["errormessage"],{errorNo:h[0]["errorno"]})}else{if(a.isFunction(f)){f(h)}}}})},_openUserProf:function(f,c){var b=this;var d=a("#"+b._option.dlgId+"user-"+f);if(d.length>0){d.dialog("open");d.find(".co-userprof-status").scrollTop(0);return}else{if(!neo.isSet(b.$_uTmpl)||b.$_uTmpl.length==0){b.$_uTmpl=a("<div />");var e=function(){b._makeUserProf(f,c)};desknets.tmpl.load(b.$_uTmpl,b._option.uTmpl,e);return}}b._makeUserProf(f,c)},_makeUserProf:function(i,f){var d=this;var g={};var c=d._option.dlgId+"user-"+i;var h;var b=function(k){var o={};var r=a.extend(desknets.dialog.getDialogOption(),{dialogClass:"dn-dialog",width:500,title:desknets.Resource.profUserTitle,open:function(){h.next().find("button").focus()},close:function(s){if(d._option.closedDel==true){d._deleteClosedUserAll()}}});var p={};p[desknets.Resource.CloseButtonLabel]=function(s){a(this).dialog("close")};r.buttons=p;h=a('<div class="'+d._option.uLdentClass+'"/>').attr("id",c).appendTo(document.body);var m=a("<div />").html(d.$_uTmpl.html());var j="";for(j in k[0]){if(typeof k[0][j]=="string"){o[j]=desknets.tmpl.dispStr(k[0][j]);if(a.inArray(j,d._arrMail)>=0){var n=d._tmplMLink;var l=desknets.pageframe.getLoginMailLink();if((neo.isSet(l)&&l<=0)||!neo.isSet(l)){n=d._tmplMLinkNoLink}if(neo.isSet(o[j],{blank:false})&&o[j]!=="&nbsp;"){o[j]=desknets.tmpl.replaceWordChkHtml(n,"mAddr",o[j])}if(!o.mailAddress){o.mailAddress="1"}}else{if(!o.officeTel&&a.inArray(j,d._arrOfficeTel)>=0){o.officeTel="1"}else{if(!o.privateTel&&a.inArray(j,d._arrPrivateTel)>=0){o.privateTel="1"}}}}else{o[j]=k[0][j]}}o.uid=i;m.find("#co-userprof-tmpl").tmpl(o).appendTo(h);var q=h.find(".co-userprof-status");if(a.trim(q.text())==""){q.remove()}a.each(h.find(".jco-userprof-maillink"),function(s,t){desknets.htmlparts.setUpMailLink(a(this))});desknets.dialog.setUp(h,r);h.dialog("open");h.find(".co-userprof-status").scrollTop(0);desknets.dialog.setFirstDialogOpen(h);if(d._option.uMakeFunc&&a.isFunction(d._option.uMakeFunc)){d._option.uMakeFunc(h)}};var e;if(neo.isSet(f)&&(f=="mset"||f=="set")){e=d._option.uProfMsetCmd}else{e=d._option.uProfCmd}g["0"]={cmd:e,id:i};d._getProfileInfoAjax(g,b)},_deleteClosedUserAll:function(){a("."+this._option.uLdentClass).each(function(){var b=a(this);if(!b.dialog("isOpen")){b.dialog("destroy").remove()}})},_openGroupProf:function(e){var b=this;var c=a("#"+b._option.dlgId+"group-"+e);if(c.length>0){c.dialog("open");return}else{if(!neo.isSet(b.$_gTmpl)||b.$_gTmpl.length==0){b.$_gTmpl=a("<div />");var d=function(){b._makeGroupProf(e)};desknets.tmpl.load(b.$_gTmpl,b._option.gTmpl,d);return}}b._makeGroupProf(e)},_makeGroupProf:function(g){var d=this;var e={};var c=d._option.dlgId+"group-"+g;var f;var b=function(l){var h={};var j=a.extend(desknets.dialog.getDialogOption(),{dialogClass:"dn-dialog",width:500,title:desknets.Resource.profGroupTitle,close:function(m){if(d._option.closedDel==true){d._deleteClosedGroupAll()}}});var k={};k[desknets.Resource.CloseButtonLabel]=function(m){a(this).dialog("close")};j.buttons=k;f=a('<div class="'+d._option.gLdentClass+'"/>').attr("id",c).appendTo(document.body);var i=a("<div />").html(d.$_gTmpl.html());l[0]["gid"]=g;i.find("#co-groupprof-tmpl").tmpl(l[0]).appendTo(f);desknets.dialog.setUp(f,j);f.dialog("open");desknets.dialog.setFirstDialogOpen(f)};e["0"]={cmd:d._option.gProfCmd,id:g};d._getProfileInfoAjax(e,b)},_deleteClosedGroupAll:function(){a("."+this._option.gLdentClass).each(function(){var b=a(this);if(!b.dialog("isOpen")){b.dialog("destroy").remove()}})},userProfSetUp:function(d,c){var b=this;if(neo.isSet(d)){b._option=a.extend({},b._option,d)}if(neo.isSet(c)&&c.length>0){b.$_area=c}b.init()}};desknets.refDialog.editGroups=function(d){var c="&nbsp;";if(neo.isSet(d)&&neo.isSet(d.Name)){var b=desknets.ajax.getItems(d.Name);a.each(b,function(e,f){b[e]=desknets.tmpl.dispStr(f)});c=b.join(", ")}return c};desknets.RefDialog.prototype=desknets.refDialog;desknets.ntwi={MODULE_MAIN:"zntwi",MODULE_API_MAIN:"zrntwi",CMD_NEWS_LIST:"ntwicmdnotice",CMD_NEWS_DEL:"ntwicmdnoticedel",CMD_SAFETYNEWS_DEL:"ntwicmdnoticesafetydel",CMD_TALK_LIST:"ntwicmdlist",CMD_TALK_REF:"ntwicmdref",CMD_TALK_ADD:"ntwicmdentry",CMD_TALK_DEL:"ntwicmddel",CMD_TALK_DOWNLOAD:"ntwidispattach",CMD_MESSAGE_USER_LIST:"ntwicmddmsguserlist",CMD_MESSAGE_LIST:"ntwicmddmsglist",CMD_MESSAGE_ADD:"ntwicmddmsgentry",CMD_MESSAGE_DEL:"ntwicmddmsgdel",CMD_MESSAGE_DOWNLOAD:"ntwidmsgdispattach",CMD_MESSAGE_READ:"ntwicmddmsgread",CMD_NOTIFY:"ntwicmdnoticeread",CMD_GETMANAGER:"ntwicmdchkmng",CMD_GETMEMO:"ntwicmdnewmemo",CMD_COPYATTACH:"ntwicmdcopyattach",CMD_MESSAGE_COPYATTACH:"ntwicmddmsgcopyattach",CMD_HISTORY_LIST:"ntwicmdhistorylist",CMD_HISTORY_DEL:"ntwicmdhistorydel",CMD_EXT_LIST:"ntwigetextlist",CMD_SURL_LIST:"ntwicmdlistsurl",CMD_SURL_ADD:"ntwicmdsurlentry",CMD_SURL_CHKEXIST:"ntwicmdsurlchkexist",CMD_SURL_DEL:"ntwicmdsurldel",CMD_STAMP_CATEGORY_LIST:"ntwicmdstampcatlist",CMD_STAMP_HISTORY_LIST:"ntwicmdstamphistlist",CMD_STAMP_LIST:"ntwicmdstamplist",CMD_PICTOGRAM_LIST:"ntwicmdpictlist",SMALL_ICON_SIZE:{width:20,height:20},ICON_SIZE:{width:40,height:40},ATTACHMENT_SIZE:{width:100,height:100},url:"",restUrl:"",mailRestUrl:"",perPageAll:0,perPageSingle:0,talkAvailable:true,messageAvailable:true,confirmToPost:true,_interval:0,_timer:null,_checkMail:"",_checkingMail:false,init:function(){var b=this;var c=a("#dn-ntwi-container");b.url=desknets.getUrl("zntwi");b.restUrl=desknets.getUrl("zrntwi");b.mailRestUrl=desknets.getUrl("zrweml");b.talkAvailable=!c.hasClass("ntwi-talk-unavailable");b.messageAvailable=!c.hasClass("ntwi-message-unavailable");b.perPageAll=Number(c.data("per-page-all"));b.perPageSingle=Number(c.data("per-page-single"));b.confirmToPost=!!c.data("confirm-to-post");b._checkMail=c.data("check-mail");b._interval=Number(c.data("interval"));desknets.ntwi.toolBar.init();this.start()},start:function(){var b=this;if(b._interval>0){b._restartTimer();a(document.body).bind("mousemove.ntwi",function(c){b._restartTimer()})}},refresh:function(){if(!desknets.ntwi.content.isShown()){desknets.ntwi.toolBar.refresh()}},confirmToProcess:function(c,e,d){var b=this;desknets.dialog.confirm(c,function(){b.beginToProcess(e,d)})},beginToProcess:function(c,b){desknets.ajax.rest({url:desknets.ntwi.restUrl,data:c,success:function(d){b(d)}})},checkMailIfEnabled:function(b){if(!!this._checkMail){if(this._checkMail=="every"||!!b){this._checkMail="sleep";this._beginToCheckMail()}}},getNewsMessage:function(d,e){var b="";if(d.mid=="todo"&&d.count=="0"){b="_end"}if(d.mid=="info"&&d.othercnt=="1"){b="_approval"}var c=desknets.Resource.Message["ntwi_new_item_"+d.mid+b]||"";c=desknets.tmpl.replaceWordHtml(c,"title",d.title);c=desknets.tmpl.replaceWordHtml(c,"detail",d.detail);c=desknets.tmpl.replaceWordHtml(c,"target",d[e]);return c},getIconUrlById:function(b){var c={creport:"circle","-1":"neo"};if(!!c[b]){b=c[b]}return"/"+desknets.DIR_RESHOME+"/images/topmenu/menu_s/"+b+"-menu_icon_s.png"},convertToStampThumbnailUrl:function(b){return String(b).replace(/attach(\d+)\./,"attach$1_mini.")},stopTimer:function(){var b=this;if(!!b._timer){clearTimeout(b._timer);b._timer=null}},_restartTimer:function(){var b=this;b.stopTimer();b._timer=setTimeout(function(){if(b._checkMail=="sleep"){b._checkMail="every"}b.refresh();b._timer=null;b._restartTimer()},b._interval*60000)},_beginToCheckMail:function(){var b=this;if(!b._checkingMail){b._checkingMail=true;desknets.ajax.rest({url:desknets.ntwi.mailRestUrl,data:{cmd:"mailupdnotice"},dataType:"xml",error:function(){},complete:function(){b._checkingMail=false}})}}};desknets.ntwi.pictogram={_TMPL_URL:"{{cginame}}?cmd=referdownload&item1=neotwidm/category/{{scid}}&filename=attach{{id}}.png&mimetype=image/png",_isSet:false,_names:[],_sscid:"",isSet:function(){return this._isSet},getPictograms:function(){return this._names},setValuesFromJson:function(c){var b=this;b._sscid=c.scid;a.each(desknets.ajax.getJsonItems(c),function(d,e){b._names[e.id]=e.Name});this._isSet=true},getCode:function(c){var b=Number(c);if(!b){b=Number(a(c).data("id"))}return !!b&&!!this._names[b]?String.fromCharCode(56192,56319+b):null},createImage:function(e,c){var d=a.extend({size:0},c);var b=this._names[e];return !!b?this._createImageTagWithName(e,b,d):""},encodeForDisplay:function(f,d){var c=this;var e=a.extend({size:0,pictogram:"image",format:"html"},d);var b=e.format=="text"?String(f):desknets.tmpl.escapeWordLF(String(f));return b.replace(/\uDB80[\uDC00-\uDFFF]/g,function(h){var i=h.charCodeAt(1)-56319;var g=c._names[i];if(!!g){if(e.pictogram=="text"){return"("+g+")"}else{return c._createImageTagWithName(i,g,e)}}return h})},decodeForSend:function(c){var d=[],b;if(typeof c=="object"){b=c}else{b=a("<div />").html(c)}this._decodeNode(d,b[0]);return d.join("")},_createImageTagWithName:function(e,c,b){var d=["<img"];d.push(this._createHtmlAttr("src",this._getImageUrl(e)));d.push(this._createHtmlAttr("data-id",e));d.push(this._createHtmlAttr("alt",c));d.push(this._createHtmlAttr("title",c));if(b.size>0){d.push(this._createHtmlAttr("width",b.size+"px"));d.push(this._createHtmlAttr("height",b.size+"px"))}return d.join(" ")+"/>"},getStampUrl:function(c,b){},_getImageUrl:function(d){var b=this;var c=b._TMPL_URL;c=desknets.tmpl.replaceWordHtml(c,"cginame",desknets.getUrl(desknets.MODULE_REFER));c=desknets.tmpl.replaceWordHtml(c,"id",desknets.zeroPadding(d,5));c=desknets.tmpl.replaceWordHtml(c,"scid",b._sscid);return c},_createHtmlAttr:function(b,c){return desknets.tmpl.replaceWord(b+'="{{value}}"',"value",c)},_decodeNode:function(d,c){var b=this;a.each(c.childNodes,function(f,e){if(e.nodeType==1){if(e.tagName=="IMG"){var g=b.getCode(e);if(!!g){d.push(g)}}else{if(e.tagName=="BR"){d.push("\n")}else{b._decodeNode(d,e);if(b._isEndWithLineFeed(e)){d.push("\n")}}}}else{if(e.nodeType==3||e.nodeType==4){d.push(e.data)}}})},_isEndWithLineFeed:function(b){return this._isBlockElement(b)&&!!b.nextSibling},_isBlockElement:function(b){return !!b&&b.nodeType==1&&a.inArray(b.tagName,["P","DIV"])>=0}};desknets.uset={CMD_USETINDEX:"usetcmdindex",};a.extend(desknets,{init:function(){var b=this;b._initSetUp();desknets.ajax.initSetUp();desknets.dateTime.init()},getErrFieName:function(c,b){var d="";d=c.find(".jco-input-"+b).attr("placeholder");if(neo.isSet(d)&&d.length>0){d=d+desknets.merrMsgConnect}return d},});desknets.sp={mobjPages:{},msBaseUrl:location.href.replace(/[\?#].*/,""),msTemplatePath:"/dneospres/",mboGetPrm:false,mobjPrm:{},mboExecChg:true,msImgPath:"/dneospres/images/",marNoDownloads:null,MODULE_MAIN:"dneosp",MODULE_SPLOGIN:"dneorsp",COOKIENAME_SETTING:"dnzSpSetting",COOKIENAME_MBSESSION_ID:"dnzMbSid",COOKIENAME_MBLOGIN_SAVE:"dnzMbSv",COOKIENAME_MAILACCOUNTID:"dnzSpMailAccountId",COOKIENAME_NTWIDMSG:"dnzMbNtwiDmsg",CMD_NTWIMOBILENOTICE:"ntwicmdmobilenotice",init:function(){var b=this;a(document).bind("mobileinit",function(){a.mobile.ajaxLinksEnabled=false;a.mobile.ajaxFormsEnabled=false});desknets.sp.msg.initSet();desknets.sp.ajax.init();desknets.sp.menu.init();desknets.sp.Neotwi.initFirst();if(desknets.browser.ipad){a(document).ready(function(){a(window).bind("scrollstart",function(){if(a(".ui-page-active").find(".ui-focus").find("input").length>0||a(".ui-page-active").find("textarea").find(".ui-focus").length>0){a(".ui-page-active").find(".ui-header-fixed ").css("position","static").hide();a(".ui-page-active").find(".ui-footer-fixed").css("position","static").hide()}});a(window).bind("scrollstop",function(){a(".ui-page-active").find(".ui-header-fixed ").show();setTimeout(function(){a(".ui-page-active").find(".ui-header-fixed").css("position","fixed")},1000);a(".ui-page-active").find(".ui-footer-fixed").show();setTimeout(function(){a(".ui-page-active").find(".ui-footer-fixed").css("position","fixed")},1000)})})}},initSetEvents:function(c){var b=this;if(!!location.hash){b.resetPage(c)}else{b._setUpPageEvents()}},resetPage:function(e){var c=this;var d=location.href.indexOf("#");var b=location.href.substring(d+1,location.href.length);if(typeof(e)=="object"&&a.inArray(b,e)>=0){c._setUpPageEvents()}else{if(d>=0){c.execLocation(location.href.substring(0,d))}else{location.reload()}}},_setUpPageEvents:function(){var b=this;if(neo.isSet(b.getLoginUid(),{blank:false})){desknets.sp.Neotwi.getAllNtwi()}var e=a(".jco-page");var c={pageinit:"init",pagebeforeshow:"showing",pageshow:"show",pagebeforehide:"hiding",pagehide:"hide",};for(var d in c){b._setUpPageEvent(e,d,c[d])}},_setUpPageEvent:function(e,d,c){var b=this;e.on(d,function(g){var f=a(this);b.execute(f.attr("id"),c,[f])})},execute:function(c,f,e){var b=this;var d=b.mobjPages[c];if(!!d){var g=d[f];return g.apply(d,e)}return null},logout:function(){var b=this;sUrl=desknets.getUrl(desknets.sp.MODULE_SPLOGIN);objPrm={cmd:"splogout"};desknets.sp.ajax.rest({url:sUrl,data:objPrm,success:function(d,c,e){b._logout(d)}})},_logout:function(d){var b=this;var c=d.logouturl;desknets.saveCookie(desknets.sp.COOKIENAME_MBSESSION_ID,"");desknets.saveCookie(desknets.COOKIENAME_STOKEN,"");if(c){b.execLocation(c)}else{b._executeOnSessionExpired()}},_executeOnSessionExpired:function(){var b=this;var c=a(".ui-page-active");if(c.attr("id")!="login-page"&&!c.hasClass("in")&&!c.hasClass("out")){b.changePageOther("login")}},changePage:function(e,d){var b=this;var f=false;var g=true;if(b.mboExecChg){b.mboExecChg=false;var c={transition:"slide"};if(e=="neotwi"){c.transition="slidedown"}else{if(e.charAt(0)=="d"&&e.charAt(1)=="-"){c.transition="pop"}}if(typeof(d)==="object"){a.extend(c,d)}a.mobile.changePage("#"+e+"-page",c)}},changePageOther:function(c){var b=this;b.execLocation(b.msBaseUrl+"?cmd="+c)},getUrl:function(c){var b=this;return b.msBaseUrl.replace(/\w+\.(\w+)$/,c+".$1")},getPrm:function(){var b=this;if(b.mboGetPrm){return b.mobjPrm}b.mboGetPrm=true;var d=window.location.href;var c=d.indexOf("#");if(c>=0){d=d.substring(0,c)}if(d.indexOf("?")>=0){b.mobjPrm=desknets.splitParam(d)}return b.mobjPrm},execLocation:function(c){var b=this;location.href=c},changePath:function(c){var b=c;if(typeof(c)=="string"){var d=desknets.DIR_RESHOME.length;d++;d++;var e=c.substr(0,d);if(e=="/"+desknets.DIR_RESHOME+"/"){b=desknets.sp.msTemplatePath+c.substr(d)}}return b},changeDateFormat_JP:function(h,b,g){var f="";if(!neo.isSet(b,{blank:false})){return""}var d=neo.isSet(g)?g:true;var e=h.indexOf("yyyy");if(e>=0){f=b.substring(e,e+4);if(!!d){f=f+"/"}}var i=h.indexOf("MM");if(i>=0){f=f+b.substring(i,i+2);if(!!d){f=f+"/"}}var c=h.indexOf("dd");if(c>=0){f=f+b.substring(c,c+2)}return f},changeTimeFormat_JP:function(g,b,f){var e="";if(!neo.isSet(b,{blank:false})){return""}var d=neo.isSet(f)?f:true;var c=g.indexOf("HH");if(c>=0){e=b.substring(c,c+2);if(!!d){e=e+":"}}var h=g.indexOf("mm");if(h>=0){e=e+b.substring(h,h+2)}return e},setUpMailLink:function(c){function b(h){var f=desknets.sp.getLoginMailLinkUseMail();if(f=="2"||f=="3"){var j=String(this.href).substring(7);var i=j.indexOf("?");if(i>0){var e=j.substr(i+1,j.length);j=j.substr(0,i);j=j+"&"+e}var d=desknets.sp.getUrl("dneosp");var g="";if(f=="3"){g="mailimapindex"}else{g="mailindex"}d=d+"?cmd="+g+"&to="+j+"#mailentry-page";desknets.sp.execLocation(d);h.preventDefault()}}if(c.is('a[href^="mailto:"]')){c.click(b)}else{c.find('a[href^="mailto:"]').click(b)}},getLoginUid:function(){return a("#jco-loginuid").val()},getLoginName:function(){return a("#jco-loginname").val()},getLoginMailLink:function(){return a("#jco-loginmaillink").val()},getLoginMailLinkUseMail:function(){var b=desknets.sp.getLoginMailLink();if(b=="2"){if(!desknets.sp.menu.boView("mail")){b="0"}}else{if(b=="3"){if(!desknets.sp.menu.boView("mailimap")){b="0"}}}return b},isAttachDownload:function(f){var b=this;var d=true;if(!b.marNoDownloads){var c=a("#jco-mbnodownload").val();if(neo.isSet(c,{blank:false})){b.marNoDownloads=c.split(",")}else{b.marNoDownloads=[]}}if(b.marNoDownloads.length==0||!neo.isSet(f)){return true}var e=f.indexOf("cmd=");if(e<0){return true}a.each(b.marNoDownloads,function(h,j){var g=f.substr(e+4,j.length);if(g!=""&&j===g){d=false;return false}});return d},getAttachUrlDel:function(e,b){var c=this;if(!desknets.sp.isAttachDownload(e)){var f=a("<div/>").append(b);var g=f.find("a");var d=f.find("img,video");a.each(g,function(k,h){var l=a(this);if(l.attr("href").indexOf(e)<0){return true}var j=a("<span/>").html(l.html());l.after(j);l.remove()});a.each(d,function(k,l){var j=a(this);var h=j.attr("src");if(h.indexOf(desknets.sp.MODULE_MAIN+".")==0){h=h+"&image=1";j.attr("src",h)}});b=f.html()}return b}};desknets.page(desknets.sp,"ComPage",null,{$mRootElement:null,mbItemRetrieved:false,mboDialog:false,init:function(d){var b=this;var c=d.attr("id");if(c.charAt(0)=="d"&&c.charAt(1)=="-"){b.mboDialog=true}b.$mRootElement=d;if(!b.mboDialog){b.$mRootElement.find('div:jqmData(role="header")').show().toolbar({tapToggle:false});b.$mRootElement.find('div:jqmData(role="footer")').show().toolbar({tapToggle:false});b.$mRootElement.find(".co-header-title").bind("vclick",function(e){e.preventDefault();b.setNtwi()});b.$mRootElement.find(".jco-reload").bind("vclick",function(e){e.preventDefault();b.reload()});b.$mRootElement.find(".jco-back").bind("vclick",function(f){f.preventDefault();var e=desknets.sp.getPrm();if(neo.isSet(e.bproc)){desknets.sp.self.execLocation(e.bproc)}else{history.back()}})}else{b.$mRootElement.find('div:jqmData(role="header")').show()}b.initSetLoadEvent()},initSetLoadEvent:function(){var b=this;if(desknets.browser.android){window.onunload=function(){}}},showing:function(){var b=this;if(!b.mboDialog){b.$mRootElement.find(".co-area").hide();b.$mRootElement.find(".co-footer").find(".ui-btn-active").removeClass("ui-btn-active")}},show:function(){var b=this;desknets.sp.mboExecChg=true;if(!b.mbItemRetrieved){b.clearItems()}if(!b.mbItemRetrieved){b.mbItemRetrieved=true;b.replaceItems()}else{b.pageViewEnd()}},hiding:function(){var b=this;if(!a.mobile.activePage.hasClass("ui-selectmenu")){b.execBeforAjaxStart()}desknets.sp.seldate.closeDate();if(!b.mboDialog){if(desknets.browser.android){b.$mRootElement.find('div:jqmData(role="header")').hide();b.$mRootElement.find('div:jqmData(role="footer")').hide();b.$mRootElement.find(".co-area").hide();setTimeout(function(){b.$mRootElement.find('div:jqmData(role="header")').show();b.$mRootElement.find('div:jqmData(role="footer")').show();b.$mRootElement.find(".co-area").show()},1000)}}},hide:function(){var b=this},reload:function(){var b=this;b.replaceItems();b.$mRootElement.find(".jco-reload").removeClass("co-hover-clear");setTimeout(function(){b.$mRootElement.find(".jco-reload").removeClass("ui-btn-active").addClass("co-hover-clear")},200)},pageViewEnd:function(){var b=this;b.$mRootElement.find(".co-area").show();b.execAfterajaxStop()},invalidate:function(){var b=this;b.mbItemRetrieved=false},replaceItems:function(){var b=this;b.pageViewEnd()},clearItems:function(){var b=this;b.execBeforAjaxStart()},setNtwi:function(){var b=this;desknets.sp.changePage("neotwi")},execBeforAjaxStart:function(){var b=this;a.mobile.loading("show");var d=a(".co-layout");if(d.length>0){}else{a("body").append('<div class="co-layout">&nbsp;</div>');d=a(".co-layout")}if(d.css("display")!="block"){var c=function(){d.height(b.getWinMaxHeight())};c();d.show();a(window).bind("resize.colayout",c)}},execAfterajaxStop:function(){var b=this;a.mobile.loading("hide");var c=a(".co-layout");if(c.css("display")=="block"){a(".co-layout").hide();a(window).unbind(".colayout")}},setSetLayout:function(){var b=this;var c=a(".co-layout");c.css("top",b.getWinTop());c.height(b.getWinMaxHeight());c.show()},getWinMaxHeight:function(){var c=this;var b=document.body;var d=document.documentElement;return Math.max(b.offsetHeight,d.clientHeight,d.scrollHeight,d.offsetHeight)},getWinTop:function(){return Math.max(a("html").scrollTop(),a("body").scrollTop())},});desknets.page(desknets.sp,"ListPage",desknets.sp.ComPage,{miMaxListItems:100,miPerPage:20,miStartIndex:0,$noItemsContainerElement:null,$listElement:null,$_TmplTop:null,$_TmplButton:null,$_Tmpl:null,mboJson:true,init:function(c){var b=this;b.callBase("init",c);b.$noItemsContainerElement=b.$mRootElement.find(".jco-list-noitems");b.$listElement=b.$mRootElement.find("ul.jco-list-itemdata");b.$_TmplTop=a('<li class="co-more jco-list-more-top"><h3>more...</h3></li>');b.$_TmplButton=a('<li class="co-more jco-list-more-bottom"><h3>more...</h3></li>');b.$_Tmpl=b.$listElement.children(".jco-list-tmpl").removeClass("jco-list-tmpl").remove();b._attachListPageEvent()},_attachListPageEvent:function(){var b=this;b.$listElement.bind("vclick",function(c){c.preventDefault();b._handleListClicked(a(c.target))})},_handleListClicked:function(b){var d=this;var c=b.closest("li");if(c.length>0){if(c.hasClass("jco-list-more-top")){d.addItems("prepend")}else{if(c.hasClass("jco-list-more-bottom")){d.addItems("append")}else{d.openListItem(c,c.data("id"))}}}},replaceItems:function(){var b=this;var c=b.getAjaxId();if(c!=""){neo.ajax.abort(c,true)}b.clearItems();b.addItems("append")},clearItems:function(){var b=this;if(b.$mRootElement!==null){b.miStartIndex=0;b.$listElement.hide();b.$noItemsContainerElement.hide();b.$listElement.empty()}},addItems:function(d){var c=this;c.execBeforAjaxStart();c.delMore();var f=(d=="prepend")?-c.miPerPage:c.getItemCount();var b=Math.max(f+c.miStartIndex,0);var g=c.miPerPage+Math.min(f+c.miStartIndex,0);var e=a.extend({url:c.getListRequestURL(),data:c.getListRequestData(b,g),success:function(i,h,j){if(!c.mboJson){i=a(i)}var k=c.getAjaxSuccessList(i,b,g);c.executeOnItemsGot(i,k,d);c.pageViewEnd()},dialogback:true},c.getRequestOption(d));desknets.sp.ajax.rest(e)},getAjaxSuccessList:function(e,b,d){var c=this;var f=[];if(c.mboJson){f=desknets.sp.ajax.getJsonItems(e)}else{f=e.find("item").filter(function(g){return g<d})}return f},executeOnItemsGot:function(e,f,d){var c=this;if(d=="prepend"){c.miStartIndex=Math.max(c.miStartIndex-f.length,0)}else{var b=c.getItemCount()+f.length-c.miMaxListItems;c.miStartIndex=c.miStartIndex+Math.max(b,0)}c.addListElements(f,d);c.removeListElements(d);c.updateContainerElement(e);c.updateListEnd(e)},delMore:function(){var b=this;b.$listElement.find(".jco-list-more-top").remove();b.$listElement.find(".jco-list-more-bottom").remove()},addListElements:function(d,h){var j=this;var f=(h=="prepend")?j.$listElement.children(":first-child"):j.$listElement;var e=(h=="prepend")?"insertBefore":"appendTo";var b=d.length;for(var g=0;g<b;g++){var c=null;c=j.addListElementsTmpl();c[e](f);var i=null;if(j.mboJson){i=d[g]}else{i=a(d[g])}j.setUpListItem(i,c)}},addListElementsTmpl:function(){var b=this;return b.$_Tmpl.clone()},removeListElements:function(d){var c=this;var b=c.getItemCount()-c.miMaxListItems;if(b>0){if(d=="prepend"){c.getItemElementWithIndex(c.miMaxListItems).nextAll().andSelf().remove()}else{c.getItemElementWithIndex(b).prevAll().remove()}}},getItemElementWithIndex:function(b){var c=b+1;return(c>0)?this.$listElement.children(":nth-child("+c+")"):a([])},updateContainerElement:function(e){var b=this;var d=0;if(b.mboJson){d=parseInt(e.allcnt)}else{d=parseInt(e.find("allcnt").text())}var g=b.miStartIndex+b.getItemCount();var c=(g>0)?"show":"hide";b.$listElement[c]();var f=(g<=0)?"show":"hide";b.$noItemsContainerElement[f]();if(c&&b.miStartIndex>0){b.updateMoreTop()}if(c&&g<d){b.updateMoreButton()}},updateMoreTop:function(){var b=this;b.$_TmplTop.clone().insertBefore(b.$listElement.children(":first-child"))},updateMoreButton:function(){var b=this;b.$_TmplButton.clone().appendTo(b.$listElement)},updateListEnd:function(){var b=this;b.$listElement.enhanceWithin();b.$listElement.listview("refresh")},setUpListItem:function(d,c){var b=this;if(b.mboJson){c.data("id",d.id)}else{c.data("id",d.attr("id"))}},openListItem:function(b,c){},getItemCount:function(){var b=this;return b.$listElement.children().length},getListRequestURL:function(){},getRequestOption:function(){var b=this;var c={};var d=b.getAjaxId();if(d!=""){c={id:d,error:function(g,f,e){if(f!="abort"){desknets.sp.ajax.onError(g.status,e)}}}}return c},getAjaxId:function(){return""},getListRequestData:function(b,c){}});desknets.page(desknets.sp,"RefPage",desknets.sp.ComPage,{msId:"",init:function(c){var b=this;b.callBase("init",c);b.initPage()},showing:function(){var b=this;b.callBase("showing");b.showingPage()},setPage:function(c){var b=this;b.msId=c;b.invalidate()},initPage:function(){var c=this;var b=c.$mRootElement.find(".co-infoggle");b.each(function(){var d=a(this).find("div");var e=d.eq(0);var f=d.eq(1);e.click(function(g){g.preventDefault();f.toggle()})});c.$mRootElement.find(".co-ref-info-link").bind("vclick",function(d){d.preventDefault();a(this).closest(".co-ref-info").find(".co-listdsp").toggleClass("open")})},showingPage:function(){var b=this},clearItems:function(){var b=this;b.callBase("clearItems");b.clearItemsPage()},clearItemsPage:function(){var c=this;var b=c.$mRootElement.find(".co-infoggle");b.each(function(){a(this).find("div").eq(1).hide()});c.$mRootElement.find(".co-listdsp.open").removeClass("open")},replaceItems:function(){var b=this;b.clearItems();var c=a.extend({url:this.getReferRequestURL(),data:this.getReferRequestData(),success:function(e,d,f){b.setUpReferItem(e);b.pageViewEnd()},dialogback:true},b.getRequestOption());desknets.sp.ajax.rest(c)},getRequestOption:function(){return{}},getReferRequestURL:function(){},getReferRequestData:function(){},setUpReferItem:function(b){},setUpText:function(g,e,f){var d=this;var c=d.$mRootElement.find(g);var b=c.closest("li");if(typeof(e)=="string"&&e.length>0){c.html(desknets.tmpl.escapeWord(e));b.removeClass("none")}else{if(typeof(f)=="string"){c.html(f);b.removeClass("none")}else{c.html("");b.addClass("none")}}},setUpBody:function(g,e,f){var d=this;var c=d.$mRootElement.find(g);var b=c.closest("li");if(typeof(e)=="string"&&e.length>0){c.html(desknets.tmpl.escapeWordLF(e));b.removeClass("none")}else{if(typeof(f)=="string"){c.html(f);b.removeClass("none")}else{c.html("");b.addClass("none")}}},setUpDate:function(g,e,f){var d=this;var c=d.$mRootElement.find(g);var b=c.closest("li");if(typeof(e)=="string"&&e.length>0){c.html(desknets.dateTime.dispDateTime(e));b.removeClass("none")}else{if(typeof(f)=="string"){c.html(f);b.removeClass("none")}else{c.html("");b.addClass("none")}}},setUpFile:function(i,c,g,h){var e=this;var d=e.$mRootElement.find(i);var b=d.closest("li");var f=desknets.sp.attachDisp.disp(c,desknets.sp.MODULE_MAIN,g);if(typeof(f)=="string"&&f.length>0&&f!="&nbsp;"){d.html(f);b.removeClass("none")}else{if(typeof(h)=="string"){d.html(h);b.removeClass("none")}else{d.html("");b.addClass("none")}}}});desknets.page(desknets.sp,"EntryPage",desknets.sp.RefPage,{mobjEntries:{},init:function(d){var b=this;b.callBase("init",d);b.$mRootElement.find(".jco-ok").bind("vclick",function(e){e.preventDefault();b.sendEntries()});var c=b.$mRootElement.find(".co-list-edit>li");c.on("focus",".ui-input-text",function(){a(this).closest(c).addClass("focused")});c.on("blur",".ui-input-text",function(f){setTimeout(a.proxy(function(){a(this).closest(c).removeClass("focused")},this),200)});b.$mRootElement.find(".jco-input-userlist").on("vclick",".jco-entry-usel",function(e){e.preventDefault();var f=a(this).find('input[type="hidden"]').val();desknets.sp.UserProfile.setPage(f);desknets.sp.UserProfile.setEntryObj(b,".jco-input-userlist");desknets.sp.changePage("profile")})},setEntries:function(b){var c=this;c.invalidate();c.mobjEntries=a.extend(c.getInitialEntries(),b);c.msId=""},initPage:function(){var b=this},showingPage:function(){var b=this;if(!!b.msId&&b.msId!==""){b.$mRootElement.find(".jco-add").hide();b.$mRootElement.find(".jco-mod").show()}else{b.$mRootElement.find(".jco-add").show();b.$mRootElement.find(".jco-mod").hide()}},clearItemsPage:function(){var b=this},clearItems:function(){var b=this;b.callBase("clearItems");b.$mRootElement.find("textarea").each(function(d){var c=a(this);c.css("height",c.css("min-height"))});b.$mRootElement.find(".mbscroll-date").each(function(c){a(this).val("").change()});b.$mRootElement.find(".mbscroll-time").each(function(c){a(this).val("").change()});b.$mRootElement.find(".co-input-selected").remove();b.$mRootElement.find(".co-input-otherto").removeClass("on")},replaceItems:function(){var b=this;if(!!b.msId&&b.msId!==""){b.callBase("replaceItems")}else{if(!!b.mobjEntries){b.mobjEntries=!!b.mobjEntries?b.mobjEntries:b.getInitialEntries();b.setUpReferItemFromEntries();b.pageViewEnd()}}},setUpReferItem:function(c){var b=this;b.callBase("setUpReferItem",c);b.mobjEntries=b.getEntriesFrom(c);b.setUpReferItemFromEntries()},getEntriesFrom:function(c){var b=this;return c},getInitialEntries:function(){var b=this;return{}},setUpReferItemFromEntries:function(){var b=this},sendEntries:function(){var b=this;b.mobjEntries=b.getEntriesFromReferItem();if(!b.validate()){return}b.confirmToSendEntries(function(){b._beginToSendToServer()})},getEntriesFromReferItem:function(){var b=this},validate:function(){var b=this;return true},confirmToSendEntries:function(c){var b=this;c()},_beginToSendToServer:function(){var b=this;b.execBeforAjaxStart();var c=a.extend({url:b.getSubmitRequestURL(),data:b.getSubmitRequestData(),success:function(e,d,f){b.completeToSendEntries()},errorconvmsg:function(d,e){var f=desknets.getErrField(d,e);f.fieldname=b._getErrorPlace(f.fieldid);return desknets.getErrConvMsg(f);b.execAfterajaxStop()}},b.getSendRequestOption());desknets.sp.ajax.rest(c)},getSendRequestOption:function(){return{}},_getErrorPlace:function(b){var c=this;if(b!==""){return desknets.getErrFieName(c.$mRootElement,b)}return""},getSubmitRequestURL:function(){var b=this;return b.getReferRequestURL()},getSubmitRequestData:function(){var b=this;return b.mobjEntries},completeToSendEntries:function(){var b=this;history.back()},setSelUsers:function(c,g,d){var b=this;var f="";var h=false;if(!neo.isSet(d,{blank:false})){d=".jco-input-userlist"}if(!neo.isSet(g,{blank:false})){g="otherto"}var e=b.$mRootElement.find(d).find('input[type="hidden"]');a.each(c,function(k,l){h=false;if(!b.boAddUser(l)){h=true}else{a.each(e,function(){if(a(this).val()==l.id){h=true;return false}})}if(!h){var j=desknets.tmpl.escapeWord(l.val);var m='<a href="#" class="jco-entry-usel">'+j+'<input type="hidden" value="'+l.id+'" name="'+g+'"></a>';f=f+m}});if(c.length>0){b.$mRootElement.find(d).find(".co-input-otherto").addClass("on")}var i=b.$mRootElement.find(d).find(".co-input-selected");if(!b.$mRootElement.find(d).is(":has('.co-input-selected')")){i=a('<div class="co-input-selected" />');i.insertBefore(b.$mRootElement.find(d).find(".ui-input-text"))}i.append(a(f))},boAddUser:function(c){var b=this;if(!!c&&!!c.user_state&&(c.user_state=="1"||c.user_state=="2")){return false}return true},setDeselUser:function(e,c){var b=this;var d=b.$mRootElement.find(c).find('input[type="hidden"]');a.each(d,function(f,g){if(e==a(this).val()){a(this).closest("a").remove()}});d=b.$mRootElement.find(c).find('input[type="hidden"]');if(d.length<=0){b.$mRootElement.find(c).find(".co-input-selected").remove();b.$mRootElement.find(c).find(".co-input-otherto").removeClass("on")}}});desknets.page(desknets.sp,"ListSetPage",desknets.sp.ListPage,{mboChk:true,mboSet:false,mboAllChk:false,mboMoreTop:false,mboMoreBottom:false,$_SetTmpl:null,init:function(c){var b=this;b.callBase("init",c);b.$_SetTmpl=b.$listElement.children(".jco-list-settmpl").removeClass("jco-list-settmpl").remove()},showing:function(){var b=this;b.callBase("showing");b.setChgView()},_attachListPageEvent:function(){var b=this;b.callBase("_attachListPageEvent");b.$mRootElement.find(".jco-all").bind("vclick",function(c){c.preventDefault();b.allChk()});b.$mRootElement.find(".jco-chg").bind("vclick",function(c){c.preventDefault();b._listChgClick()});b.$listElement.delegate("input[type=checkbox]","change",function(c){c.preventDefault();b.allChkOff()})},setChgView:function(){var b=this;if(b.mboSet){b.$mRootElement.find(".jco-list").hide();b.$mRootElement.find(".jco-listset").show();if(b.mboChk){b.$listElement.addClass("_edit")}}else{b.$mRootElement.find(".jco-list").show();b.$mRootElement.find(".jco-listset").hide();if(b.mboChk){b.$listElement.removeClass("_edit")}}},replaceItems:function(){var b=this;b.callBase("replaceItems");b.setChgView()},addListElementsTmpl:function(){var b=this;if(b.mboSet){return b.$_SetTmpl.clone()}return b.$_Tmpl.clone()},_handleListClicked:function(b){var c=this;c.allChkOff();c.callBase("_handleListClicked",b)},invalidate:function(){var b=this;b.callBase("invalidate");b.allChkOff();if(b.mboChk){b.mboSet=false}},_listChgClick:function(){var b=this;b.$mRootElement.find(".co-footer").find(".ui-btn-active").removeClass("ui-btn-active");if(b.mboSet){b.mboSet=false}else{b.mboSet=true}b.allChkOff();b._listChg()},_listChg:function(){var b=this;if(b.mboChk){b.setChgView();if(b.mboSet){b.chkMore();b.delMore()}else{b.$listElement.find("input[type=checkbox]").prop("checked",false).checkboxradio("refresh");b.addMore()}b.updateListEnd()}else{b.reload()}},chkMore:function(){var b=this;b.mboMoreTop=false;b.mboMoreBottom=false;if(b.$listElement.find(".jco-list-more-top").length>0){b.mboMoreTop=true}if(b.$listElement.find(".jco-list-more-bottom").length>0){b.mboMoreBottom=true}},addMore:function(){var b=this;if(b.mboMoreTop){b.$_TmplTop.clone().insertBefore(b.$listElement.children(":first-child"))}if(b.mboMoreBottom){b.$_TmplButton.clone().appendTo(b.$listElement)}b.mboMoreTop=false;b.mboMoreBottom=false},allChkOff:function(){var b=this;if(b.mboAllChk){b.mboAllChk=false;b.$mRootElement.find(".co-checkall-msg").hide()}},allChk:function(){var c=this;if(c.mboAllChk){c.mboAllChk=false;c.$mRootElement.find(".co-checkall-msg").hide()}else{if(c.$listElement.css("display")!="block"){return}var b=c.$listElement.children().length;var d=desknets.Resource.Message.com_listchk_cnt_some_disp;d=desknets.tmpl.replaceWordHtml(d,"num",b);c.$mRootElement.find(".co-chk-cnt-some").html(d);c.mboAllChk=true;c.$mRootElement.find(".co-checkall-msg").show()}c.$listElement.find("input[type=checkbox]").prop("checked",c.mboAllChk).checkboxradio("refresh")},getChkId:function(d){var c=this;var b=[];c.$listElement.find("input[type=checkbox]:checked").each(function(){b[b.length]=a(this).closest("li").data("id")});if(b.length===0){if(d){desknets.sp.msg.view("","W:"+c.getNoChkMsg())}return false}return b},getNoChkMsg:function(){return desknets.Resource.Message.com_del_nochecked}});desknets.page(desknets.sp,"SearchPage",desknets.sp.ListPage,{mboFirst:true,mobjSrch:{},init:function(c){var b=this;b.callBase("init",c);b.initPage()},initPage:function(){var b=this;b.getDefSrch(true);b.$mRootElement.find(".jco-srch").bind("vclick",function(c){c.preventDefault();a(this).focus();if(b.chkSearch()){b.mboFirst=false;b.mobjSrch.srch_key=b.$mRootElement.find('input[name="srch_key"]').val();b.reload()}})},show:function(){var b=this;if(b.mboFirst){b.mbItemRetrieved=true;b.showFirstPage()}b.callBase("show")},showFirstPage:function(){var b=this;b.$mRootElement.find(".co-srch-first").show();b.$listElement.hide();b.$noItemsContainerElement.hide()},replaceItems:function(){var b=this;b.callBase("replaceItems");b.$mRootElement.find(".co-srch-first").hide()},setSrch:function(b){var c=this;c.mboFirst=false;c.mobjSrch=b;c.invalidate()},getRequestOption:function(c){var b=this;var d={};var e=b.getAjaxId();if(e!=""){d={id:e,error:function(h,g,f){if(g!="abort"){b.$listElement.hide();b.$noItemsContainerElement.show();desknets.sp.ajax.onError(h.status,f)}}}}return d},chkSearch:function(){return true},getDefSrch:function(c){var b=this;b.mobjSrch={};b.invalidate();b.mboFirst=c;if(c===true){b.clearItems()}},delMore:function(){var b=this;b.callBase("delMore");b.$listElement.find(".jco-srchset").remove()},_handleListClicked:function(b){var d=this;var c=b.closest("li");if(c.length>0){if(c.hasClass("jco-srchset")){d._handleListClickSrch()}else{d.callBase("_handleListClicked",b)}}},_handleListClickSrch:function(){var b=this},updateContainerElement:function(c){var b=this;b.callBase("updateContainerElement",c);b.$noItemsContainerElement.find(".jco-srchset").clone().insertBefore(b.$listElement.children(":first-child"))}});desknets.page(desknets.sp,"FolderPage",desknets.sp.ListSetPage,{mobjParent:null,marFolderList:null,init:function(c){var b=this;b.marFolderList=[];b.mboChk=false;b.callBase("init",c);b.$mRootElement.find(".jco-parent").bind("vclick",function(d){d.preventDefault();b.mobjParent=b.marFolderList.pop();b.reload()})},removeListElements:function(c){var b=this},updateMoreTop:function(){var b=this},updateMoreButton:function(){var b=this},replaceItems:function(){var b=this;b.callBase("replaceItems");if(b.mobjParent==null||b.mboSet){b.$mRootElement.find(".jco-parent").hide()}else{b.$mRootElement.find(".jco-parent").show()}b.setFolderView()},setFolderView:function(){var c=this;var b=c.marFolderList.length;var e="";for(var d=0;d<b;d++){if(e!=""||c.getFolderDef()){e=e+" &gt; "}e=e+desknets.tmpl.escapeWord(c.marFolderList[d].Name)}if(c.mobjParent!=null){if(e!=""||c.getFolderDef()){e=e+" &gt; "}e=e+desknets.tmpl.escapeWord(c.mobjParent.Name)}if(e!=""||c.getFolderDef()){c.$mRootElement.find(".co-subtitle").show().find("span").html(e)}else{c.$mRootElement.find(".co-subtitle").hide().find("span").html("&nbsp;")}},getFolderDef:function(){return false},_handleListClicked:function(b){var e=this;var d=b.closest("a");var c=d.closest("li");if(c.length>0){if(c.hasClass("jco-list-more-top")){e.addItems("prepend")}else{if(c.hasClass("jco-list-more-bottom")){e.addItems("append")}else{if(d.hasClass("jco-listsub")){e.openListSubItem(c,c.data("id"),d,b)}else{e.openListItem(c,c.data("id"))}}}}},openListSubItem:function(f,g,e,c){var d=this;if(d.mobjParent!=null){d.marFolderList[d.marFolderList.length]=d.mobjParent}var b={id:g,Name:f.find("h3").text()};d.mobjParent=b;d.reload()}});desknets.page(desknets.sp,"SearchBatPage",desknets.sp.SearchPage,{mboInit:false,getListRequestData:function(d,e){var b=this;var c={row:d,num:e};if(b.mboInit){b.mboInit=false;c.init="1"}return c},getRequestOption:function(c){var b=this;var d=b.callBase("getRequestOption");d.success=function(f,e,h){b.pageViewEnd();if(f.searching=="1"){var g=function(){b.onSrchStop()};desknets.sp.msg.srchview(g);setTimeout(function(){b.addItems("append")},3000)}else{if(a(".ui-page-active").attr("id")=="dialog-page"){desknets.sp.msg.$mRootElement.dialog("close")}var i=desknets.sp.ajax.getJsonItems(f);b.executeOnItemsGot(f,i,c)}};return d},onSrchStop:function(){var b=this;var e=b.getAjaxId();if(e!=""){neo.ajax.abort(e,true)}var c={};c.cmd=b._getStopBatSearchCmd();var d=a.extend({url:b.getListRequestURL(),data:c,success:function(g,f,h){b.onSrchStopEnd()},},b.onSrchStopOption());desknets.sp.ajax.rest(d)},onSrchStopOption:function(){return{}},onSrchStopEnd:function(){var b=this},_getStopBatSearchCmd:function(){return""}});desknets.page(desknets.sp,"UserSelPage",desknets.sp.ListPage,{boSingle:true,srchKey:"",init:function(c){var b=this;if(c.data("mode")=="multi"){b.boSingle=false}b.callBase("init",c)},show:function(){var b=this;if(!!b.mbItemRetrieved){b.$listElement.find("input[type=checkbox]:checked").each(function(c){a(this).prop("checked",false).checkboxradio("refresh")})}b.callBase("show")},_attachListPageEvent:function(){var b=this;b.callBase("_attachListPageEvent");if(!b.boSingle){b.$mRootElement.find(".jco-user-ok").bind("vclick",function(d){d.preventDefault();var c=[];b.$listElement.find("input[type=checkbox]:checked").each(function(e){var f={};f.id=a(this).closest("li").data("id");f.val=a(this).closest("li").find("h3:first").text();c[e]=f});b.openMultiItems(c)})}b.$mRootElement.find(".jco-user-search").bind("vclick",function(c){c.preventDefault();a(this).focus();var d=a(this).closest("div.co-search-input").find('input[name="search"]').val();b.srchKey=d;b.reload()})},getListRequestURL:function(){return desknets.sp.getUrl(desknets.MODULE_API_MAIN)},getListRequestData:function(c,d){var b=this;var e={cmd:desknets.uset.CMD_USETINDEX,row:c,num:d};if(neo.isSet(this.srchKey,{blank:false})){e.srch_key=b.srchKey}else{e.gid=a('input[name="logingid"]').val()}return e},setUpListItem:function(e,d){var c=this;var b={};c.callBase("setUpListItem",e,d);if(neo.isSet(e.assigngrp)){b=desknets.user.getListAssignGroups(e.assigngrp.Name)}d.find("h3").html(desknets.tmpl.escapeWord(e.Name));d.find("p").html(!!b.assign?b.assign:"&nbsp;");if(!c.boSingle){d.find("input[type=checkbox]").attr("id","jco-chk-userlist-"+e.id);d.find("label").attr("for","jco-chk-userlist-"+e.id)}},clearItems:function(){var b=this;b.callBase("clearItems");if(!b.mbItemRetrieved){b.$mRootElement.find("div.co-search-input").find('input[name="search"]').val("")}},openMultiItems:function(b){},updateContainerElement:function(c){var b=this;b.miStartIndex=0;b.callBase("updateContainerElement",c)},updateMoreTop:function(){var b=this},removeListElements:function(c){var b=this}});desknets.page(desknets.sp,"UserProfile",desknets.sp.RefPage,{mEntryObj:null,marea:".jco-input-userlist",initPage:function(){var b=this;b.callBase("initPage");b.$mRootElement.find(".jco-usel-deselect").bind("vclick",function(c){c.preventDefault();desknets.sp.UserDeselect.setPage(b.msId);desknets.sp.UserDeselect.setEntryObj(b.mEntryObj,b.marea);desknets.sp.changePage("d-userdeselect")})},getReferRequestURL:function(){return desknets.sp.getUrl("zrconst")},getReferRequestData:function(){var b=this;var c={cmd:"constructcmduserinfo",id:b.msId,};return c},getRequestOption:function(){var b=this;return{dialogback:false,error:function(e,c,f){if(e.status=="-110"){var d=desknets.parseErrorInfo(f,e.status);b.setNoDataUser(d.message)}else{desknets.sp.ajax.onError(e.status,f,false)}}}},replaceItems:function(){var b=this;if(a("#jco-userinfodisp").val()=="1"){b.callBase("replaceItems")}else{b.setNoDataUser(desknets.Resource.sp.profdisabled)}},setNoDataUser:function(d){var c=this;c.clearItems();var e=c.mEntryObj.$mRootElement.find("li."+c.marea).find("input[type=hidden]").filter(function(){return a(this).val()==c.msId}).closest("a").text();var b={};b.Name=e;b.Kana=d;c.setUpReferItem(b);c.pageViewEnd()},setUpReferItem:function(h){var c=this;c.setUpText(".co-user-name",h.Name);c.setUpText(".co-user-kana",h.Kana);var b=desknets.sp.changePath(h.attach);var e=c.$mRootElement.find(".co-user-img").remove();if(neo.isSet(b,{block:false})){var f='<img class="co-user-img" src="{{src}}">';f=desknets.tmpl.replaceWordHtml(f,"src",b);c.$mRootElement.find(".co-user-prof").prepend(f)}var g=desknets.tmpl.dispStr(h.Group);var d=desknets.refDialog.editGroups(h.assigngrp);if(g=="&nbsp;"&&d=="&nbsp;"){c.$mRootElement.find(".co-user-info").hide()}else{c.$mRootElement.find(".jco-user-group").html(g);c.$mRootElement.find(".jco-user-assigngroup").html(d);c.$mRootElement.find(".co-user-info").show()}},setEntryObj:function(d,c){var b=this;b.mEntryObj=d;if(!neo.isSet(c,{blank:false})){c=".jco-input-userlist"}b.marea=c}});desknets.page(desknets.sp,"UserDeselect",desknets.sp.EntryPage,{mEntryObj:null,marea:".jco-input-userlist",showingPage:function(){var b=this;b.$mRootElement.find(".co-dialog-msg").hide();b.$mRootElement.find(b.marea).show()},replaceItems:function(){var b=this;b.pageViewEnd()},sendEntries:function(){var b=this;b.mEntryObj.setDeselUser(b.msId,b.marea);b.$mRootElement.dialog("close");setTimeout(function(){history.back()},100)},setEntryObj:function(d,c){var b=this;b.mEntryObj=d;if(!neo.isSet(c,{blank:false})){c=".jco-input-userlist"}b.marea=c}});desknets.page(desknets.sp,"TagPage",desknets.sp.EntryPage,{mboTagSet:false,msTag:"0",showingPage:function(){var b=this;if(b.mboTagSet){b.mboTagSet=false;if(b.msTag==""){b.msTag="0"}b.$mRootElement.find('select[name="tagcolor"]').val(b.msTag).selectmenu("refresh")}},setPage:function(d,c){var b=this;b.callBase("setPage",d);b.msTag=c;b.mboTagSet=true},replaceItems:function(){var b=this;b.pageViewEnd()},getSendRequestOption:function(){var b=this;var c={};c.error=function(e,d,f){desknets.sp.ajax.onError(e.status,f,true);b.setInvalidate()};return c},setInvalidate:function(){var b=this},getEntriesFromReferItem:function(){var b=this;var c={};c.id=b.msId;c.tagcolor=b.$mRootElement.find('select[name="tagcolor"] option:selected').val();return c},completeToSendEntries:function(){var b=this;b.completeTag(b.$mRootElement.find('select[name="tagcolor"] option:selected').val());b.$mRootElement.dialog("close")},completeTag:function(c){var b=this},});desknets.page(desknets.sp,"DelPage",desknets.sp.EntryPage,{mboList:false,init:function(c){var b=this;b.callBase("init",c);b.$mRootElement.find(".jco-delclose").bind("vclick",function(d){d.preventDefault();b.delClose()});b.$mRootElement.find('div:jqmData(role="header")').find("a").unbind();b.$mRootElement.find('div:jqmData(role="header")').find("a").bind("vclick",function(d){d.preventDefault();b.delClose()})},delClose:function(){var b=this;if(b.mboList===false){desknets.sp.changePage(b.delCloseId(),{changeHash:false,transition:"pop",reverse:true})}else{history.back()}},delCloseId:function(){return""},setPage:function(d,b){var c=this;c.callBase("setPage",d);if(b===true){c.mboList=b}else{c.mboList=false}},replaceItems:function(){var b=this;b.pageViewEnd()},getSendRequestOption:function(){var b=this;var c={};c.error=function(e,d,f){desknets.sp.ajax.onError(e.status,f);b.setInvalidate()};return c},getEntriesFromReferItem:function(){var b=this;var c={};c.id=b.msId;return c},completeToSendEntries:function(){var b=this;b.setInvalidate();b.$mRootElement.dialog("close")},setInvalidate:function(){var b=this},});desknets.page(desknets.sp,"UsetList",desknets.sp.ListSetPage,{srchKey:"",mobjParent:null,marFolderList:null,musercnt:0,init:function(c){var b=this;b.marFolderList=[];b.callBase("init",c);b.$mRootElement.find(".jco-parent").bind("vclick",function(d){d.preventDefault();b.mobjParent=b.marFolderList.pop();b.reload()});b.$mRootElement.find(".jco-user-search").bind("vclick",function(d){d.preventDefault();a(this).focus();var e=a(this).closest("div.co-search-input").find('input[name="search"]').val();b.srchKey=e;b.reload()});b.$mRootElement.find(".jco-parent").removeClass("ui-btn-right")},addItems:function(c){var b=this;b.execBeforAjaxStart();b.delMore();b.addItemsGrp(c)},addItemsGrp:function(e){var c=this;if(neo.isSet(this.srchKey,{blank:false})||(c.mobjParent!=null&&c.mobjParent.id=="0")){c.addItemsUser(e,{allcnt:0},[])}else{var g=(e=="prepend")?-c.miPerPage:c.getItemCount();var b=Math.max(g+c.miStartIndex,0);var h=c.miPerPage+Math.min(g+c.miStartIndex,0);var d=c.getListRequestDataGrp(b,h);var f=a.extend({url:c.getListRequestURLGrp(),data:d,success:function(k,i,l){var m=[];if(c.mobjParent==null){var j={id:"0",children:"0",Name:desknets.Resource.chooser.unassignGroupName};if(k.row==d.row){m=c.getAjaxSuccessList(k,b,h);if(k.allcnt<=b+h){m[m.length]=j}}else{m[m.length]=j}k.allcnt=Number(k.allcnt)+1}else{if(k.row==d.row){m=c.getAjaxSuccessList(k,b,h)}else{m=[]}}c.addItemsUser(e,k,m)},dialogback:true},c.getRequestOption(e));desknets.sp.ajax.rest(f)}},addItemsUser:function(g,i,f){var j=this;if(neo.isSet(this.srchKey,{blank:false})||j.mobjParent!=null){var c=(g=="prepend")?-j.miPerPage:j.getItemCount();var b=Math.max(c+j.miStartIndex,0);var d=j.miPerPage+Math.min(c+j.miStartIndex,0);bochk=false;b=b-Number(i.allcnt);if(b<0){b=0;bochk=true}d=d-f.length;if(d<0){d=0}if(g=="append"&&b!=0&&j.musercnt!=0&&d==j.miPerPage){var h=j.musercnt-b;if(h<=j.miPerPage){d=h}}var e=a.extend({url:j.getListRequestURLUser(),data:j.getListRequestDataUser(b,d),success:function(l,k,m){j.musercnt=Number(l.allcnt);var n=j.getAjaxSuccessList(l,b,d);if(d==0){n=[]}j.addItemsEnd(g,i,f,l,n)},dialogback:true},j.getRequestOption(g));desknets.sp.ajax.rest(e)}else{j.musercnt=0;j.addItemsEnd(g,i,f,{allcnt:0},[])}},addItemsEnd:function(d,h,g,f,c){var b=this;h.allcnt=Number(h.allcnt)+Number(f.allcnt);var e=c.length;for(var i=0;i<e;i++){g[g.length]=c[i]}b.executeOnItemsGot(h,g,d);b.pageViewEnd()},getListRequestURLGrp:function(){return desknets.sp.getUrl("zrconst")},getListRequestURLUser:function(){return desknets.sp.getUrl("dneor")},getAjaxId:function(){return"dnsp-com-uset"},getListRequestDataGrp:function(c,d){var b=this;var f=null;if(b.mobjParent!=null){f=b.mobjParent.id}var e={cmd:"constructugroups",row:c,pgid:f,num:d};return e},getListRequestDataUser:function(c,d){var b=this;var f="all";if(d==0){d=1}var e={cmd:"usetcmdindex",fldsort:"SEQNO",order:"1",row:c,num:d};if(neo.isSet(this.srchKey,{blank:false})){e.srch_key=b.srchKey;e.gid=f}else{if(b.mobjParent!=null){f=b.mobjParent.id}e.gid=f}return e},grpChangeId:function(d,e){var c=this;if(c.mobjParent!=null){c.marFolderList[c.marFolderList.length]=c.mobjParent}var b={id:e,Name:d.find("h3").text()};c.mobjParent=b;c.reload()},replaceItems:function(){var b=this;if(neo.isSet(this.srchKey,{blank:false})){b.marFolderList=[];b.mobjParent=null;b.$mRootElement.find(".jco-uset-list-title").hide();b.$mRootElement.find(".jco-uset-search-title").show()}else{b.$mRootElement.find(".jco-uset-list-title").show();b.$mRootElement.find(".jco-uset-search-title").hide()}b.callBase("replaceItems");if(b.mobjParent==null||b.mboSet){b.$mRootElement.find(".jco-parent").hide()}else{b.$mRootElement.find(".jco-parent").show()}b.setFolderView()},setFolderView:function(){var c=this;var b=c.marFolderList.length;var e="";for(var d=0;d<b;d++){e=e+" &gt; ";e=e+desknets.tmpl.escapeWord(c.marFolderList[d].Name)}if(c.mobjParent!=null){e=e+" &gt; ";e=e+desknets.tmpl.escapeWord(c.mobjParent.Name)}c.$mRootElement.find(".co-subtitle").show().find(".jco-grp-list").html(e)},});desknets.page(desknets.sp,"Neotwi",desknets.sp.ComPage,{CMDSP_NTWILIST:"ntwiindex",NTWI_GETLIMIT:"4",boNtwiPage:false,$_TmplDnMsg:null,$_TmplDnMsgInfo:null,$_TmplNtwi:null,$_TmplDirect:null,mboSafety:false,boUseMail:false,boNtwi:false,boDirect:false,optHref:{convertMail:false,urlSchemas:["http","https","ftp"]},initFirst:function(){var b=this;b.getBoUse();b.getTmpl()},init:function(d){var b=this;b.callBase("init",d);var c=desknets.sp.getPrm();if(c.cmd==b.CMDSP_NTWILIST){b.boNtwiPage=true}else{b.boNtwiPage=false}b.setBtn();b.setView();b.setEvent();b.$mRootElement.find('div:jqmData(role="footer")').hide()},showing:function(){var b=this;b.callBase("showing");b.changeView("dnmsg")},show:function(){var b=this;desknets.sp.mboExecChg=true;b.pageViewEnd();b.$mRootElement.find('div:jqmData(role="footer")').show()},hiding:function(){var b=this;b.callBase("hiding");b.$mRootElement.find('div:jqmData(role="footer")').hide()},getBoUse:function(){var b=this;if(a("body").data("chkmail")=="1"){b.boUseMail=true}else{b.boUseMail=false}b.boNtwi=desknets.sp.menu.boView("ntwi");b.boDirect=desknets.sp.menu.boView("ntwid");if(b.boUseMail){desknets.ntwi._checkMail="every"}else{desknets.ntwi._checkMail=""}desknets.ntwi.mailRestUrl=desknets.sp.getUrl("zrweml")},getTmpl:function(){var b=this;b.$mRootElement=a("#neotwi-page");b.$_TmplDnMsg=b.$mRootElement.find(".jntwi-neomsg").find(".jntwi-tmpl").remove();b.$_TmplDnMsgInfo=b.$mRootElement.find(".jntwi-neomsg").find(".jntwi-tmpl-info").remove();b.$_TmplNtwi=b.$mRootElement.find(".jntwi-ntwi").find(".jntwi-tmpl").remove();b.$_TmplDirect=b.$mRootElement.find(".jntwi-direct").find(".jntwi-tmpl").remove()},setView:function(){var b=this;if(b.boNtwi==true){b.$mRootElement.find(".jntwi-icon-ntwi").show()}else{b.$mRootElement.find(".jntwi-icon-ntwi").hide()}if(b.boDirect==true){b.$mRootElement.find(".jntwi-icon-direct").show()}else{b.$mRootElement.find(".jntwi-icon-direct").hide()}},setEvent:function(){var b=this;b.$mRootElement.find(".jntwi-neomsg").delegate("a.list","vclick",function(e){e.preventDefault();var f=a(this);var g=f.closest("li");var c=f.attr("href");var d=g.data("mid");if(d=="todo"){c=c+"cmd=todo"}else{if(d=="mail"){c=c+"cmd=mail"}else{if(d=="memo"){c=c+"cmd=memo"}else{if(d=="flow"){c=c+"cmd=flow"}else{if(d=="creport"){c=c+"cmd=creport"}else{if(d=="safety"){c=c+"cmd=safetyindex"}else{if(d=="info"){c=c+"cmd=infoindex"}else{if(d=="-1"){}else{if(b.boNtwiPage){desknets.sp.changePage("neomsg");return}else{desknets.sp.changePageOther("ntwi");return}}}}}}}}}desknets.sp.execLocation(c)});b.$mRootElement.find(".jntwi-direct").on("vclick","a.list",function(c){var d=a(this);if(b.boNtwiPage){c.preventDefault();desknets.sp.ntwi.DirectList.setPage(d.data("id"),d.data("name"),d.data("img"),b.IsReplyUser(d));desknets.sp.changePage("directlist")}else{neo.storage.local(desknets.sp.COOKIENAME_NTWIDMSG,{id:d.data("id"),name:d.data("name"),img:d.data("img"),boreply:b.IsReplyUser(d)})}})},setBtn:function(){var b=this;b.$mRootElement.find(".jntwi-icon-neomsg").bind("vclick",function(c){c.preventDefault();b.changeView("dnmsg")});b.$mRootElement.find(".jntwi-icon-ntwi").bind("vclick",function(c){c.preventDefault();b.getNtwi()});b.$mRootElement.find(".jntwi-icon-direct").bind("vclick",function(c){c.preventDefault();b.getDirect()});b.$mRootElement.find(".ntwi-more-ntwi").bind("vclick",function(c){c.preventDefault()});b.$mRootElement.find(".ntwi-more-ntwi").find("h3").bind("vclick",function(c){c.preventDefault();location.href=b.$mRootElement.find(".ntwi-more-ntwi").attr("href")});b.$mRootElement.find(".ntwi-more-direct").bind("vclick",function(c){c.preventDefault()});b.$mRootElement.find(".ntwi-more-direct").find("h3").bind("vclick",function(c){c.preventDefault();location.href=b.$mRootElement.find(".ntwi-more-direct").attr("href")});b.$mRootElement.find(".jntwi-entry").bind("vclick",function(c){if(b.boNtwiPage){c.preventDefault();desknets.sp.changePage("ntwientry")}});b.$mRootElement.find(".jntwi-directentry").bind("vclick",function(c){if(b.boNtwiPage){c.preventDefault();desknets.sp.ntwi.DirectEntry.setReply({});desknets.sp.changePage("directentry")}});b.$mRootElement.find(".co-neotwi-close").bind("vclick",function(c){c.preventDefault();b.$mRootElement.dialog("close")})},changeView:function(c){var b=this;b.$mRootElement.find(".co-neotwi-menu").removeClass("open");b.$mRootElement.find(".co-neotwi-tl").hide();b.$mRootElement.find(".jntwi-entry").hide();b.$mRootElement.find(".jntwi-directentry").hide();if(c=="dnmsg"){b.$mRootElement.find(".jntwi-icon-neomsg").addClass("open");b.$mRootElement.find(".jntwi-neomsg").show()}else{if(c=="ntwi"){b.$mRootElement.find(".jntwi-icon-ntwi").addClass("open");b.$mRootElement.find(".jntwi-ntwi").show();b.$mRootElement.find(".jntwi-entry").show()}else{if(c=="direct"){b.$mRootElement.find(".jntwi-icon-direct").addClass("open");b.$mRootElement.find(".jntwi-direct").show();b.$mRootElement.find(".jntwi-directentry").show()}}}},getAllNtwi:function(){var b=this;desknets.sp.ajax.rest({url:desknets.sp.getUrl(desknets.ntwi.MODULE_API_MAIN),data:b.getAllNtwiPrm(),success:function(i,d,j){var f=0;var e=0;var g=0;var c=0;var h=i[f];f++;e=b.setDnMsg(h);g=parseInt(h.talkcnt,10);c=parseInt(h.dmsgcnt,10);b.setNoticeCnt(e);b.setNtwiCnt(g,c)},detectMultiError:true});desknets.ntwi.checkMailIfEnabled()},getAllNtwiPrm:function(){var c=this;var d={};var f={};var e=0;var b={cmd:desknets.sp.CMD_NTWIMOBILENOTICE};d[e]=b;e++;f=desknets.ajax.arrayToMultiCmdData(d);return f},getNtwi:function(){var b=this;desknets.sp.ajax.rest({url:desknets.sp.getUrl(desknets.ntwi.MODULE_API_MAIN),data:b.getNtwiPrm(),success:function(d,c,e){b.setNtwi(d[0]);b.clearNtwiCnt();b.changeView("ntwi")},detectMultiError:true})},getNtwiPrm:function(){var c=this;var e={};var g={};var f=0;var b={cmd:desknets.ntwi.CMD_TALK_LIST,num:c.NTWI_GETLIMIT};e[f]=b;f++;var d={cmd:desknets.ntwi.CMD_NOTIFY,kind:"1"};e[f]=d;f++;g=desknets.ajax.arrayToMultiCmdData(e);return g},getDirect:function(){var b=this;desknets.sp.ajax.rest({url:desknets.sp.getUrl(desknets.ntwi.MODULE_API_MAIN),data:b.getDirectPrm(),success:function(d,c,e){if(!desknets.ntwi.pictogram.isSet()){desknets.ntwi.pictogram.setValuesFromJson(d["1"])}b.setDirect(d[0]);b.changeView("direct")},detectMultiError:true})},getDirectPrm:function(){var d=this;var e={};var g={};var f=0;var b={cmd:desknets.ntwi.CMD_MESSAGE_USER_LIST,num:d.NTWI_GETLIMIT};e[f]=b;f++;if(!desknets.ntwi.pictogram.isSet()){var c={cmd:desknets.ntwi.CMD_PICTOGRAM_LIST};e[f]=c;f++}g=desknets.ajax.arrayToMultiCmdData(e);return g},setDnMsg:function(e){var l=this;l.mboSafety=false;var h=desknets.sp.ajax.getJsonItems(e);var c=h.length;var b=0;var f=0;var k="";for(var i=0;i<c;i++){var g;var j=h[i];if(j.mid=="safety"){l.mboSafety=true}if(desknets.sp.Neotwi.chkNeoInfoViewSp(j)){if(f<l.NTWI_GETLIMIT){f++;if(j.mid!="-1"){g=l.$_TmplDnMsg.clone()}else{g=l.$_TmplDnMsgInfo.clone()}g.data("id",j.id);g.data("mid",j.mid);g.find("h3").html(desknets.tmpl.escapeWord(j.title));var d=l.getDnMsgBody(j);if(j.mid!="-1"){d=desknets.tmpl.escapeWordLF(d)}g.find(".ntwi-detail").html(d);g.find(".date").html(desknets.dateTime.dispDateTime(j.cretime,{type:"list"}));k="";if(Number(j.count)>1){k="("+desknets.Resource.ntwi.andNItemsLabel+")";k=desknets.tmpl.replaceWordHtml(k,"count",j.count-1);g.find(".morecnt").text(k)}g.insertBefore(l.$mRootElement.find(".jntwi-neomsg").find(".more"))}}else{b++}}c=c-b;return c},chkNeoInfoViewSp:function(b){var c=this;if(b.mid=="-1"){return false}if(b.mid=="info"&&!!b.othercnt&&b.othercnt=="1"){return false}return desknets.sp.menu.boSp(b.mid)},getDnMsgBody:function(b){var c=this;return desknets.ntwi.getNewsMessage(b,"detail")},setNtwi:function(h){var d=this;var i=desknets.sp.ajax.getJsonItems(h);d.$mRootElement.find(".jntwi-ntwi").find(".jntwi-tmpl").remove();var e=i.length;for(var g=0;g<e;g++){var b=d.$_TmplNtwi.clone();var c=i[g];b.data("id",c.id);c.uimgurl=desknets.sp.changePath(c.uimgurl);b.find("img").attr("src",c.uimgurl);b.find("h3").html(desknets.tmpl.escapeWord(c.uname));b.find(".detail").html(desknets.tmpl.escapeWord(c.detail));var f={cmd:"ntwidispattach",id:c.id};b.find(".detail").append(desknets.sp.attachDisp.disp(c.attach,desknets.sp.MODULE_MAIN,f));b.find(".date").html(desknets.dateTime.dispDateTime(c.cretime,{type:"list"}));b.find(".detail").each(function(){a(this).detectHref(desknets.sp.Neotwi.optHref)});b.insertBefore(d.$mRootElement.find(".jntwi-ntwi").find(".more"))}d.$mRootElement.find(".jntwi-ntwi").listview("refresh")},setDirect:function(f){var l=this;var i=desknets.sp.ajax.getJsonItems(f);l.$mRootElement.find(".jntwi-direct").find(".jntwi-tmpl").remove();var d=i.length;for(var j=0;j<d;j++){var h=l.$_TmplDirect.clone();var k=i[j];h.data("id",f.id);k.uimgurl=desknets.sp.changePath(k.uimgurl);var e=h.find("a.list");e.data("id",k.uid);e.data("img",k.uimgurl);e.data("name",k.uname);e.data("suspension",k.user_state);if(!!k.deluflg){e.data("deluflg",k.deluflg)}h.find("img").attr("src",k.uimgurl);h.find("h3").html("<span>"+desknets.tmpl.escapeWord(k.uname)+"</span>");if(!!k.sname){if(!!k.referurl&&k.referurl!=""){h.find(".detail").html('<div class="ntwi-list-img-size"><img border="0" src="'+k.referurl+'"></div>')}else{h.find(".detail").html("("+k.sname+")")}}else{if(!!k.detail){h.find(".detail").html(desknets.ntwi.pictogram.encodeForDisplay(k.detail))}else{var c="";var g={cmd:"ntwidmsgdispattach",id:k.id};if(!!k.attach.item.thumbnail){var b=desknets.getUrl(desknets.sp.MODULE_MAIN)+"?"+desknets.getNeoParam(g)+"&fno=1&thumbnail=1&filename="+encodeURIComponent(k.attach.item.attachdisp).replace(/'/g,"%27");if(desknets.sp.isAttachDownload(b)){c='<div class="ntwi-list-img-size"><img src="'+b+'"></div>'}else{c=desknets.sp.attachDisp.disp(k.attach,desknets.sp.MODULE_MAIN,g)}}else{c=desknets.sp.attachDisp.disp(k.attach,desknets.sp.MODULE_MAIN,g)}h.find(".detail").html(c)}}h.find(".date").html(desknets.dateTime.dispDateTime(k.cretime,{type:"list"}));h.find(".detail").each(function(){a(this).detectHref(desknets.sp.Neotwi.optHref)});if(k.read=="0"){h.addClass("unread")}h.insertBefore(l.$mRootElement.find(".jntwi-direct").find(".more"))}l.$mRootElement.find(".jntwi-direct").listview("refresh")},setNoticeCnt:function(c){var b=this;var d=a("body");if(b.mboSafety){d.addClass("_neotwi_safety")}if(c>0){b.$mRootElement.find(".jntwi-icon-neomsg").addClass("on").find("span").html(c).show();d.addClass("_neotwi_system")}else{b.$mRootElement.find(".jntwi-icon-neomsg").removeClass("on").find("span").html(c).hide();d.removeClass("_neotwi_system")}},setNtwiCnt:function(e,c){var b=this;var d=a("body");if(e>0){b.$mRootElement.find(".jntwi-icon-ntwi").addClass("on").find("span").html(e).show()}else{b.$mRootElement.find(".jntwi-icon-ntwi").removeClass("on").find("span").html(e).hide()}if(c>0){b.$mRootElement.find(".jntwi-icon-direct").addClass("on").find("span").html(c).show()}else{b.$mRootElement.find(".jntwi-icon-direct").removeClass("on").find("span").html(c).hide()}if(b.boNtwi||b.boDirect){if(e>0||c>0){d.addClass("_neotwi_new")}else{d.removeClass("_neotwi_new")}}else{d.removeClass("_neotwi_new")}},clearNtwiCnt:function(){var b=this;b.setNtwiCnt(0,parseInt(b.$mRootElement.find(".jntwi-icon-direct").find("span").text(),10))},IsReplyUser:function(b){var d=true;var c=b.data("deluflg");if((!!c&&c=="1")||b.data("suspension")=="1"){d=false}return d},});desknets.sp.ajax={};a.extend(desknets.sp.ajax,desknets.ajax,{init:function(){a.ajaxSetup({traditional:true})},onError:function(b,c,d){desknets.sp.msg.view(b,c,d)},_setUpOptions:function(c){var b=this;if(typeof(c.dataType)!=="string"){c.dataType="json"}if(!a.isFunction(c.error)){c.error=function(e,d,f){b.onError(e.status,f,c.dialogback)}}},_setUpToken:function(c){if(neo.isSet(c.data)&&c.processData!==false){var b=a.cookie(desknets.COOKIENAME_STOKEN);if(neo.isSet(b)&&!neo.isSet(c.data[b])){c.data[b]="1"}}}});desknets.page(desknets.sp,"msg",desknets.sp.ComPage,{mboBack:false,mboFunc:null,init:function(b){this.mboDialog=true},hiding:function(){var b=this;b.callBase("hiding");if(typeof b.mboFunc==="function"){b.mboFunc()}else{if(b.mboBack===true){setTimeout(function(){history.back()},100)}}},initSet:function(){var b=this;b.$mRootElement=a("#dialog-page");b.$mRootElement.find('div:jqmData(role="header")').show();desknets.sp.mobjPages["dialog-page"]=desknets.sp.msg;b.$mRootElement.find(".jco-errclose").bind("vclick",function(c){b.$mRootElement.dialog("close")})},view:function(d,c,e){var b=this;b.mboBack=e;b.mboFunc=null;a(".co-layout").hide();a(window).unbind(".colayout");if(d==401){setTimeout(function(){desknets.sp._executeOnSessionExpired()},1)}else{var f=desknets.parseErrorInfo(c,d);b._view(f.message,f.level)}},_view:function(d,c){var b=this;c=(typeof(c)=="undefined")?"error":c;b.$mRootElement.find("h1").html(desknets.Resource[c+"DefaultTitle"]);b.$mRootElement.find(".dialog-msg").html(d);var f=b.$mRootElement.find(".jco-errclose");var e=f.find("span");if(e.length>0){e.html(desknets.Resource.CloseButtonLabel)}else{f.html(desknets.Resource.CloseButtonLabel)}a.mobile.changePage("#dialog-page")},srchview:function(e){var b=this;b.mboBack=false;b.mboFunc=e;b.$mRootElement.find("h1").html(desknets.Resource.messageDefaultTitle);b.$mRootElement.find(".dialog-msg").html(desknets.Resource.sp.search);var d=b.$mRootElement.find(".jco-errclose");var c=d.find("span");if(c.length>0){c.html(desknets.Resource.sp.searchstop)}else{d.html(desknets.Resource.sp.searchstop)}a.mobile.changePage("#dialog-page")},mailrecvview:function(e,c,d){var b=this;b.mboBack=false;b.mboFunc=e;b.$mRootElement.find("h1").html(desknets.Resource.messageDefaultTitle);b.$mRootElement.find(".dialog-msg").html(c);var f=b.$mRootElement.find(".jco-errclose");f.hide();a.mobile.changePage("#dialog-page")}});desknets.sp.validation={isSrchInputDateFromTo:function(e){var d=this;var c=true;var b="";e.find(".jco-search-date").each(function(){var g=a(this);var f=g.find("legend").not(".jco-nottitle");if(f.length==1){b=f.text()}else{b=false}c=d.isInputDateFromTo(g,b);if(c===false){return false}});return c},isInputDateFromTo:function(d,b){var c=this;var h=d.find('input[type="text"]');var e=h.eq(0);var g=h.eq(1);if(e.length>0&&g.length>0&&e.val().length>0&&g.val().length>0){if(e.val()>g.val()){if(neo.isSet(b)){var f="";if(b===false){f=desknets.Resource.Message.com_datechk_fromto}else{f=desknets.tmpl.replaceWordHtml(desknets.Resource.Message.com_datechk_fromto_item,"item",b)}desknets.sp.msg.view("",f)}return false}}return true},};desknets.sp.attachDisp={};a.extend(desknets.sp.attachDisp,desknets.attachDisp,{_TMP_ATTACHAREA:'<div class="jco-attach-area">{{tmpl}}</div>',editDispItem:function(g,e,b){var c=this;var h="",d,f="";var i=desknets.tmpl.escapeWord(e.attachdisp);if(e.size){f=" ("+desknets.attachDisp.getSize(e.size)+")"}else{f=" ("+desknets.Resource.attachInvSize+")"}if(g!=0){h=c.dispDelimited()}if(b.cgi==null||!desknets.sp.isAttachDownload(b.query)){h=h+i+f}else{d=b.cgi+"?"+b.query+"&fno="+e.id+"&filename="+encodeURIComponent(e.attachdisp).replace(/'/g,"%27");h=h+'<a target="attach" href="'+d+'">'+i+"</a>"+f}return h},dispDelimited:function(){return'<br /><div class="co-attach-space"></div>\n'}});desknets.sp.seldate={formatDate:"",formatTime:"",setUp:function(c){var b=this;b._setFormat();b._setUpDate(c);b._setUpTime(c);b._setUpClear(c)},setUpDate:function(c){var b=this;b._setFormat();b._setUpDate(c);b._setUpClear(c)},setUpTime:function(d,c){var b=this;b._setFormat();b._setUpTime(d,c);b._setUpClear(d)},_setFormat:function(){var c=this;var d=desknets.Resource.scrFormat_date;var b=desknets.Resource.scrFormat_time;d=d.replace("yy","yyyy");d=d.replace("mm","MM");b=b.replace("ii","mm");c.formatDate=d;c.formatTime=b},_setUpDate:function(c){var b=this;c.find(".mbscroll-date").scroller({preset:"date",minDate:new Date(1970,0,3),maxDate:new Date(2038,0,16),dateFormat:desknets.Resource.scrFormat_date,dateOrder:desknets.Resource.scrFormat_dateorder,theme:"ios",display:"modal",rows:3,height:35,mode:"scroller",setText:desknets.Resource.OKButtonLabel,cancelText:desknets.Resource.CancelButtonLabel,onSelect:function(e,d){a(this).change()}});c.on("focus",".mbscroll-date",function(){setTimeout(function(){a(".dwb").focus()},500)});c.on("change.seldate",".mbscroll-date",function(){var d=desknets.sp.changeDateFormat_JP(b.formatDate,a(this).val(),false);a(this).data("rval",d)})},_setUpTime:function(d,c){var b=this;var e={preset:"time",timeFormat:desknets.Resource.scrFormat_time,timeWheels:desknets.Resource.scrFormat_timewheels,theme:"ios",display:"modal",rows:3,height:35,mode:"scroller",setText:desknets.Resource.OKButtonLabel,cancelText:desknets.Resource.CancelButtonLabel,onSelect:function(g,f){a(this).change()}};a.extend(e,c);d.find(".mbscroll-time").scroller(e);d.on("focus",".mbscroll-time",function(){setTimeout(function(){a(".dwb").focus()},500)});d.on("change.seldate",".mbscroll-time",function(){var f=desknets.sp.changeTimeFormat_JP(b.formatTime,a(this).val(),false);a(this).data("rval",f)})},_setUpClear:function(b){b.find(".mbscroll-clear").click(function(){var c=a(this).parent().find("input");c.val("");c.data("rval","");return false})},closeDate:function(){if(a(".dw.dwbg").length>0){a(".dw.dwbg").find(".dwbc").find(".dwbw.dwb-c").find(".dwb").click()}},changeFormatDate:function(e){var b=this;var c="&nbsp;";var d;if(!neo.isSet(e,{blank:false})){return c}d=neo.dateTime.parse(e);c=neo.dateTime.format(b.formatDate,d);return c}};desknets.sp.menu={arView:[],arSp:["ntwi","ntwid","ntwistamp","sch","todo","mail","mailimap","memo","plant","flow","creport","info","addr","memp","cab","safety"],init:function(){var b=this;a(".jco-module").each(function(){b.arView[b.arView.length]=a(this).text()})},boView:function(c){var b=this;if(a.inArray(c,b.arView)>=0){return true}return false},boSp:function(c){var b=this;if(a.inArray(c,b.arSp)>=0){return true}return false},};a.fn.searchkeychg=function(){$div=a(this).closest(".ui-input-search");if($div.find("input").val().length>0){$div.find("a").removeClass("ui-input-clear-hidden")}else{$div.find("a").addClass("ui-input-clear-hidden")}};desknets.init();desknets.sp.init()})(jQuery);