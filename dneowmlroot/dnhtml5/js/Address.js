/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2017 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
(function(a){var d=neo.core.readyNamespace("neo.denbun.Address");if(!d){return}var b=neo.denbun;var c=neo.denbun.Address=new neo.core.Class({classProperties:{DROPPABLE_SCOPE_ADDRESS:"address",DROPPABLE_SCOPE_USER:"user",PARAM_INIT_PARAMETER:"initParameter",PARAM_CMD:"cmd",PARAM_INDEX_NAME_OF_KANA:"kana",PARAM_INDEX_NAME_OF_COMPANY_KANA:"companyKana",PARAM_INDEX_NAME_OF_OLD_KANA:"oldKana",PARAM_INDEX_NAME_OF_OLD_COMPANY_KANA:"oldCompanyKana",PARAM_AREA:"area",INIT_PARAMETER_FALSE:"false",CMD_RELOAD:"reload",constructor:function(){},getMailAddressForGroup:function(h,f,g){if(f.length>20){f=f.substr(0,18)+".."}f=f.replace(/\\/g,"\\\\");f=f.replace(/'/g,"\\'");f=f.replace(/"/g,'\\"');var e='@"'+f+":"+g+":"+Math.abs(h)+'"';return{mail:e,text:e}},getMailAddressLabelByText:function(f){var e="";if(b.isSendGroupFormat(f)){e="@"+b.getDecodeQuotEscape(f.slice(2,-1));if(e=="@"){e=""}}else{var g=b.getParsedMailToAddressAndName(f);if(g.name==""){e=g.address}else{e=g.name+"<"+g.address+">"}}return e},banpei:null},properties:{__constructor:function(){if(this instanceof c){var e="Class <neo.denbun.Address> is not allowed to build instances.";throw new Error("neo.denbun.Address.__constructor : "+e)}}}});c.constructor()})(jQuery);(function(a){var e=neo.core.readyNamespace("neo.denbun.Address.AddressTable");if(!e){return}var b=neo.denbun;var d=neo.denbun.Address;var c=neo.denbun.Address.AddressTable=new neo.core.Class({superClass:b.Table,classProperties:{VAL_MODE_DEFAULT:0,VAL_MODE_SEARCH:1,VAL_MAILLINK_NOTHING:"0",VAL_MAILLINK_NORMAL:"1",VAL_MAILLINK_WEBMAIL:"2",banpei:null},properties:{_mode:null,_getMode:function(){return this._mode},_setMode:function(f){return this._mode=f},setting:null,_getPage:function(){return this.setting.page},__constructor:function(f){b.Table.prototype.__constructor.apply(this,arguments)},initialize:function(){b.Table.prototype.initialize.apply(this,arguments)},switchMode:function(f){this._setMode(f);if(this.isSearchMode()){this.updateTitle()}},_updateToolbarEnabled:function(f){var g=this._getPage();g.updateMenuEnabled()},updateToolbarEnabled:function(f){this._updateToolbarEnabled(f)},_getTableRange:function(){var f=b.comSetting.getAddressRow();return f},isSearchMode:function(){return this._getMode()==c.VAL_MODE_SEARCH},isSelectorMode:function(){var f=this._getPage();return f.isSelectorMode()},getVisibleMailsById:function(g){var p=this._getRowOf(g);var h=p.data;var l=this.getVisibleMails(h);var f=this._getNameOf(h);var m=[];for(var j=0;j<l.length;j++){var k=l[j];var o=b.getDestinationText(f,k);var n={mail:k,text:o};m.push(n)}return m},getVisibleMails:function(f){},_getNameFrom:function(f){},_getNameOf:function(f){},isElMail:function(f){},_getMailFrom:function(f){},_getElMailFrom:function(f){},_getElSelectMailFrom:function(f){},updateTable:function(){this._updateTable()},getSelectedMailArray:function(){var g=this.getSelectedIdList();var j=[];for(var f=0;f<g.length;f++){var h=this.getVisibleMailsById(g[f]);j=j.concat(h)}return j},getMailLinkSetting:function(){var f=b.comSetting.getMailLinkSetting();if(f==d.AddressTable.VAL_MAILLINK_WEBMAIL&&!b.comSetting.isAvailableWebMail()){f=d.AddressTable.VAL_MAILLINK_NOTHING}return f},_buildHtmlMailLinkForNormalMode:function(i,g,h,j){var f=this.getMailLinkSetting();switch(f){case d.AddressTable.VAL_MAILLINK_NORMAL:i.push('<span class="');i.pushText(h);i.push('">');i.push('<a href="mailto:');i.pushValue(g);i.push('">');i.pushText(g);i.push("</a>");break;case d.AddressTable.VAL_MAILLINK_WEBMAIL:if(j){i.push('<span class="address-table-mail-item ')}else{i.push('<span class="users-table-mail-item ')}i.pushText(h);i.push(' link">');i.pushText(g);break;default:i.push('<span class="');i.pushText(h);i.push('">');i.pushText(g)}i.push("</span>");return i},onchangeImmediately:function(f){this._updateToolbarEnabled(f)},onclickRow:function(h,j){var n=a(h.target);var q=this.isSelectorMode();var v=this.isElMail(n);var k=true;if(DENBUN_MODE_XNEO){var o=this.getMailLinkSetting();if(o!=d.AddressTable.VAL_MAILLINK_WEBMAIL){k=false}}if(!q&&v&&k){h.preventDefault();var l=this._getElMailFrom(n);var g=this._getNameFrom(n);var m=this._getMailFrom(l);var s=b.getDestinationText(g,m);var r={mail:m,text:s};var f=b.getMailAddressForToMailInputItem(r);var u={method:b.METHOD_POST,to:f};u[b.PARAM_FORK]=true;b.openPage(b.PAGE_MAIL_EDIT,u,false);return}if(q&&v){h.preventDefault();var l=this._getElMailFrom(n);var i=this._getRowIdFrom(n);var t=this._getRowOf(i);var g=this._getNameOf(t.data);var m=this._getMailFrom(l);var s=b.getDestinationText(g,m);var r={mail:m,text:s};var p=this._getPage();if(p.isExistedMailInSelectedList(r)){p.removeMailFromSelectedList(r)}else{p.addMailToSelectedList(r)}this._updateTable();return}b.Table.prototype.onclickRow.apply(this,arguments)},banpei:null}});c.constructor()})(jQuery);(function(a){var e=neo.core.readyNamespace("neo.denbun.Address.AddressFolders");if(!e){return}var b=neo.denbun;var d=b.Address;var c=neo.denbun.Address.AddressFolders=new neo.core.Class({superClass:b.Tree,classProperties:{CLS_ROOT_NODE:"tree-root-node",CLS_MENU_ITEM_FOR_MUTABLE_FOLDER:"address_list-for_mutable_folder",CLS_MENU_ITEM_FOR_SEND_MAIL_FOLDER:"address_list-for_send_mail_folder",DATA_FOLDER_TYPE:"data-folder_type",DATA_FOLDER_TYPE_ALL:3,DATA_FOLDER_TYPE_PRIVATE:1,DATA_FOLDER_TYPE_PUBLIC:2,VAL_NODE_ID_ALL:"all-tree",VAL_NODE_ID_PRIVATE:"private-tree",VAL_NODE_ID_PUBLIC:"public-tree",VAL_MOVE_NODE_UP:"up",VAL_MOVE_NODE_DOWN:"down",constructor:function(){}},properties:{setting:null,_getPage:function(){return this.setting.page},_curType:null,_getCurType:function(){return this._curType},_setCurType:function(f){return this._curType=f},_elCreate:null,_getElCreate:function(){return this._elCreate||this._initElCreate()},_initElCreate:function(){return this._elCreate=a("#address-folder-create")},_elRemove:null,_getElRemove:function(){return this._elRemove||this._initElRemove()},_initElRemove:function(){return this._elRemove=a("#address-folder-remove")},_elUp:null,_getElUp:function(){return this._elUp||this._initElUp()},_initElUp:function(){return this._elUp=a("#address-folder-up")},_elDown:null,_getElDown:function(){return this._elDown||this._initElDown()},_initElDown:function(){return this._elDown=a("#address-folder-down")},_ajaxCreate:null,_getAjaxCreate:function(){return this._ajaxCreate||this._initAjaxCreate()},_initAjaxCreate:function(){var f=this;var g={getSendData:this.__closure(function(){var i={cmd:"addrcmdgrppentry",Name:this._getElCreateFolderName().val(),area:this._getElCreateFolderArea().filter(":checked").val()};return i}),onsuccess:this.__closure(this.onsuccessCreate)};var h=new b.Ajax(g);h.initialize();return this._ajaxCreate=h},_dlgCreate:null,_getDlgCreate:function(){return this._dlgCreate||this._initDlgCreate()},_initDlgCreate:function(){var f={content:this._getElContentOfDlgCreate(),title:b.getText("アドレスフォルダ作成"),onopen:this.__closure(this._updateDlgCreate),onok:this.__closure(this._sendRequestToCreate)};var g=new b.Dialog(f);g.initialize();return this._dlgCreate=g},_elContentOfDlgCreate:null,_getElContentOfDlgCreate:function(){return this._elContentOfDlgCreate||this._initElContentOfDlgCreate()},_initElContentOfDlgCreate:function(){return this._elContentOfDlgCreate=a("#dlg-address_folder-create")},_elCreateFolderName:null,_getElCreateFolderName:function(){return this._elCreateFolderName||this._initElCreateFolderName()},_initElCreateFolderName:function(){var f=this._getElContentOfDlgCreate();return this._elCreateFolderName=f.find("input[name=Name]")},_elCreateFolderAreaContainer:null,_getElCreateFolderAreaContainer:function(){return this._elCreateFolderAreaContainer||this._initElCreateFolderAreaContainer()},_initElCreateFolderAreaContainer:function(){var f=this._getElContentOfDlgCreate();return this._elCreateFolderAreaContainer=f.find(".dlg-address_folder-area-container")},_elCreateFolderArea:null,_getElCreateFolderArea:function(){return this._elCreateFolderArea||this._initElCreateFolderArea()},_initElCreateFolderArea:function(){var f=this._getElContentOfDlgCreate();return this._elCreateFolderArea=f.find("input[name=area]")},_ajaxRename:null,_getAjaxRename:function(){return this._ajaxRename||this._initAjaxRename()},_initAjaxRename:function(){var f=this;var g={getSendData:this.__closure(function(){var j=this.getCurNodeId();var i={cmd:"addrcmdgrppentry",id:j,Name:this._getElRenameFolderName().val(),area:"1"};return i}),onsuccess:this.__closure(this.onsuccessRename)};var h=new b.Ajax(g);h.initialize();return this._ajaxRename=h},_dlgRename:null,_getDlgRename:function(){return this._dlgRename||this._initDlgRename()},_initDlgRename:function(){var f={content:a("#dlg-address_folder-rename"),title:b.getText("_アドレス一覧＞フォルダ名変更"),onopen:this.__closure(this._updateDlgRename),onok:this.__closure(this._sendRequestToRename)};if(DENBUN_MODE_XNEO){f.title=b.getText("アドレスフォルダ名変更")}var g=new b.Dialog(f);g.initialize();return this._dlgRename=g},_elRenameFolderName:null,_getElRenameFolderName:function(){return this._elRenameFolderName||this._initElRenameFolderName()},_initElRenameFolderName:function(){return this._elRenameFolderName=a("#address_folder-rename-name")},_getElContainerLow:function(){return a("#address-folder-book-body")},_load:function(){this._setCurType(c.TYPE_PRIVATE);this.__call("_load",arguments)},_hook:function(){this.__call("_hook",arguments);var g;var i=this.getElRoot();var f=i.find("."+b.Tree.CLS_LINK);this._hookDroppable(f);var h=this.__closure(this._updateMenuStatus);b.app.registerMenuCallback(h,"address_list","address_folder")},_hookDroppable:function(f){var g=this._getDroppableOptions();f.droppable(g)},_getDroppableOptions:function(){var f={scope:b.Address.DROPPABLE_SCOPE_ADDRESS,tolerance:"pointer",drop:this.__closure(this.ondrop),over:this.__closure(this.ondropover),out:this.__closure(this.ondropout)};return f},_getSendDataToLoad:function(){var f={cmd:"addrgroups",area:this._getCurType(),fid_pvt:undefined,proc:undefined};return f},_openFirstNode:function(){if(DENBUN_MODE_XNEO){var g=b.getParameter("key");if(g&&g!=""){var f=this._getTmOnChange();clearTimeout(f);var h=this._getPage();h.setReady();h.updateMenuEnabled();h.setEasySearchKeyword(g);h.execEasySearch()}else{this.select(c.VAL_NODE_ID_PRIVATE);var h=this._getPage();h.setReady();h.updateMenuEnabled()}}else{this.select(c.VAL_NODE_ID_PRIVATE);var h=this._getPage();h.setReady();h.updateMenuEnabled()}},_buildElement:function(p){var g={};var o={};g.order=[];o.order=[];for(var j=0;j<p.order.length;j++){var f=p.order[j];var h=p[f];if(Number(f)<0){g[f]=h;g.order.push(f)}else{o[f]=h;o.order.push(f)}}var n=this._buildElEmptyTree();var l=this._buildElAllNode();n.append(l);var k=this._buildElPrivateNode(g);n.append(k);var m=this._buildElPublicNode(o);n.append(m);n.addClass(b.Tree.CLS_ROOT);return n},_buildElAllNode:function(){var g={};g.id=c.VAL_NODE_ID_ALL;g.Name=b.getText("（すべて）");this._addNode(g);var f=this._buildElNodeLow(g);f.addClass(c.CLS_ROOT_NODE);f.attr(c.DATA_FOLDER_TYPE,c.DATA_FOLDER_TYPE_ALL);return f},_buildElPrivateNode:function(f){var h=this._buildElEmptyPrivateNode();var g=this._buildElTree(f);h.append(g);if(f.order.length>0){h.addClass(b.Tree.CLS_WITH_CHILDREN);this._openElNode(h)}return h},_buildElEmptyPrivateNode:function(){var g={};g.id=c.VAL_NODE_ID_PRIVATE;g.Name=b.getText("（個人）");this._addNode(g);var f=this._buildElNodeLow(g);f.addClass(c.CLS_ROOT_NODE);f.attr(c.DATA_FOLDER_TYPE,c.DATA_FOLDER_TYPE_PRIVATE);return f},_buildElPublicNode:function(f){var h=this._buildElEmptyPublicNode();var g=this._buildElTree(f);h.append(g);if(f.order.length>0){h.addClass(b.Tree.CLS_WITH_CHILDREN);this._openElNode(h)}return h},_buildElEmptyPublicNode:function(){var g={};g.id=c.VAL_NODE_ID_PUBLIC;g.Name=b.getText("（共有）");this._addNode(g);var f=this._buildElNodeLow(g);f.addClass(c.CLS_ROOT_NODE);f.attr(c.DATA_FOLDER_TYPE,c.DATA_FOLDER_TYPE_PUBLIC);return f},unselectAll:function(){this._unselectAll();this._setCurNodeId(null);this._elCurNode=a("empty")},_isValidDraggable:function(h,g){var f=this._getElNodeFrom(g);var i=this.getNodeIdFrom(f);return(this._isRowDroppableFolder(i))},_hookOneNode:function(g){var f=this._getElLinkFrom(g);this._hookDroppable(f)},remove:function(){var f=this._getPage();if(f.isSelectorMode()){return}var g=this.getCurNodeId();if(!this.isMutableFolderId(g)){return}this.__call("remove",arguments)},_getRemoveMessage:function(){return b.getText("フォルダを削除してよろしいですか？\nアドレスは削除されません。")},execRemoving:function(i){var f=this;var g={getSendData:function(){var j={cmd:"addrgrpdel",id:i};return j},onsuccess:function(){f._moveFromRemovingNode(i);f._execRemovingLow(i)}};var h=new b.Ajax(g);h.initialize();h.sendRequest()},rename:function(){var f=this._getPage();if(f.isSelectorMode()){return}var h=this.getCurNodeId();if(!this.isMutableFolderId(h)){return}var g=this._getDlgRename();g.open()},_updateDlgRename:function(h){var g=this.getCurNodeId();var f=this.getNameOf(g);var i=this._getElRenameFolderName();i.val(f);setTimeout(function(){i.select()},1)},_sendRequestToRename:function(){var h=this._getErrorMessageToRename();if(h){b.alert(h);return false}var k=this._getElRenameFolderName();var g=k.val();var j=this.getCurNodeId(j);var f=this.getNameOf(j);if(g==f){return}var i=this._getAjaxRename();i.sendRequest()},_getErrorMessageToRename:function(){var g=null;var j=this._getElRenameFolderName();var f=j.val();if(/^[ 　]*$/.test(f)){var h=neo.denbun.getText("フォルダ名");var i=neo.denbun.getText("$$を入力してください。");var g=neo.core.replace(i,h)}return g},_updateNameLow:function(g,f){this.__call("_updateNameLow",arguments);this._updateNameInTable()},_updateNameInTable:function(){var f=this._getPage();f.updateFolderNameInTable()},create:function(){var f=this._getDlgCreate();f.open()},_updateDlgCreate:function(h){var i=this._getElCreateFolderName();i.val("");var f=this._getElCreateFolderArea();f.filter("[value="+c.DATA_FOLDER_TYPE_PRIVATE+"]").attr("checked",true);var g=this._getElCreateFolderArea();if(b.comSetting.hasAuthorityToCreateAddressFolder()){g.removeClass(b.CLS_DISABLED);f.attr("disabled",false)}else{g.addClass(b.CLS_DISABLED);f.attr("disabled",true)}setTimeout(function(){i.select()},1)},_sendRequestToCreate:function(){var f=this._getErrorMessageToCreate();if(f){b.alert(f);return false}var g=this._getAjaxCreate();g.sendRequest()},_getErrorMessageToCreate:function(){var g=null;var j=this._getElCreateFolderName();var f=j.val();if(/^[ 　]*$/.test(f)){var h=neo.denbun.getText("フォルダ名");var i=neo.denbun.getText("$$を入力してください。");g=neo.core.replace(i,h)}return g},_execCreateLow:function(j,g,i){var h={};h.id=j;h.Name=g;var f;if(i==c.DATA_FOLDER_TYPE_PRIVATE){f=c.VAL_NODE_ID_PRIVATE}else{if(i==c.DATA_FOLDER_TYPE_PUBLIC){f=c.VAL_NODE_ID_PUBLIC}}this.append(h,f);this._openPathTo(j);this.scrollToShow(j)},moveUp:function(){var f=this.getCurNodeId();if(!this.isMutableFolderId(f)){return}this._execMoveUpDown(f,c.VAL_MOVE_NODE_UP)},moveDown:function(){var f=this.getCurNodeId();if(!this.isMutableFolderId(f)){return}this._execMoveUpDown(f,c.VAL_MOVE_NODE_DOWN)},_execMoveUpDown:function(l,f){var h=this.getElNodeOf(l);var i;if(f==c.VAL_MOVE_NODE_UP){i=this._getElPrevNode(h)}else{if(f==c.VAL_MOVE_NODE_DOWN){i=this._getElNextNode(h)}}if(!i||i.length==0){return}var g=this;var j={getSendData:function(){var m={cmd:"addrgrpupdown",proc:f,id:l};return m},onsuccess:function(){if(f==c.VAL_MOVE_NODE_UP){i.before(h)}else{if(f==c.VAL_MOVE_NODE_DOWN){i.after(h)}}}};var k=new b.Ajax(j);k.initialize();k.sendRequest()},_getDroppableSetting:function(){var f=this;var g={hoverClass:b.Tree.CLS_LINK_HOVERED,tolerance:"pointer",drop:this.__closure(this.ondrop)};return g},_moveRows:function(i,h){if(!this._isRowDroppableFolder(i)){return}var f=h.data(b.Table.DATA_SELECTED_DATA_LIST);var g=this._getPage();g.moveRows(f,i)},_isRowDroppableFolder:function(h){if(!h){return false}var f=this.getElNodeOf(h);if(f.is("."+c.CLS_ROOT_NODE)){return false}var g=this._getFolderTypeFrom(f);if(g==c.DATA_FOLDER_TYPE_PUBLIC){if(!b.comSetting.hasAuthorityToCreateAddress()){return false}}return true},_updateMenuStatus:function(h){var f=h.find("."+b.App.Menu.CLS_MENU_ITEM);f.removeClass(b.CLS_DISABLED);var i=f.filter("."+c.CLS_MENU_ITEM_FOR_MUTABLE_FOLDER);var g=this.getElCurNode();var k=this.getNodeIdFrom(g);if(!this.isMutableFolderId(k)){i.addClass(b.CLS_DISABLED)}var j=f.filter("."+c.CLS_MENU_ITEM_FOR_SEND_MAIL_FOLDER);if(g.is("."+c.CLS_ROOT_NODE)){j.addClass(b.CLS_DISABLED)}},_updateOperatorStatus:function(){var j=this._getElCreate();j.attr("disabled",false);var f=this._getElRemove();var h=this._getElUp();var k=this._getElDown();var g=this.getElCurNode();var l=this.getNodeIdFrom(g);var i=this.isMutableFolderId(l);f.attr("disabled",!i);h.attr("disabled",!i);k.attr("disabled",!i)},_openFolder:function(i){var f=this.getElNodeOf(i);var g=this._getFolderTypeFrom(f);if(f.is("."+c.CLS_ROOT_NODE)){i=undefined}neo.denbun.keysearch.cleanUp("address-table-search-keyword");var h=this._getPage();h.loadTable(i,g)},_getFolderTypeFrom:function(g){var f=this._getElRootNodeFrom(g);var h=f.attr(c.DATA_FOLDER_TYPE);return h},_getElRootNodeFrom:function(g){var f=g.closest("."+c.CLS_ROOT_NODE);return f},isMutableFolderId:function(h){if(!h){return false}var f=this.getElNodeOf(h);if(f.is("."+c.CLS_ROOT_NODE)){return false}var g=this._getFolderTypeFrom(f);if(g==c.DATA_FOLDER_TYPE_PUBLIC){if(!b.comSetting.hasAuthorityToCreateAddressFolder()){return false}}return true},getMailAddress:function(){var j=this.getCurNodeId();if(!j){return null}var f=this.getElNodeOf(j);if(f.is("."+c.CLS_ROOT_NODE)){return null}var g=this.getNameOf(j);var h=this._getFolderTypeFrom(f);if(h==c.DATA_FOLDER_TYPE_PRIVATE){h=b.SEND_GROUP_TYPE_ADDRESS_PERSONAL}else{h=b.SEND_GROUP_TYPE_ADDRESS_PUBLIC}var i=d.getMailAddressForGroup(j,g,h);return i},getFolderIdAndType:function(){var i=this.getCurNodeId();if(!i){return null}var f=this.getElNodeOf(i);if(f.is("."+c.CLS_ROOT_NODE)){return null}var g=this._getFolderTypeFrom(f);var h={id:i,type:g};return h},onsuccessLoad:function(g,f,h){this.__call("onsuccessLoad",arguments);this._openFirstNode()},onchange:function(f){this._openFolder(f);this._updateOperatorStatus()},ondrop:function(i,k,l){var j=this._getPage();var g=j._getElLeftContainer().width()||0;if(g<k.position.left-3){return}this._setElLastHoveredNode(null);var h=this._getElNodeFrom(a(l));var f=this.getNodeIdFrom(h);this._moveRows(f,k.helper)},onsuccessRename:function(g,f,i){var j=b.getAjaxSendParams(f);var k=j.id;var h=j.Name;this._updateNameLow(k,h)},onsuccessCreate:function(g,f,i){var k=b.getAjaxSendParams(f);var l=a(g).find("id").text();var h=k.Name;var j=k.area;this._execCreateLow(l,h,j)},__closure:b.__closure,__bind:b.__bind,banpei:null}});c.constructor()})(jQuery);(function(a){var e=neo.core.readyNamespace("neo.denbun.Address.AddressPage");if(!e){return}var b=neo.denbun;var d=b.Address;var c=neo.denbun.Address.AddressPage=new neo.core.Class({superClass:b.Page,classProperties:{MODE:"mode",MODE_SELECTOR:"selector",CLS_PAGE_ITEM_ADDRESS_SELECTOR_MODE:"page-item-address_selector_mode",CLS_POPUP_MENU_ADDRESS_SELECTOR_MODE:"popup_menu-list-address_selector_mode",constructor:function(){}},properties:{_ready:null,isReady:function(){return this._ready},_initReady:function(){return this._ready=false},setReady:function(){return this._ready=true},_mode:null,_getMode:function(){return this._mode||this._initMode()},_initMode:function(){return this._mode=b.getParameter(c.MODE)},_to:null,_getTo:function(){return this._to||this._initTo()},_initTo:function(){var f=b.getParameter("to");return this._to=b.getParsedAddresses(f)},_cc:null,_getCc:function(){return this._cc||this._initCc()},_initCc:function(){var f=b.getParameter("cc");return this._cc=b.getParsedAddresses(f)},_bcc:null,_getBcc:function(){return this._bcc||this._initBcc()},_initBcc:function(){var f=b.getParameter("bcc");return this._bcc=b.getParsedAddresses(f)},_targetList:null,_getTargetList:function(){return this._targetList||this._initTargetList()},_initTargetList:function(){return this._targetList=b.getParameter("targetList")},_elSelectFolderTab:null,_getSelectElFolderTab:function(){return this._elSelectFolderTab||this._initElSelectFolderTab()},_initElSelectFolderTab:function(){return this._elSelectFolderTab=this._getElSelectFolderTabLow()},_getElSelectFolderTabLow:function(){},__constructor:function(){this._initReady()},initialize:function(){this._hook();this.setReady()},_updateMenuStatus:function(i){if(this.isReady()){var l=this._getTable();if(DENBUN_MODE_XNEO){var h=this;var g=function(m){var o=l.getSelectedIdList();var n=o.length;b.app.updateMenuEnabledByLength(m,n);h._updateMenuEnable(m)};setTimeout(function(){g(i)},1)}else{var k=l.getSelectedIdList();var j=k.length;b.app.updateMenuEnabledByLength(i,j)}}else{var f=i.find("."+b.App.Menu.CLS_MENU_ITEM);f.addClass(b.CLS_DISABLED)}},_updateMenuEnable:function(f){},_hook:function(){var f;f=this._getSelectElFolderTab();this.__bind(f,"click","FolderTab")},_initOnOpening:function(){this._initPageParameter();if(this.isSelectorMode()){if(DENBUN_MODE_XNEO){if(b.isTablet()){b.$body.addClass(b.CLS_COM_LEFT_CONTAINER_NARROW)}}this._showLeft();this._showRight();b.app.toggleDisabledOfHeaderLink(true)}else{this._showLeft();this._hideRight()}this._updatePageClass();this._updateSelectedList()},_initPageParameter:function(){var f=b.getParameter(d.PARAM_INIT_PARAMETER);if(f==d.INIT_PARAMETER_FALSE){return}this._initMode();this._initTo();this._initCc();this._initBcc();this._initTargetList()},_updatePageClass:function(){var h=this.isSelectorMode();var g=c.CLS_PAGE_ITEM_ADDRESS_SELECTOR_MODE;var f=this._getElOwnItems();f.toggleClass(g,h)},_clean:function(){this.updateMenuEnabled(true)},runAction:function(f,g){if(this.isReady()){b.Page.prototype.runAction.apply(this,arguments)}},updateMenuEnabled:function(h){if(this.isReady()){var k;if(h){k=0}else{var j=this._getTable();var i=j.getSelectedIdList();k=i.length}var g=this._getElToolbar();b.app.updateToolbarEnabledByLength(g,k)}else{var f=this._getElToolbar().find("."+b.App.Menu.CLS_ITEM);f.addClass(b.CLS_DISABLED)}},_updateSelectedList:function(){if(!this.isSelectorMode()){return}var h=function(l){return l||[]};var k=h(this._getTo());var j=h(this._getCc());var f=h(this._getBcc());this.setDestinations(k,j,f);var i=this._getTargetList();var g=this._getListPanel();g.selectTarget(i)},ok:function(){var h=this._getListPanel();var g=h.getTo();var f=h.getCc();var i=h.getBcc();this.setDestinationsToMailEditPage(g,f,i)},cancel:function(){if(this.isSelectorMode()){b.app.toggleDisabledOfHeaderLink(false)}b.openPage(b.PAGE_MAIL_EDIT,null,false)},getSelectedMailArray:function(){var g=this._getTable();var f=g.getSelectedMailArray();return f},setDestinations:function(g,f,i){var h=this._getListPanel();h.setDestinations(g,f,i)},setDestinationsToMailEditPage:function(h,g,l){if(this.isSelectorMode()){b.app.toggleDisabledOfHeaderLink(false)}var j=b.getMailAddressForToMailInputItem(h);var i=b.getMailAddressForToMailInputItem(g);var f=b.getMailAddressForToMailInputItem(l);var k={method:b.METHOD_POST,to:j,cc:i,bcc:f};b.openPage(b.PAGE_MAIL_EDIT,k,false)},updateTable:function(){var f=this._getTable();f.updateTable()},isSelectorMode:function(){return this._getMode()==c.MODE_SELECTOR},saveParameter:function(){var f=this._getListPanel();this._to=f.getTo();this._cc=f.getCc();this._bcc=f.getBcc()},onclickFolderTab:function(f,h){var l=a(h);var g=l.attr("href");var k=g.slice(g.indexOf("#")+1);var o=neo.core.splitParam(k);var n=o[b.PARAM_PAGE];var p={};if(this._getMode()){p[c.MODE]=this._getMode();var j=this._getListPanel();var i=b.getMailAddressForToMailInputItem;p.to=i(j.getTo());p.cc=i(j.getCc());p.bcc=i(j.getBcc());var m=j.getCurType();p.targetList=m;p[b.PARAM_METHOD]=b.METHOD_POST}b.openPage(n,p,false)},__closure:b.__closure,__bind:b.__bind,banpei:null}});c.constructor()})(jQuery);(function(b){var e=neo.core.readyNamespace("neo.denbun.Address.AddressSelectedList");if(!e){return}var c=neo.denbun;var d=c.Address;var a=neo.denbun.Address.AddressSelectedList=new neo.core.Class({superClass:neo.denbun.Table,classProperties:{CLS_REMOVE:"selected-table-remove",DATA_INDEX:"data-index",constructor:function(){}},properties:{_lastPublicationId:null,_getLastPublicationId:function(){return this._lastPublicationId},_setLastPublicationId:function(f){return this._lastPublicationId=f},_getElContainerLow:function(){var f=this.setting.containerId;return b("#"+f)},_buildTableCellsHtml:function(k,l,i){var f=this._getTableCellEndHtml();var g=0;var j=l.data;k.push('<td class="');k.push(c.Table.CLS_CELL);k.push('"><div class="');k.push(c.Table.CLS_BOX);if(DENBUN_MODE_XNEO){k.push('" title="');var h=desknets.escapeValue(desknets.escape(j.text));k.push(h);k.push('"><span class="');k.push(a.CLS_REMOVE);k.push('">x</span>')}else{k.push('"><img class="');k.push(a.CLS_REMOVE);k.push('" src="');k.push(DENBUN_DOC_ROOT);k.push('/img/com/ico-close.png" width="15" height="15" />')}k.pushText(j.text);k.push(f)},_getNewPublicationId:function(){var f=this._getLastPublicationId();if(!f){f=0}f++;f=""+f;this._setLastPublicationId(f);return f},__constructor:function(){this.__call("__constructor",arguments);this._data={idList:[],textMap:{},rows:{}}},_hook:function(){this.__call("_hook",arguments)},_isUseNativeScroll:function(){return true},_getMaxRowNativeScroll:function(){var f=this._getIdList();if(f){return f.length}return 0},_buildTable:function(h,f){this.__call("_buildTable",arguments);var g={onDrop:this.__closure(this._updateRowData)};this._getElBodyContainer().find("tbody").tableDnD(g)},_updateRowData:function(){var h=this._getElBodyContainer().find("tr");var f=h.length;var k=this._data.idList=[];for(var j=0;j<f;j++){var g=h.eq(j);var m=g.attr(c.Table.DATA_ID);k.push(m);var l=this._getRowOf(m);l.index=j}},_appendRow:function(f,g){this.__call("_appendRow",arguments);if(DENBUN_MODE_XNEO){f.textMap[g.data.mail]=g.data.id}else{f.textMap[g.data.text]=g.data.id}},addRows:function(f){var j=this._getData();var k;for(var g=0;g<f.length;g++){var h=f[g];h.id=this._getNewPublicationId();k=this._createRow(h);this._appendRow(j,k)}this._updateScroller();this._updateTable();k&&this._scrollTo(k)},addRow:function(g){g.id=this._getNewPublicationId();var h=this._createRow(g);var f=this._getData();this._appendRow(f,h);this._updateScroller();this._updateTable();this._scrollTo(h)},removeRow:function(m){if(!m.id){var n;if(DENBUN_MODE_XNEO){n=this._data.textMap[m.mail]}else{n=this._data.textMap[m.text]}if(!n){return}m.id=n}var g=m.id;var j=this._getIdList();var k=this._data.idList=[];for(var h=0;h<j.length;h++){var n=j[h];if(n!=g){k.push(n)}}var l=this._getRows();delete l[g];var f=this._data.textMap;if(DENBUN_MODE_XNEO){delete f[m.mail]}else{delete f[m.text]}this._updateScroller();this._updateTable()},clear:function(){this._data={idList:[],textMap:{},rows:{}};this._setLastPublicationId(null);this._updateScroller();this._updateTable()},updateTable:function(){this._initRowHeight();this._initVisibleRange();this._updateScroller();this._updateTable();var f=this._getCurRow();f&&this._scrollTo(f)},remove:function(){var g=this.getSelectedIdList();for(var f=0;f<g.length;f++){var h=this._getRowOf(g[f]);this.removeRow(h.data)}this.onUpdateTable()},isExistedOf:function(g){var f;if(DENBUN_MODE_XNEO){f=this._data.textMap[g.mail]}else{f=this._data.textMap[g.text]}if(f){return true}return false},_isElRemove:function(f){return f.hasClass(a.CLS_REMOVE)},getRowDataArray:function(){var f=[];var h=this._getIdList();for(var g=0;g<h.length;g++){var j=this._getRowOf(h[g]);f.push(j.data)}return f},onclickRow:function(g,h){var f=b(g.target);if(this._isElRemove(f)){var i=this._getRowFrom(f);this.removeRow(i.data);this.onUpdateTable();return}this.__call("onclickRow",arguments)},onUpdateTable:function(){if(typeof this.setting.onUpdateTable=="function"){this.setting.onUpdateTable()}},__closure:c.__closure,__bind:c.__bind,banpei:null}});a.constructor()})(jQuery);(function(a){var e=neo.core.readyNamespace("neo.denbun.Address.AddressSelectedListPanel");if(!e){return}var b=neo.denbun;var d=b.Address;var c=neo.denbun.Address.AddressSelectedListPanel=new neo.core.Class({classProperties:{DATA_TARGET:"data-target",DATA_NAME:"data-name",TARGET_TYPE_TO:"to",TARGET_TYPE_CC:"cc",TARGET_TYPE_BCC:"bcc",constructor:function(){}},properties:{_toTable:null,_getToTable:function(){return this._toTable||this._initToTable()},_initToTable:function(){var g={containerId:this._getContainerIdToTable(),onUpdateTable:this.__closure(this.onUpdateTable)};var f=new d.AddressSelectedList(g);f.initialize();return this._toTable=f},_ccTable:null,_getCcTable:function(){return this._ccTable||this._initCcTable()},_initCcTable:function(){var f={containerId:this._getContainerIdCcTable(),onUpdateTable:this.__closure(this.onUpdateTable)};var g=new d.AddressSelectedList(f);g.initialize();return this._ccTable=g},_bccTable:null,_getBccTable:function(){return this._bccTable||this._initBccTable()},_initBccTable:function(){var g={containerId:this._getContainerIdBccTable(),onUpdateTable:this.__closure(this.onUpdateTable)};var f=new d.AddressSelectedList(g);f.initialize();return this._bccTable=f},_elContainer:null,_getElContainer:function(){return this._elContainer||this._initElContainer()},_initElContainer:function(){return this._elContainer=this._getElContainerLow()},_getElContainerLow:function(){},_elListSections:null,_getElListSections:function(){return this._elListSections||this._initElListSections()},_initElListSections:function(){return this._elListSections=this._getElListSectionsLow()},_getElListSectionsLow:function(){},_elRemoveSelected:null,_getElRemoveSelected:function(){return this._elRemoveSelected||this._initElRemoveSelected()},_initElRemoveSelected:function(){return this._elRemoveSelected=this._getElRemoveSelectedLow()},_getElRemoveSelectedLow:function(){},_elAdd:null,_getElAdd:function(){return this._elAdd||this._initElAdd()},_initElAdd:function(){return this._elAdd=this._getElAddLow()},_getElAddLow:function(){},setting:null,_getPage:function(){return this.setting.page},__constructor:function(f){this.setting=f||{}},initialize:function(){this._hook()},_hook:function(){var f;f=this._getElListSections();this.__bind(f,"mousedown","Section");this._hookDroppable(f);f=this._getElRemoveSelected();this.__bind(f,"click","RemoveSelected");f=this._getElAdd();this.__bind(f,"click","Add")},_hookDroppable:function(g){var f=this._getDroppableOptions();g.droppable(f)},_getDroppableOptions:function(){var g=this._getClsSectionHover();var f={hoverClass:g,tolerance:"pointer",drop:this.__closure(this.ondrop)};return f},_getClsSectionHover:function(){},getTo:function(){var f=this._getToTable();return f.getRowDataArray()},getCc:function(){var f=this._getCcTable();return f.getRowDataArray()},getBcc:function(){var f=this._getBccTable();return f.getRowDataArray()},setDestinations:function(g,f,h){this._setToTo(g);this._setToCc(f);this._setToBcc(h)},_setToTo:function(g){var f=this._getToTable();f.clear();this._addToTable(f,g,true)},_setToCc:function(g){var f=this._getCcTable();f.clear();this._addToTable(f,g,true)},_setToBcc:function(g){var f=this._getBccTable();f.clear();this._addToTable(f,g,true)},addToTo:function(g){var f=this._getToTable();this._addToTable(f,g)},addToCc:function(g){var f=this._getCcTable();this._addToTable(f,g)},addToBcc:function(g){var f=this._getBccTable();this._addToTable(f,g)},add:function(h,g){var f=this._getCurTable();if(!g&&f.isExistedOf(h)){return}f.addRow(h)},addMailAddresses:function(f,h){var g=this._getCurTable();this._addToTable(g,f,h)},_addToTable:function(g,l,h){var k=[];for(var f=0;f<l.length;f++){var j=l[f];if(!h&&g.isExistedOf(j)){continue}k.push(j)}g.addRows(k)},_removeSelected:function(){var f=this._getCurTable();f.remove()},remove:function(g){var f=this._getCurTable();f.removeRow(g)},_getCurTable:function(){var f=this.getCurType();var g=this._getTable(f);return g},_getTable:function(f){var g;switch(f){case c.TARGET_TYPE_TO:g=this._getToTable();break;case c.TARGET_TYPE_CC:g=this._getCcTable();break;case c.TARGET_TYPE_BCC:g=this._getBccTable();break}return g},getCurType:function(){var g=this._getElContainer();var f=g.attr(c.DATA_TARGET);return f},isExistedOf:function(g){var f=this._getCurTable();return f.isExistedOf(g)},selectTarget:function(h){if(!h){return}var j=this._getElContainer();j.attr(c.DATA_TARGET,h);var i=this._getClsCurrentSection();var k=this._getElListSections();k.removeClass(i);var g=k.filter("["+c.DATA_NAME+"="+h+"]");g.addClass(i);if(DENBUN_MODE_XNEO){var f=g.find("."+b.Table.CLS_CONTAINER);setTimeout(function(){b.App.Keyboard.updateFocusElement(f)},1)}if(b.isIe7()){j.children().addClass("com_content-manualy").css({height:""});g.removeClass("com_content-manualy");b.$window.trigger("resize")}if(a.browser.msie){var l=g.find("."+b.Table.CLS_SCROLLER);l.trigger("scroll")}},onresize:function(h){var f=this._getToTable();f.onresize(h);var i=this._getCcTable();i.onresize(h);var g=this._getBccTable();g.onresize(h)},onUpdateTable:function(){var f=this._getPage();f.updateTable()},onclickRemoveSelected:function(f,g){this._removeSelected()},onmousedownSection:function(g,j){var i=a(j);var f=this._getTargetTypeOf(i);if(f!=this.getCurType()){this.selectTarget(f);var h=this._getCurTable();h.updateTable();this.onUpdateTable()}},onclickAdd:function(f,i){var h=this._getPage();var j=h.getSelectedMailArray();var g=this._getCurTable();this._addToTable(g,j);this.onUpdateTable()},ondrop:function(h,j,k){var i=this._getPage();var l=i.getSelectedMailArray();var g=this._getTargetTypeOf(a(k));var f=this._getTable(g);this._addToTable(f,l);this.onUpdateTable()},__closure:b.__closure,__bind:b.__bind,banpei:null}});c.constructor()})(jQuery);(function(b){var e=neo.core.readyNamespace("neo.denbun.Address.UsersFolders");if(!e){return}var c=neo.denbun;var d=c.Address;var a=neo.denbun.Address.UsersFolders=new neo.core.Class({superClass:c.Tree,classProperties:{CLS_IS_CHILD_LOADED:"tree-node-is_child_loaded",CLS_PERSONAL:"users-folder-node-personal",CLS_SHARE:"users-folder-node-share",CLS_ROOT:"users-folder-tree-root",CLS_MENU_ITEM_FOR_MUTABLE_FOLDER:"address_users_list-for_mutable_folder",CLS_MENU_ITEM_FOR_SEND_MAIL_FOLDER:"address_users_list-for_send_mail_folder",CLS_IS_CHILD_LOADING:"tree-node-is_child_loading",KEY_NODE_TYPE:"type",NODE_TYPE_PERSONAL:"0",NODE_TYPE_SHARE:"1",NODE_TYPE_NOGROUP:"2",NODE_TYPE_ALL:"3",DATA_FOLDER_TYPE:"data-folder_type",VAL_GROUP_ID_NOGROUP:"nogroup",VAL_GROUP_ID_ALL:"all",VAL_MOVE_NODE_UP:"up",VAL_MOVE_NODE_DOWN:"down",constructor:function(){}},properties:{setting:null,_getPage:function(){return this.setting.page},_loadNodeId:null,_getLoadNodeId:function(){return this._loadNodeId},_setLoadNodeId:function(f){return this._loadNodeId=f},_loadedCallBack:null,_getLoadedCallBack:function(){return this._loadedCallBack},_setLoadedCallBack:function(f){return this._loadedCallBack=f},_curType:null,getCurType:function(){return this._curType},_setCurType:function(f){return this._curType=f},_elToggle:null,_getElToggle:function(){return this._elToggle||this._initElToggle()},_initElToggle:function(){var f=this.getElContainer();return this._elToggle=f.find("."+c.Tree.CLS_TOGGLE)},_elCreate:null,_getElCreate:function(){return this._elCreate||this._initElCreate()},_initElCreate:function(){return this._elCreate=b("#users-folder-create")},_elRemove:null,_getElRemove:function(){return this._elRemove||this._initElRemove()},_initElRemove:function(){return this._elRemove=b("#users-folder-remove")},_elUp:null,_getElUp:function(){return this._elUp||this._initElUp()},_initElUp:function(){return this._elUp=b("#users-folder-up")},_elDown:null,_getElDown:function(){return this._elDown||this._initElDown()},_initElDown:function(){return this._elDown=b("#users-folder-down")},_ajaxCreate:null,_getAjaxCreate:function(){return this._ajaxCreate||this._initAjaxCreate()},_initAjaxCreate:function(){var f=this;var g=c.getUrl(c.CGI_USET);var h={url:g,getSendData:this.__closure(function(){var j={cmd:"usetpsetgroupentry",Name:this._getElCreateFolderName().val()};return j}),onsuccess:this.__closure(this.onsuccessCreate)};var i=new c.Ajax(h);i.initialize();return this._ajaxCreate=i},_dlgCreate:null,_getDlgCreate:function(){return this._dlgCreate||this._initDlgCreate()},_initDlgCreate:function(){var f={content:this._getElContentOfDlgCreate(),title:c.getText("個人グループ作成"),onopen:this.__closure(this._updateDlgCreate),onok:this.__closure(this._sendRequestToCreate)};var g=new c.Dialog(f);g.initialize();return this._dlgCreate=g},_elContentOfDlgCreate:null,_getElContentOfDlgCreate:function(){return this._elContentOfDlgCreate||this._initElContentOfDlgCreate()},_initElContentOfDlgCreate:function(){return this._elContentOfDlgCreate=b("#dlg-users_folder-create")},_elCreateFolderName:null,_getElCreateFolderName:function(){return this._elCreateFolderName||this._initElCreateFolderName()},_initElCreateFolderName:function(){var f=this._getElContentOfDlgCreate();return this._elCreateFolderName=f.find("input[name=Name]")},_ajaxRename:null,_getAjaxRename:function(){return this._ajaxRename||this._initAjaxRename()},_initAjaxRename:function(){var f=this;var g=c.getUrl(c.CGI_USET);var h={url:g,getSendData:this.__closure(function(){var k=this.getCurNodeId();var j={cmd:"usetpsetgroupentry",id:k,Name:this._getElRenameFolderName().val()};return j}),onsuccess:this.__closure(this.onsuccessRename)};var i=new c.Ajax(h);i.initialize();return this._ajaxRename=i},_dlgRename:null,_getDlgRename:function(){return this._dlgRename||this._initDlgRename()},_initDlgRename:function(){var f={content:b("#dlg-users_folder-rename"),title:c.getText("個人グループ名の変更"),onopen:this.__closure(this._updateDlgRename),onok:this.__closure(this._sendRequestToRename)};var g=new c.Dialog(f);g.initialize();return this._dlgRename=g},_elRenameFolderName:null,_getElRenameFolderName:function(){return this._elRenameFolderName||this._initElRenameFolderName()},_initElRenameFolderName:function(){return this._elRenameFolderName=b("#users_folder-rename-name")},__constructor:function(f){f.isAutoExpand=true;this.__call("__constructor",arguments)},_getElContainerLow:function(){return b("#users-folder-book-body")},_load:function(){this._setCurType(3);this.__call("_load",arguments)},_getUrlToLoad:function(){return c.getUrl(c.CGI_USET)},_getSendDataToLoad:function(){var f={cmd:"usetpsetgroup",area:this.getCurType()};if(this._getLoadNodeId()){f.pgid=this._getLoadNodeId()}return f},_build:function(g){var f=this._parseResponse(g);var j=c.parseFlatData(g);var k=j.id;if(DENBUN_MODE_XNEO){if(!k||k==""){var l=a.VAL_GROUP_ID_ALL;var h={};h.id=l;h.Name=desknets.Resource.chooser.allGroupName;h[a.KEY_NODE_TYPE]=a.NODE_TYPE_ALL;f[l]=h;f.order.unshift(l)}}var i=this._buildElement(f);if(k&&k!=""){var l=k;this._addChildTree(f,i,l);this.open(l)}else{this._apply(i);this._saveTreeData(f,i);this._hook()}},_hook:function(){this.__call("_hook",arguments);var g;g=this._getElToggle();this.__bind(g,"click","ToggleTree");var i=this.getElRoot();var f=i.find("."+c.Tree.CLS_LINK);this._hookDroppable(f);var h=this.__closure(this._updateMenuStatus);c.app.registerMenuCallback(h,"address_users_list","users_folder")},_hookDroppable:function(f){var g=this._getDroppableOptions();f.droppable(g)},_getDroppableOptions:function(){var f={scope:c.Address.DROPPABLE_SCOPE_USER,tolerance:"pointer",drop:this.__closure(this.ondrop),over:this.__closure(this.ondropover),out:this.__closure(this.ondropout)};return f},open:function(h,g){var f=this.getElNodeOf(h);if(!f.is("."+a.CLS_IS_CHILD_LOADED)){f.addClass(a.CLS_IS_CHILD_LOADING);this._loadChildTree(h,g)}else{this.__call("open",arguments);if(typeof g=="function"){g()}}},_loadChildTree:function(g,f){this._setLoadNodeId(g);this._setLoadedCallBack(f);this._load()},_addChildTree:function(f,h,i){var g=this.getElNodeOf(i);g.addClass(a.CLS_IS_CHILD_LOADED);g.removeClass(a.CLS_IS_CHILD_LOADING);g.find("ul").remove();h.removeClass(c.Tree.CLS_ROOT);g.append(h);this._saveAllNodes(f)},_openFirstNode:function(){var i=c.comSetting.getGroupId();if(i==""||i=="0"){i=a.VAL_GROUP_ID_NOGROUP}var g=this.getElNodeOf(i);if(g.length>0){this.select(i)}else{var f=this;var h=c.getUrl(c.CGI_USET);var j={url:h,getSendData:function(){var m={cmd:"usetpsetgroup",area:"",pgid:i};return m},onsuccess:function(n,m,o){var p=c.parseFlatData(n);f._openByConstId(i,p.const_id)}};if(DENBUN_MODE_XNEO){j.onerror=function(n,m,p){var o=-110;if(p.errorno==o){f.select(a.VAL_GROUP_ID_NOGROUP);return false}return}}var l=new c.Ajax(j);l.initialize();l.sendRequest()}var k=this._getPage();k.setReady();k.updateMenuEnabled()},_openByConstId:function(i,g,j){if(j==undefined){j=0}if(!g){return}j++;if(j*3>=g.length){this.select(i);return}var f=g.substr(0,j*3);var k=this._getIdByConstId(f);if(!k){return}var h=this;this.open(k,function(){h._openByConstId(i,g,j)})},_getIdByConstId:function(f){var g=this._getNodes();var k=g.getIdList();for(var h=0;h<k.length;h++){var j=g.get(k[h]);if(j.const_id==f){return k[h]}}return null},_parseNode:function(f){var g=this.__call("_parseNode",arguments);var h=g.id;if(isNaN(h)){g[a.KEY_NODE_TYPE]=a.NODE_TYPE_NOGROUP}else{if(Number(h)<0){g[a.KEY_NODE_TYPE]=a.NODE_TYPE_PERSONAL}else{g[a.KEY_NODE_TYPE]=a.NODE_TYPE_SHARE}}return g},_buildElNodeLow:function(i){var g=i[a.KEY_NODE_TYPE];var h=this.__call("_buildElNodeLow",arguments);var f=this._getClsNodeType(i);h.addClass(f);if(i.childgrpcnt>0){h.addClass(c.Tree.CLS_WITH_CHILDREN);h.addClass(c.Tree.CLS_MANUALLY_TOGGLE)}return h},_getClsNodeType:function(h){var g=h[a.KEY_NODE_TYPE];var f;switch(g){case a.NODE_TYPE_PERSONAL:f=a.CLS_PERSONAL;break;case a.NODE_TYPE_SHARE:case a.NODE_TYPE_ALL:case a.NODE_TYPE_NOGROUP:f=a.CLS_SHARE;break}return f},_isValidDraggable:function(h,g){var f=this._getElNodeFrom(g);var i=this.getNodeIdFrom(f);return(this._isRowDroppableFolder(i))},_getDroppableSetting:function(){var f=this;var g={hoverClass:c.Tree.CLS_LINK_HOVERED,tolerance:"pointer",drop:this.__closure(this.ondrop)};return g},_hookOneNode:function(g){var f=this._getElLinkFrom(g);this._hookDroppable(f)},_openFolder:function(h){var f=this.getCurType();neo.denbun.keysearch.cleanUp("users-table-search-keyword");var g=this._getPage();g.loadTable(h,f)},remove:function(){var f=this._getPage();if(f.isSelectorMode()){return}var g=this.getCurNodeId();if(!this.isMutableFolderId(g)){return}this.__call("remove",arguments)},execRemoving:function(j){var f=this;var g=c.getUrl(c.CGI_USET);var h={url:g,getSendData:function(){var k={cmd:"usetgrpdel",id:j};return k},onsuccess:function(){f._moveFromRemovingNode(j);f._execRemovingLow(j)}};var i=new c.Ajax(h);i.initialize();i.sendRequest()},rename:function(){var f=this._getPage();if(f.isSelectorMode()){return}var h=this.getCurNodeId();if(!this.isMutableFolderId(h)){return}var g=this._getDlgRename();g.open()},_updateDlgRename:function(h){var g=this.getCurNodeId();var f=this.getNameOf(g);var i=this._getElRenameFolderName();i.val(f);setTimeout(function(){i.select()},1)},_sendRequestToRename:function(){var h=this._getErrorMessageToRename();if(h){c.alert(h);return false}var k=this._getElRenameFolderName();var g=k.val();var j=this.getCurNodeId(j);var f=this.getNameOf(j);if(g==f){return}var i=this._getAjaxRename();i.sendRequest()},_getErrorMessageToRename:function(){var g=null;var j=this._getElRenameFolderName();var f=j.val();if(/^[ 　]*$/.test(f)){var h=neo.denbun.getText("グループ名");var i=neo.denbun.getText("$$を入力してください。");var g=neo.core.replace(i,h)}return g},_updateNameLow:function(g,f){this.__call("_updateNameLow",arguments);this._updateNameInTable()},_updateNameInTable:function(){var f=this._getPage();f.updateFolderNameInTable()},create:function(){var f=this._getDlgCreate();f.open()},_updateDlgCreate:function(f){var g=this._getElCreateFolderName();g.val("");setTimeout(function(){g.select()},1)},_sendRequestToCreate:function(){var f=this._getErrorMessageToCreate();if(f){c.alert(f);return false}var g=this._getAjaxCreate();g.sendRequest()},_getErrorMessageToCreate:function(){var g=null;var j=this._getElCreateFolderName();var f=j.val();if(/^[ 　]*$/.test(f)){var h=neo.denbun.getText("グループ名");var i=neo.denbun.getText("$$を入力してください。");g=neo.core.replace(i,h)}return g},_execCreateLow:function(l,h){var i={};i.id=l;i.Name=h;i[a.KEY_NODE_TYPE]=a.NODE_TYPE_PERSONAL;this._addNode(i);var g=this._buildElNode(i);var k=this.getElRoot();var j=k.find("."+a.CLS_PERSONAL+":last");if(j.length>0){j.after(g)}else{if(DENBUN_MODE_XNEO){var f=k.find("."+a.CLS_SHARE+"["+c.Tree.DATA_ID+'="'+a.VAL_GROUP_ID_ALL+'"]');if(f.length>0){f.after(g)}else{k.prepend(g)}}else{k.prepend(g)}}this._hookOneNode(g);this._openPathTo(l);this.scrollToShow(l)},moveUp:function(){var f=this.getCurNodeId();if(!this.isMutableFolderId(f)){return}this._execMoveUpDown(f,a.VAL_MOVE_NODE_UP)},moveDown:function(){var f=this.getCurNodeId();if(!this.isMutableFolderId(f)){return}this._execMoveUpDown(f,a.VAL_MOVE_NODE_DOWN)},_execMoveUpDown:function(h,j){var i=this.getElNodeOf(h);var l;if(j==a.VAL_MOVE_NODE_UP){l=this._getElPrevNode(i);if(DENBUN_MODE_XNEO){var f=this.getNodeIdFrom(l);if(!this.isMutableFolderId(f)){return}}}else{if(j==a.VAL_MOVE_NODE_DOWN){l=this._getElNextNode(i);var f=this.getNodeIdFrom(l);if(!this.isMutableFolderId(f)){return}}}if(!l||l.length==0){return}var m=this;var g=c.getUrl(c.CGI_USET);var n={url:g,getSendData:function(){var o={cmd:"usetgrpupdown",proc:j,id:h};return o},onsuccess:function(){if(j==a.VAL_MOVE_NODE_UP){l.before(i)}else{if(j==a.VAL_MOVE_NODE_DOWN){l.after(i)}}}};var k=new c.Ajax(n);k.initialize();k.sendRequest()},_moveRows:function(i,h){if(!this._isRowDroppableFolder(i)){return}var f=h.data(c.Table.DATA_SELECTED_DATA_LIST);var g=this._getPage();g.moveRows(f,i)},_isRowDroppableFolder:function(f){return this.isMutableFolderId(f)},_updateMenuStatus:function(h){var f=h.find("."+c.App.Menu.CLS_MENU_ITEM);f.removeClass(c.CLS_DISABLED);var i=f.filter("."+a.CLS_MENU_ITEM_FOR_MUTABLE_FOLDER);var g=this.getElCurNode();var k=this.getNodeIdFrom(g);if(!this.isMutableFolderId(k)){i.addClass(c.CLS_DISABLED)}var j=f.filter("."+a.CLS_MENU_ITEM_FOR_SEND_MAIL_FOLDER);if(isNaN(k)){j.addClass(c.CLS_DISABLED)}},_updateOperatorStatus:function(){var j=this._getElCreate();j.attr("disabled",false);var f=this._getElRemove();var h=this._getElUp();var k=this._getElDown();var g=this.getElCurNode();var l=this.getNodeIdFrom(g);var i=this.isMutableFolderId(l);f.attr("disabled",!i);h.attr("disabled",!i);k.attr("disabled",!i)},isMutableFolderId:function(f){if(!f){return false}if(isNaN(f)||f>0){return false}if(DENBUN_MODE_XNEO&&f==0){return false}return true},getMailAddress:function(){var i=this.getCurNodeId();if(!i){return null}var f=this.getNameOf(i);if(isNaN(i)){return null}var g;if(i>0){g=c.SEND_GROUP_TYPE_USERS_PUBLIC}else{g=c.SEND_GROUP_TYPE_USERS_PERSONAL}var h=d.getMailAddressForGroup(i,f,g);return h},getFolderIdAndType:function(){var h=this.getCurNodeId();if(!h){return null}if(isNaN(h)){return null}var f=this.getCurType();var g={id:h,type:f};return g},onsuccessLoad:function(g,f,h){this.__call("onsuccessLoad",arguments);var i=c.parseFlatData(g);var j=i.id;if(!j||j==""){this._openFirstNode()}var k=this._getLoadedCallBack();if(typeof k=="function"){this._setLoadedCallBack(null);k()}},onerrorLoad:function(i,g,k){var h=c.getAjaxSendParams(g);var j=h.pgid;if(j&&j!=""){var f=this.getElNodeOf(j);f.removeClass(a.CLS_IS_CHILD_LOADING)}},onclickToggleTree:function(h,i){var f=b(i);var g=f.closest("."+c.Tree.CLS_NODE);if(g.is("."+a.CLS_IS_CHILD_LOADING)){return}if(g.is("."+c.Tree.CLS_MANUALLY_TOGGLE)){if(!g.is("."+a.CLS_WITH_CHILDREN_OPENED)){var j=this.getNodeIdFrom(g);this.onexpand(j)}else{this._closeElNode(g)}}},onexpand:function(f){this.open(f)},onchange:function(f){this._openFolder(f);this._updateOperatorStatus()},ondrop:function(i,k,l){var j=this._getPage();var g=j._getElLeftContainer().width()||0;if(g<k.position.left-3){return}this._setElLastHoveredNode(null);var h=this._getElNodeFrom(b(l));var f=this.getNodeIdFrom(h);this._moveRows(f,k.helper)},onsuccessRename:function(g,f,i){var j=c.getAjaxSendParams(f);var k=j.id;var h=j.Name;this._updateNameLow(k,h)},onsuccessCreate:function(g,f,i){var j=c.getAjaxSendParams(f);var k=b(g).find("id").text();var h=j.Name;this._execCreateLow(k,h)},__closure:c.__closure,__bind:c.__bind,banpei:null}});a.constructor()})(jQuery);(function(a){var e=neo.core.readyNamespace("neo.denbun.Address.ListPage");if(!e){return}var c=neo.denbun;var d=c.Address;var b=neo.denbun.Address.ListPage=new neo.core.Class({superClass:d.AddressPage,classProperties:{constructor:function(){}},properties:{_getElSelectFolderTabLow:function(){return a("#address-folder-tab-list .tab_selector-link")},_searchForm:null,_getSearchForm:function(){return this._searchForm||this._initSearchForm()},_initSearchForm:function(){return this._searchForm=a("#address-table-search")},_elSearchKeyword:null,_getElSearchKeyword:function(){return this._elSearchKeyword||this._initElSearchKeyword()},_initElSearchKeyword:function(){if(DENBUN_MODE_XNEO){var f=this;var g=function(){f.execEasySearch()};neo.denbun.keysearch.setUp("address-table-search-keyword",a("#address-table-search-keyword"),g)}return this._elSearchKeyword=a("#address-table-search-keyword")},_elSearchExec:null,_getElSearchExec:function(){return this._elSearchExec||this._initElSearchExec()},_initElSearchExec:function(){return this._elSearcdExec=a("#address-table-search-exec")},_addressFolders:null,_getAddressFolders:function(){return this._addressFolders},_initAddressFolders:function(){var g={page:this};var f=new d.AddressFolders(g);f.initialize();return this._addressFolders=f},_table:null,_getTable:function(){return this._table||this._initTable()},_initTable:function(){var f={page:this};var g=new b.AddressTable(f);g.initialize();return this._table=g},_listPanel:null,_getListPanel:function(){return this._listPanel||this._initListPanel()},_initListPanel:function(){var f={page:this};var g=new b.SelectedListPanel(f);g.initialize();return this._listPanel=g},initialize:function(){if(DENBUN_MODE_XNEO){if(!c.comSetting.isAvailableWebMail()){a("[data-action=folderSendMail]").hide().prev(".popup_menu-item-separator").hide()}}this._registerMenuCallbacks();var f=this;c.comSetting.getAddressSetting(function(){f._initAddressFolders();f._getTable();f._getListPanel()});this._hook()},_hook:function(){this.__call("_hook",arguments);var f;f=this._getSearchForm();this.__bind(f,"submit","Search");if(c.isIe7()){f=this._getElSearchExec();this.__bind(f,"click","SearchExec")}},_initOnOpening:function(){this.__call("_initOnOpening",arguments);if(this._addressFolders&&this._table){var j=c.getParameter(d.PARAM_CMD);if(j==d.CMD_RELOAD||c.app.getFlgUpdateAddressList()){var i=c.getParameter(d.PARAM_INDEX_NAME_OF_KANA);var f=c.getParameter(d.PARAM_INDEX_NAME_OF_COMPANY_KANA);var k=c.getParameter(d.PARAM_INDEX_NAME_OF_OLD_KANA);var g=c.getParameter(d.PARAM_INDEX_NAME_OF_OLD_COMPANY_KANA);var h=c.getParameter(d.PARAM_AREA);this.reloadTable(i,f,k,g,h)}}},_updateMenuStatus:function(f){this.__call("_updateMenuStatus",arguments);if(!DENBUN_MODE_XNEO){this._updateEditMenuEnable(f)}},_updateMenuEnable:function(f){this._updateEditMenuEnable(f)},_updateEditMenuEnable:function(j){var l=c.CLS_DISABLED;var s=this._getTable();var f=s.isPrivate();var q=s.isPublic();var r=c.comSetting.hasAuthorityToCreateAddress();if(DENBUN_MODE_XNEO){var k=s.isSearchMode();if(k){f=false;q=false}}var p=this._getElMenuForRemove(j);var o=s.getSelectedIdList();var h=o.length;if(h==1){var g=o[0];if(Number(g)>0&&!r){var n=this._getElMenuForEdit(j);n.addClass(l);if(!f){p.addClass(l)}}}if(DENBUN_MODE_XNEO){if(!f&&!q){if(h>1){for(var m=0;o&&m<h;m++){var g=o[m];if(Number(g)>0&&!r){p.addClass(l);break}}}}}if(q&&!r){p.addClass(l)}},_getElMenuForEdit:function(f){var g=f.find(".address_menu-for_edit");return g},_getElMenuForRemove:function(f){var g=f.find(".address_menu-for_remove");return g},_registerMenuCallbacks:function(){var f=this.__closure(this._updateMenuStatus);c.app.registerMenuCallback(f,"address_list","address_table")},updateMenuEnabled:function(g){this.__call("updateMenuEnabled",arguments);if(g){return}var f=this._getElToolbar();this._updateEditMenuEnable(f)},_updatePageClass:function(){this.__call("_updatePageClass",arguments);var k=this.isSelectorMode();var m=d.AddressPage.CLS_POPUP_MENU_ADDRESS_SELECTOR_MODE;var l=a("#popup_menu-address_list-address_table");l.toggleClass(m,k);var f=a("#popup_menu-address_list-address_folder");f.toggleClass(m,k);var i="page-item-no_index";var h=this._getElOwnItems();var g=c.getLang()!=c.LANG_JA;h.toggleClass(i,g);var n=a('#address-folder-tab-list [href="#'+c.PARAM_PAGE+"="+c.PAGE_ADDRESS_USERS_LIST+'"]').closest("li");var j=c.comSetting.isAvailableUserList();if(j){n.show()}else{n.hide()}},_getElOwnItemsLow:function(){return a(".page-address_list-item")},getAddressFolderNameOf:function(h){var g=this._getAddressFolders();var f=g.getNameOf(h);return f},loadTable:function(i,f){var g=this._getTable();g.switchMode(d.AddressTable.VAL_MODE_DEFAULT);this._clearSearchKeyword();var h=g.getConditionsFromFolder(i,f);g.load(h,true,true)},reloadTable:function(k,f,l,g,j){var i=this._getTable();if(i.isChangeFolder(j)){i.setLoadIndexName(k,f);var h=this._getAddressFolders();if(j==b.AddressTable.VAL_FOLDER_TYPE_PRIVATE){h.select(d.AddressFolders.VAL_NODE_ID_PRIVATE)}else{if(j==b.AddressTable.VAL_FOLDER_TYPE_PUBLIC){h.select(d.AddressFolders.VAL_NODE_ID_PUBLIC)}else{h.select(d.AddressFolders.VAL_NODE_ID_ALL)}}return}if(k||f||l||g){i.setIndexName(k,f,l,g)}else{i.clearIndex()}i.reload(null,true);c.app.setFlgUpdateAddressList(false)},loadTableByConditions:function(h){var g=this._getAddressFolders();var f=this._getTable();g.unselectAll();f.switchMode(d.AddressTable.VAL_MODE_SEARCH);f.load(h)},_search:function(){if(!this.isReady()){return}var f=this._getElSearchKeyword();var g=f.val();if(!DENBUN_MODE_XNEO){if(g==""){var k=c.getText("検索条件を入力してください。");c.alert(k);return}}if(DENBUN_MODE_XNEO){if(g&&g.length>desknets.SRCHKEY_MAXLENGTH){var h=desknets.Resource.Message.com_search_keyword_toolarge;c.alert(h);return}}var i={};i[b.AddressTable.PARAM_KEY]=g;i[b.AddressTable.PARAM_SHARE]=b.AddressTable.VAL_SEARCH_ENABLE;i[b.AddressTable.PARAM_PERSONAL]=b.AddressTable.VAL_SEARCH_ENABLE;i[b.AddressTable.PARAM_NAME]=b.AddressTable.VAL_SEARCH_ENABLE;i[b.AddressTable.PARAM_CONST]=b.AddressTable.VAL_SEARCH_ENABLE;i[b.AddressTable.PARAM_MAIL]=b.AddressTable.VAL_SEARCH_ENABLE;i[b.AddressTable.PARAM_DOMAIN]=b.AddressTable.VAL_SEARCH_ENABLE;var j=c.getLang();var l=j==c.LANG_JA;if(l){i[b.AddressTable.PARAM_KANA]=b.AddressTable.VAL_SEARCH_ENABLE}this.loadTableByConditions(i)},_clearSearchKeyword:function(){var f=this._getElSearchKeyword();f.val("")},setEasySearchKeyword:function(g){var f=this._getElSearchKeyword();f.val(g)},execEasySearch:function(){this._search()},updateFolderNameInTable:function(){var f=this._getTable();f.updateTitle()},create:function(){c.openPage(c.PAGE_ADDRESS_EDIT)},view:function(){this._execView()},_execView:function(i){var g=this._getTable();var f=g.getSelectedIdList();if(f.length!=1){return}var h={id:f[0]};if(i){h[c.PARAM_FORK]=true}this.saveParameter();c.openPage(c.PAGE_ADDRESS_VIEW,h)},edit:function(){this._execEdit()},_execEdit:function(i){var g=this._getTable();var f=g.getSelectedIdList();if(f.length!=1){return}var h={id:f[0]};if(i){h[c.PARAM_FORK]=true}this.saveParameter();c.openPage(c.PAGE_ADDRESS_EDIT,h)},remove:function(){var i=this._getTable();var h=i.getSelectedIdList();var j=i.isSubFolder();if(h.length<1){return}if(this._removeIsDisabled()){return}var g=this._getRemoveMessage();var f=this;c.confirm(g,{onok:function(){if(j){var k=i.getFolderId();f.execRemovingForSubFolder(k,h)}else{f.execRemoving(h)}}})},execRemoving:function(i){var f=this;var g={getSendData:function(){var j={cmd:"addrdel",id:i};return j},onsuccess:function(){f.reloadTable()}};var h=new c.Ajax(g);h.initialize();h.sendRequest()},execRemovingForSubFolder:function(g,j){var f=this;var h={getSendData:function(){var k={cmd:"addrgroupadd",addrgid:g,id:j};return k},onsuccess:function(){f.reloadTable()}};var i=new c.Ajax(h);i.initialize();i.sendRequest()},_getRemoveMessage:function(){var g;var f=this._getTable();if(f.isSubFolder()){g=c.getText("選択したアドレスをフォルダから削除します。よろしいですか？")}else{g=c.getText("選択したアドレスを削除してよろしいですか？")}return g},folderCreate:function(){var f=this._getAddressFolders();f.create()},folderRemove:function(){var f=this._getAddressFolders();f.remove()},folderRename:function(){var f=this._getAddressFolders();f.rename()},folderUp:function(){var f=this._getAddressFolders();f.moveUp()},folderDown:function(){var f=this._getAddressFolders();f.moveDown()},folderSendMail:function(){this._execSendMail(true)},_execSendMail:function(i){var h=this._getAddressFolders();var j=h.getMailAddress();if(!j){return}var f=c.getMailAddressForToMailInputItem(j);var g={to:f};if(i){g[c.PARAM_FORK]=true}c.openPage(c.PAGE_MAIL_EDIT,g)},addToTo:function(){var g=this._getAddressFolders();var h=g.getFolderIdAndType();if(!h){return}var f=this;var i=function(j){var k=f._getListPanel();k.addToTo(j);f.updateTable()};c.getMailAddressesOfAddressBookByGroup(h.id,h.type,i)},addToCc:function(){var g=this._getAddressFolders();var h=g.getFolderIdAndType();if(!h){return}var f=this;var i=function(j){var k=f._getListPanel();k.addToCc(j);f.updateTable()};c.getMailAddressesOfAddressBookByGroup(h.id,h.type,i)},addToBcc:function(){var g=this._getAddressFolders();var h=g.getFolderIdAndType();if(!h){return}var f=this;var i=function(j){var k=f._getListPanel();k.addToBcc(j);f.updateTable()};c.getMailAddressesOfAddressBookByGroup(h.id,h.type,i)},addMailsToSelectedList:function(g){var f=this._getListPanel();f.addMailAddresses(g)},addMailToSelectedList:function(g){var f=this._getListPanel();f.add(g)},removeMailFromSelectedList:function(g){var f=this._getListPanel();f.remove(g)},isExistedMailInSelectedList:function(g){var f=this._getListPanel();return f.isExistedOf(g)},moveRows:function(g,h){var f=this._getTable();var i=f.getFolderId();if(c.isCtrlPressed()){i=null}if(Number(i)>0&&Number(h)<0){i=null}if(i==h){return}this.execMoveRows(i,h,g)},execMoveRows:function(j,f,k){if(!k||k.length<1){return}var g=this;var h={getSendData:function(){var l={cmd:"addrgroupadd",toaddrgid:f,id:k};if(j){l.addrgid=j}return l},onsuccess:function(){g.reloadTable()}};var i=new c.Ajax(h);i.initialize();i.sendRequest()},_removeIsDisabled:function(){var g=this._getElToolbar();var f=this._getElMenuForRemove(g);return f.is("."+c.CLS_DISABLED)},onresize:function(h){var g=this._getTable();g.onresize(h);var f=this._getListPanel();f.onresize(h)},onsubmitSearch:function(f,g){f.preventDefault();this._search()},onclickSearchExec:function(f,g){this._search()},onclose:function(f){if(DENBUN_MODE_XNEO){if(c.isTablet()){c.$body.removeClass(c.CLS_COM_LEFT_CONTAINER_NARROW)}}f()},__closure:c.__closure,__bind:c.__bind,banpei:null}});b.constructor()})(jQuery);(function(a){var f=neo.core.readyNamespace("neo.denbun.Address.ListPage.AddressTable");if(!f){return}var c=neo.denbun;var e=c.Address;var b=c.Address.ListPage;var d=neo.denbun.Address.ListPage.AddressTable=new neo.core.Class({superClass:e.AddressTable,classProperties:{CLS_FLG_SUB_FOLDER:"address-table-flg_sub_folder",CLS_NAME:"address-table-name",CLS_MAIL_LIST_LABEL:"address-table-mail-label",HTML_ICON:'<img class="address-table-item-icon" src="'+c.PATH_IMG_SPACER+'" width="12" height="12" alt="" />',KEY_RUBY:"Kana",KEY_NAME:"Name",KEY_COMPANY_NAME:"Company",KEY_PUBLIC_TEL:"Tel1",KEY_PRIVATE_TEL:"TelHome",KEY_MOBILE_TEL:"TelHand",KEY_SKYPE_TEL:"skype",KEY_PUBLIC_MAIL:"Mail",KEY_PRIVATE_MAIL:"mailprivate",KEY_MOBILE_MAIL:"mailmobile",PARAM_ID:"addrgid",PARAM_INDEX:"no",PARAM_ALL_OF_GROUP:"noall",PARAM_FOLDER_TYPE:"area",PARAM_SORT_TYPE:"kind",PARAM_NUM:"num",PARAM_KEY:"key",PARAM_SHARE:"share",PARAM_PERSONAL:"personal",PARAM_KANA:"kana",PARAM_NAME:"name",PARAM_CONST:"const",PARAM_MAIL:"mail",PARAM_DOMAIN:"domain",VAL_ALL_OF_GROUP:"all",VAL_NOT_ALL_OF_GROUP:"",VAL_FOLDER_TYPE_PRIVATE:1,VAL_FOLDER_TYPE_PUBLIC:2,VAL_FOLDER_TYPE_ALL:3,VAL_SORT_BY_NAME:1,VAL_SEARCH_ENABLE:"1",constructor:function(){}},properties:{_setConditions:function(g){this._conditions=g;this._updateFlgSubFolder();return this._conditions},_ajaxLoadForSearch:null,_getAjaxLoadForSearch:function(){return this._ajaxLoadForSearch||this._initAjaxLoadForSearch()},_initAjaxLoadForSearch:function(){var g=this;var h={cache:true,getSendData:function(){var k=g._getDataToLoadForSearch();if(neo.core.isString(k)){k=neo.core.splitParam(k)}var j=String(new Date().getTime());g._setLastConnectionKey(j);k._=j;return k},onsuccess:this.__closure(this.onsuccessLoad)};var i=new c.Ajax(h);i.initialize();return this._ajaxLoadForSearch=i},_index:null,_getIndex:function(){return this._index||this._initIndex()},_initIndex:function(){var h={table:this};var g=new b.AddressTable.Index(h);g.initialize();return this._index=g},_displayFilter:null,_getDisplayFilter:function(){return this._displayFilter||this._initDisplayFilter()},_initDisplayFilter:function(){var g={table:this,onchange:this.__closure(this.onchangeDisplayFilter)};var h=new b.AddressTable.DisplayFilter(g);h.initialize();return this._displayFilter=h},_getElSectionTitleLow:function(){return a("#address-table-title")},_getElPagerLow:function(){return a("#address-table-pager")},_getElContainerLow:function(){return a("#address-table-table-container.com_table")},_getElDraggableHelperLow:function(){var i=a("#address-draggable-helper");if(!DENBUN_MODE_XNEO){var h=i.text();var g=c.getText(h);i.html(g)}return i},_elTableContainer:null,_getElTableContainer:function(){return this._elTableContainer||this._initElTableContainer()},_initElTableContainer:function(){return this._elTableContaienr=a("#address-table-container")},_elSortType:null,_getElSortType:function(){return this._elSortType||this._initElSortType()},_initElSortType:function(){return this._elSortType=a(".address-table-sort_type")},_loadIndexName:null,_getLoadIndexName:function(){return this._loadIndexName},_setLoadIndexName:function(g){return this._loadIndexName=g},initialize:function(){this.__call("initialize",arguments);this._initIndex();this._initDisplayFilter()},_hook:function(){var g;this.__call("_hook",arguments);g=this._getElSortType();this.__bind(g,"click","SortType");this._hookDraggable()},_getDraggableScope:function(){return c.Address.DROPPABLE_SCOPE_ADDRESS},load:function(k,j,n){if(k){this._setConditions(k)}var i=this._getPage();i.updateMenuEnabled(true);if(this.isSearchMode()){var h=this._getAjaxLoadForSearch();h.sendRequest()}else{var m=c.getLang()==c.LANG_JA;var g=this._getIndex();if(m&&!this.isSubFolder()&&(!g.isIndexCountLoaded()||j)){if(n){this.updateTitle();this.clean();this._setData(null);g.unselectIndex();this._setCurRow(null)}var l=true;g.getAllCount(l)}else{var h=this._getAjaxLoad();h.sendRequest()}}},_updateFlgSubFolder:function(){var g=d.CLS_FLG_SUB_FOLDER;var j=this._getElTableContainer();var i=this._getElSortType();if(this.isSubFolder()||this.isSearchMode()){j.addClass(g);i.attr("disabled",true)}else{j.removeClass(g);i.attr("disabled",false)}var h=this._getIndex();h.initIndexEnabled()},isSubFolder:function(){var g=this._getConditions(d.PARAM_ID)||"";return(g!="")},_getUrlToLoad:function(){return c.getUrl(c.CGI_EML)},_getDataToLoad:function(){var g=this._getConditions();g.cmd="addrindex";if(c.getLang()==c.LANG_JA){if(!g[d.PARAM_INDEX]){var h=this._getLoadIndexName();if(h){g[d.PARAM_INDEX]=h;g[d.PARAM_ALL_OF_GROUP]=undefined}else{g[d.PARAM_INDEX]=this._getFirstBroadIndex()}}}else{g[d.PARAM_INDEX]=d.VAL_ALL_OF_GROUP}this._setLoadIndexName(null);if(!this.isSubFolder()&&c.getLang()!=c.LANG_JA){g.cmd="addrallindex"}g[d.PARAM_SORT_TYPE]=this.getSortType();g[d.PARAM_FOLDER_TYPE]=this.getFolderType();return g},_getDataToLoadForSearch:function(){var g=this._getConditions();g.cmd="addrsearchlist";g[d.PARAM_NUM]=0;return g},_update:function(h){this.__call("_update",arguments);if(h){if(!this.isSubFolder()){var g=this._getIndex();g.updateIndex()}}},_updateData:function(){this._initRowHeight()},_getTitle:function(){if(this.isSearchMode()){return c.getText("検索結果")}return this._getFolderName()},_getFolderName:function(){var i=this._getFolderId();var g;if(i){var h=this._getPage();g=h.getAddressFolderNameOf(i)}else{if(this.isPrivate()){g=c.getText("（個人）")}else{if(this.isPublic()){g=c.getText("（共有）")}else{g=c.getText("（すべて）")}}}return g},_buildTableCellsHtml:function(j,k,i){var g=this._getTableCellEndHtml();var h=0;j.push(this._getTableCellStartHtml(["address-table-cell","address-table-cell-name",c.Table.CLS_CELL_FLEXIBLE],i[h++]));this._buildHtmlName(j,k);j.push(g);j.push(this._getTableCellStartHtml(["address-table-cell","address-table-cell-tel"],i[h++]));this._buildHtmlTel(j,k);j.push(g);j.push(this._getTableCellStartHtml(["address-table-cell","address-table-cell-mail"],i[h++]));this._buildHtmlMail(j,k);j.push(g);return j},_buildHtmlName:function(i,j){var h;var g=j.data;if(c.getLang()==c.LANG_JA&&!this.isSelectorMode()){h=g[d.KEY_RUBY];if(h){i.push('<div class="address-table-ruby">');i.pushText(h);i.push("</div>")}}h=g[d.KEY_NAME];if(h){i.push('<div class="address-table-name">');i.pushText(h);i.push("</div>")}h=g[d.KEY_COMPANY_NAME];if(h){i.push('<div class="address-table-company_name">');i.pushText(h);i.push("</div>")}return i},_buildHtmlTel:function(j,k){var i;var h=k.data;var g=d.HTML_ICON;if(this.isSelectorMode()){return}j.push('<ul class="address-table-tel-list">');i=h[d.KEY_PUBLIC_TEL];if(i){j.push('<li class="address-table-item address-table-item-public">');j.push(g);j.push('<span class="address-table-tel-public">');j.pushText(i);j.push("</span>");j.push("</li>")}i=h[d.KEY_PRIVATE_TEL];if(i){j.push('<li class="address-table-item address-table-item-private">');j.push(g);j.push('<span class="address-table-tel-private">');j.pushText(i);j.push("</span>");j.push("</li>")}i=h[d.KEY_MOBILE_TEL];if(i){j.push('<li class="address-table-item address-table-item-mobile">');j.push(g);j.push('<span class="address-table-tel-mobile">');j.pushText(i);j.push("</span>");j.push("</li>")}i=h[d.KEY_SKYPE_TEL];if(i){j.push('<li class="address-table-item address-table-item-skype">');j.push(g);j.push('<span class="address-table-tel-skype">');j.push('<a href="callto://');j.pushValue(i);j.push('/">');j.pushText(i);j.push("</a>");j.push("</span>");j.push("</li>")}j.push("</ul>");return j},_buildHtmlMail:function(g,h){if(this.isSelectorMode()){g=this._buildHtmlMailForSelectorMode(g,h)}else{g=this._buildHtmlMailForNormalMode(g,h)}return g},_buildHtmlMailForNormalMode:function(j,k){var i;var h=k.data;var g=d.HTML_ICON;j.push('<ul class="address-table-mail-list">');i=h[d.KEY_PUBLIC_MAIL];if(i){j.push('<li class="address-table-item address-table-item-public">');j.push('<span class="address-table-mail-label">');j.push(g);if(DENBUN_MODE_XNEO){this._buildHtmlMailLinkForNormalMode(j,i,"address-table-mail-public",true)}else{j.push('<span class="address-table-mail-item address-table-mail-public link">');j.pushText(i);j.push("</span>")}j.push("</span>");j.push("</li>")}i=h[d.KEY_PRIVATE_MAIL];if(i){j.push('<li class="address-table-item address-table-item-private">');j.push('<span class="address-table-mail-label">');j.push(g);if(DENBUN_MODE_XNEO){this._buildHtmlMailLinkForNormalMode(j,i,"address-table-mail-private",true)}else{j.push('<span class="address-table-mail-item address-table-mail-private link">');j.pushText(i);j.push("</span>")}j.push("</span>");j.push("</li>")}i=h[d.KEY_MOBILE_MAIL];if(i){j.push('<li class="address-table-item address-table-item-mobile">');j.push('<span class="address-table-mail-label">');j.push(g);if(DENBUN_MODE_XNEO){this._buildHtmlMailLinkForNormalMode(j,i,"address-table-mail-mobile",true)}else{j.push('<span class="address-table-mail-item address-table-mail-mobile link">');j.pushText(i);j.push("</span>")}j.push("</span>");j.push("</li>")}j.push("</ul>");return j},_buildHtmlMailForSelectorMode:function(h,p){var i=this._getDisplayFilter();var n;var j=p.data;var k=d.HTML_ICON;var l=this._getPage();var g=j[d.KEY_NAME];h.push('<ul class="address-table-mail-list">');if(i.isPublic()){n=j[d.KEY_PUBLIC_MAIL];if(n){var o=c.getDestinationText(g,n);var m=l.isExistedMailInSelectedList({mail:n,text:o});h.push('<li class="address-table-item address-table-item-public">');h.push('<span class="address-table-mail-label">');h.push('<input class="address-table-mail-item-value" type="checkbox" autocomplete="off"');(m)&&h.push(" checked");h.push(' value="');h.pushValue(n);h.push('" />');h.push(k);h.push('<span class="address-table-mail-item address-table-mail-public">');h.pushText(n);h.push("</span>");h.push("</span>");h.push("</li>")}}if(i.isPrivate()){n=j[d.KEY_PRIVATE_MAIL];if(n){var o=c.getDestinationText(g,n);var m=l.isExistedMailInSelectedList({mail:n,text:o});h.push('<li class="address-table-item address-table-item-private">');h.push('<span class="address-table-mail-label">');h.push('<input class="address-table-mail-item-value" type="checkbox" autocomplete="off"');(m)&&h.push(" checked");h.push(' value="');h.pushValue(n);h.push('" />');h.push(k);h.push('<span class="address-table-mail-item address-table-mail-private">');h.pushText(n);h.push("</span>");h.push("</span>");h.push("</li>")}}if(i.isMobile()){n=j[d.KEY_MOBILE_MAIL];if(n){var o=c.getDestinationText(g,n);var m=l.isExistedMailInSelectedList({mail:n,text:o});h.push('<li class="address-table-item address-table-item-mobile">');h.push('<span class="address-table-mail-label">');h.push('<input class="address-table-mail-item-value" type="checkbox" autocomplete="off"');(m)&&h.push(" checked");h.push(' value="');h.pushValue(n);h.push('" />');h.push(k);h.push('<span class="address-table-mail-item address-table-mail-mobile">');h.pushText(n);h.push("</span>");h.push("</span>");h.push("</li>")}}h.push("</ul>");return h},loadByBroadIndex:function(g){var h=this._getConditions();h[d.PARAM_INDEX]=g;h[d.PARAM_ALL_OF_GROUP]=d.VAL_ALL_OF_GROUP;h[c.Table.PARAM_OFFSET]=0;this.load(h)},loadByNarrowIndex:function(h){var j=this._getConditions();if(h==d.VAL_ALL_OF_GROUP){var g=this._getIndex();var i=g.getSelectedBroadIndexName();j[d.PARAM_INDEX]=i;j[d.PARAM_ALL_OF_GROUP]=d.VAL_ALL_OF_GROUP}else{j[d.PARAM_INDEX]=h;j[d.PARAM_ALL_OF_GROUP]=undefined}j[c.Table.PARAM_OFFSET]=0;this.load(j)},clearIndex:function(){var g=this._getIndex();g.clearIndex()},_getFirstBroadIndex:function(){var g=this._getIndex();return g.getFirstBroadIndex()},open:function(){if(this.isSelectorMode()){var i=this.getCurId();var g=this.getVisibleMailsById(i);if(g.length>0){var h=this._getPage();h.addMailsToSelectedList(g);h.updateTable()}return}var h=this._getPage();h.saveParameter();var i=this.getCurId();c.openPage(c.PAGE_ADDRESS_VIEW,{id:i})},remove:function(){var g=this._getPage();g.remove()},_changeDisplayFilter:function(){var j=this._getDisplayFilter();var g=j.getAvailableCountOfMailFilterType();var i=this._getElTableContainer();i.removeClass(["mail-filter-count-0","mail-filter-count-1","mail-filter-count-2","mail-filter-count-3",].join(" ")).addClass("mail-filter-count-"+g);this._initRowHeight();this._initVisibleRange();this._updateScroller();this._updateTable();var h=this._getCurRow();h&&this._scrollTo(h)},_updateDraggableHelper:function(j){var g=this._getDragingDataList();var i=g.length+"";var k=c.getText("$$ 件のアドレス");var h=neo.core.replace(k,i);j.text(h);var j=this._getElDraggableHelper();j.data(d.DATA_SELECTED_DATA_LIST,g)},getConditionsFromFolder:function(i,g){var h={};h[d.PARAM_INDEX]=null;h[d.PARAM_ALL_OF_GROUP]=d.VAL_ALL_OF_GROUP;h[d.PARAM_FOLDER_TYPE]=g;h[d.PARAM_ID]=i;return h},_getFolderId:function(){return this._getConditions(d.PARAM_ID)},getFolderId:function(){return this._getFolderId()},getIndexName:function(){return this._getConditions(d.PARAM_INDEX)||this._getFirstBroadIndex()},isAllOfGroup:function(){var g=this._getConditions(d.PARAM_ALL_OF_GROUP);return(g==d.VAL_ALL_OF_GROUP)},setIndexName:function(m,l,n,i){if(c.getLang()!=c.LANG_JA){return}var j=this.getSortType();var h=(j==d.VAL_SORT_BY_NAME);var k=this._getIndex();if(h){k.reflectToCounts(m,n)}else{k.reflectToCounts(l,i)}var g;if(h){g=m}else{g=l}if(!g){return}var o=this._getConditions();if(g.match(/[a-z]/)){g=k.getCorrectedIndexNameOfAlphabet(g)}o[d.PARAM_INDEX]=g;o[d.PARAM_ALL_OF_GROUP]=undefined},isChangeFolder:function(g){if(c.getLang()!=c.LANG_JA){return false}if(!g){return false}if(this.isSearchMode()){return true}if(!this._getData()){return true}if(this.isSubFolder()){return true}if(g!=this.getFolderType()){return true}return false},setLoadIndexName:function(j,g){if(c.getLang()!=c.LANG_JA){return}var l=this.getSortType();var k=(l==d.VAL_SORT_BY_NAME);var i;if(k){i=j}else{i=g}if(!i){return}if(i.match(/[a-z]/)){var h=this._getIndex();i=h.getCorrectedIndexNameOfAlphabet(i)}this._setLoadIndexName(i)},getFolderType:function(){return this._getConditions(d.PARAM_FOLDER_TYPE)||d.VAL_FOLDER_TYPE_PRIVATE},_getLastSortType:function(){return this._getConditions(d.PARAM_SORT_TYPE)},isPrivate:function(){var g=this.getFolderType();return(g==d.VAL_FOLDER_TYPE_PRIVATE)},isPublic:function(){var g=this.getFolderType();return(g==d.VAL_FOLDER_TYPE_PUBLIC)},getVisibleMails:function(h){var j=[];var i=this._getDisplayFilter();if(i.isPublic()){var g=h[d.KEY_PUBLIC_MAIL];if(g&&g!=""){j.push(g)}}if(i.isPrivate()){var g=h[d.KEY_PRIVATE_MAIL];if(g&&g!=""){j.push(g)}}if(i.isMobile()){var g=h[d.KEY_MOBILE_MAIL];if(g&&g!=""){j.push(g)}}return j},_getNameFrom:function(i){var g=this._getElRowFrom(i);var j=g.find("."+d.CLS_NAME);var h=j.text();return h},_getNameOf:function(g){return g[d.KEY_NAME]},getSortType:function(){var g=this._getElSortType().filter(":checked");var h=g.val()||d.VAL_SORT_BY_NAME;return h},isElMail:function(g){var h=g.closest("."+d.CLS_MAIL_LIST_LABEL);return(h.length>0)},_getMailFrom:function(h){var i=h.find(".address-table-mail-item");var g=i.text();return g},_getElMailFrom:function(g){var h=g.closest(".address-table-item");return h},_getElSelectMailFrom:function(g){var h=g.find(".address-table-mail-item-value");return h},onsuccessLoad:function(h,g,i){this.__call("onsuccessLoad",arguments)},onchangeDisplayFilter:function(){this._changeDisplayFilter()},onclickSortType:function(i,k){var l=this.getSortType();var g=this._getLastSortType();if(l!=g){var j=this._getConditions();j[d.PARAM_INDEX]=null;j[d.PARAM_ALL_OF_GROUP]=d.VAL_ALL_OF_GROUP;var h=this._getIndex();h.clearIndex();j[c.Table.PARAM_OFFSET]=0;this.load()}},banpei:null}});d.constructor()})(jQuery);(function(a){var e=neo.core.readyNamespace("neo.denbun.Address.ListPage.AddressTable.Index");if(!e){return}var b=neo.denbun;var d=b.Address.ListPage.AddressTable;var c=neo.denbun.Address.ListPage.AddressTable.Index=new neo.core.Class({classProperties:{ID_NARROW_INDEX_ALL:"address-select_index-all",CLS_SELECTED_INDEX:"address-select_index-selected",DATA_INDEX_NAME:"data-name",DATA_PARENT_INDEX_NAME:"data-parent",VAL_INDEX_NAME_ALL:"all",constructor:function(){}},properties:{_privateIndexCountLoaded:null,_isPrivateIndexCountLoaded:function(){return this._privateIndexCountLoaded},_setPrivateIndexCountLoaded:function(f){return this._privateIndexCountLoaded=f},_broadPrivateIndexCounts:null,_getBroadPrivateIndexCounts:function(){return this._broadPrivateIndexCounts},_setBroadPrivateIndexCounts:function(f){return this._broadPrivateIndexCounts=f},_narrowPrivateIndexCounts:null,_getNarrowPrivateIndexCounts:function(){return this._narrowPrivateIndexCounts},_setNarrowPrivateIndexCounts:function(f){return this._narrowPrivateIndexCounts=f},_publicIndexCountLoaded:null,_isPublicIndexCountLoaded:function(){return this._publicIndexCountLoaded},_setPublicIndexCountLoaded:function(f){return this._publicIndexCountLoaded=f},_broadPublicIndexCounts:null,_getBroadPublicIndexCounts:function(){return this._broadPublicIndexCounts},_setBroadPublicIndexCounts:function(f){return this._broadPublicIndexCounts=f},_narrowPublicIndexCounts:null,_getNarrowPublicIndexCounts:function(){return this._narrowPublicIndexCounts},_setNarrowPublicIndexCounts:function(f){return this._narrowPublicIndexCounts=f},_allIndexCountLoaded:null,_isAllIndexCountLoaded:function(){return this._allIndexCountLoaded},_setAllIndexCountLoaded:function(f){return this._allIndexCountLoaded=f},_broadAllIndexCounts:null,_getBroadAllIndexCounts:function(){return this._broadAllIndexCounts},_setBroadAllIndexCounts:function(f){return this._broadAllIndexCounts=f},_narrowAllIndexCounts:null,_getNarrowAllIndexCounts:function(){return this._narrowAllIndexCounts},_setNarrowAllIndexCounts:function(f){return this._narrowAllIndexCounts=f},_isLoadTable:null,_getIsLoadTable:function(){return this._isLoadTable},_setIsLoadTable:function(f){return this._isLoadTable=f},_ajaxGetAllCount:null,_getAjaxGetAllCount:function(){return this._ajaxGetAllCount||this._initAjaxGetAllCount()},_initAjaxGetAllCount:function(){var f=this;var g={getSendData:function(){var i={cmd:"addrgetcnt"};i[d.PARAM_FOLDER_TYPE]=f._getFolderType();i[d.PARAM_SORT_TYPE]=f._getSortType();return i},onsuccess:this.__closure(this.onsuccessGetAllCount)};var h=new b.Ajax(g);h.initialize();return this._ajaxGetAllCount=h},_elBroadIndexes:null,_getElBroadIndexes:function(){return this._elBroadIndexes||this._initElBroadIndexes()},_initElBroadIndexes:function(){return this._elBroadIndexes=a("#address-index-broad .address-select_index")},_elNarrowIndexes:null,_getElNarrowIndexes:function(){return this._elNarrowIndexes||this._initElNarrowIndexes()},_initElNarrowIndexes:function(){return this._elNarrowIndexes=a("#address-index-narrow .address-select_index")},setting:null,_getTable:function(){return this.setting.table},__constructor:function(f){this.setting=f;this._privateIndexCountLoaded=false;this._publicIndexCountLoaded=false;this._allIndexCountLoaded=false},initialize:function(){this._hook()},_hook:function(){var f;f=this._getElBroadIndexes();this.__bind(f,"click","SelectBroadIndex");f=this._getElNarrowIndexes();this.__bind(f,"click","SelectNarrowIndex")},updateIndex:function(){var g=this._getIndexName();if(this._isAllOfGroup()){this._selectBroadIndex(g)}else{var h=this.getSelectedBroadIndexName();var f=this.getBroadIndexNameByNarrowIndexName(g);if(h!=f){this._selectBroadIndex(f)}if(g=="@"){g=""}this._selectNarrowIndex(g)}},_loadByBroadIndex:function(f){var g=this._getTable();g.loadByBroadIndex(f)},_loadByNarrowIndex:function(f){var g=this._getTable();g.loadByNarrowIndex(f)},getSelectedBroadIndexName:function(){var f=this._getElBroadIndexes().filter("."+c.CLS_SELECTED_INDEX);var g=this._getIndexNameOf(f);return g},getAllCount:function(g){this._setIsLoadTable(g);var f=this._getAjaxGetAllCount();f.sendRequest()},_initAllCountData:function(g){var i={};var j={};var f=a(g).children();this._getKanaCounts(f,i,j);this._getAlphabetCounts(f,i,j);this._getNumberCounts(f,i,j);this._getOtherCounts(f,i,j);var h=this._getTable();if(h.isPrivate()){this._setPrivateIndexCountLoaded(true);this._setBroadPrivateIndexCounts(i);this._setNarrowPrivateIndexCounts(j)}else{if(h.isPublic()){this._setPublicIndexCountLoaded(true);this._setBroadPublicIndexCounts(i);this._setNarrowPublicIndexCounts(j)}else{this._setAllIndexCountLoaded(true);this._setBroadAllIndexCounts(i);this._setNarrowAllIndexCounts(j)}}},_getKanaCounts:function(o,f,p){for(var l=1;l<=46;l+=5){var g="kana"+l;var h=o.children(g);var q=h.text().split(",");var n=0;if(l==36){for(var k=0;k<q.length;k++){var m=Number(q[k]);p[(l+k*2)]=m;n+=m}}else{for(var k=0;k<q.length;k++){var m=Number(q[k]);p[(l+k)]=m;n+=m}}f[l]=n}},_getAlphabetCounts:function(n,f,o){var g=n.children("alpha");var p=g.text().split(",");var m=0;var j="adgjmptw";if(DENBUN_MODE_XNEO){j="adgjmorux"}for(var h=0;h<p.length;h++){var l=Number(p[h]);var k=j.charAt(h);o[k]=l;m+=l}f.a=m},_getNumberCounts:function(f,l,n){var j=f.children("number");var m=j.text().split(",");var h=0;for(var g=0;g<m.length;g++){var k=Number(m[g]);n["_"+g]=k;h+=k}l._1=h},_getOtherCounts:function(f,i,j){var g=f.children("etc");var h=g.text();var h=Number(h);j["@"]=h;i["@"]=h},initIndexEnabled:function(){var f=this._getTable();if(f.isSearchMode()){this._disableIndexes();return}if(f.isSubFolder()){this._disableIndexes()}else{this._updateIndexEnabled()}},_disableIndexes:function(){var f=this._getElBroadIndexes().add(this._getElNarrowIndexes());f.attr("disabled",true)},_updateIndexEnabled:function(){var k=this._getBroadIndexCounts();var l=this._getNarrowIndexCounts();for(var f in k){var h=k[f];var g=this._getElBroadIndexOf(f);g.attr("disabled",(h<1))}var j=this._getElNarrowIndexOf(c.VAL_INDEX_NAME_ALL);j.attr("disabled",false);for(var f in l){var h=l[f];var i=this._getElNarrowIndexOf(f);i.attr("disabled",(h<1))}if(b.isAndroid()){j.hide();setTimeout(function(m){j.show()},0)}},_selectBroadIndex:function(h){if(!h){h=this.getFirstBroadIndex()}var i=c.CLS_SELECTED_INDEX;var g=this._getElBroadIndexes();g.filter("."+i).removeClass(i);var f=this._getElBroadIndexOf(h);f.addClass(i);if(!DENBUN_MODE_XNEO||f.length>0){this._showNarrowIndexOf(h);this._selectNarrowIndex()}},getFirstBroadIndex:function(){var g=this._getBroadIndexCounts();for(var f in g){var h=g[f];if(h>0){return f}}return null},_showNarrowIndexOf:function(g){var h=this._getElNarrowIndexes().not("#"+c.ID_NARROW_INDEX_ALL);h.hide();var f=this._getElNarrowIndexes().filter("#"+c.ID_NARROW_INDEX_ALL);f.show();h.filter("["+c.DATA_PARENT_INDEX_NAME+'="'+g+'"]').show()},_selectNarrowIndex:function(h){if(!h){h=d.VAL_ALL_OF_GROUP}var i=c.CLS_SELECTED_INDEX;var g=this._getElNarrowIndexes();g.filter("."+i).removeClass(i);var f=this._getElNarrowIndexOf(h);f.addClass(i)},clearIndex:function(){this._setPrivateIndexCountLoaded(false);this._setPublicIndexCountLoaded(false);this._setAllIndexCountLoaded(false)},unselectIndex:function(){var f=this._getElBroadIndexes().add(this._getElNarrowIndexes());var h=c.CLS_SELECTED_INDEX;f.filter("."+h).removeClass(h);var g=this._getElNarrowIndexes();g.hide()},isIndexCountLoaded:function(){var f=this._getTable();if(f.isPrivate()){return this._isPrivateIndexCountLoaded()}else{if(f.isPublic()){return this._isPublicIndexCountLoaded()}else{return this._isAllIndexCountLoaded()}}},_getBroadIndexCounts:function(){var f;var g=this._getTable();if(g.isPrivate()){f=this._getBroadPrivateIndexCounts()}else{if(g.isPublic()){f=this._getBroadPublicIndexCounts()}else{f=this._getBroadAllIndexCounts()}}return f},_getNarrowIndexCounts:function(){var f;var g=this._getTable();if(g.isPrivate()){f=this._getNarrowPrivateIndexCounts()}else{if(g.isPublic()){f=this._getNarrowPublicIndexCounts()}else{f=this._getNarrowAllIndexCounts()}}return f},_getElBroadIndexOf:function(f){var h=this._getElBroadIndexes();var g=h.filter("["+c.DATA_INDEX_NAME+'="'+f+'"]');return g},_getElNarrowIndexOf:function(f){var g=this._getElNarrowIndexes();var h=g.filter("["+c.DATA_INDEX_NAME+'="'+f+'"]');return h},_isIndexForAllOfGroup:function(f){var g=f.attr(c.DATA_INDEX_NAME);return(g==d.VAL_ALL_OF_GROUP)},_getIndexName:function(){var f=this._getTable();return f.getIndexName()},_isAllOfGroup:function(){var f=this._getTable();return f.isAllOfGroup()},_getFolderType:function(){var f=this._getTable();return f.getFolderType()},_getIndexNameOf:function(f){var g=f.attr(c.DATA_INDEX_NAME);return g},getBroadIndexNameByNarrowIndexName:function(f){if(!f){return f}if(f=="@"){return f}if(f.match(/[a-z]/)){return"a"}var h=this._getElNarrowIndexOf(f);var g=this._getBroadIndexNameByElNarrowIndex(h);return g},_getBroadIndexNameByElNarrowIndex:function(g){var f=g.attr(c.DATA_PARENT_INDEX_NAME);return f},getCorrectedIndexNameOfAlphabet:function(k){var h=["abc","def","ghi","jkl","mno","pqrs","tuv","wxyz"];if(DENBUN_MODE_XNEO){h=["abc","def","ghi","jkl","mn","opq","rst","uvw","xyz"]}for(var g=0;g<h.length;g++){var j=h[g];var f=j.indexOf(k);if(f>=0){k=j.charAt(0);break}}return k},reflectToCounts:function(j,h){if(j&&j.match(/[a-z]/)){j=this.getCorrectedIndexNameOfAlphabet(j)}if(h&&h.match(/[a-z]/)){h=this.getCorrectedIndexNameOfAlphabet(h)}var f=this._getBroadIndexCounts();var g=this._getNarrowIndexCounts();if(f&&g&&j){var i=this.getBroadIndexNameByNarrowIndexName(j);f[i]=f[i]+1;g[j]=g[j]+1}if(f&&g&&h){var i=this.getBroadIndexNameByNarrowIndexName(h);f[i]=f[i]-1;g[h]=g[h]-1}},_getSortType:function(){var f=this._getTable();return f.getSortType()},_loadTable:function(){var f=this._getTable();return f.load()},onsuccessGetAllCount:function(g,f,h){this._initAllCountData(g);this.initIndexEnabled();if(this._getIsLoadTable()){this._loadTable()}},onclickSelectBroadIndex:function(h,i){var f=a(i);if(f.is(":disabled")){return}var g=this._getIndexNameOf(f);this._loadByBroadIndex(g)},onclickSelectNarrowIndex:function(h,i){var f=a(i);if(f.is(":disabled")){return}var g=this._getIndexNameOf(f);this._loadByNarrowIndex(g)},__closure:b.__closure,__bind:b.__bind,banpei:null}});c.constructor()})(jQuery);(function(b){var f=neo.core.readyNamespace("neo.denbun.Address.ListPage.AddressTable.DisplayFilter");if(!f){return}var d=neo.denbun;var e=d.Address;var c=d.Address.ListPage;var a=neo.denbun.Address.ListPage.AddressTable.DisplayFilter=new neo.core.Class({classProperties:{constructor:function(){}},properties:{_public:null,isPublic:function(){return this._public},_setPublic:function(g){return this._public=g},_private:null,isPrivate:function(){return this._private},_setPrivate:function(g){return this._private=g},_mobile:null,isMobile:function(){return this._mobile},_setMobile:function(g){return this._mobile=g},_elMailFilter:null,_getElMailFilter:function(){return this._elMailFilter||this._initElMailFilter()},_initElMailFilter:function(){return this._elMailFilter=b("#address-mail_filter")},_elPublic:null,_getElPublic:function(){return this._elPublic||this._initElPublic()},_initElPublic:function(){var g=this._getElMailFilter();return this._elPublic=g.find(".address-mail_filter-item-public")},_elPrivate:null,_getElPrivate:function(){return this._elPrivate||this._initElPrivate()},_initElPrivate:function(){var g=this._getElMailFilter();return this._elPrivate=g.find(".address-mail_filter-item-private")},_elMobile:null,_getElMobile:function(){return this._elMobile||this._initElMobile()},_initElMobile:function(){var g=this._getElMailFilter();return this._elMobile=g.find(".address-mail_filter-item-mobile")},setting:null,__constructor:function(g){this.setting=g||{}},initialize:function(){this._hook();this.updateMailFilter()},_hook:function(){var g;g=this._getElMailFilter();this.__bind(g,"click","MailFilter")},updateMailFilter:function(){var g;var h;h=this._getElPublic();g=this._getStatusFrom(h);this._setPublic(g);h=this._getElPrivate();g=this._getStatusFrom(h);this._setPrivate(g);h=this._getElMobile();g=this._getStatusFrom(h);this._setMobile(g)},getAvailableCountOfMailFilterType:function(){var g=0;if(this.isPublic()){g++}if(this.isPrivate()){g++}if(this.isMobile()){g++}return g},_getStatusFrom:function(i){var h=this._getElCheckBox(i);var g=h.attr("checked");return g},_getElCheckBox:function(h){var g=h.find("input[type=checkbox]");return g},onclickMailFilter:function(g,h){this.updateMailFilter();if(typeof this.setting.onchange=="function"){this.setting.onchange()}},__closure:d.__closure,__bind:d.__bind,banpei:null}});a.constructor()})(jQuery);(function(b){var e=neo.core.readyNamespace("neo.denbun.Address.ListPage.SelectedListPanel");if(!e){return}var c=neo.denbun;var d=c.Address;var a=neo.denbun.Address.ListPage.SelectedListPanel=new neo.core.Class({superClass:d.AddressSelectedListPanel,classProperties:{CLS_SECTION:"address-selected_list-section",CLS_SECTION_HOVERED:"address-section-hover",constructor:function(){}},properties:{_getContainerIdToTable:function(){return"address-selected_list-to-table-container"},_getContainerIdCcTable:function(){return"address-selected_list-cc-table-container"},_getContainerIdBccTable:function(){return"address-selected_list-bcc-table-container"},_getElContainerLow:function(){return b("#address-selected_list-container")},_getElListSectionsLow:function(){return b("."+a.CLS_SECTION)},_getElRemoveSelectedLow:function(){return b(".address-selected_list-remove_selected")},_getElAddLow:function(){return b(".address-selected_list-add")},_getClsSectionHover:function(){return a.CLS_SECTION_HOVERED},_getClsCurrentSection:function(){return"address-selected_list-section-current"},_getDroppableOptions:function(){var f=this.__call("_getDroppableOptions",arguments);f.scope=c.Address.DROPPABLE_SCOPE_ADDRESS;return f},_getTargetTypeOf:function(g){var h=g.closest("."+a.CLS_SECTION);var f=h.attr(d.AddressSelectedListPanel.DATA_NAME);return f},__closure:c.__closure,__bind:c.__bind,banpei:null}});a.constructor()})(jQuery);(function(a){var e=neo.core.readyNamespace("neo.denbun.Address.UsersListPage");if(!e){return}var c=neo.denbun;var d=c.Address;var b=neo.denbun.Address.UsersListPage=new neo.core.Class({superClass:d.AddressPage,classProperties:{constructor:function(){}},properties:{_getElSelectFolderTabLow:function(){return a("#users-folder-tab-list .tab_selector-link")},_searchForm:null,_getSearchForm:function(){return this._searchForm||this._initSearchForm()},_initSearchForm:function(){return this._searchForm=a("#users-table-search")},_elSearchKeyword:null,_getElSearchKeyword:function(){return this._elSearchKeyword||this._initElSearchKeyword()},_initElSearchKeyword:function(){if(DENBUN_MODE_XNEO){var f=this;var g=function(){f.onclickSearchExec()};neo.denbun.keysearch.setUp("users-table-search-keyword",a("#users-table-search-keyword"),g)}return this._elSearchKeyword=a("#users-table-search-keyword")},_elSearchExec:null,_getElSearchExec:function(){return this._elSearchExec||this._initElSearchExec()},_initElSearchExec:function(){return this._elSearcdExec=a("#users-table-search-exec")},_usersFolders:null,_getUsersFolders:function(){return this._usersFolders},_initUsersFolders:function(){var g={page:this};var f=new d.UsersFolders(g);f.initialize();return this._usersFolders=f},_table:null,_getTable:function(){return this._table||this._initTable()},_initTable:function(){var f={page:this};var g=new b.UsersTable(f);g.initialize();return this._table=g},_listPanel:null,_getListPanel:function(){return this._listPanel||this._initListPanel()},_initListPanel:function(){var f={page:this};var g=new b.SelectedListPanel(f);g.initialize();return this._listPanel=g},_lastKeyword:null,_getLastKeyword:function(){return this._lastKeyword},_setLastKeyword:function(f){return this._lastKeyword=f},initialize:function(){if(DENBUN_MODE_XNEO){if(!c.comSetting.isAvailableWebMail()){a("[data-action=folderSendMail]").hide().prev(".popup_menu-item-separator").hide()}}this._registerMenuCallbacks();var f=this;c.comSetting.getAddressSetting(function(){f._initUsersFolders();f._getTable();f._getListPanel()});this._hook()},_updateMenuStatus:function(f){this.__call("_updateMenuStatus",arguments);if(!DENBUN_MODE_XNEO){this._updateRemoveMenuEnable(f)}},_updateMenuEnable:function(f){this._updateRemoveMenuEnable(f)},_updateRemoveMenuEnable:function(i){var g=c.CLS_DISABLED;var f=this._getElMenuForRemove(i);var h=this._getUsersFolders();var j=h.getCurNodeId();if(isNaN(j)||j>0){f.addClass(g)}},_getElMenuForRemove:function(f){var g=f.find(".address_users_menu-for_remove");return g},_registerMenuCallbacks:function(){var f=this.__closure(this._updateMenuStatus);c.app.registerMenuCallback(f,"address_users_list","users_table")},updateMenuEnabled:function(g){this.__call("updateMenuEnabled",arguments);if(g){return}var f=this._getElToolbar();this._updateRemoveMenuEnable(f)},_hook:function(){this.__call("_hook",arguments);var f;f=this._getSearchForm();this.__bind(f,"submit","Search");if(c.isIe7()){f=this._getElSearchExec();this.__bind(f,"click","SearchExec")}},_initOnOpening:function(){this.__call("_initOnOpening",arguments);if(this._usersFolders&&this._table){if(c.app.getFlgUpdateUserList()){this.reloadTable()}}},_updatePageClass:function(){this.__call("_updatePageClass",arguments);var i=this.isSelectorMode();var g=d.AddressPage.CLS_POPUP_MENU_ADDRESS_SELECTOR_MODE;var h=a("#popup_menu-address_users_list-users_table");h.toggleClass(g,i);var f=a("#popup_menu-address_users_list-users_folder");f.toggleClass(g,i);if(DENBUN_MODE_XNEO){var k=a('#users-folder-tab-list [href="#'+c.PARAM_PAGE+"="+c.PAGE_ADDRESS_LIST+'"]').closest("li");var j=c.comSetting.isAvailableAddress();if(j){k.show()}else{k.hide()}}},_getElOwnItemsLow:function(){return a(".page-address_users_list-item")},getUsersFolderNameOf:function(h){var g=this._getUsersFolders();var f=g.getNameOf(h);return f},loadTable:function(i,f){var g=this._getTable();g.switchMode(d.AddressTable.VAL_MODE_DEFAULT);this._clearSearchKeyword();var h=g.getConditionsFromFolder(i,f);g.load(h)},reloadTable:function(){var f=this._getTable();f.reload(null,true);c.app.setFlgUpdateAddressList(false)},loadTableByConditions:function(g){var f=this._getTable();f.switchMode(d.AddressTable.VAL_MODE_SEARCH);f.load(null,g)},_search:function(){if(!this.isReady()){return}var f=this._getElSearchKeyword();var g=f.val();if(g==""){var k=this._getUsersFolders();var j=k.getCurNodeId();var i=k.getCurType();this.loadTable(j,i);return}if(DENBUN_MODE_XNEO){if(g&&g.length>desknets.SRCHKEY_MAXLENGTH){var h=desknets.Resource.Message.com_search_keyword_toolarge;c.alert(h);return}}this._setLastKeyword(g);var k=this._getUsersFolders();var j=k.getCurNodeId();var l={};l[b.UsersTable.PARAM_KEY]=g;l[b.UsersTable.PARAM_ID]=j;if(DENBUN_MODE_XNEO){l.num=c.comSetting.getAddressRow()}this.loadTableByConditions(l)},_clearSearchKeyword:function(){var f=this._getElSearchKeyword();f.val("");this._setLastKeyword(null)},updateFolderNameInTable:function(){var f=this._getTable();f.updateTitle()},_reSearch:function(){if(!this.isReady()){return}var k=this._getUsersFolders();var i=k.getCurNodeId();var g=this._getLastKeyword();if(g==""){var h=k.getCurType();this.loadTable(i,h);return}var f=this._getElSearchKeyword();f.val(g);var j=this._getTable();j.setFlgInitConditionsForSearch(false);var l={};l[b.UsersTable.PARAM_KEY]=g;l[b.UsersTable.PARAM_ID]=i;this.loadTableByConditions(l)},view:function(){this._execView()},_execView:function(i){var g=this._getTable();var f=g.getSelectedIdList();if(f.length!=1){return}var h={id:f[0]};if(i){h[c.PARAM_FORK]=true}this.saveParameter();c.openPage(c.PAGE_ADDRESS_USER_VIEW,h)},remove:function(){var i=this._getTable();var h=i.getSelectedIdList();if(h.length<1){return}if(this._removeIsDisabled()){return}var g=c.getText("選択したユーザーをグループから外します。よろしいですか？");var f=this;c.confirm(g,{onok:function(){var j=i.getFolderId();f.execRemoving(j,h)}})},execRemoving:function(h,k){var g=c.getUrl(c.CGI_USET);var f=this;var i={url:g,getSendData:function(){var l={cmd:"usetgroupadd",gid:h,id:k};return l},onsuccess:function(){var l=f._getTable();if(l.isSearchMode()){f._reSearch()}else{f.reloadTable()}if(c.parent&&!c.isIpadiOS6()){c.parent.app.updateUserList()}}};var j=new c.Ajax(i);j.initialize();j.sendRequest()},folderCreate:function(){var f=this._getUsersFolders();f.create()},folderRemove:function(){var f=this._getUsersFolders();f.remove()},folderRename:function(){var f=this._getUsersFolders();f.rename()},folderUp:function(){var f=this._getUsersFolders();f.moveUp()},folderDown:function(){var f=this._getUsersFolders();f.moveDown()},folderSendMail:function(){this._execSendMail(true)},_execSendMail:function(i){var h=this._getUsersFolders();var j=h.getMailAddress();if(!j){return}var f=c.getMailAddressForToMailInputItem(j);var g={to:f};if(i){g[c.PARAM_FORK]=true}c.openPage(c.PAGE_MAIL_EDIT,g)},addToTo:function(){var g=this._getUsersFolders();var h=g.getFolderIdAndType();if(!h){return}var f=this;var i=function(j){var k=f._getListPanel();k.addToTo(j);f.updateTable()};c.getMailAddressesOfUsersListByGroup(h.id,h.type,i)},addToCc:function(){var g=this._getUsersFolders();var h=g.getFolderIdAndType();if(!h){return}var f=this;var i=function(j){var k=f._getListPanel();k.addToCc(j);f.updateTable()};c.getMailAddressesOfUsersListByGroup(h.id,h.type,i)},addToBcc:function(){var g=this._getUsersFolders();var h=g.getFolderIdAndType();if(!h){return}var f=this;var i=function(j){var k=f._getListPanel();k.addToBcc(j);f.updateTable()};c.getMailAddressesOfUsersListByGroup(h.id,h.type,i)},addMailsToSelectedList:function(g){var f=this._getListPanel();f.addMailAddresses(g)},addMailToSelectedList:function(g){var f=this._getListPanel();f.add(g)},removeMailFromSelectedList:function(g){var f=this._getListPanel();f.remove(g)},isExistedMailInSelectedList:function(g){var f=this._getListPanel();return f.isExistedOf(g)},moveRows:function(h,i){var g=this._getTable();var j=g.getFolderId();var f=this._getUsersFolders();if(!f.isMutableFolderId(j)){j=null}if(c.isCtrlPressed()){j=null}if(j==i){return}this.execMoveRows(j,i,h)},execMoveRows:function(k,f,l){if(!l||l.length<1){return}var h=c.getUrl(c.CGI_USET);var g=this;var i={url:h,getSendData:function(){var m={cmd:"usetgroupadd",togid:f,id:l};if(k){m.gid=k}return m},onsuccess:function(){if(k){var m=g._getTable();if(m.isSearchMode()){g._reSearch()}else{g.reloadTable()}}if(c.parent&&!c.isIpadiOS6()){c.parent.app.updateUserList()}}};var j=new c.Ajax(i);j.initialize();j.sendRequest()},_removeIsDisabled:function(){var g=this._getElToolbar();var f=this._getElMenuForRemove(g);return f.is("."+c.CLS_DISABLED)},onresize:function(h){var g=this._getTable();g.onresize(h);var f=this._getListPanel();f.onresize(h)},onsubmitSearch:function(f,g){f.preventDefault();this._search()},onclickSearchExec:function(f,g){this._search()},onclose:function(g){if(c.isIe7()){var f=this._getElOwnItems();f.hide()}if(DENBUN_MODE_XNEO){if(c.isTablet()){c.$body.removeClass(c.CLS_COM_LEFT_CONTAINER_NARROW)}}g()},__closure:c.__closure,__bind:c.__bind,banpei:null}});b.constructor()})(jQuery);(function(a){var f=neo.core.readyNamespace("neo.denbun.Address.UsersListPage.UsersTable");if(!f){return}var c=neo.denbun;var e=c.Address;var b=c.Address.UsersListPage;var d=neo.denbun.Address.UsersListPage.UsersTable=new neo.core.Class({superClass:e.AddressTable,classProperties:{CLS_CELL_NAME:"users-table-cell-name",CLS_CELL_BELONGING_GROUP:"users-table-cell-belonging_group",CLS_CELL_EXTENSTION:"users-table-cell-extension",CLS_NAME:"users-table-name",CLS_MAIL_LIST_LABEL:"users-table-mail-label",HTML_ICON:'<img class="users-table-item-icon" src="'+c.PATH_IMG_SPACER+'" width="12" height="12" alt="" />',KEY_NAME:"Name",KEY_BELONGING_GROUP:"assigngrp",KEY_BELONGING_GROUP_NAME:"Name",KEY_BELONGING_GROUP_GROUP:"Group",KEY_NAISEN:"Naisen",KEY_PUBLIC_MAIL:"Mail",KEY_MOBILE_MAIL:"mailmobile",KEY_PRIVATE_MAIL:"mailprivate",KEY_ETC_MAIL:"mailother",KEY_SKYPE:"skype",PARAM_KEY:"srch_key",PARAM_ID:"gid",PARAM_FOLDER_TYPE:"area",PARAM_SORT_FIELD:"fldsort",PARAM_SORT_ORDER:"order",SORT_NAME:"Name",SORT_BELONGING_GROUP:"gname",SORT_EXTENSTION:"Naisen",SORT_ORDER_ASC:"1",SORT_ORDER_DESC:"-1",constructor:function(){}},properties:{_setConditions:function(g){this._conditions=g;return this._conditions},_sortField:undefined,_getSortField:function(){return this._sortField},_setSortField:function(g){return this._sortField=g},_sortOrder:undefined,_getSortOrder:function(){return this._sortOrder},_setSortOrder:function(g){return this._sortOrder=g},_conditionsForExecSearch:null,_getConditionsForExecSearch:function(g){var h=this._conditionsForExecSearch||{};if(g==null){return h}else{return h[g]}},_setConditionsForExecSearch:function(g){return this._conditionsForExecSearch=g},_ajaxLoadForExecSearch:null,_getAjaxLoadForExecSearch:function(){return this._ajaxLoadForExecSearch||this._initAjaxLoadForExecSearch()},_initAjaxLoadForExecSearch:function(){var g=this;var h=c.getUrl(c.CGI_USET);var i={cache:true,url:h,getSendData:function(){var l=g._getDataToLoadForExecSearch();if(neo.core.isString(l)){l=neo.core.splitParam(l)}var k=String(new Date().getTime());g._setLastConnectionKey(k);l._=k;return l},onsuccess:this.__closure(this.onsuccessLoadForExecSearch)};var j=new c.Ajax(i);j.initialize();return this._ajaxLoadForExecSearch=j},_ajaxLoadForSearch:null,_getAjaxLoadForSearch:function(){return this._ajaxLoadForSearch||this._initAjaxLoadForSearch()},_initAjaxLoadForSearch:function(){var g=this;var h=c.getUrl(c.CGI_USET);var i={cache:true,url:h,getSendData:function(){var l=g._getDataToLoadForSearch();if(neo.core.isString(l)){l=neo.core.splitParam(l)}var k=String(new Date().getTime());g._setLastConnectionKey(k);l._=k;return l},onsuccess:this.__closure(this.onsuccessLoad),onerror:this.__closure(this.onerrorForSearch)};var j=new c.Ajax(i);j.initialize();return this._ajaxLoadForSearch=j},_displayFilter:null,_getDisplayFilter:function(){return this._displayFilter||this._initDisplayFilter()},_initDisplayFilter:function(){var g={table:this,onchange:this.__closure(this.onchangeDisplayFilter)};var h=new b.UsersTable.DisplayFilter(g);h.initialize();return this._displayFilter=h},_getElSectionTitleLow:function(){return a("#users-table-title")},_getElPagerLow:function(){return a("#users-table-pager")},_getElContainerLow:function(){return a("#users-table-table-container.com_table")},_getElDraggableHelperLow:function(){var i=a("#address_users-draggable-helper");if(!DENBUN_MODE_XNEO){var h=i.text();var g=c.getText(h);i.html(g)}return i},_elTitleBox:null,_getElTitleBox:function(){return this._elTitleBox||this._initElTitleBox()},_initElTitleBox:function(){var g=this._getElTitleCells();var h=g.find("."+c.Table.CLS_BOX);return this._elTitleBox=h},_elTableContainer:null,_getElTableContainer:function(){return this._elTableContainer||this._initElTableContainer()},_initElTableContainer:function(){return this._elTableContaienr=a("#users-table-container")},_flgInitConditionsForSearch:true,_getFlgInitConditionsForSearch:function(){return this._flgInitConditionsForSearch},_initFlgInitConditionsForSearch:function(){return this._flgInitConditionsForSearch=true},setFlgInitConditionsForSearch:function(g){return this._flgInitConditionsForSearch=g},initialize:function(){this.__call("initialize",arguments);this._initDisplayFilter()},_hook:function(){var g;this.__call("_hook",arguments);g=this._getElTitleBox();this.__bind(g,"click","TitleBox");this._hookDraggable()},_getDraggableScope:function(){return c.Address.DROPPABLE_SCOPE_USER},load:function(j,i){if(j){this._setConditions(j)}var h=this._getPage();h.updateMenuEnabled(true);if(this.isSearchMode()){if(DENBUN_MODE_XNEO){if(i!=null&&i!=undefined){if(i[d.PARAM_ID]=="nogroup"){i[d.PARAM_ID]="0"}this._setConditions(i)}this._loadForSearch()}else{if(i){this._setConditionsForExecSearch(i);var g=this._getAjaxLoadForExecSearch();g.sendRequest()}else{this._loadForSearch()}}}else{var g=this._getAjaxLoad();g.sendRequest()}},_loadForSearch:function(){var g=this._getAjaxLoadForSearch();g.sendRequest()},_getUrlToLoad:function(){return c.getUrl(c.CGI_USET)},_getDataToLoad:function(){var g=this._getConditions();g.cmd="usetindex";g[d.PARAM_SORT_FIELD]=this._getSortField();g[d.PARAM_SORT_ORDER]=this._getSortOrder();if(DENBUN_MODE_XNEO){if(g[d.PARAM_ID]=="nogroup"){g[d.PARAM_ID]="0"}}return g},_getDataToLoadForExecSearch:function(){var g=this._getConditionsForExecSearch();g.cmd="usetsearch";if(DENBUN_MODE_XNEO){if(g[d.PARAM_ID]=="nogroup"){g[d.PARAM_ID]="0"}}if(this._getFlgInitConditionsForSearch()){var h=this._getConditions();h[c.Table.PARAM_OFFSET]=0;this._setSortField(undefined);this._setSortOrder(undefined);this._cleanSortIcons()}this._initFlgInitConditionsForSearch();return g},_getDataToLoadForSearch:function(){var g=this._getConditions();g.cmd="usetsearchlist";g[d.PARAM_SORT_FIELD]=this._getSortField();g[d.PARAM_SORT_ORDER]=this._getSortOrder();return g},_parseListItem:function(g){var k=this.__call("_parseListItem",arguments);k[d.KEY_BELONGING_GROUP]=[];var m=g.children(d.KEY_BELONGING_GROUP).children();for(var j=0;j<m.length;j++){var h=m.eq(j);var l={};l[d.KEY_BELONGING_GROUP_NAME]=h.text();l[d.KEY_BELONGING_GROUP_GROUP]=h.attr(d.KEY_BELONGING_GROUP_GROUP);k[d.KEY_BELONGING_GROUP].push(l)}return k},_update:function(){this.__call("_update",arguments)},setTitle:function(j){if(DENBUN_MODE_XNEO){var i=this._getElSectionTitle();if(!i||i.length<1){return}if(this.isSearchMode()){var g=neo.core.escape(this._getFolderName());g=desknets.escapeSpace(g);var h=c.getText("検索結果")+desknets.merrMsgConnect+g;i.html(h);if(a.browser.webkit){i.hide();setTimeout(function(){i.show()},1)}}else{this.__call("setTitle",arguments)}}else{this.__call("setTitle",arguments)}},_getTitle:function(){var g=this._getPage();if(!g.isReady()){return""}if(this.isSearchMode()){var h=c.getText("検索結果");return h+this._getFolderName()}return this._getFolderName()},_getFolderName:function(){var i=this._getFolderId();if(DENBUN_MODE_XNEO){if(i=="0"){i="nogroup"}}var g;var h=this._getPage();g=h.getUsersFolderNameOf(i);return g},_buildTableCellsHtml:function(j,k,i){var g=this._getTableCellEndHtml();var h=0;j.push(this._getTableCellStartHtml(["users-table-cell","users-table-cell-name",c.Table.CLS_CELL_FLEXIBLE],i[h++]));this._buildHtmlName(j,k);j.push(g);j.push(this._getTableCellStartHtml(["users-table-cell","users-table-cell-belonging_group"],i[h++]));this._buildHtmlBelongingGroup(j,k);j.push(g);j.push(this._getTableCellStartHtml(["users-table-cell","users-table-cell-extension"],i[h++]));this._buildHtmlExtension(j,k);j.push(g);j.push(this._getTableCellStartHtml(["users-table-cell","users-table-cell-mail"],i[h++]));this._buildHtmlMail(j,k);j.push(g);return j},_buildHtmlName:function(i,j){var h;var g=j.data;h=g[d.KEY_NAME];if(h){i.push('<div class="users-table-name">');i.pushText(h);i.push("</div>")}h=g[d.KEY_SKYPE];if(h){i.push('<div class="users-table-item users-table-item-skype">');i.push(d.HTML_ICON);i.push('<span class="users-table-skype">');i.push('<a href="callto://');i.pushValue(h);i.push('/">');i.pushText(h);i.push("</a>");i.push("</span>");i.push("</div>")}return i},_buildHtmlBelongingGroup:function(m,n){var k;var j=n.data;belogingGroup=j[d.KEY_BELONGING_GROUP];if(belogingGroup>0){m.push('<span class="users-table-belonging_group">')}for(var h=0;h<belogingGroup.length;h++){var l=belogingGroup[h];if(h){m.push(", ")}var g=(l[d.KEY_BELONGING_GROUP_GROUP]?true:false);var k=l[d.KEY_BELONGING_GROUP_NAME];if(g){m.push("<em>")}else{m.push("<span>")}m.pushText(k);if(g){m.push("</em>")}else{m.push("</span>")}}if(belogingGroup>0){m.push("</span>")}return m},_buildHtmlExtension:function(i,j){var h;var g=j.data;if(this.isSelectorMode()){return}h=g[d.KEY_NAISEN];if(h){i.push('<span class="users-table-extension">');i.pushText(h);i.push("</span>")}return i},_buildHtmlMail:function(g,h){if(this.isSelectorMode()){g=this._buildHtmlMailForSelectorMode(g,h)}else{g=this._buildHtmlMailForNormalMode(g,h)}return g},_buildHtmlMailForNormalMode:function(j,k){var i;var h=k.data;var g=d.HTML_ICON;j.push('<ul class="users-table-mail-list">');i=h[d.KEY_PUBLIC_MAIL];if(i){j.push('<li class="users-table-item users-table-item-public">');j.push('<span class="users-table-mail-label">');j.push(g);if(DENBUN_MODE_XNEO){this._buildHtmlMailLinkForNormalMode(j,i,"users-table-mail-public",false)}else{j.push('<span class="users-table-mail-item users-table-mail-public link">');j.pushText(i);j.push("</span>")}j.push("</span>");j.push("</li>")}i=h[d.KEY_MOBILE_MAIL];if(i){j.push('<li class="users-table-item users-table-item-mobile">');j.push('<span class="users-table-mail-label">');j.push(g);if(DENBUN_MODE_XNEO){this._buildHtmlMailLinkForNormalMode(j,i,"users-table-mail-mobile",false)}else{j.push('<span class="users-table-mail-item users-table-mail-mobile link">');j.pushText(i);j.push("</span>")}j.push("</span>");j.push("</li>")}i=h[d.KEY_PRIVATE_MAIL];if(i){j.push('<li class="users-table-item users-table-item-private">');j.push('<span class="users-table-mail-label">');j.push(g);if(DENBUN_MODE_XNEO){this._buildHtmlMailLinkForNormalMode(j,i,"users-table-mail-private",false)}else{j.push('<span class="users-table-mail-item users-table-mail-private link">');j.pushText(i);j.push("</span>")}j.push("</span>");j.push("</li>")}i=h[d.KEY_ETC_MAIL];if(i){j.push('<li class="users-table-item users-table-item-etc">');j.push('<span class="users-table-mail-label">');j.push(g);if(DENBUN_MODE_XNEO){this._buildHtmlMailLinkForNormalMode(j,i,"users-table-mail-etc",false)}else{j.push('<span class="users-table-mail-item users-table-mail-etc link">');j.pushText(i);j.push("</span>")}j.push("</span>");j.push("</li>")}j.push("</ul>");return j},_buildHtmlMailForSelectorMode:function(h,p){var i=this._getDisplayFilter();var n;var j=p.data;var k=d.HTML_ICON;var l=this._getPage();var g=j[d.KEY_NAME];h.push('<ul class="users-table-mail-list">');if(i.isPublic()){n=j[d.KEY_PUBLIC_MAIL];if(n){var o=c.getDestinationText(g,n);var m=l.isExistedMailInSelectedList({mail:n,text:o});h.push('<li class="users-table-item users-table-item-public">');h.push('<span class="users-table-mail-label">');h.push('<input class="users-table-mail-item-value" type="checkbox" autocomplete="off"');(m)&&h.push(" checked");h.push(' value="');h.pushValue(n);h.push('" />');h.push(k);h.push('<span class="users-table-mail-item users-table-mail-public">');h.pushText(n);h.push("</span>");h.push("</span>");h.push("</li>")}}if(i.isMobile()){n=j[d.KEY_MOBILE_MAIL];if(n){var o=c.getDestinationText(g,n);var m=l.isExistedMailInSelectedList({mail:n,text:o});h.push('<li class="users-table-item users-table-item-mobile">');h.push('<span class="users-table-mail-label">');h.push('<input class="users-table-mail-item-value" type="checkbox" autocomplete="off"');(m)&&h.push(" checked");h.push(' value="');h.pushValue(n);h.push('" />');h.push(k);h.push('<span class="users-table-mail-item users-table-mail-mobile">');h.pushText(n);h.push("</span>");h.push("</span>");h.push("</li>")}}if(i.isPrivate()){n=j[d.KEY_PRIVATE_MAIL];if(n){var o=c.getDestinationText(g,n);var m=l.isExistedMailInSelectedList({mail:n,text:o});h.push('<li class="users-table-item users-table-item-private">');h.push('<span class="users-table-mail-label">');h.push('<input class="users-table-mail-item-value" type="checkbox" autocomplete="off"');(m)&&h.push(" checked");h.push(' value="');h.pushValue(n);h.push('" />');h.push(k);h.push('<span class="users-table-mail-item users-table-mail-private">');h.pushText(n);h.push("</span>");h.push("</span>");h.push("</li>")}}if(i.isEtc()){n=j[d.KEY_ETC_MAIL];if(n){var o=c.getDestinationText(g,n);var m=l.isExistedMailInSelectedList({mail:n,text:o});h.push('<li class="users-table-item users-table-item-etc">');h.push('<span class="users-table-mail-label">');h.push('<input class="users-table-mail-item-value" type="checkbox" autocomplete="off"');(m)&&h.push(" checked");h.push(' value="');h.pushValue(n);h.push('" />');h.push(k);h.push('<span class="users-table-mail-item users-table-mail-etc">');h.pushText(n);h.push("</span>");h.push("</span>");h.push("</li>")}}h.push("</ul>");return h},open:function(){if(this.isSelectorMode()){var i=this.getCurId();var g=this.getVisibleMailsById(i);if(g.length>0){var h=this._getPage();h.addMailsToSelectedList(g);h.updateTable()}return}var h=this._getPage();h.saveParameter();var i=this.getCurId();c.openPage(c.PAGE_ADDRESS_USER_VIEW,{id:i})},remove:function(){var g=this._getPage();g.remove()},_sort:function(k){var i=this._getSortType(k);if(!i){return}var l=this._getConditions();l[c.Table.PARAM_OFFSET]="";var g;var h=l[d.PARAM_SORT_FIELD];if(i==h){var j=l[d.PARAM_SORT_ORDER];if(j==d.SORT_ORDER_ASC){g=d.SORT_ORDER_DESC}else{g=d.SORT_ORDER_ASC}this._setSortOrder(g)}else{g=d.SORT_ORDER_ASC;this._setSortField(i);this._setSortOrder(g)}this.load();this._updateSortIcons(k,g)},_getSortType:function(g){var h;a.each([{cls:d.CLS_CELL_NAME,sortType:d.SORT_NAME},{cls:d.CLS_CELL_BELONGING_GROUP,sortType:d.SORT_BELONGING_GROUP},{cls:d.CLS_CELL_EXTENSTION,sortType:d.SORT_EXTENSTION},],function(j,k){if(!k){return}if(g.hasClass(k.cls)){h=k.sortType;return false}});return h},_updateSortIcons:function(i,g){this._cleanSortIcons();var h=i.find("."+c.CLS_COM_TRIANGLE);if(g==d.SORT_ORDER_ASC){h.addClass(c.CLS_COM_TRIANGLE_UP)}else{h.addClass(c.CLS_COM_TRIANGLE_DOWN)}},_cleanSortIcons:function(){var g=this._getElTitleBox();var h=g.find("."+c.CLS_COM_TRIANGLE);h.removeClass(c.CLS_COM_TRIANGLE_UP).removeClass(c.CLS_COM_TRIANGLE_DOWN)},_changeDisplayFilter:function(){var j=this._getDisplayFilter();var g=j.getAvailableCountOfMailFilterType();var i=this._getElTableContainer();i.removeClass(["mail-filter-count-0","mail-filter-count-1","mail-filter-count-2","mail-filter-count-3","mail-filter-count-4",].join(" ")).addClass("mail-filter-count-"+g);this._initRowHeight();this._initVisibleRange();this._updateScroller();this._updateTable();var h=this._getCurRow();h&&this._scrollTo(h)},_updateDraggableHelper:function(j){var g=this._getDragingDataList();var i=g.length+"";var k=c.getText("$$ 件のユーザー");var h=neo.core.replace(k,i);j.text(h);var j=this._getElDraggableHelper();j.data(d.DATA_SELECTED_DATA_LIST,g)},getConditionsFromFolder:function(i,g){var h={};h[d.PARAM_FOLDER_TYPE]=g;h[d.PARAM_ID]=i;return h},_getFolderId:function(){return this._getConditions(d.PARAM_ID)},getFolderId:function(){return this._getFolderId()},getVisibleMails:function(h){var j=[];var i=this._getDisplayFilter();if(i.isPublic()){var g=h[d.KEY_PUBLIC_MAIL];if(g&&g!=""){j.push(g)}}if(i.isMobile()){var g=h[d.KEY_MOBILE_MAIL];if(g&&g!=""){j.push(g)}}if(i.isPrivate()){var g=h[d.KEY_PRIVATE_MAIL];if(g&&g!=""){j.push(g)}}if(i.isEtc()){var g=h[d.KEY_ETC_MAIL];if(g&&g!=""){j.push(g)}}return j},_getNameFrom:function(i){var g=this._getElRowFrom(i);var j=g.find("."+d.CLS_NAME);var h=j.text();return h},_getNameOf:function(g){return g[d.KEY_NAME]},isElMail:function(g){var h=g.closest("."+d.CLS_MAIL_LIST_LABEL);return(h.length>0)},_getMailFrom:function(h){var i=h.find(".users-table-mail-item");var g=i.text();return g},_getElMailFrom:function(g){var h=g.closest(".users-table-item");return h},_getElSelectMailFrom:function(g){var h=g.find(".users-table-mail-item-value");return h},onchangeDisplayFilter:function(){this._changeDisplayFilter()},onsuccessLoadForExecSearch:function(h,g,i){this._loadForSearch()},onerrorForSearch:function(i,g,j,h){if(j.errorno=="1"){this._loadForSearch();return false}},onclickTitleBox:function(g,i){var h=a(i).closest("."+c.Table.CLS_CELL);this._sort(h)},banpei:null}});d.constructor()})(jQuery);(function(b){var f=neo.core.readyNamespace("neo.denbun.Address.UsersListPage.UsersTable.DisplayFilter");if(!f){return}var c=neo.denbun;var e=c.Address;var d=c.Address.UsersTable;var a=neo.denbun.Address.UsersListPage.UsersTable.DisplayFilter=new neo.core.Class({classProperties:{constructor:function(){}},properties:{_public:null,isPublic:function(){return this._public},_setPublic:function(g){return this._public=g},_mobile:null,isMobile:function(){return this._mobile},_setMobile:function(g){return this._mobile=g},_private:null,isPrivate:function(){return this._private},_setPrivate:function(g){return this._private=g},_etc:null,isEtc:function(){return this._etc},_setEtc:function(g){return this._etc=g},_elMailFilter:null,_getElMailFilter:function(){return this._elMailFilter||this._initElMailFilter()},_initElMailFilter:function(){return this._elMailFilter=b("#users-mail_filter")},_elPublic:null,_getElPublic:function(){return this._elPublic||this._initElPublic()},_initElPublic:function(){var g=this._getElMailFilter();return this._elPublic=g.find(".users-mail_filter-item-public")},_elMobile:null,_getElMobile:function(){return this._elMobile||this._initElMobile()},_initElMobile:function(){var g=this._getElMailFilter();return this._elMobile=g.find(".users-mail_filter-item-mobile")},_elPrivate:null,_getElPrivate:function(){return this._elPrivate||this._initElPrivate()},_initElPrivate:function(){var g=this._getElMailFilter();return this._elPrivate=g.find(".users-mail_filter-item-private")},_elEtc:null,_getElEtc:function(){return this._elEtc||this._initElEtc()},_initElEtc:function(){var g=this._getElMailFilter();return this._elEtc=g.find(".users-mail_filter-item-etc")},setting:null,__constructor:function(g){this.setting=g||{}},initialize:function(){this._hook();this.updateMailFilter()},_hook:function(){var g;g=this._getElMailFilter();this.__bind(g,"click","MailFilter")},updateMailFilter:function(){var g;var h;h=this._getElPublic();g=this._getStatusFrom(h);this._setPublic(g);h=this._getElMobile();g=this._getStatusFrom(h);this._setMobile(g);h=this._getElPrivate();g=this._getStatusFrom(h);this._setPrivate(g);h=this._getElEtc();g=this._getStatusFrom(h);this._setEtc(g)},getAvailableCountOfMailFilterType:function(){var g=0;if(this.isPublic()){g++}if(this.isMobile()){g++}if(this.isPrivate()){g++}if(this.isEtc()){g++}return g},_getStatusFrom:function(i){var h=this._getElCheckBox(i);var g=h.attr("checked");return g},_getElCheckBox:function(h){var g=h.find("input[type=checkbox]");return g},onclickMailFilter:function(g,h){this.updateMailFilter();if(typeof this.setting.onchange=="function"){this.setting.onchange()}},__closure:c.__closure,__bind:c.__bind,banpei:null}});a.constructor()})(jQuery);(function(b){var e=neo.core.readyNamespace("neo.denbun.Address.UsersListPage.SelectedListPanel");if(!e){return}var c=neo.denbun;var d=c.Address;var a=neo.denbun.Address.UsersListPage.SelectedListPanel=new neo.core.Class({superClass:d.AddressSelectedListPanel,classProperties:{CLS_SECTION:"address_users-selected_list-section",CLS_SECTION_HOVERED:"address_users-section-hover",constructor:function(){}},properties:{_getContainerIdToTable:function(){return"address_users-selected_list-to-table-container"},_getContainerIdCcTable:function(){return"address_users-selected_list-cc-table-container"},_getContainerIdBccTable:function(){return"address_users-selected_list-bcc-table-container"},_getElContainerLow:function(){return b("#address_users-selected_list-container")},_getElListSectionsLow:function(){return b("."+a.CLS_SECTION)},_getElRemoveSelectedLow:function(){return b(".address_users-selected_list-remove_selected")},_getElAddLow:function(){return b(".address_users-selected_list-add")},_getClsSectionHover:function(){return a.CLS_SECTION_HOVERED},_getClsCurrentSection:function(){return"address_users-selected_list-section-current"},_getDroppableOptions:function(){var f=this.__call("_getDroppableOptions",arguments);f.scope=c.Address.DROPPABLE_SCOPE_USER;return f},_getTargetTypeOf:function(g){var h=g.closest("."+a.CLS_SECTION);var f=h.attr(d.AddressSelectedListPanel.DATA_NAME);return f},__closure:c.__closure,__bind:c.__bind,banpei:null}});a.constructor()})(jQuery);(function(b){var e=neo.core.readyNamespace("neo.denbun.Address.ViewPage");if(!e){return}var c=neo.denbun;var d=c.Address;var a=neo.denbun.Address.ViewPage=new neo.core.Class({superClass:c.Page,classProperties:{defaults:{Name:"",Kana:"",Mail:"",TelHand:"",skype:"",homeZip:"",homeCountry:"",homeState:"",homeCity:"",homeAddress:"",TelHome:"",TelOther:"",Zip:"",Country:"",State:"",City:"",Address:"",Company:"",CompanyKana:"",Tel1:"",CompanyFax:"",Post:"",Office:"",Dept1:"",Dept2:"",Tel2:"",TelFax:"",mailprivate:"",mailmobile:"",Birthday:"",memo:""},DATA_NAME:"data-name",constructor:function(){}},properties:{_ajaxGetData:null,_getAjaxGetData:function(){return this._ajaxGetData||this._initAjaxGetData()},_initAjaxGetData:function(){var f=this;var g={url:f._getUrlToGetData(),getSendData:this.__closure(f._getDataToGetData),onsuccess:this.__closure(this.onsuccessGetData)};var h=new neo.denbun.Ajax(g);h.initialize();return this._ajaxGetData=h},_elPageBody:null,_getElPageBody:function(){return this._elPageBody||this._initElPageBody()},_initElPageBody:function(){var f=this._getClsThisPage();return this._elPageBody=b("."+f+"."+c.Page.CLS_CENTER_ITEM+" ."+c.CLS_COM_CONTENT_BODY+":first")},_elViewItems:null,_getElViewItems:function(){return this._elViewItems||this._initElViewItems()},_initElViewItems:function(){var f=this._getElPageBody();return this._elViewItems=f.find(".address_view-view_item")},_id:null,_getId:function(){return this._id||this._initId()},_initId:function(){return this._id=c.getParameter("id")},_elTagLink:null,_getTagLink:function(){return this._elTagLink||this._initTagLink()},_initTagLink:function(){return this._elTagLink=b("#address-view-set_tag")},_ajaxSetAddrTag:null,_getAjaxSetAddrTag:function(){return this._ajaxSetAddrTag||this._initAjaxSetAddrTag()},_initAjaxSetAddrTag:function(){var f=this;var g={getSendData:this.__closure(f._getDataToSetAddrTag)};var h=new c.Ajax(g);h.initialize();return this._ajaxSetAddrTag=h},_dataToSetAddrTag:null,_getDataToSetAddrTag:function(){return this._dataToSetAddrTag},_setDataToSetAddrTag:function(f){return this._dataToSetAddrTag=f},__constructor:function(){},initialize:function(){this._hook();this._updateItemVisiblity()},_hook:function(){if(DENBUN_MODE_XNEO){var f=this._getTagLink();this.__bind(f,"click","SetTag")}},_clean:function(){c.Page.prototype._clean.apply(this,arguments);var f=this;setTimeout(function(){f._revertScrolling()},0);this._initId();this._cleanView();if(DENBUN_MODE_XNEO){var g=this._getTagLink();g.hide()}this._load();this._updateAddressType();this.updateMenuEnabled(true)},_revertScrolling:function(){var f=this._getElPageBody();f.scrollTop(0)},updateMenuEnabled:function(g){var f=this._getElToolbar();c.app.updateToolbarEnabledByLength(f,0);this._updateEditMenuEnable(f)},_updateEditMenuEnable:function(i){var g=c.CLS_DISABLED;var h=!this._isPrivate();var k=c.comSetting.hasAuthorityToCreateAddress();if(h&&!k){var j=this._getElMenuForEdit(i);var f=this._getElMenuForRemove(i);j.addClass(g);f.addClass(g)}},_isPrivate:function(){var f=this._getId();if(f&&f>0){return false}else{return true}},_getElMenuForEdit:function(f){var g=f.find(".address_menu-for_edit");return g},_getElMenuForRemove:function(f){var g=f.find(".address_menu-for_remove");return g},_cleanView:function(){var f=a.defaults;this._setValuesToView(f)},_initOnOpening:function(){this._hideLeft();this._hideRight()},_getElOwnItemsLow:function(){var f=this._getClsThisPage();return b("."+f)},_getClsThisPage:function(){return"page-address_view-item"},_load:function(){var f=this._getAjaxGetData();f.sendRequest()},_updateAddressType:function(){var g;var h=this._getId();if(h>0){g=c.getText("共有アドレス")}else{g=c.getText("個人アドレス")}var f=this._getElViewItemOf("AddressKind");f.text(g)},_updateItemVisiblity:function(){var g=c.getLang();var f=g==c.LANG_JA;var j=this._getElViewItemOf("Kana");var i=this._getElViewItemOf("CompanyKana");if(f){j.closest("tr").show();i.closest("tr").show()}else{j.closest("tr").hide();i.closest("tr").hide()}if(!DENBUN_MODE_XNEO){var n=this._getElViewItemOf("Birthday");var h=n.text();var l=c.getText(h);n.empty();n.append(l)}var m=c.comSetting.isAvailableSkype();var k=this._getElViewItemOf("skype");if(m){k.closest("tr").show()}else{k.closest("tr").hide()}},_getUrlToGetData:function(){return undefined},_getDataToGetData:function(){var f={cmd:"addrentry",id:this._getId()};return f},_setResponseToView:function(g){var f=c.parseFlatData(g);this._setValuesToView(f)},_setValuesToView:function(f){for(var g in f){var h=f[g];this._setValueToViewItem(g,h)}},_setValueToViewItem:function(g,h){var f=this._getElViewItemOf(g);switch(g){case"skype":this._setSkypeTo(f,h);break;case"Birthday":this._setBirthDayTo(f,h);break;case"memo":this._setMemoTo(f,h);break;case"tagcolor":if(DENBUN_MODE_XNEO){this._setTag(h);break}case"updtime":if(DENBUN_MODE_XNEO){f.text(desknets.dateTime.dispDateTime(h));if(this._isPrivate()){b(".address_view-item_updtime").show();b(".address_view-item_upduser").hide()}else{b(".address_view-item_updtime").hide();b(".address_view-item_upduser").show()}}break;default:if(DENBUN_MODE_XNEO){h=neo.core.escape(h);h=desknets.escapeSpace(h);f.html(h)}else{f.text(h)}}},_setSkypeTo:function(f,i){f.empty();if(i==""){return}var h=b("<a/>");var g="callto://"+i+"/";h.attr("href",g);h.text(i);f.append(h)},_setBirthDayTo:function(k,n){if(DENBUN_MODE_XNEO){var o=this._getElViewItemOf("Birthday");var i="";if(n&&n!=""){i=desknets.dateTime.formatDate("m",n)}o.text(i);return}var j="";var g="";var l="";if(n!=""){j=n.substring(0,4);g=n.substring(4,6);l=n.substring(6,8);if(DENBUN_MODE_XNEO){j=Number(j)+""}}var h=k.find("["+a.DATA_NAME+"=year]");var f=k.find("["+a.DATA_NAME+"=month]");var m=k.find("["+a.DATA_NAME+"=day]");h.text(j);f.text(g);m.text(l);if(DENBUN_MODE_XNEO){if(j==""&&g==""&&l==""){k.hide()}else{k.show()}}},_setMemoTo:function(f,j){f.empty();if(!j){return}var g=j.split(/\n/);for(var h=0;h<g.length;h++){if(h!=0){f.append(document.createElement("br"))}if(DENBUN_MODE_XNEO){var k=neo.core.escape(g[h]);k=desknets.escapeSpace(k);f.append(k)}else{f.append(document.createTextNode(g[h]))}}},_setTag:function(g){var f=this._getTagLink();c.setTagColorStatus(f,g);f.show()},back:function(){var f={};f[d.PARAM_INIT_PARAMETER]="false";c.openPage(c.PAGE_ADDRESS_LIST,f,false)},edit:function(){var f={id:this._getId()};c.openPage(c.PAGE_ADDRESS_EDIT,f)},remove:function(){var h=this._getId();var g=c.getText("削除してよろしいですか？");var f=this;c.confirm(g,{onok:function(){f.execRemoving(h)}})},execRemoving:function(i){var f=this;var g={getSendData:function(){var j={cmd:"addrdel",id:i};return j},onsuccess:function(){var j={};j[d.PARAM_CMD]=d.CMD_RELOAD;j[d.PARAM_INIT_PARAMETER]=d.INIT_PARAMETER_FALSE;c.openPage(c.PAGE_ADDRESS_LIST,j,false)}};var h=new c.Ajax(g);h.initialize();h.sendRequest()},_getElViewItemOf:function(g){var h=this._getElViewItems();var f=h.filter("["+a.DATA_NAME+"="+g+"]");return f},selectTag:function(h){this.__call("selectTag",arguments);var f=this._getId();var i=b(h.target);var g=i.attr("data-value");this._updateMailTag(f,g)},_updateMailTag:function(i,h){var g={cmd:"addrcmdsettag",id:i,tagcolor:h};this._setDataToSetAddrTag(g);var f=this._getAjaxSetAddrTag();f.sendRequest()},onsuccessGetData:function(g,f,h){this._setResponseToView(g)},onclickSetTag:function(h,i){var f=this._getTagLink();var g=c.getRect(f,true);var j={left:g.left,top:g.top+g.height};c.app.showMenu("com","select_tag",j)},__closure:c.__closure,__bind:c.__bind,banpei:null}});a.constructor()})(jQuery);(function(b){var e=neo.core.readyNamespace("neo.denbun.Address.EditPage");if(!e){return}var c=neo.denbun;var d=c.Address;var a=neo.denbun.Address.EditPage=new neo.core.Class({superClass:c.Page,classProperties:{defaults:{Name:"",Kana:"",Mail:"",TelHand:"",skype:"",homeZip:"",homeCountry:"",homeState:"",homeCity:"",homeAddress:"",TelHome:"",TelOther:"",Zip:"",Country:"",State:"",City:"",Address:"",Company:"",CompanyKana:"",Tel1:"",CompanyFax:"",Post:"",Office:"",Dept1:"",Dept2:"",Tel2:"",TelFax:"",mailprivate:"",mailmobile:"",Birthday:"",memo:""},FIELD_NAME_AREA:"area",DATA_NAME:"data-name",constructor:function(){}},properties:{_valueChanged:null,_isValueChanged:function(){return this._valueChanged},_initValueChanged:function(){return this._valueChanged=false},setValueChanged:function(){return this._valueChanged=true},_ajaxGetData:null,_getAjaxGetData:function(){return this._ajaxGetData||this._initAjaxGetData()},_initAjaxGetData:function(){var f=this;var g={url:f._getUrlToGetData(),getSendData:this.__closure(f._getDataToGetData),onsuccess:this.__closure(this.onsuccessGetData)};var h=new neo.denbun.Ajax(g);h.initialize();return this._ajaxGetData=h},_ajaxSetData:null,_getAjaxSetData:function(){return this._ajaxSetData||this._initAjaxSetData()},_initAjaxSetData:function(){var f=this;var g={url:f._getUrlToSetData(),type:"POST",getSendData:this.__closure(f._getDataToSetData),onsuccess:this.__closure(this.onsuccessSetData),onerror:this.__closure(this.onerrorSetData)};if(DENBUN_MODE_XNEO){g.errorconvmsg=this.__closure(this.onerrorConvMsg)}var h=new neo.denbun.Ajax(g);h.initialize();return this._ajaxSetData=h},_datepicker:null,_getDatepicker:function(){return this._datepicker||this._initDatepicker()},_initDatepicker:function(){var f={elDate:this._getElDate(),elInput:this._getElSelectDate(),elMonth:this._getElMonth(),elYear:this._getElYear(),uiSetting:{yearRange:"c-100:c+100",onSelect:this.__closure(this.onselectDatepicker)}};if(DENBUN_MODE_XNEO){f.uiSetting.minDate=new Date(100,0,1);f.uiSetting.maxDate=new Date(9999,11,31)}var g=new c.Datepicker(f);g.initialize();return this._datepicker=g},_elForm:null,_getElForm:function(){return this._elForm||this._initElForm()},_initElForm:function(){var f=this._getClsThisPage();return this._elForm=b("."+f+" .setting_form")},_elPageTitle:null,_getElPageTitle:function(){return this._elPageTitle||this._initElPageTitle()},_initElPageTitle:function(){var f=this._getClsThisPage();return this._elPageTitle=b("."+f+"."+c.Page.CLS_CENTER_ITEM+" ."+c.CLS_COM_CONTENT_TITLE+":first")},_elPageBody:null,_getElPageBody:function(){return this._elPageBody||this._initElPageBody()},_initElPageBody:function(){var f=this._getClsThisPage();return this._elPageBody=b("."+f+"."+c.Page.CLS_CENTER_ITEM+" ."+c.CLS_COM_CONTENT_BODY+":first")},_elOkButtonOfToolbar:null,_getElOkButtonOfToolbar:function(){return this._elOkButtonOfToolbar||this._initElOkButtonOfToolbar()},_initElOkButtonOfToolbar:function(){return this._elOkButtonOfToolbar=this.getElToolbarItemOf("ok")},_elRemoveButtonOfToolbar:null,_getElRemoveButtonOfToolbar:function(){return this._elRemoveButtonOfToolbar||this._initElRemoveButtonOfToolbar()},_initElRemoveButtonOfToolbar:function(){return this._elRemoveButtonOfToolbar=this.getElToolbarItemOf("remove")},_elSeparatorBeforeRemove:null,_getElSeparatorBeforeRemove:function(){return this._elSeparatorBeforeRemove||this._initElSeparatorBeforeRemove()},_initElSeparatorBeforeRemove:function(){var f=this._getElToolbar();var g=f.find("."+c.App.Menu.CLS_ITEM);return this._elSeparatorBeforeRemove=g.filter(".address_menu-separator_before_remove")},_elOk:null,_getElOk:function(){return this._elOk||this._initElOk()},_initElOk:function(){var f=this._getElForm();return this._elOk=f.find(".setting_form-ok")},_elCancel:null,_getElCancel:function(){return this._elCancel||this._initElCancel()},_initElCancel:function(){var f=this._getElForm();return this._elCancel=f.find(".setting_form-cancel")},_elRemove:null,_getElRemove:function(){return this._elRemove||this._initElRemove()},_initElRemove:function(){var f=this._getElForm();return this._elRemove=f.find(".setting_form-remove")},_elInputItem:null,_getElInputItem:function(){return this._elInputItem||this._initElInputItem()},_initElInputItem:function(){var f=this._getElForm();return this._elInputItem=f.find("input, textarea")},_elTelOne:null,_getElTelOne:function(){return this._elTelOne||this._initTelOne()},_initTelOne:function(){return this._elTelOne=this._getElInputOf("Tel1")},_elAddressTypeDataCell:null,_getElAddressTypeDataCell:function(){return this._elAddressTypeDataCell||this._initElAddressTypeDataCell()},_initElAddressTypeDataCell:function(){var f=this._getElForm();return this._elAddressTypeDataCell=f.find(".editor-address_type-data-cell")},_elSelectDate:null,_getElSelectDate:function(){return this._elSelectDate||this._initElSelectDate()},_initElSelectDate:function(){var f=this._getElForm();return this._elSelectDate=f.find(".edit_item-list_item-select_date")},_elYear:null,_getElYear:function(){return this._elYear||this._initElYear()},_initElYear:function(){var f=this._getElForm();return this._elYear=f.find(".edit_item-list_item[data-name=year]")},_elMonth:null,_getElMonth:function(){return this._elMonth||this._initElMonth()},_initElMonth:function(){var f=this._getElForm();return this._elMonth=f.find(".edit_item-list_item[data-name=month]")},_elDate:null,_getElDate:function(){return this._elDay||this._initElDate()},_initElDate:function(){var f=this._getElForm();return this._elDate=f.find(".edit_item-list_item[data-name=day]")},_elDlSkype:null,_getElDlSkype:function(){return this._elDlSkype||this._initElDlSkype()},_initElDlSkype:function(){var f=this._getElForm();return this._elDlSkype=f.find(".download_skype")},_elDlSkypeImage:null,_getElDlSkypeImage:function(){return this._elDlSkypeImage||this._initDlSkypeImage()},_initDlSkypeImage:function(){var f=this._getElForm();return this._elDlSkypeImage=f.find(".download_skype-image")},_id:null,_getId:function(){return this._id||this._initId()},_initId:function(){return this._id=c.getParameter("id")},_destination:null,_getDestination:function(){return this._destination||this._initDestination()},_initDestination:function(){return this._destination=c.getParameter("destination")},_backPage:null,_getBackPage:function(){return this._backPage||this._initBackPage()},_initBackPage:function(){return this._backPage=c.getParameter(c.PARAM_BACK_PAGE)},_elTagLink:null,_getTagLink:function(){return this._elTagLink||this._initTagLink()},_initTagLink:function(){return this._elTagLink=b("#address-edit-set_tag")},_elTagColor:null,_getElTagColor:function(){return this._elTagColor||this._initElTagColor()},_initElTagColor:function(){var f=this._getElForm();return this._elTagColor=f.find('input[name="tagcolor"]')},_elAddrTypeRadio:null,_getAddrTypeRadio:function(){return this._elAddrTypeRadio||this._initAddrTypeRadio()},_initAddrTypeRadio:function(){var f=this._getElForm();return this._elAddrTypeRadio=f.find('input[name="area"]')},_elAllUserCheckbox:null,_getAllUserCheckbox:function(){return this._elAllUserCheckbox||this._initAllUserCheckbox()},_initAllUserCheckbox:function(){var f=this._getElForm();return this._elAllUserCheckbox=f.find('input[name="everyone"]')},_elAddrAccessSelItemTemplate:null,_getElAddrAccessSelItemTemplate:function(){return this._elAddrAccessSelItemTemplate||this._initElAddrAccessSelItemTemplate()},_initElAddrAccessSelItemTemplate:function(){var f=this._getElForm();var g=c.CLS_TEMPLATE;var h=f.find(".co-selitem."+g).removeClass(g).remove();return this._elAddrAccessSelItemTemplate=h},__constructor:function(){},initialize:function(){this._updateItemVisiblity();if(DENBUN_MODE_XNEO){var f=this._getElForm().find(".address_edit-edit_item");desknets.htmlparts.setUpForm(f)}else{this._initDatepicker()}this._hook()},_hook:function(){var h;h=this._getElForm();this.__bind(h,"submit");h=this._getElOk();this.__bind(h,"click","Ok");h=this._getElCancel();this.__bind(h,"click","Cancel");h=this._getElRemove();this.__bind(h,"click","Remove");h=this._getElInputItem();this.__bind(h,"change","InputItem");h=this._getElTelOne();this.__bind(h,"change","TelOne");h=this._getElDlSkype();this.__bind(h,"click","DlSkype");if(DENBUN_MODE_XNEO){h=this._getTagLink();this.__bind(h,"click","SetTag");h=this._getAddrTypeRadio();this.__bind(h,"click","SetAddrType");h=this._getAllUserCheckbox();this.__bind(h,"click","SetAllUser");var g=this;var f=this._getElForm();f.find(".jaddr-accsel-button").click(function(i){i.preventDefault();desknets.chooser.open("jaddr-accsel-button",g._getSelDialogOptions())})}},_getSelDialogOptions:function(){var g=this;var f=this._getElForm();var h=desknets.chooser.getItemsFromElement(f.find(".jco-sel-items"));options={chooseTarget:["user","group"],allGroup:"readonly",unassignGroup:"readonly",editDescendant:false,choose:function(i){g._onSetSelect(i)},items:h};return options},_onSetSelect:function(o){var r;var s=this;var g="";var l="";var h="";var p="";var j=this._getElForm();var m=j.find(".jco-sel-items");var k=o.length;j.find(".co-selitem").remove();if(k>0){this._setAllUser(false)}else{this._setAllUser(true)}for(r=0;r<k;r++){var q=o[r];l=q.id;g=q.type.substring(0,1);h=g+l+"_1";var n='<span class="co-selitem"><span title="{{titlename}}">{{Name}}</span><input type="hidden" value="{{id}}" name="assignid"><input type="hidden" value="{{id}}_1" name="accesskind"><input type="hidden" value="{{condition}}" name="condition"><input type="hidden" class="jco-sel-item" data-id="{{id}}" data-name="{{Name}}" data-description="{{description}}" /></span>';if(g=="u"){p=desknets.escapeValue(desknets.escape(q.description))}else{p=q.description}var i=desknets.escapeValue(desknets.escape(q.name));var f="";if(g=="u"){f=i}else{if(DNNEO.neo.isSet(q.description,{blank:false})){f=q.description+"-"}f=f+i}i=desknets.escapeSpace(i);n=desknets.tmpl.replaceWordHtml(n,"Name",i);n=desknets.tmpl.replaceWordHtml(n,"titlename",f);n=desknets.tmpl.replaceWordHtml(n,"id",g+l);n=desknets.tmpl.replaceWordHtml(n,"condition",h);n=desknets.tmpl.replaceWordHtml(n,"description",p);m.append(n)}},_clean:function(){c.Page.prototype._clean.apply(this,arguments);var g=this;setTimeout(function(){g._revertScrolling()},0);this._initValueChanged();var f=this._getElForm();f[0].reset();if(DENBUN_MODE_XNEO){var h=this._getTagLink();h.hide();this._getElForm().find(".co-datepicker").val("").removeClass("ui-invalid-mismatch ui-invalid");this._getElInputOf("Birthday").val("")}this._load()},_revertScrolling:function(){var f=this._getElPageBody();f.scrollTop(0)},_initOnOpening:function(){this._hideLeft();this._hideRight()},_getElOwnItemsLow:function(){var f=this._getClsThisPage();return b("."+f)},_getClsThisPage:function(){return"page-address_edit-item"},_updateItemVisiblity:function(){var i=c.getLang();var h=i==c.LANG_JA;var l=this._getElInputOf("Kana");var k=this._getElInputOf("CompanyKana");if(h){l.closest("tr").show();k.closest("tr").show()}else{l.closest("tr").hide();k.closest("tr").hide()}if(!DENBUN_MODE_XNEO){var p=this._getElEditItemOf("Birthday");var j=p.text();var n=c.getText(j);p.empty();p.append(n);var o=c.comSetting.isAvailableSkype();var m=this._getElInputOf("skype");if(o){m.closest("tr").show()}else{m.closest("tr").hide()}var g=this._getElDlSkypeImage();var f=c.getText("_アドレス編集＞DlSkypeImage");g.css("background-image",'url("'+f+'")')}},_getUrlToGetData:function(){return undefined},_getDataToGetData:function(){var f={cmd:"addrentry",id:this._getId()};return f},_setPageTitle:function(g){var f=this._getElPageTitle();f.text(g)},_decide:function(){var f=this._validate();if(f.length>0){this._showValidationError(f)}else{var g=this._getAjaxSetData();g.sendRequest();this._disableOkButton();if(DENBUN_MODE_XNEO){this._disableRemoveButton()}}},_validate:function(){var g=[];if(this._validateNameIsNothing()){var j;if(DENBUN_MODE_XNEO){j=c.getText("基本情報")+desknets.merrMsgConnect}else{j=c.getText("基本情報：")}var h=c.getText("氏名");var i=c.getText("$$を入力してください。");f=neo.core.replace(i,j+h);g.push(f)}if(this._validateKanaIsNothing()){var j;if(DENBUN_MODE_XNEO){j=c.getText("基本情報")+desknets.merrMsgConnect}else{j=c.getText("基本情報：")}var h=c.getText("ふりがな");var i=c.getText("$$を入力してください。");f=neo.core.replace(i,j+h);g.push(f)}var f=this._getValidateMessageOfBirthday();if(f&&f.length>0){g.push(f)}return g},_validateNameIsNothing:function(){var f=this._getElInputOf("Name");var g=f.val();if(g.length<1){return true}return false},_validateKanaIsNothing:function(){var f=this._getElInputOf("Kana");var g=f.val();if(g.length<1){return true}return false},_getValidateMessageOfBirthday:function(){var f="";if(this._validateBirthdayIsInvalid()){var i;if(DENBUN_MODE_XNEO){i=c.getText("個人情報")+desknets.merrMsgConnect}else{i=c.getText("個人情報：")}var g=c.getText("生年月日");var h=c.getText("$$が不正です。");f=neo.core.replace(h,i+g);return f}if(!DENBUN_MODE_XNEO){if(this._validateBirthdayIsTooSmall()){var i=c.getText("個人情報：");var g=c.getText("生年月日");var h=c.getText("$$が小さすぎます。");f=neo.core.replace(h,i+g);return f}}return f},_validateBirthdayIsInvalid:function(){if(DENBUN_MODE_XNEO){return this._getElForm().find(".hasDatepicker").hasClass("ui-invalid")}var f=this._getElYear();var j=this._getElMonth();var l=this._getElDate();var i=f.val();var k=j.val();var g=l.val();if(i==""&&k==""&&g==""){return false}if(i==""||k==""||g==""){return true}var h=function(m){return m.search("[^0123456789]")>=0};if(h(i)||h(k)||h(g)){return true}i=Number(i);k=Number(k);g=Number(g);if(DENBUN_MODE_XNEO){if(i<0){return true}}else{if(i<1){return true}}if(k<1||k>12){return true}if(g<1){return true}switch(k){case 2:if(i%4==0&&i%100!=0||i%400==0){if(g>29){return true}}else{if(g>28){return true}}break;case 4:case 6:case 9:case 11:if(g>30){return true}break;default:if(g>31){return true}break}return false},_validateBirthdayIsTooSmall:function(){var f=this._getElYear();var g=f.val();if(g==""){return false}if(DENBUN_MODE_XNEO){if(g<0){return true}}else{if(g<100){return true}}return false},_showValidationError:function(g){var f="";if(g.length>0){f="- "+g.join("\n- ")}if(DENBUN_MODE_XNEO){f=f.replace(/(\r\n|\r|\n)/g,"<br />");neo.denbun.alert(f,null,null,true)}else{neo.denbun.alert(f)}},_getUrlToSetData:function(){return undefined},_getDataToSetData:function(){var k=this._getElForm();var r=k.serializeArray();var p={};for(var n=0;n<r.length;n++){p[r[n].name]=r[n].value}var g=k.find('input[type="checkbox"]');for(var n=0;n<g.length;n++){var o=g.eq(n);var j=o.attr("name");var s=(o.attr("checked")?"1":"0");p[j]=s}if(this._getId()){p.id=this._getId()}var l=this._getArea();p.area=l;var t=this._getBirthDay();p.Birthday=t;var u=c.comSetting.isAvailableSkype();if(!u){delete p.skype}if(DENBUN_MODE_XNEO){delete p.assignid;delete p.accesskind;delete p.condition;if(this._isPrivate||k.find('input[name="area"]').val()=="2"){var r=k.serializeArray();var f=[];var h=[];var q=[];var m=r.length;for(var n=0;n<m;n++){if(r[n].name=="assignid"){f.push(r[n].value)}else{if(r[n].name=="accesskind"){h.push(r[n].value)}else{if(r[n].name=="condition"){q.push(r[n].value)}}}}p.assignid=f;p.accesskind=h;p.condition=q}}return p},_getArea:function(){var f=this._getElInputOf(a.FIELD_NAME_AREA);var g=f.filter(":checked").val();return g},_getBirthDay:function(){if(DENBUN_MODE_XNEO){return this._getElInputOf("Birthday").val()}var f=this._getElYear();var k=this._getElMonth();var i=this._getElDate();var h=f.val();var l=k.val();var g=i.val();if(h==""&&l==""&&g==""){return""}var j=neo.core.getZeroFilled;var m=j(h,4)+j(l,2)+j(g,2);return m},_load:function(){this._initId();this._initDestination();this._initBackPage();this._setPageTitleToPage();this._setRemoveButtonVisibility();this._updateAddressType();if(this._getId()){this._disableOkButton();if(DENBUN_MODE_XNEO){this._disableRemoveButton()}var f=this._getAjaxGetData();f.sendRequest()}else{this._setDefaultsToForm();this._enableOkButton();if(DENBUN_MODE_XNEO){this._setTag(null);this._setDefaultAddrAccess()}}},_setPageTitleToPage:function(){var f="";if(this._getId()){f=neo.denbun.getText("アドレスの変更")}else{f=neo.denbun.getText("アドレスの登録")}this._setPageTitle(f)},_setRemoveButtonVisibility:function(){if(this._getId()){this._showRemoveButton()}else{this._hideRemoveButton()}},_updateAddressType:function(){var f=this._getElInputOf(a.FIELD_NAME_AREA);var h=this._getElAddressTypeDataCell();var k=this._canElAddressTypeBeUsed();var g=c.CLS_DISABLED;f.attr("disabled",!k);var i=this._isPrivate();var j=(i?1:2);f.filter('[value="'+j+'"]').attr("checked",true)},_isPrivate:function(){var f=this._getId();if(f&&f>0){return false}else{return true}},_canElAddressTypeBeUsed:function(){var f=this._isPrivate();var g=c.comSetting.hasAuthorityToCreateAddress();if(f&&g){return true}return false},_setDefaultsToForm:function(){var j=this._getDefaults();var f=this._getDestination();if(f&&f!=""){var i=c.getParsedMailToAddressAndName(f);var g=i.address;var h=i.name;if(g&&g!=""){j.Mail=g}if(h&&h!=""){j.Name=h}}this._setValuesToEditor(j)},_getDefaults:function(){var f={};var i=c.getLang();var j=i==c.LANG_JA;if(j){var h=c.getText("日本");f.homeCountry=h;f.Country=h}else{f.Kana="*****"}var g=b.extend({},a.defaults,f);return g},_setResponseToEditor:function(i){var h=c.parseFlatData(i);this._setValuesToEditor(h);if(DENBUN_MODE_XNEO){if(this._isPrivate()){this._setDefaultAddrAccess()}else{var f=b(i).children();this._setAddrAccessSelItemsToForm(f);var g=this._getElForm();g.find(".setting-address-edit-share_access").show()}}},_setValuesToEditor:function(f){for(var g in f){var h=f[g];this._setValueToEditor(g,h)}},_setValueToEditor:function(f,g){switch(f){case"Birthday":this._setBirthdayToEditor(f,g);break;case"tagcolor":if(DENBUN_MODE_XNEO){this._setTag(g);break}default:this._setValueToForm(f,g)}},_setBirthdayToEditor:function(f,n){if(DENBUN_MODE_XNEO){if(n&&n!=""){var j=desknets.dateTime.formatDate("m",n);this._getElInputOf("Birthday").val(n);this._getElForm().find(".hasDatepicker").val(j)}return}var k="";var h="";var l="";if(n!=""){var k=n.substring(0,4);var h=n.substring(4,6);var l=n.substring(6,8);if(DENBUN_MODE_XNEO){k=Number(k)+""}}var i=this._getElYear();var g=this._getElMonth();var m=this._getElDate();i.val(k);g.val(h);m.val(l)},_setValueToForm:function(g,i){var f=this._getElInputOf(g);var h=f.attr("type");switch(h){case"radio":f.filter('[value="'+i+'"]').attr("checked",true);break;case"checkbox":f.attr("checked",(i=="1"?true:false));break;default:f.val(i)}},_setTag:function(i){var f=this._getTagLink();var h=i;if(!h||h==""){h="0"}c.setTagColorStatus(f,h);var g=this._getElTagColor();g.val(h);f.show()},_setAddrAccessSelItemsToForm:function(g){var i=this;var k=this._getElAddrAccessSelItemTemplate();var h=this._getElForm();var j=h.find(".jco-sel-items");j.empty();var f=g.find("list > item");var l=[];if(f.children("id").text()=="r2"){this._setAllUser(true);this._setDefaultAddrAccess();return}else{this._setAllUser(false)}f.each(function(o,m){var p=b(m);var q={id:p.children("id").text(),name:p.children("Name").text(),accesskind:p.children("accesskind").text(),condition:p.children("condition").text(),titlename:p.children("titlename").text(),description:p.children("description").text(),item_value:p.children("item_value").text(),item_data:p.children("item_data").text(),item_title:p.children("item_title").text()};var n=k.clone();i._addAddrAccessSelItem(j,n,q)})},_setDefaultAddrAccess:function(){var i=this._getElAddrAccessSelItemTemplate();var g=this._getElForm();var h=g.find(".jco-sel-items");var f=i.clone();this._setDefaultAddrAccessSelItems(h,f);if(this._isPrivate()){g.find(".setting-address-edit-share_access").hide()}else{g.find(".setting-address-edit-share_access").show()}this._setAllUser(true)},_setDefaultAddrAccessSelItems:function(h,g){h.empty();var i=c.comSetting.getSysUserId();var f=c.comSetting.getUserName();var j={id:"u"+i,name:f,accesskind:"u"+i+"_1",condition:"u"+i+"_1",titlename:f,description:"",item_value:"u"+i+"_1",item_data:f,item_title:c.comSetting.getUserDispItemTitle()};this._addAddrAccessSelItem(h,g,j)},_addAddrAccessSelItem:function(i,h,j){var k;k=h.find(".selitem-name");k.attr("title",j.titlename);var g=neo.core.escape(j.name);g=desknets.escapeSpace(g);k.html(g);k=h.find('[name="assignid"]');k.val(j.id);k=h.find('[name="accesskind"]');k.val(j.accesskind);k=h.find('[name="condition"]');k.val(j.condition);var f='<input type="hidden" class="jco-sel-item" '+j.item_title+" />";k=b(f);k.attr("data-id",j.id);k.attr("data-name",j.name);h.append(k);k=h.find(".jaddr-acc-description");var g=j.description;if(j.id&&j.id.charAt(0)!="u"){g=desknets.escapeValue(desknets.escape(g))}k.html(g);i.append(h);return},_setAllUser:function(f){var g=this._getElForm();if(f){g.find(".jaddr-alluser").attr("checked","checked");g.find(".jaddr-accsel-button").attr("disabled",true);g.find(".co-selmulti-items-scroll").hide()}else{g.find(".jaddr-alluser").attr("checked",false);g.find(".jaddr-accsel-button").attr("disabled",false);g.find(".co-selmulti-items-scroll").show()}},onclickSelectPage:function(f){if(this._isValueChanged()){this._showDlgConfirm(f);return}f()},ok:function(){this._decide()},cancel:function(){if(this._getBackPage()){this._openToBackPage()}else{this._openToListPage()}},remove:function(){var h=this._getId();var g=c.getText("削除してよろしいですか？");var f=this;c.confirm(g,{onok:function(){f.execRemoving(h)}})},execRemoving:function(i){var f=this;var g={getSendData:function(){var j={cmd:"addrdel",id:i};return j},onsuccess:function(){f._reloadDirectTransitioToList()}};var h=new c.Ajax(g);h.initialize();h.sendRequest()},_getElInputOf:function(h){var g=this._getElForm();var f=g.find('[name="'+h+'"]');return f},_getElEditItemOf:function(h){var i=this._getElPageBody();var f=i.find(".address_edit-edit_item");var g=f.filter("["+a.DATA_NAME+"="+h+"]");return g},_showRemoveButton:function(){var g=this._getElRemove();g.show();var f=this._getElRemoveButtonOfToolbar();f.show();var h=this._getElSeparatorBeforeRemove();h.show()},_hideRemoveButton:function(){var g=this._getElRemove();g.hide();var f=this._getElRemoveButtonOfToolbar();f.hide();var h=this._getElSeparatorBeforeRemove();h.hide()},_enableOkButton:function(){if(DENBUN_MODE_XNEO){var h=this._isPrivate();var i=c.comSetting.hasAuthorityToCreateAddress();if(!h&&!i){this._disableOkButton();return}}var g=this._getElOk();g.attr("disabled",false);var f=this._getElOkButtonOfToolbar();f.removeClass(c.CLS_DISABLED)},_disableOkButton:function(){var g=this._getElOk();g.attr("disabled",true);var f=this._getElOkButtonOfToolbar();f.addClass(c.CLS_DISABLED)},_enableRemoveButton:function(){var h=this._isPrivate();var i=c.comSetting.hasAuthorityToCreateAddress();if(!h&&!i){this._disableRemoveButton();return}var g=this._getElRemove();g.attr("disabled",false);var f=this._getElRemoveButtonOfToolbar();f.toggleClass(c.CLS_DISABLED,false)},_disableRemoveButton:function(){var g=this._getElRemove();g.attr("disabled",true);var f=this._getElRemoveButtonOfToolbar();f.toggleClass(c.CLS_DISABLED,true)},_reloadDirectTransitioToList:function(j,f,k,g,l){var i={};i[d.PARAM_CMD]=d.CMD_RELOAD;if(j){i[d.PARAM_INDEX_NAME_OF_KANA]=j}if(f){i[d.PARAM_INDEX_NAME_OF_COMPANY_KANA]=f}if(k){i[d.PARAM_INDEX_NAME_OF_OLD_KANA]=k}if(g){i[d.PARAM_INDEX_NAME_OF_OLD_COMPANY_KANA]=g}if(l){var h=(l&&l>0)?2:1;i[d.PARAM_AREA]=h}i[d.PARAM_INIT_PARAMETER]=d.INIT_PARAMETER_FALSE;c.openPage(c.PAGE_ADDRESS_LIST,i,false)},_openToListPage:function(){var f={};f[d.PARAM_INIT_PARAMETER]=d.INIT_PARAMETER_FALSE;c.openPage(c.PAGE_ADDRESS_LIST,f,false)},_reloadDirectTransitionToBackPage:function(){c.app.updateAddressList();var f=this._getBackPage();c.openPage(f,{},false)},_openToBackPage:function(){var f=this._getBackPage();c.openPage(f,{},false)},_showDlgConfirm:function(i){var h=c.getText("キャンセルしますか？");var g={};var f=this;g.onok=function(){i()};c.confirm(h,g)},selectTag:function(h){this.__call("selectTag",arguments);var i=b(h.target);var g=i.attr("data-value");var f=this._getElTagColor();f.val(g)},onsuccessGetData:function(g,f,h){this._setResponseToEditor(g);this._enableOkButton();if(DENBUN_MODE_XNEO){this._enableRemoveButton()}},onsuccessSetData:function(i,h,j){if(this._getBackPage()){this._reloadDirectTransitionToBackPage()}else{var k=b(i).find("Kana").text();var f=b(i).find("CompanyKana").text();var l=b(i).find("oldKana").text();var g=b(i).find("oldCompanyKana").text();var m=b(i).find("id").text();this._reloadDirectTransitioToList(k,f,l,g,m)}},onerrorSetData:function(h,g,i){this._enableOkButton();if(DENBUN_MODE_XNEO){this._enableRemoveButton();var f=i.type;var g={onok:g.afterShowError};h=h.replace(/(\r\n|\r|\n)/g,"<br />");neo.denbun.alert(h,g,f,true);return false}},onerrorConvMsg:function(i){var h="";if(!!i&&!!i.errmsgadd&&i.errmsgadd!=""){var g="name";var f=this._getElForm().find("["+g+'="'+i.errmsgadd+'"]').closest("td").prev("th").find(".setting-item_name").eq(0).text();h=f+desknets.merrMsgConnect}return h},onsubmit:function(f,g){f.preventDefault()},onclickOk:function(f,g){this.ok()},onclickCancel:function(f,g){this.cancel()},onclickRemove:function(f,g){this.remove()},onchangeInputItem:function(f,g){this.setValueChanged()},onselectDatepicker:function(i,g,h){var f=this._getDatepicker();f.onselect(i,g,h);this.setValueChanged()},onchangeTelOne:function(g,i){var j=b(i);var h=j.val();var f=this._getElTelOne();f.val(h)},onclickDlSkype:function(g,h){g.preventDefault();var f=c.getText("_アドレス編集＞DlSkype");window.open(f)},onclickSetTag:function(h,i){var f=this._getTagLink();var g=c.getRect(f,true);var j={left:g.left,top:g.top+g.height};c.app.showMenu("com","select_tag",j)},onclickSetAddrType:function(g){var f=this._getElForm();var h=b(g.target).val();if(h=="1"){f.find(".setting-address-edit-share_access").hide()}else{f.find(".setting-address-edit-share_access").show()}},onclickSetAllUser:function(g){var f=this._getElForm();var h=b(g.target).attr("checked");if(h==true||h=="checked"){f.find(".jaddr-accsel-button").attr("disabled",true);f.find(".co-selmulti-items-scroll").hide()}else{f.find(".jaddr-accsel-button").attr("disabled",false);f.find(".co-selmulti-items-scroll").show()}},__closure:c.__closure,__bind:c.__bind,banpei:null}});a.constructor()})(jQuery);(function(b){var e=neo.core.readyNamespace("neo.denbun.Address.UserViewPage");if(!e){return}var c=neo.denbun;var d=c.Address;var a=neo.denbun.Address.UserViewPage=new neo.core.Class({superClass:c.Page,classProperties:{defaults:{Name:"",Kana:"",UserID:"",Mail:"",mailmobile:"",mailprivate:"",mailother:"",Group:"",assigngrp:"",Office:"",Dept1:"",Dept2:"",Post:"",Tel1:"",Naisen:"",TelFax:"",Tel2:"",TelHome:"",TelOther:"",TelHand:"",mobileid:"",skype:"",imgwidth:"",imgheight:"",attach:""},DATA_NAME:"data-name",constructor:function(){}},properties:{_ajaxGetData:null,_getAjaxGetData:function(){return this._ajaxGetData||this._initAjaxGetData()},_initAjaxGetData:function(){var f=this;var g={url:f._getUrlToGetData(),getSendData:this.__closure(f._getDataToGetData),onsuccess:this.__closure(this.onsuccessGetData)};var h=new neo.denbun.Ajax(g);h.initialize();return this._ajaxGetData=h},_elPageBody:null,_getElPageBody:function(){return this._elPageBody||this._initElPageBody()},_initElPageBody:function(){var f=this._getClsThisPage();return this._elPageBody=b("."+f+"."+c.Page.CLS_CENTER_ITEM+" ."+c.CLS_COM_CONTENT_BODY+":first")},_elViewItems:null,_getElViewItems:function(){return this._elViewItems||this._initElViewItems()},_initElViewItems:function(){var f=this._getElPageBody();return this._elViewItems=f.find(".user_view-view_item")},_elCategoryMailRow:null,_getElCategoryMailRow:function(){return this._elCategoryMailRow||this._initElCategoryMailRow()},_initElCategoryMailRow:function(){var f=this._getElPageBody();return this._elCategoryMailRow=f.find(".view-category-table-mail")},_elCategoryTelRow:null,_getElCategoryTelRow:function(){return this._elCategoryTelRow||this._initElCategoryTelRow()},_initElCategoryTelRow:function(){var f=this._getElPageBody();return this._elCategoryTelRow=f.find(".view-category-table-tel")},_elCategoryTelCorpRow:null,_getElCategoryTelCorpRow:function(){return this._elCategoryTelCorpRow||this._initElCategoryTelCorpRow()},_initElCategoryTelCorpRow:function(){var f=this._getElPageBody();return this._elCategoryTelCorpRow=f.find(".view-category-table-tel-corp")},_elCategoryTelPrivateRow:null,_getElCategoryTelPrivateRow:function(){return this._elCategoryTelPrivateRow||this._initElCategoryTelPrivateRow()},_initElCategoryTelPrivateRow:function(){var f=this._getElPageBody();return this._elCategoryTelPrivateRow=f.find(".view-category-table-tel-private")},_viewItemNameMap:null,_getViewItemNameMap:function(){return this._viewItemNameMap||this._initElViewItemNameMap()},_initElViewItemNameMap:function(){var k={};var j=this._getElViewItems();for(var h=0;h<j.length;h++){var f=j.eq(h);var g=f.attr(a.DATA_NAME);k[g]=true}return this._viewItemNameMap=k},_id:null,_getId:function(){return this._id||this._initId()},_initId:function(){return this._id=c.getParameter("id")},__constructor:function(){},initialize:function(){this._hook()},_hook:function(){},_clean:function(){c.Page.prototype._clean.apply(this,arguments);var f=this;setTimeout(function(){f._revertScrolling()},0);this._initId();this._cleanView();this._load()},_revertScrolling:function(){var f=this._getElPageBody();f.scrollTop(0)},_cleanView:function(){var f=a.defaults;this._setValuesToView(f)},_initOnOpening:function(){this._hideLeft();this._hideRight()},_getElOwnItemsLow:function(){var f=this._getClsThisPage();return b("."+f)},_getClsThisPage:function(){return"page-user_view-item"},_updateItemVisiblity:function(){var f=c.comSetting.isAvailableSkype();var g=this._getElViewItemOf("skype");if(f){g.closest("tr").show()}else{g.closest("tr").hide()}},_load:function(){var f=this._getAjaxGetData();f.sendRequest()},_getUrlToGetData:function(){return c.getUrl(c.CGI_USET)},_getDataToGetData:function(){var f={cmd:"usetuserinfo",id:this._getId()};return f},_setResponseToView:function(j){var h=c.parseFlatData(j);if(!DENBUN_MODE_XNEO||h.assigngrp){var g=b(j);var f=g.find("assigngrp");h.assigngrp=[];var l=f.children();for(var k=0;k<l.length;k++){var m=l.eq(k);h.assigngrp.push(m.text())}}this._setValuesToView(h)},_setValuesToView:function(f){this._updateItemVisiblityByValues(f);for(var g in f){var h=f[g];this._setValueToViewItem(g,h)}if(!DENBUN_MODE_XNEO){this._updateLoginIdVisibility(f)}},_updateItemVisiblityByValues:function(g){var r=this._getViewItemNameMap();for(var y in r){r[y]=false}for(var y in g){r[y]=true}for(var y in r){var h=r[y];var v=this._getElViewItemOf(y);var m=v.closest("tr");if(DENBUN_MODE_XNEO){switch(y){case"Name":case"Kana":case"attach":continue}}else{switch(y){case"Name":case"Kana":case"attach":case"Tel1":case"Naisen":case"skype":continue}}if(h){m.show()}else{m.hide();v.text("")}}if(!DENBUN_MODE_XNEO){var v=this._getElViewItemOf("Tel1");var m=v.closest("tr");if(r.Tel1==false&&r.Naisen==false){m.hide()}else{m.show()}v.text("");var v=this._getElViewItemOf("Naisen");v.text("")}var j=this._getElCategoryMailRow();if(r.Mail==false&&r.mailmobile==false&&r.mailprivate==false&&r.mailother==false){j.hide()}else{j.show()}if(DENBUN_MODE_XNEO){var f=["Tel1","Tel2","Naisen","TelHand","TelFax"];var w=false;for(var u=0;u<f.length;u++){if(r[f[u]]==true){w=true;break}}var s=this._getElCategoryTelCorpRow();if(w){s.show()}else{s.hide()}var x=["TelHome","TelOther"];var l=false;for(var u=0;u<x.length;u++){if(r[x[u]]==true){l=true;break}}var k=this._getElCategoryTelPrivateRow();if(l){k.show()}else{k.hide()}}else{var o=["Tel1","Naisen","Tel2","TelFax","TelHome","TelOther","TelHand","mobileid",];var n=false;for(var u=0;u<o.length;u++){if(r[o[u]]==true){n=true;break}}var q=c.comSetting.isAvailableSkype();var t=this._getElViewItemOf("skype");if(q&&r.skype==true){n=true;t.closest("tr").show()}else{t.closest("tr").hide();t.empty()}var p=this._getElCategoryTelRow();if(n){p.show()}else{p.hide()}}},_setValueToViewItem:function(g,h){var f=this._getElViewItemOf(g);switch(g){case"attach":this._setAttachTo(f,h);break;case"Kana":this._setKanaTo(f,h);break;case"assigngrp":this._setAssginGroupsTo(f,h);break;case"Naisen":this._setNaisenTo(f,h);break;case"skype":this._setSkypeTo(f,h);break;default:if(DENBUN_MODE_XNEO){switch(g){case"level":this._setUserLevel(f,h);break;case"gender":this._setGenderTo(f,h);break;case"birthday":this._setBirthdayTo(f,h);break;case"address":this._setAddressTo(f,h);break;default:h=neo.core.escape(h);h=desknets.escapeSpace(h);f.html(h)}break}f.text(h)}},_setAttachTo:function(f,h){f.empty();if(h!=""){var g=b("<img/>");g.attr("class","co-prof-img");var i;if(h.indexOf("/")==0){i=h}else{if(DENBUN_MODE_XNEO){i=c.getUrl(c.CGI_ZREFER)+"?cmd=refuser&"+h}else{i="./"+c.getUrl(c.CGI_REFER)+"?cmd=referdownload&"+h}}g.attr("src",i);f.append(g)}},_setKanaTo:function(f,g){f.empty();var h=c.getLang();var i=h==c.LANG_JA;if(!i){return}if(g!=""){if(DENBUN_MODE_XNEO){g=neo.core.escape(g);g=desknets.escapeSpace(g);f.html("("+g+")")}else{f.text("("+g+")")}}},_setAssginGroupsTo:function(f,g){f.empty();if(!g||g.length<1){return}var h=g.join(", ");if(DENBUN_MODE_XNEO){h=neo.core.escape(h);h=desknets.escapeSpace(h);f.html(h)}else{f.text(h)}},_setNaisenTo:function(f,h){if(DENBUN_MODE_XNEO){h=neo.core.escape(h);h=desknets.escapeSpace(h);f.html(h);return}f.empty();if(!h||h==""){return}var g=c.getText("内線");var i="("+g+":"+h+")";f.text(i)},_setSkypeTo:function(f,i){f.empty();if(!i||i==""){return}var h=b("<a/>");var g="callto://"+i+"/";h.attr("href",g);h.text(i);f.append(h)},_setUserLevel:function(f,g){f.empty();if(!g||g.length<1){return}var h="";if(g=="1"){h=c.getText("システム管理者")}else{h=c.getText("一般ユーザー")}f.text(h)},_setGenderTo:function(f,g){f.empty();if(!g||g.length<1){return}var h="";if(g=="o"){h=c.getText("その他")}else{if(g=="m"){h=c.getText("男性")}else{if(g=="f"){h=c.getText("女性")}}}f.text(h)},_setBirthdayTo:function(f,g){f.empty();if(!g||g.length<1){return}var h=desknets.dateTime.dispDateTime(g,"longMDFormatBirthday");f.text(h)},_setAddressTo:function(f,j){f.empty();if(!j||j.length<1){return}var g=j.split(/\n/);for(var h=0;h<g.length;h++){if(h!=0){f.append(document.createElement("br"))}var k=neo.core.escape(g[h]);k=desknets.escapeSpace(k);f.append(k)}},_updateLoginIdVisibility:function(g){var i=(g.UserID?true:false);var f=this._getElViewItemOf("UserID");var h=f.closest("tr");if(i){h.show()}else{h.hide()}},back:function(){var f={};f[d.PARAM_INIT_PARAMETER]="false";c.openPage(c.PAGE_ADDRESS_USERS_LIST,f,false)},_getElViewItemOf:function(g){var h=this._getElViewItems();var f=h.filter("["+a.DATA_NAME+"="+g+"]");return f},onsuccessGetData:function(g,f,h){this._setResponseToView(g)},__closure:c.__closure,__bind:c.__bind,banpei:null}});a.constructor()})(jQuery);