/*
 * desknet's NEO
 * https://www.desknets.com/
 * Copyright (C)2012-2016 NEOJAPAN Inc. All Rights Reserved.
 * 本製品は日本国著作権法および国際条約により保護されています。 
 * 本製品の全部または一部を無断で複製したり、無断で複製物を頒 
 * 布すると著作権の侵害となりますのでご注意ください。 
 */
desknets.cal={SEL_DAY:".cal-day",SEL_WEEK_BTN:".cal-weeklink",CLASS_SUNDAY:"co-sunday",CLASS_SATURDAY:"co-saturday",CLASS_OTHER_MONTH:"cal-other-month",CGI_SCH:"",CGI_SCH_REST:"",CGI_TODO:"",CGI_TODO_REST:"",CGI_AGENDA:"zagenda",PAGE_SCH_INDEX:"schindex",PAGE_SCH_REF:"schreferdtl",PAGE_SCH_ADD:"schadd",CMD_SCH_REF:"schref",CMD_SCH_DEL:"schdel",PAGE_PLANT_INDEX:"plantweekgrp",PAGE_PLANT_REF:"plantreferdtl",PAGE_PLANT_ADD:"plantadd",CMD_PLANT_REF:"schref",CMD_PLANT_DEL:"schdel",PAGE_TODO_INDEX:"todolist",PAGE_TODO_REF:"todotaskref",CMD_TODO_REF:"todocmdtaskref",CMD_TODO_COMPLETE:"todocmdtaskcomplete",PAGE_AGNEDA_REF:"agendarefer",PAGE_AGENDA_INDEX:"agendaindex",MAX_POP_MEMOCOL:"44",MAX_POP_MEMOROW:"5",REPEAT_RANDOM:"r",PUBLIC_LEVEL_OPEN:"open",PUBLIC_LEVEL_SECRET:"secret",PUBLIC_LEVEL_PERMIT:"permission",init:function(){this.CGI_SCH=desknets.getUrl(desknets.MODULE_MAIN);this.CGI_SCH_REST=desknets.getUrl(desknets.MODULE_API_MAIN);this.CGI_TODO=this.CGI_SCH;this.CGI_TODO_REST=this.CGI_SCH_REST;desknets.cal.tmpl.init();desknets.cal.holiday.init();desknets.cal.refPopUp.init()},updateCmds:function(a){for(var b in a){if(typeof desknets.cal[b]=="string"){desknets.cal[b]=a[b]}}},getSubject:function(a,b){if(!DNNEO.neo.isSet(a)||a=="--"){a=""}if(!DNNEO.neo.isSet(b)){b=""}return[a,b].join((a!=""&&b!="")?" : ":"")},setToDraggableScrollView:function(b,a){var c=$.extend({start:function(d){$(this).data("dragging",true)},stop:function(d){var e=$(this);setTimeout(function(){e.data("dragging",false)},0)}},a);b.bind("beforeSelect.cal",function(d){if($(this).data("dragging")){d.preventDefault()}});b.bind(desknets.EVENT_SCROLL,function(){desknets.cal.refPopUp.close()});b.dndscroll(c)}};desknets.cal.tmplRef={ALARM_USE:"1",ALARM_NONUSE:"0",APPRVSTS_COMPLETE:"1",APPRVSTS_REQ:"2",APPRVSTS_APPROV:"3",dispSchColor:function(b){var c=(Number(b)-1)%10+1;var a=desknets.Resource.cal["color_"+c];if(!a){a=desknets.Resource.cal.color_1}return a},dispIcon:function(c){var a;var b={};b.iconno=c.iconno;b.agnasts=c.agnasts;b.approvsts=c.approvsts;var d=desknets.cal.item.getItemFromSch(b);a=desknets.cal.tmpl.getIconsAsHtml(d);return a},_getOptionIcon:function(b){var a={};a.outflg=b.outflg;a.reserve=b.reserve;a.rankflg=b.rankflg;a.flag=b.flag;a.level=b.level;return a},dispOptionIcon:function(c){var a;var b;var d;b=this._getOptionIcon(c);d=desknets.cal.item.getItemFromSch(b);a=desknets.cal.tmpl.getIconsAsHtml(d);return a},dispOptionName:function(c){var a;var b;var d;b=this._getOptionIcon(c);d=desknets.cal.item.getItemFromSch(b);a=desknets.cal.tmpl.getIconsAsName(d);return a},dispAlarm:function(c,b){var a;if(c!=desknets.cal.tmplRef.ALARM_USE){return desknets.Resource.cal.alarmNothign}else{if(b<60){a=desknets.Resource.cal.alarmMin}else{if(b<24*60){b=b/60;a=desknets.Resource.cal.alarmHour}else{b=b/60/24;a=desknets.Resource.cal.alarmDay}}}a=desknets.tmpl.replaceWordHtml(a,"time",b);return a},dispEvent:function(c,b){var a=desknets.cal.getSubject(c,b);return desknets.tmpl.dispStr(a)},dispOtherTo:function(f,b,e){var c=desknets.tmpl.dispItems(f,e);var a=desknets.tmpl.dispItems(b);var d="&nbsp;";if(c==d&&a==d){return d}else{if(c==d){return a}else{if(a==d){return c}else{return c+",\n"+a}}}},_dispTime:function(c,a){var b;a=desknets.Resource[a];if(c.substr(0,2)=="24"){if(a.indexOf("k")>=0){c="23"+c.substr(2,2)}}b=DNNEO.neo.dateTime.parse("20101231"+c);return DNNEO.neo.dateTime.format(a,b)},dispTimeShort:function(b){var a;if(!DNNEO.neo.isSet(b,{blank:false})){return"&nbsp;"}if(b.substr(0,2)=="24"){a="shortSchTimeFormat24"}else{a="shortTimeFormat"}return this._dispTime(b,a)},dispTimeLong:function(b){var a;if(!DNNEO.neo.isSet(b,{blank:false})){return"&nbsp;"}if(b.substr(0,2)=="24"){a="longSchTimeFormat24"}else{a="timeFormat"}return this._dispTime(b,a)},dispRepDate:function(e,b,a){var c="";e=desknets.ajax.getItems(e.item);for(var d=0;d<e.length;d++){c+=desknets.dateTime.dispDateTime(e[d].val,a);if(d!=e.length-1){if(d!=0&&(d+1)%b==0){c+="\r\n"}else{c+=", "}}}return desknets.tmpl.dispStr(c)},isApprovOrNormal:function(b,a){if(!DNNEO.neo.isSet(b,{blank:false})&&!DNNEO.neo.isSet(a,{blank:false})){return true}if(b==desknets.cal.tmplRef.APPRVSTS_COMPLETE||b==desknets.cal.tmplRef.APPRVSTS_REQ){return true}return false}};