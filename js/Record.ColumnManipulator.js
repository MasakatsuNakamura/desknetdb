(function(g){var j=neo.core.readyNamespace("neo.webdb.Record.ColumnManipulator");if(!j){return}var s="（未選択）";var e=neo.webdb.Record.ColumnManipulator.InputType={DATETIME_TEXT_Y:"0",DATETIME_TEXT_YM:"1",DATETIME_TEXT_YMD:"2",DATETIME_TEXT_YMDHI:"3",DATETIME_TEXT_YMDHIS:"4",TIMESPAN_D:"0",TIMESPAN_DH:"1",TIMESPAN_DHI:"2",TIMESPAN_DHIS:"3",TIMESPAN_H:"4",TIMESPAN_HI:"5",TIMESPAN_HIS:"6",TIMESPAN_I:"7",TIMESPAN_IS:"8",TIMESPAN_S:"9"};var t=neo.webdb.Record.ColumnManipulator=new neo.core.Class({classProperties:{defaultSetting:{}},properties:{setting:null,__constructor:function(v){this.setting=v||{}},initialize:function(){this._initSetting()},_initSetting:function(){var v=this._getDefaultSetting();this.setting=g.extend({},v,this.setting)},_getDefaultSetting:function(){return g.extend({},t.defaultSetting)},_elColumn:null,_getElColumn:function(){return this._elColumn},_setElColumn:function(v){this._elColumn=v},getColumnMap:function(w){var x=w.find('[name="send_value-on_submit"]');if(x.val()!="true"){return null}var v=this._getColumnMap(w);v.column_id=w.attr("data-id");return v},_getColumnMap:function(w){var v={};return v},setColumnMap:function(w,v){w.attr("data-id",v.column_id);this._setColumnMap(w,v);return v},updateColumnMap:function(v){var w=this._getElColumn();if(!w){return}this._setColumnMap(w,v)},_setColumnMap:function(w,v){},_setTmpnm:function(v){if(this.setting.callbackOnSetTmpnm){this.setting.callbackOnSetTmpnm(v)}},_getTmpnm:function(){if(!this.setting.callbackOnGetTmpnm){throw new Error("neo.webdb.Record.ColumnManipulator._getTmpnm : The callbackOnGetTmpnm is required.")}return this.setting.callbackOnGetTmpnm()},_adjustImageColumnSize:function(){if(this.setting.callbackOnAdjustImgColumn){this.setting.callbackOnAdjustImgColumn()}},hookColumn:function(w,v){this._setElColumn(w);this._hookColumn(w,v)},_hookColumn:function(w,v){},cleanColumn:function(){this._cleanColumn()},_cleanColumn:function(){},setColumnId:function(w,v){w.attr("data-id",v)},banpei:null}});var k=neo.webdb.Record.KeyColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElKey:function(v){return v.find('[name="key"]')},getColumnMap:function(v){return null},_setColumnMap:function(x,v){var w;w=this._findElKey(x);w.text(v.key)}}});var c=neo.webdb.Record.TextColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElText:function(v){return v.find('[name="text-text"]')},_getColumnMap:function(x){var v={};var w;w=this._findElText(x);v.text=w.val();return v},_setColumnMap:function(x,v){var w;w=this._findElText(x);w.val(v.text)}}});var l=neo.webdb.Record.TextsColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElTexts:function(v){return v.find('[name="texts-texts"]')},_getColumnMap:function(x){var v={};var w;w=this._findElTexts(x);v.texts=w.val();return v},_setColumnMap:function(x,v){var w;w=this._findElTexts(x);w.val(v.texts)}}});var m=neo.webdb.Record.NumberColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElNum:function(v){return v.find('[name="number-num"]')},_getColumnMap:function(x){var v={};var w;w=this._findElNum(x);v.number=w.val();return v},_setColumnMap:function(x,v){var w;w=this._findElNum(x);w.val(v.num)}}});var o=neo.webdb.Record.DatetimeColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElDateTimeText:function(v){return v.find('[name="datetime-value"]')},_findElYear:function(v){return v.find('[name="datetime-year"]')},_findElMonth:function(v){return v.find('[name="datetime-month"]')},_findElDay:function(v){return v.find('[name="datetime-day"]')},_findElHour:function(v){return v.find('[name="datetime-hour"]')},_findElMinute:function(v){return v.find('[name="datetime-minute"]')},_findElSecond:function(v){return v.find('[name="datetime-second"]')},_getColumnMap:function(x){var v={};var w;w=this._findElDateTimeText(x);if(w.length){v.text=w.val()}else{v.datetime="";w=this._findElYear(x);v.year=w.val();w=this._findElMonth(x);v.month=w.val();w=this._findElDay(x);v.day=w.val();w=this._findElHour(x);v.hour=w.val();w=this._findElMinute(x);v.minute=w.val();w=this._findElSecond(x);v.second=w.val()}return v},_setColumnMap:function(z,v){var y;y=this._findElDateTimeText(z);if(y.length){var x=this.setting.column.inputformat;var A=v.text;if(v.year&&v.year.length&&!v.ismod){var w=new Date(v.year,v.month-1,v.day,v.hour,v.minute,v.second);A=this._buildDateText(x,w);v.ismod="1"}y.val(A)}else{y=this._findElYear(z);y.val(v.year);y=this._findElMonth(z);if(y.is("select")){y.val(parseInt(v.month,10))}else{y.val(v.month)}y=this._findElDay(z);if(y.is("select")){y.val(parseInt(v.day,10))}else{y.val(v.day)}y=this._findElHour(z);y.val(v.hour);y=this._findElMinute(z);y.val(v.minute);y=this._findElSecond(z);y.val(v.second)}},_hookColumn:function(x){var w;w=x.find('[name="datetime-now"]');var v=this;w.click(function(){v.setNow(x)})},setNow:function(z){var x=this._findElDateTimeText(z);var w=new Date();var A;var y=neo.core.buildDateByFormat;if(x.length){var v=this.setting.column.inputformat;var B=this._buildDateText(v,w);x.val(B)}else{x=this._findElYear(z);if(x.length){A="$YYYY$";var B=y(w,A);x.val(B)}x=this._findElMonth(z);if(x.length){A="$month$";var B=y(w,A);if(x.is("select")){B=parseInt(B,10)}x.val(B)}x=this._findElDay(z);if(x.length){A="$DD$";var B=y(w,A);if(x.is("select")){B=parseInt(B,10)}x.val(B)}x=this._findElHour(z);if(x.length){A="$hh$";var B=y(w,A);x.val(B)}x=this._findElMinute(z);if(x.length){A="$mm$";var B=y(w,A);x.val(B)}x=this._findElSecond(z);if(x.length){A="$ss$";var B=y(w,A);x.val(B)}}},_buildDateText:function(w,v){var x;if(w==e.DATETIME_TEXT_Y){x="$YYYY$"}else{if(w==e.DATETIME_TEXT_YM){x="$YYYY$/$month$"}else{if(w==e.DATETIME_TEXT_YMD){x="$YYYY$/$month$/$DD$"}else{if(w==e.DATETIME_TEXT_YMDHI){x="$YYYY$/$month$/$DD$ $hh$:$mm$"}else{if(w==e.DATETIME_TEXT_YMDHIS){x="$YYYY$/$month$/$DD$ $hh$:$mm$:$ss$"}}}}}return neo.core.buildDateByFormat(v,x)}}});var h=neo.webdb.Record.MailColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElMailAddress:function(v){return v.find('[name="mail-mail_address"]')},_getColumnMap:function(x){var v={};var w;w=this._findElMailAddress(x);v.mail=w.val();return v},_setColumnMap:function(x,v){var w;w=this._findElMailAddress(x);w.val(v.mail)}}});var r=neo.webdb.Record.UrlColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElUrl:function(v){return v.find('[name="url-url"]')},_findElUrlDispName:function(v){return v.find('[name="url-url_disp_name"]')},_getColumnMap:function(x){var v={};var w;w=this._findElUrl(x);v.url=w.val();w=this._findElUrlDispName(x);v.url_disp_name=w.val();return v},_setColumnMap:function(x,v){var w;w=this._findElUrl(x);w.val(v.url);w=this._findElUrlDispName(x);w.val(v.url_disp_name)}}});var a=neo.webdb.Record.TimeSpanColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElDay:function(v){return v.find('[name="timespan-day"]')},_findElHour:function(v){return v.find('[name="timespan-hour"]')},_findElMinute:function(v){return v.find('[name="timespan-minute"]')},_findElSecond:function(v){return v.find('[name="timespan-second"]')},_getColumnMap:function(x){var v={};var w;w=this._findElDay(x);v.timespan_day=w.val();w=this._findElHour(x);v.timespan_hour=w.val();w=this._findElMinute(x);v.timespan_minute=w.val();w=this._findElSecond(x);v.timespan_second=w.val();return v},_setColumnMap:function(y,v){var x;var w=this.setting.column.format;var z={day:(v.timespan_day?v.timespan_day:""),hour:(v.timespan_hour?valuestimespan_hour:""),minute:(v.timespan_minute?v.timespan_minute:""),second:(v.timespan_second?v.timespan_second:"")};if(v.totalsecond){z=this._parseTimeSpanByInputFormat(w,v.totalsecond);delete v.totalsecond}x=this._findElDay(y);x.val(z.day);x=this._findElHour(y);x.val(z.hour);x=this._findElMinute(y);x.val(z.minute);x=this._findElSecond(y);x.val(z.second)},_parseTimeSpanByInputFormat:function(z,B){var A={day:"",hour:"",minute:"",second:""};var v={day:"",hour:"",minute:"",second:""};var x="1";if(z==e.TIMESPAN_D){v.day=x}else{if(z==e.TIMESPAN_DH){v.day=x;v.hour=x}else{if(z==e.TIMESPAN_DHI){v.day=x;v.hour=x;v.minute=x}else{if(z==e.TIMESPAN_DHIS){v.day=x;v.hour=x;v.minute=x;v.second=x}else{if(z==e.TIMESPAN_H){v.hour=x}else{if(z==e.TIMESPAN_HI){v.hour=x;v.minute=x}else{if(z==e.TIMESPAN_HIS){v.hour=x;v.minute=x;v.second=x}else{if(z==e.TIMESPAN_I){v.minute=x}else{if(z==e.TIMESPAN_IS){v.minute=x;v.second=x}else{if(z==e.TIMESPAN_S){v.second=x}}}}}}}}}}var y=(B<0?Math.ceil:Math.floor);var C={day:y(B/(60*60*24))};var w=B-(C.day*(60*60*24));C.hour=y(w/(60*60));w=w-(C.hour*(60*60));C.minute=y(w/60);w=w-(C.minute*60);C.second=w;if(v.day==x){A.day=C.day}if(v.hour==x){if(v.day!=x){A.hour=C.hour+(C.day*24)}else{A.hour=C.hour}}if(v.minute==x){if(v.hour!=x){A.minute=C.minute+(C.day*(24*60))+(C.hour*60)}else{A.minute=C.minute}}if(v.second==x){if(v.minute!=x){A.second=B}else{A.second=C.second}}return A}}});var i=neo.webdb.Record.SelectColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElCheckedSelect:function(w){var v;v=w.find('[name="select-select"]');if(v.length){return v}v=w.find('[name="select-radio"]:checked');return v},_getColumnMap:function(x){var v={};var w;v.select="";w=this._findElCheckedSelect(x);v.select=w.val();return v},_setColumnMap:function(y,v){var x;x=y.find('[name="select-select"]');if(x.length){x.val(v.select)}else{x=y.find('[name="select-radio"]');for(var w=0;w<x.length;w++){if(x.eq(w).val()==v.select){x.eq(w).attr("checked",true)}else{x.eq(w).attr("checked",false)}}}}}});var f=neo.webdb.Record.SelectsColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElSelects:function(v){return v.find('[name="selects-checkbox"]')},_findElCheckedSelects:function(v){return v.find('[name="selects-checkbox"]:checked')},_getColumnMap:function(y){var v={};v.selects="";var x;x=this._findElCheckedSelects(y);for(var w=0;w<x.length;w++){var z=x.eq(w).val();if(w==0){v.selects=z}else{v.selects+="\n"+z}}return v},_setColumnMap:function(z,v){var B=v.selects.split("\n");var y;y=this._findElSelects(z);for(var x=0;x<y.length;x++){var A=y.eq(x).val();y.eq(x).attr("checked",false);for(var w=0;w<B.length;w++){if(A==B[w]){y.eq(x).attr("checked",true);break}}}}}});var u=neo.webdb.Record.SelectsForMassUpdateColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElSelectsValue:function(v){return v.find('[name="selects-select_value"]')},_findElSelectsType:function(v){return v.find('[name="selects-select_type"]')},_getColumnMap:function(x){var v={};var w;v.selects="";v.opttype="";w=this._findElSelectsValue(x);v.selects=w.val();w=this._findElSelectsType(x);v.opttype=w.val();return v},_setColumnMap:function(x,v){var w;w=this._findElSelectsValue(x);if(w.length){w.val(v.selects)}w=this._findElSelectsType(x);if(w.length){w.val(v.opttype)}}}});var q=neo.webdb.Record.UserColumnManipulator=new neo.core.Class({superClass:t,properties:{_findElUserId:function(v){return v.find('[name="user-userid"]')},_findElUserName:function(v){return v.find('[name="user-username"]')},_userSelectDialog:null,_getColumnMap:function(x){var v={};var w;v.select="";w=this._findElUserId(x);v.userid=w.val();w=this._findElUserName(x);v.username=w.text();if(w.text()==s){v.username=""}return v},_setColumnMap:function(x,v){var w;w=this._findElUserId(x);w.val(v.userid);w=this._findElUserName(x);w.text(v.username);this.refreshSelectedUsers()},_hookColumn:function(A){var w=A.find('[name="user-select_btn"]');if(w.length<=0){return}var v=this;var y=this._findElUserId(A);var z=this._findElUserName(A);var x={single:true,selectedUsers:v.getSelectedUsers(),selectedUserSearchByName:true,callbackOnChange:function(B){var C=B[0];if(C){y.val(C.id);z.text(C.name)}else{y.val("");z.text(s)}}};this._userSelectDialog=neo.webdb.bindUserSelectDialog(w,x)},getSelectedUsers:function(){var w=this._getElColumn();var v=this._findElUserName(w);var x=[{id:"",name:v.text()}];return x},refreshSelectedUsers:function(){if(this._userSelectDialog){this._userSelectDialog.setSelectedUsers(this.getSelectedUsers())}}}});var n=neo.webdb.Record.UsersColumnManipulator=new neo.core.Class({superClass:t,properties:{_getColumnMap:function(w){var v={};v.select="";return v},_hookColumn:function(v){}}});var d=neo.webdb.Record.FileColumnManipulator=new neo.core.Class({superClass:t,classProperties:{_lastTargetCount:0,getNextTargetCount:function(){return ++d._lastTargetCount}},properties:{_getColumnMap:function(x){var v={};var y=this._getFileManager();var w=y.getDeleteContentsIds();v.deletecontentsid=w;return v},_hookColumn:function(w){this._setElColumn(w);element=this._initElIframe();var v=element.attr("name");element=w.find('[name="file_upload_form_div"]');var x=element;var y=element.find("form");y.attr("target",v);this._initFileManager()},_elIframe:null,_getElIframe:function(){return this._elIframe},_initElIframe:function(){var A='[name="file_upload_iframe"]';var y=this._getElColumn();var x=y.find(A);var w=new Date();var v=x.attr("name")+"_"+w.getTime()+"_File_"+d.getNextTargetCount();x.attr("name",v);var B=function(){if(x[0]&&x[0].contentWindow){x[0].contentWindow.name=v}};if(g.browser.msie){try{if(x[0]&&x[0].readyState=="complete"){B()}else{x.one("load",function(){B()})}}catch(z){x.one("load",function(){B()})}}else{B()}return this._elIframe=x},_cleanColumn:function(x,v){var w;w=this._getElIframe();if(w){w.attr("name","file_upload_iframe")}},_fileManager:null,_getFileManager:function(){return this._fileManager||this._initFileManager()},_initFileManager:function(){var B=this._getElColumn();var x={};var z=this.setting.column.maxcount;x=B.find('[name="file_upload_form_div"]');var y=x;x=B.find('[name="upload_files"]');var D=x;x=B.find('[name="upload_file_not_select"]');var A=x;x=B.find('[name="upload_file_template"]');var C=x;x=B.find('[name="submit"]');var w=x;var E={maxFileCount:z,elPostFormOuter:y,elUploadFiles:D,elNotSelect:A,elIframe:this._getElIframe(),elTemplate:C,elSubmit:w,callbackOnSetTmpnm:this.__closure(this._setTmpnm),callbackOnGetTmpnm:this.__closure(this._getTmpnm)};var v=new neo.webdb.Record.ColumnManipulator.File.Manager(E);v.initialize();return this._fileManager=v},__closure:neo.core.getClosure}});var p=neo.webdb.Record.ImageColumnManipulator=new neo.core.Class({superClass:t,classProperties:{_lastTargetCount:0,getNextTargetCount:function(){return ++p._lastTargetCount}},properties:{_getColumnMap:function(w){var v={};if(this._removeImageFileContentsId&&this._removeImageFileContentsId.length){v.deletecontentsid=this._removeImageFileContentsId}return v},_hookColumn:function(y,w){var x;var z=this.setting.tid;x=y.find('[name="tid"]');x.val(z);x=y.find('[name="recordid"]');x.val(w.recordId);this._setEasyEditMode(w.isEasyEditMode);this._setElColumn(y);x=this._initElIframe();var v=x.attr("name");x=this._getElIframe();this.__bind(x,"load","IframeLoaded");x=y.find('[name="delete"]');this.__bind(x,"click","Delete");x=y.find('[name="file_upload_form_div"]');var A=x.find("form");A.attr("target",v);this.__bind(A,"submit","UploadForm");x=y.find('[name="submit"]');this.__bind(x,"click","Submit");this._removeImageFileContentsId=null},_removeImageFileContentsId:null,_elIframe:null,_getElIframe:function(){return this._elIframe},_initElIframe:function(){var z='[name="file_upload_iframe"]';var y=this._getElColumn();var x=y.find(z);var w=new Date();var v=x.attr("name")+"_"+w.getTime()+"_Image_"+p.getNextTargetCount();x.attr("name",v);var B=function(){if(x[0]&&x[0].contentWindow){x[0].contentWindow.name=v}};if(g.browser.msie){try{if(x[0]&&x[0].readyState=="complete"){B()}else{x.one("load",function(){B()})}}catch(A){x.one("load",function(){B()})}}else{B()}return this._elIframe=x},_cleanColumn:function(){var v;v=this._getElIframe();if(v){v.attr("name","file_upload_iframe")}},_isEasyEditMode:false,_getIsEasyEditMode:function(){return this._isEasyEditMode},_setEasyEditMode:function(v){return this._isEasyEditMode=v},__bind:neo.jq.bindListener,changeMode:function(w){var x=this._getElColumn();var v;v=x.find('[name="no_image"]');v.css("display",(w?"none":"block"));v=x.find('[name="upload_image"]');v.css("display",(!w?"none":"block"))},deleteImage:function(){var A;var C=this._getElColumn();var w=C.find('[name="image"]');var z=w.attr("content-id");var D=this;if(z.length){this._removeImageFileContentsId=z;w.attr("content-id","");this.changeMode(false)}else{this.changeMode(false);var E={callbackOnSuccess:function(){w.attr("file-no","")},callbackOnError:function(){D.changeMode(true)}};var x=new neo.webdb.pg_recordEdit.DeleteTempAttach(E);var B=this._getTmpnm();var y=w.attr("file-no");if(!y){return}A=C.find('[name="cid"]');var v=A.val();x.exec(B,y,v)}},onsubmitUploadForm:function(v){v.stopPropagation()},onclickSubmit:function(){var w=this._getElColumn();var v=w.find('[name="tmpnm"]');var x=this._getTmpnm();v.val(x)},onloadIframeLoaded:function(){var A=this._getElIframe();if(!A[0]||!A[0].contentWindow){return}var x=A[0].contentWindow;var E=x.neo_iframe_file_upload_result;if(!E){return}var G=this._getElColumn();A=G.find('[name="attach"]');A.before(g('<input type="file" name="attach" class="input_file_normal" size="33">'));A.remove();if(E.status!="ok"){var y=(E.errormessage||"")+" ["+E.errorno+"]";neo.webdb.alert(y);return}this.deleteImage();A=G.find('[name="cid"]');var C=A.val();A=G.find('[name="tid"]');var F=A.val();var w=G.find('[name="image"]');w.attr("file-no",E.fno);var D="dbrecorddownloadtempattach";var z={cmd:D,mode:"image",tmpnm:E.tmpnm,tid:F,cid:C,fno:E.fno};var v=neo.webdb.getMainUrl(z);w.attr("src",v);w.attr("alt","");this.changeMode(true);this._setTmpnm(E.tmpnm);if(this._getIsEasyEditMode()){var H={mode:neo.webdb.Record.ImageColumnSizeAdjustment.MODE_EASY_EDIT};var B=new neo.webdb.Record.ImageColumnSizeAdjustment(H);B.initialize();B.adjustByResize()}},onclickDelete:function(){this.deleteImage()}}});var b=neo.webdb.Record.RelKeyColumnManipulator=new neo.core.Class({classProperties:{CHILD_CALL_BACK_FUNCK_NAME:"onChildWindowCallBackDecideRelKey",getCallBackFuncDecideRelKey:function(){var v=b.CHILD_CALL_BACK_FUNCK_NAME;if(!window[v]){window[v]=function(x){if(x&&x.windowId){var w=x.windowId;var y=b.getCallBackFuncs();if(y[w]){y[w](x)}}}}return window[v]},getCallBackFuncs:function(){b.getCallBackFuncDecideRelKey();var v=b.CHILD_CALL_BACK_FUNCK_NAME+"Funcs";if(!window[v]){window[v]={}}return window[v]},setCallBackFunc:function(v,w){var x=b.getCallBackFuncs();x[v]=w}},superClass:t,properties:{_findElRelKey:function(v){return v.find('[name="relkey-key"]')},_isEasyEditMode:false,_getIsEasyEditMode:function(){return this._isEasyEditMode},_setEasyEditMode:function(v){return this._isEasyEditMode=v},_getColumnMap:function(x){var v={};var w;w=this._findElRelKey(x);v.key=w.val();return v},_setColumnMap:function(w,v){element=this._findElRelKey(w);element.val(v.key)},_hookColumn:function(x,v){var w={};this._setEasyEditMode(v.isEasyEditMode);this._setElColumn(x);w=x.find('[name="relkey-search_btn"]');this.__bind(w,"click","Search")},_getSubordinateColumns:function(){var x=this.setting.columns;var y=this._getElColumn();var z=y.attr("data-id");var v=[];for(var w in x){if(x[w]&&x[w].relkey==z&&x[w].type=="relcpy"){v.push(x[w])}}return v},_getRefSubordinateCoumns:function(){var x=this.setting.columns;var y=this._getElColumn();var z=y.attr("data-id");var v=[];for(var w in x){if(x[w]&&x[w].relkey==z&&x[w].type=="relref"){v.push(x[w])}}return v},__bind:neo.jq.bindListener,onclickSearch:function(){var y="";var x="";var z=this._getElColumn();y=z.find('[name="relkey-reltid"]');var A=y.val();var w=neo.webdb.newWindowId();x=location.pathname+"?cmd=dbrecordsearchrelkey&init=1&sv_tid="+A+"&wid="+w;var v=this;window.open(x,"searchrelkey");b.setCallBackFunc(w,function(D){var L=v._getSubordinateColumns();var F=A;var G=D.result.relKey;var H=v._findElRelKey(z);H.val(G);if(v._getIsEasyEditMode()){return}g("[name=s_ok]").attr("disabled","disabled");g("[name=s_close]").attr("disabled","disabled");var N={callbackOnSuccess:function(P){var U=v.setting.manager;for(var Q=0;Q<L.length;Q++){var S=L[Q];if(S.type!="relcpy"){continue}var O=G+"_"+S.relcolid;var T=P.result.recorddata[O];if(T.select){T.text=T.select;T.select=null}else{if(T.selects){T.texts=T.selects.replace(/(^\n+)|(\n+$)/g,"");T.selects=null}}var R=U.getManipulator(S.colid);if(!R){continue}R.updateColumnMap(T)}g("[name=s_ok]").removeAttr("disabled");g("[name=s_close]").removeAttr("disabled")}};var I=new neo.webdb.Record.GetTableData(N);var J="";for(var K=0;K<L.length;K++){J+=(K?",":"")+L[K].relcolid}I.exec(F,G,J);var E=v._getRefSubordinateCoumns();var M={callbackOnSuccess:function(S){var P=v.setting.elDetail;if(!P){throw new Error("neo.webdb.Record.RelKeyColumnManipulator : Not found detail");return}var Q=P.find(".layout-item-data");for(var U=0;U<E.length;U++){var X=E[U];if(X.type!="relref"){continue}var V=G+"_"+X.relcolid;var W=S.result.recorddata[V];var R=Q.filter('[data-id="'+X.colid+'"]');if(!R){continue}var T=R.find(".table_layout-cell_box");T.empty();T.append(W.element);if(X.reltype=="image"){var O=T.find(".data_image");O.click(function(aa){var ab=g(aa.target);var Z={fileName:ab.attr("alt")};var Y=ab.attr("src");if(Y){neo.webdb.image(Y,Z)}})}}v._adjustImageColumnSize()}};var C="";for(var K=0;K<E.length;K++){C+=(K?",":"")+E[K].relcolid}var B=new neo.webdb.Record.GetTableDataCellElement(M);B.exec(F,G,C)})}}})})(jQuery);