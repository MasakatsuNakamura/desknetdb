(function(c){var d=neo.core.readyNamespace("neo.webdb.Filter.Manager");if(!d){return}var b=neo.webdb.Filter;var a=neo.webdb.Filter.Manager=new neo.core.Class({classProperties:{CLS_FILTER:"filter",CLS_NAME:"filter-name",CLS_BTN_REMOVE:"btn-filter-remove",defaultSetting:{}},properties:{setting:null,_filters:null,_details:null,_conditionManipulatorMan:null,_getConditionManipulatorMan:function(){return this._conditionManipulatorMan||this._initConditionManipulatorMan()},_initConditionManipulatorMan:function(){var e={columns:this.setting.columns};var f=new b.ConditionManipulator.Manager(e);f.initialize();return this._conditionManipulatorMan=f},_elTemplate:null,_getElTemplate:function(){return this._elTemplate||this._initElTemplate()},_initElTemplate:function(){var e=c("#filter-prototype");if(e.length<1){throw new Error("neo.webdb.Filter.Manager : The template element is required.")}return this._elTemplate=e},__constructor:function(e){this.setting=e||{};this._filters=new neo.core.Strage();this._details=new neo.core.Strage()},initialize:function(){},_getDefaults:function(){return c.extend({},b.defaultSetting)},getElFilter:function(g,e){if(!g){return null}var f=this._filters.get(g);if(f&&f.parent().length>0){f=null}else{if(!f){f=this._buildElFilter(g,e)}this._hookFilter(f);this._filters.set(g,f)}return f},_buildElFilter:function(j,e){var h=this._getElTemplate().clone();var i=this._findElName(h);i.text(e);h.attr("data-id",j);var g={conditionManipulatorMan:this._getConditionManipulatorMan(),editable:this.setting.editable,elConditionsContainer:this.setting.elConditionsContainer,elFilter:h,id:j};var f=this._buildFilter(g);f.initialize();this._details.set(j,f);return h},_buildFilter:function(f){var e=new b(f);return e},_hookFilter:function(f){var g=this._findElName(f);this.__bind(g,"click");var e=this._findElBtnRemove(f);this.__bind(e,"click","Remove")},show:function(f){var e=this._details.get(f);e.show()},remove:function(f){var e=this._filters.get(f);e.remove();this._filters.remove(f)},getQuery:function(){var l=this._filters;var j=l.getIdList();var f=[];for(var g=0;g<j.length;g++){var m=j[g];var k=l.get(m);if(!k||k.parent().length<1){continue}var h=this._details.get(m);f.push(h.getQuery(g+1))}var e=f.join("&");return e},getFilterIdList:function(){var e=this._filters.getIdList();return e},_findFilterId:function(f){var e=this._findElContainmentFilter(f);var g=e.attr("data-id");return g},_findElContainmentFilter:function(e){return e.closest("."+a.CLS_FILTER)},_findElName:function(e){return e.find("."+a.CLS_NAME)},_findElBtnRemove:function(e){return e.find("."+a.CLS_BTN_REMOVE)},_getColumns:function(f){var e=this.setting.columns||{};return e[f]},_getComparisonType:function(){return this.setting.comparisonType},_getFilterDetails:function(f){var e=this.setting.filterDetails||{};return e[f]},__bind:neo.jq.bindListener,onclick:function(e){var f=c(e.target);var g=this._findFilterId(f);this.show(g)},onclickRemove:function(e){var f=c(e.target);var g=this._findFilterId(f);this.remove(g)},banpei:null}})})(jQuery);