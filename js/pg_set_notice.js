(function(b){var c=neo.core.readyNamespace("neo.webdb.pg_notice");if(!c){return}var a=neo.webdb.pg_notice={_elBtnOk:null,_getElBtnOk:function(){return this._elBtnOk||this._initElBtnOk()},_initElBtnOk:function(){return this._elBtnOk=b("#btnok")},_elBntUserAdd:null,_getElBntUserAdd:function(){return this._elBntUserAdd||this._initElBntUserAdd()},_initElBntUserAdd:function(){return this._elBntUserAdd=b("#btnadd")},_elBtnUserDel:null,_getElBtnUserDel:function(){return this._elBtnUserDel||this._initElBtnUserDel()},_initElBtnUserDel:function(){return this._elBtnUserDel=b("#btndel")},_elTxtNoticeName:null,_getElTxtNoticeName:function(){return this._elTxtNoticeName||this._initElTxtNoticeName()},_initElTxtNoticeName:function(){return this._elTxtNoticeName=b("[name=notice_name]")},_elChkBoxEventAdd:null,_getElChkBoxEventAdd:function(){return this._elChkBoxEventAdd||this._initElChkBoxEventAdd()},_initElChkBoxEventAdd:function(){return this._elChkBoxEventAdd=b("[name=event_flag_add]")},_elChkBoxEventMod:null,_getElChkBoxEventMod:function(){return this._elChkBoxEventMod||this._initElChkBoxEventMod()},_initElChkBoxEventMod:function(){return this._elChkBoxEventMod=b("[name=event_flag_mod]")},_elChkBoxEventDel:null,_getElChkBoxEventDel:function(){return this._elChkBoxEventDel||this._initElChkBoxEventDel()},_initElChkBoxEventDel:function(){return this._elChkBoxEventDel=b("[name=event_flag_del]")},_elChkBoxUser:null,_getElChkBoxUser:function(){return this._elChkBoxUser||this._initElChkBoxUser()},_initElChkBoxUser:function(){return this._elChkBoxUser=b("[name=notice_flag_users]")},_elChkBoxAny:null,_getElChkBoxAny:function(){return this._elChkBoxAny||this._initElChkBoxAny()},_initElChkBoxAny:function(){return this._elChkBoxAny=b("[name=notice_flag_any]")},_elChkBoxRegister:null,_getElChkBoxRegister:function(){return this._elChkBoxRegister||this._initElChkBoxRegister()},_initElChkBoxRegister:function(){return this._elChkBoxRegister=b("[name=notice_flag_register]")},_elSelUsers:null,_getElSelUsers:function(){return this._elSelUsers||this._initElSelUsers()},_initElSelUsers:function(){return this._elSelUsers=b("[name=notice_to_users]")},_elTxtAny:null,_getElTxtAny:function(){return this._elTxtAny||this._initElTxtAny()},_initElTxtAny:function(){return this._elTxtAny=b("[name=notice_to_any]")},_getSetting:function(d){var e=window.neo_webdb_pg_notice_setting;if(d){return e[d]}else{return e}},initialize:function(){var d;d=this._getElChkBoxUser().attr("checked");this._toggleNoticeUserList(d);d=this._getElChkBoxAny().attr("checked");this._toggleNoticeAnyList(d);this._hook();this._hookSelectUser()},_hook:function(){var d;d=this._getElBtnOk();this.__bind(d,"click","Ok");d=this._getElChkBoxUser();this.__bind(d,"click","ChkBoxUser");d=this._getElChkBoxAny();this.__bind(d,"click","ChkBoxAny");d=this._getElBtnUserDel();this.__bind(d,"click","DelUser")},_hookSelectUser:function(){var d=this._getElBntUserAdd();var e={selectedUsers:this.selectedUsers(),freeVisibility:true,selectedUserVisibility:true,single:false,updateIdList:this.__closure(this.selectedUsers),callbackOnChange:this.__closure(this.onchangeUser)};neo.webdb.bindUserSelectDialog(d,e)},selectedUsers:function(){var g=[];var e=this._getElSelUsers().find("option");for(var f=0;f<e.length;f++){var h=e.eq(f);var j=h.text();var d=j.lastIndexOf("<");if(d!=-1){j=j.substring(0,d)}if(h.val()){g[g.length]={id:h.val(),name:j}}}return g},onchangeUser:function(d){var h=this._getElSelUsers();h.children().remove();if(d.length<=0){return}for(var f=0;f<d.length;f++){var g=b("<option />").attr("title",d[f].name).text(d[f].name);g.val(d[f].id);h.append(g)}var e='<option value="" disabled="disabled">&nbsp;</option>';h.append(e)},_toggleNoticeUserList:function(d){var e=b("#notice_to_users_expand");if(d){e.show()}else{e.hide()}},_toggleNoticeAnyList:function(d){var e=b("#notice_to_any_expand");if(d){e.show()}else{e.hide()}},_submitUpdate:function(){var j=[];var d=this._getElSelUsers().children("[value!='']");for(var e=0;e<d.length;e++){j[e]=b(d[e]).val()}var h={cmd:"dbsetnoticemod",tid:this._getSetting("tableId"),notice_id:this._getSetting("noticeId"),notice_name:this._getElTxtNoticeName().val(),event_flag_add:!!this._getElChkBoxEventAdd().attr("checked")==true?"1":"0",event_flag_mod:!!this._getElChkBoxEventMod().attr("checked")==true?"1":"0",event_flag_del:!!this._getElChkBoxEventDel().attr("checked")==true?"1":"0",notice_flag_users:!!this._getElChkBoxUser().attr("checked")==true?"1":"0",notice_flag_any:!!this._getElChkBoxAny().attr("checked")==true?"1":"0",notice_flag_register:!!this._getElChkBoxRegister().attr("checked")==true?"1":"0",notice_to_users:j,notice_to_any:this._getElTxtAny().val()};var f={url:neo.webdb.getDbSettingUrl(),getSendData:this.__closure(function(){return h}),onsuccess:this.__closure(this.onsuccessUpdateNotice)};var g=new neo.webdb.Ajax(f);g.initialize();g.sendRequest();g=null},__closure:neo.core.getClosure,__bind:neo.jq.bindListener,onclickChkBoxUser:function(d){var e=this._getElChkBoxUser().attr("checked");this._toggleNoticeUserList(e)},onclickChkBoxAny:function(d){var e=this._getElChkBoxAny().attr("checked");this._toggleNoticeAnyList(e)},onclickOk:function(d){this._submitUpdate()},onsuccessUpdateNotice:function(e,d){var f={pg:"dbsetnoticelist",tid:this._getSetting("tableId")};location.href=neo.webdb.getDbSettingUrl(f)},onclickDelUser:function(d){var e=this._getElSelUsers();e.children().remove(":selected")},banpei:null};b(document).ready(function(){a.initialize()})})(jQuery);