(function(c){var e=neo.core.readyNamespace("neo.webdb.pg_tableList");if(!e){return}var a="OK";var d="キャンセル";var b=neo.webdb.pg_tableList={_getDbTree:function(){var f=neo.webdb.getTopWindow();return f.neo.webdb.pg_frame._getDbTree()},_elCreateTable:null,_getElCreateTable:function(){return this._elCreateTable||this._initElCreateTable()},_initElCreateTable:function(){return this._elCreateTable=c("#table-create")},_elStartSortingTables:null,_getElStartSortingTables:function(){return this._elStartSortingTables||this._initElStartSortingTables()},_initElStartSortingTables:function(){return this._elStartSortingTables=c("#table-start_sorting")},_elStopSortingTables:null,_getElStopSortingTables:function(){return this._elStopSortingTables||this._initElStopSortingTables()},_initElStopSortingTables:function(){return this._elStopSortingTables=c("#table-stop_sorting")},_elRemoveTable:null,_getElRemoveTable:function(){return this._elRemoveTable||this._initElRemoveTable()},_initElRemoveTable:function(){return this._elRemoveTable=c("#table-remove")},_elDownloadTemplate:null,_getElDownloadTemplate:function(){return this._elDownloadTemplate||this._initElDownloadTemplate()},_initElDownloadTemplate:function(){return this._elDownloadTemplate=c("#table-download_tmpl")},_elTableTable:null,_getElTableTable:function(){return this._elTableTable||this._initElTableTable()},_initElTableTable:function(){return this._elTableTable=c("#table-table")},_elTableNameLink:null,_getElTableNameLink:function(){return this._elTableNameLink||this._initElTableNameLink()},_initElTableNameLink:function(){return this._elTableNameLink=c(".table-name-link")},_getSetting:function(f){var g=window.neo_webdb_pg_tableList_setting;if(f){return g[f]}else{return g}},_getTableIdOf:function(g){var f=g.closest(".table-row");var h=f.attr("data-id");return h},_getElRowFrom:function(g){var f=g.closest(".table-row");return f},_getElSelectedRows:function(){var h=this._getElTableTable();var g=h.find(":checked");var f=this._getElRowFrom(g);return f},_getTableIdListOf:function(g){var k=[];for(var h=0;h<g.length;h++){var f=g.eq(h);var j=this._getTableIdOf(f);k.push(j)}return k},_sendDataToSort:null,_getSendDataToSort:function(){return this._sendDataToSort},_setSendDataToSort:function(f){return this._sendDataToSort=f},_ajaxSort:null,_getAjaxSort:function(){return this._ajaxSort||this._initAjaxSort()},_initAjaxSort:function(){var f={url:neo.webdb.getDbSettingUrl(),getSendData:this.__closure(function(){var h=c.extend({},this._getSendDataToSort());h.cmd="dbsettablelistseq";return h}),onsuccess:function(h,j){var k=neo.core.splitParam(j.url);if(k.js_pagemoved=="1"){var i=neo.webdb.getDbSettingUrl({pg:"dbsettablelist"});location.href=i}}};var g=new neo.webdb.Ajax(f);g.initialize();return this._ajaxSort=g},_elDelConfDialog:null,_getElDelConfDialog:function(){return this._elDelConfDialog||this._initElDelConfDialog()},_initElDelConfDialog:function(){var g=c("#dialog_deldb_conf");var i=g.attr("widthdialog");var h={width:Number(i),buttons:{}};h.buttons[a]=this.__closure(this.removeTable);h.buttons[d]=this.__closure(this.closeDialogDelConf);var f=neo.webdb.getDialog(g,h);return this._elDelConfDialog=f._getElSelfOrg()},initialize:function(){this.initSortableTable();this._hook()},initSortableTable:function(){var g=c(".sortable_table");var f={prevPage:this._getSetting("hasPrevPage"),nextPage:this._getSetting("hasNextPage"),ondrop:this.__closure(this.ondropSortable)};g.webdbSelectableTable().webdbSortableTable(f);if(g.webdbSortableTable("beforeReloadingIsSortMode")){this.startSortingTables()}else{this.stopSortingTables()}},_hook:function(){var f;f=this._getElCreateTable();this.__bind(f,"click","CreateTable");f=this._getElStartSortingTables();this.__bind(f,"click","StartSortingTables");f=this._getElStopSortingTables();this.__bind(f,"click","StopSortingTables");f=this._getElRemoveTable();this.__bind(f,"click","RemoveTable");f=this._getElDownloadTemplate();this.__bind(f,"click","DownloadTemplate");f=this._getElTableNameLink();this.__bind(f,"click","DbName")},createTable:function(){location.href=neo.webdb.getDbSettingUrl()+"?pg=dbsetcreatedbmenu"},startSortingTables:function(){var h=c(".sortable_table");h.webdbSortableTable("start");var f=this._getElStartSortingTables();f.hide();var g=this._getElStopSortingTables();g.show()},stopSortingTables:function(){var h=c(".sortable_table");h.webdbSortableTable("stop");var f=this._getElStartSortingTables();f.show();var g=this._getElStopSortingTables();g.hide()},getConfMsgDelDb:function(){var f=this._getElSelectedRows();if(f.length<1){var h="選択して下さい。";neo.webdb.alert(h);return}var j=this._getTableIdListOf(f);var g={url:neo.webdb.getDbSettingUrl(),getSendData:this.__closure(function(){var k={cmd:"dbsettablesetdelconfmsg",tid:j};return k}),onsuccess:this.__closure(this.onsuccessGetMsg)};var i=new neo.webdb.Ajax(g);i.initialize();i.sendRequest()},closeDialogDelConf:function(){neo.webdb.getDialog(this._getElDelConfDialog()).close()},removeTable:function(f){this.closeDialogDelConf();this._removeLow()},_removeLow:function(){var f=this._getElSelectedRows();var g=this._getTableIdListOf(f);this._submitRemoving(g);f.find(":checked").attr("checked",false)},_submitRemoving:function(j){this._buttonOff();var f=this;var i={tid:j};var g={url:neo.webdb.getDbSettingUrl(),getSendData:this.__closure(function(){var k=c.extend({},i);k.cmd="dbsettablesetdel";return k}),onsuccess:this.__closure(this.onsuccessRemoveDb),onerror:function(){f._buttonOn()}};var h=new neo.webdb.Ajax(g);h.initialize();h.sendRequest();h=null},downloadTemplate:function(){var g=this._getElSelectedRows();var i=this._getTableIdListOf(g);var h={tid:i};var j=c.extend({},h);j.cmd="dbsetdownloadtemplate";var f=neo.webdb.getDbSettingUrl(j);location.href=f},_sort:function(h,g,f){var j=this._getTableIdListOf(h);var i=g+this._getSetting("offset");this._submitSorting(j,i,f)},_submitSorting:function(j,g,f){var i={tgtrow:g,js_pagemoved:(f?"1":"0"),tid:j};this._setSendDataToSort(i);var h=this._getAjaxSort();h.sendRequest()},_buttonOff:function(){var f;f=this._getElCreateTable();f.attr("disabled","disabled").removeClass("btn");f=this._getElStartSortingTables();f.attr("disabled","disabled").removeClass("btn");f=this._getElStopSortingTables();f.attr("disabled","disabled").removeClass("btn");f=this._getElRemoveTable();f.attr("disabled","disabled").removeClass("btn");f=this._getElDownloadTemplate();f.attr("disabled","disabled").removeClass("btn")},_buttonOn:function(){var f;f=this._getElCreateTable();f.removeAttr("disabled").addClass("btn");f=this._getElStartSortingTables();f.removeAttr("disabled").addClass("btn");f=this._getElStopSortingTables();f.removeAttr("disabled").addClass("btn");f=this._getElRemoveTable();f.removeAttr("disabled").addClass("btn");f=this._getElDownloadTemplate();f.removeAttr("disabled").addClass("btn")},__closure:neo.core.getClosure,__bind:neo.jq.bindListener,onclickCreateTable:function(f){this.createTable()},onclickStartSortingTables:function(f){f.preventDefault();this.startSortingTables()},onclickStopSortingTables:function(f){f.preventDefault();this.stopSortingTables()},onclickRemoveTable:function(f){this.getConfMsgDelDb()},onclickDownloadTemplate:function(f){this.downloadTemplate()},ondropSortable:function(f,g){this._sort(g.elTargetRow,g.insertIntoIndex,g.pageMoved)},onsuccessRemoveDb:function(j,h){var f=this._getDbTree();var k=h.getSendData()["tid"];for(var g in k){f.removeElDbItem(k[g])}location.href=location.href},onclickDbName:function(g){var f=c(".sortable_table");var i=f.webdbSortableTable("isSorting");if(i){return}var h=c(arguments[arguments.length-1]);var j=h.closest(".table-row").attr("data-id");var k=[];k.pg="dbsettableset";k.tid=j;k.fpg=location.href;location.href=neo.webdb.getDbSettingUrl(k)},onsuccessGetMsg:function(g){var k=this._getElDelConfDialog();var n=k.find("#msg_deldb_conf_msg");var f=k.find("#msg_deldb_warning_msgs");n.empty();f.empty();var m=g.result.confmsg||"";m=neo.core.escape(m).replace(/(\n\r|\n|\r)/g,"<br>");n.html(m);var j=g.result.warningmsgs||[];if(j.length>0){for(var h=0;h<j.length;h++){var o=j[h];if(!o){continue}var l="<li>"+neo.core.escape(o)+"</li>";f.append(l)}f.show()}else{f.hide()}neo.webdb.getDialog(k).open()},banpei:null};c(document).ready(function(){b.initialize()})})(jQuery);